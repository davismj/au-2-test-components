{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@aurelia/kernel/dist/esnext/platform.js","webpack:///./src/elements/date-picker.html","webpack:///./src/pages/date-picker.html","webpack:///./src/shell.html","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/metadata.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/resource.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/functions.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/di.js","webpack:///./node_modules/tslib/tslib.es6.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/logger.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/path.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/profiler.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/eventaggregator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/subscriber-collection.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/proxy-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/setter-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/binding-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/signaler.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behavior.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converter.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ast.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/connectable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/property-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/call-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/expression-parser.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/interpolation-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/let-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ref-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-length-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/array-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-size-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/map-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/set-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/computed-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/scheduler.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/dirty-checker.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/primitive-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/property-accessor.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/self-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/binding-mode.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/debounce.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/signals.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/throttle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/bindable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attribute.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle-task.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/if.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/repeat.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/replaceable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/with.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/children.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-element.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/sanitize.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/render-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/rendering-engine.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/controller.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/activator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/aurelia.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/renderer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/ast.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-pattern.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-patterns.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-command.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/common.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/expression-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/resource-model.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/listener.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/attribute.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/attribute-ns-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/checked-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/class-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/data-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-property-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/event-manager.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/select-value-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/style-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/svg-analyzer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/value-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/attr.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/self.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/update-trigger.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/blur.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/focus.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/portal.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/create-element.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-elements/compose.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/html-renderer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-styles.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/projectors.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/attribute-patterns.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-binder.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-element-factory.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-compiler.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/html-attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/runtime-html-browser/dist/esnext/browser-scheduler.js","webpack:///./node_modules/@aurelia/runtime-html-browser/dist/esnext/index.js","webpack:///./node_modules/@aurelia/jit-html-browser/dist/esnext/index.js","webpack:///./node_modules/@aurelia/router/dist/esnext/queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/link-handler.js","webpack:///./node_modules/@aurelia/router/dist/esnext/utils.js","webpack:///./node_modules/@aurelia/router/dist/esnext/parser.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-instruction.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-content.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/type-resolvers.js","webpack:///./node_modules/@aurelia/router/dist/esnext/guard.js","webpack:///./node_modules/@aurelia/router/dist/esnext/guardian.js","webpack:///./node_modules/@aurelia/router/dist/esnext/interfaces.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/route-recognizer.js","webpack:///./node_modules/@aurelia/router/dist/esnext/route-table.js","webpack:///./node_modules/@aurelia/router/dist/esnext/router.js","webpack:///./node_modules/@aurelia/router/dist/esnext/navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/instruction-resolver.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/goto.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/configuration.js","webpack:///./src/converters/date.ts","webpack:///./src/elements/date-picker.ts","webpack:///./src/pages/date-picker.ts","webpack:///./src/shell.ts","webpack:///./src/main.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","$global","global","self","window","Function","_a","isBrowserLike","document","isWebWorkerLike","constructor","isNodeLike","process","versions","node","$now","getNanoSeconds","hrtime","moduleLoadTime","nodeLoadTime","upTime","performance","now","$performance","hr","uptime","Date","emptyArray","freeze","emptyObject","$PLATFORM","noop","assign","PLATFORM","g","this","e","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","marker","runClearTimeout","Item","array","nextTick","args","Array","arguments","push","apply","title","browser","env","argv","version","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","LogLevel","Reporter","level","code","params","error","metadataInternalSlot","WeakMap","ensureObject","target","TypeError","toPropertyKeyOrUndefined","propertyKey","GetOrCreateMetadataMap","O","P","Create","targetMetadata","Map","set","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","has","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","keys","keysObj","k","$define","metadataKey","metadataValue","$has","OrdinaryHasMetadata","parent","getPrototypeOf","$hasOwn","$get","OrdinaryGetMetadata","$getOwn","$getKeys","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeysLen","parentKeysLen","Set","add","$getOwnKeys","$delete","delete","OrdinaryDeleteMetadata","Metadata","define","hasOwn","getOwn","getKeys","getOwnKeys","obj","Reflect","writable","configurable","hasMetadata","hasDecorate","hasDefineMetadata","hasHasMetadata","hasHasOwnMetadata","hasGetMetadata","hasGetOwnMetadata","hasGetMetadataKeys","hasGetOwnMetadataKeys","hasDeleteMetadata","console","warn","ensurePropertyKeyOrUndefined","decorators","attributes","isArray","descriptor","decorated","decorator","DecorateProperty","toPropertyKey","DecorateConstructor","context","kind","keyFrom","resourceResolvers","resolver","root","getFactory","factory","definition","Type","undefined","instance","resolve","annotation","prop","keyFor","isKey","startsWith","map","Protocol","resource","fromAnnotationOrDefinitionOrTypeOrDefault","def","getDefault","fromAnnotationOrTypeOrDefault","fromDefinitionOrDefault","isNumericLookup","isNumeric","result","ch","charCodeAt","isNumberOrBigInt","isStringOrDate","baseCase","CharKind","isDigit","charToKind","char","toUpperCase","toLowerCase","input","cb","prevKind","sep","output","curChar","curKind","nextChar","charAt","nextKind","camelCase","cache","callback","pascalCase","slice","kebabCase","ids","nextId","compareNumber","a","b","mergeDistinct","arr1","arr2","lookup","arr3","item","len1","len2","bound","boundFn","mergeArrays","arrays","arraysLen","arrayLen","j","firstDefined","values","getPrototypeChain","functionPrototype","proto","chain","toLookup","objs","cloneArrayWithPossibleProps","source","clone","register","annotationParamtypes","appendTo","dependencies","inject","designParamtypes","getDesignParamtypes","getAnnotationParamtypes","Proto","getDependencies","auAnnotationParamtype","friendlyName","Interface","index","getOrCreateAnnotationParamTypes","noDefault","withDefault","configure","container","trueKey","registerResolver","singleton","transient","aliasTo","destinationKey","dep","fn","Registration","IContainer","createInterface","IServiceLocator","createResolver","handler","requestor","getAll","ResolverStrategy","strategy","state","String","construct","getResolver","Factory","invoker","transformers","dynamicDependencies","invokeWithDynamicDependencies","invoke","ii","transformer","createFactory","staticDependencies","classInvokers","deps","fallbackInvoker","containerResolver","isRegistry","nextContainerId","id","registerDepth","path","toString","resolvers","current","jj","defs","validateKey","indexOf","isResourceKey","registerTransformer","autoRegister","jitRegister","searchAncestors","buildAllResponse","keyAsValue","registrationResolver","newResolver","ParameterizedRegistry","filter","x","alias","originalKey","aliasKey","defer","results","ColorOptions","__decorate","desc","getOwnPropertyDescriptor","decorate","__param","paramIndex","ILogConfig","ISink","ILogEventFactory","ILogger","format","red","str","green","yellow","blue","magenta","cyan","white","grey","LogConfig","colorOptions","getLogLevelString","logLevelString","TRC","DBG","INF","WRN","ERR","FTL","QQQ","getIsoString","timestamp","toISOString","DefaultLogEvent","severity","message","optionalParams","scope","join","getScopeString","DefaultLogEventFactory","config","logger","ConsoleSink","$console","event","debug","info","DefaultLogger","sinks","sinksLen","msgOrGetMsg","createLogEvent","trace","messageOrGetMessage","fatal","encodeURIComponent","Profiler","timers","profileMap","profiler","createTimer","depth","mark","enter","topLevelCount","totalCount","leave","duration","enable","timer","enabled","disable","report","sort","forEach","Handler","messageType","invokeCallback","data","invokeHandler","handle","eventLookup","messageHandlers","channelOrInstance","subscribers","channel","channelOrType","idx","splice","sub","subscribe","dispose","subscriberCollection","_subscriberFlags","addSubscriber","removeSubscriber","hasSubscriber","hasSubscribers","callSubscribers","unsubscribe","collectionSubscriberCollection","_collectionSubscriberFlags","addCollectionSubscriber","removeCollectionSubscriber","hasCollectionSubscriber","hasCollectionSubscribers","callCollectionSubscribers","subscribeToCollection","unsubscribeFromCollection","subscriber","subscriberFlags","_subscriber0","_subscriber1","_subscriber2","_subscribersRest","addProxySubscriber","hasProxySubscriber","_proxySubscriberFlags","_proxySubscriber0","_proxySubscriber1","_proxySubscriber2","_proxySubscribersRest","_collectionSubscriber0","_collectionSubscriber1","_collectionSubscriber2","_collectionSubscribersRest","removeProxySubscriber","hasProxySubscribers","newValue","previousValue","flags","subscriber0","subscriber1","subscriber2","callSubscriber","ownFlags","handleChange","callProxySubscribers","handleProxyChange","indexMap","handleCollectionChange","ProxyObserver_1","ProxySubscriberCollection","proxy","raw","inBatch","getOrCreate","oldValue","Proxy","$raw","proxyObserver","$observer","getRawIfProxy","receiver","callPropertySubscribers","deleteProperty","thisArg","argArray","subscribeToProxy","unsubscribeFromProxy","lifecycle","currentValue","observing","persistentFlags","batch","getValue","setValue","write","RuntimeError","keyOrObj","$synthetic","bc","ancestor","part","overrideContext","parentOverrideContext","bindingContext","parentScope","scopeParts","includes","$observers","oc","OverrideContext","ps","poc","ISignaler","Signaler","signals","listener","TargetedInstructionType","ITargetedInstruction","HooksDefinition","hasRender","hasCreated","hasBinding","hasBound","hasUnbinding","hasUnbound","hasAttaching","hasAttached","hasDetaching","hasDetached","hasCaching","registerAliases","aliases","bindingBehavior","nameOrDef","BindingBehavior","none","getAnnotation","isType","valueConverter","ValueConverter","hasBind","expr","$kind","hasUnbind","CustomExpression","locator","expression","behaviorKey","evaluate","connect","behavior","evalList","unbind","visitor","visitBindingBehavior","converterKey","converter","toView","fromView","signaler","addSignalListener","removeSignalListener","visitValueConverter","AssignExpression","visitAssign","ConditionalExpression","condition","yes","no","visitConditional","visitAccessThis","$this","$parent","evaluatedValue","observeProperty","visitAccessScope","AccessMemberExpression","visitAccessMember","visitAccessKeyed","func","getFunction","visitCallScope","CallMemberExpression","visitCallMember","visitCallFunction","operation","left","right","f","visitBinary","visitUnary","PrimitiveLiteralExpression","visitPrimitiveLiteral","$undefined","$null","$true","$false","$empty","ArrayLiteralExpression","elements","visitArrayLiteral","ObjectLiteralExpression","visitObjectLiteral","cooked","expressions","visitTemplate","visitTaggedTemplate","ArrayBindingPattern","visitArrayBindingPattern","ObjectBindingPattern","visitObjectBindingPattern","BindingIdentifier","visitBindingIdentifier","declaration","iterable","size","$array","arr","entry","entries","$map","$set","$number","visitForOfStatement","parts","isMulti","firstExpression","visitInterpolation","list","proxyAndOriginalArray","rawArray","BindingMode","BindingStrategy","State","Hooks","LifecycleFlags","ExpressionKind","ViewModelKind","IController","MountStrategy","IViewFactory","ILifecycle","BoundQueue","head","tail","begin","end","controller","prevBound","nextBound","next","cur","UnboundQueue","prevUnbound","nextUnbound","unbound","AttachedQueue","mount","prevAttached","nextAttached","attached","DetachedQueue","unmount","prevDetached","nextDetached","detached","MountQueue","remove","log","prevMount","nextMount","UnmountQueue","prevUnmount","nextUnmount","BatchQueue","flushBatch","slotNames","versionSlotNames","lastSlot","ensureEnoughSlotNames","currentSlot","addObserver","observer","observerSlots","propertyName","observerLocator","getObserver","unobserve","all","slots","slotName","connectableDecorator","connectable","assignIdTo","oneTime","toViewOrOneTime","sourceExpression","targetProperty","$state","$scope","targetObserver","$lifecycle","_previousValue","updateTarget","updateSource","$unbind","getAccessor","$args","callSource","IExpressionParser","expressionLookup","forOfLookup","interpolationLookup","bindingType","found","parseCore","split","firstPart","endsWith","replace","currentPart","BindingType","MultiInterpolationBinding","interpolation","$bind","isFirst","_newValue","toBindingContext","SubscriberFlags","DelegationStrategy","CollectionKind","createIndexMap","deletedItems","isIndexMap","CollectionLengthObserver","sortCompare","y","preSortCompare","insertionSort","from","to","compareFn","velement","ielement","vtmp","itmp","order","quickSort","v0","v1","v2","i0","i1","i2","c01","c02","c12","vpivot","ipivot","lowEnd","highStart","vtopElement","thirdIndex","partition","$push","$unshift","unshift","$pop","pop","$shift","shift","$splice","$reverse","reverse","$sort","methods","observe","argCount","notify","inserts","element","start","deleteCount","relativeStart","actualStart","Math","max","min","actualDeleteCount","itemCount","deleted","middle","lower","upper","lowerValue","lowerIndex","upperValue","upperIndex","descriptorProps","method","enableArrayObservationCalled","enableArrayObservation","collection","lengthObserver","getArrayObserver","CollectionSizeObserver","$clear","clear","oldSize","deleteResult","enableMapObservationCalled","enableMapObservation","getMapObserver","$add","enableSetObservationCalled","observedSet","enableSetObservation","getSetObserver","computedOverrideDefaults","static","volatile","CustomSetterObserver","convertProperty","overrides","propertyDeps","collectionDeps","subscriberCount","isCollecting","createGetterTraps","subscribable","getValueAndCollectDependencies","unsubscribeAllDependencies","requireCollect","doNotCollect","addCollectionDep","addPropertyDep","proxyOrValue","defaultClockSettings","forceUpdateInterval","round","num","prefix","TaskQueue","created","preempt","reusable","repeat","IClock","globalClock","opts","highRes","TaskQueuePriority","IScheduler","createPromise","$resolve","$reject","executor","reject","Promise","defaultQueueTaskOptions","delay","priority","persistent","clock","scheduler","processingSize","processingHead","processingTail","pendingSize","pendingHead","pendingTail","delayedSize","delayedHead","delayedTail","flushRequested","yieldPromise","taskPool","taskPoolSize","lastRequest","microTaskRequestFlushTask","cancel","movePendingToProcessing","moveDelayedToProcessing","requestFlush","getTaskQueue","queueTask","noMoreFiniteWork","cancelFlush","time","task","reuse","Task","prev","status","taskQueue","addToProcessing","queueTime","addToPending","addToDelayed","removeFromProcessing","removeFromDelayed","removeFromPending","reset","createdTime","finish","count","TaskAbortError","super","_result","_status","promise","ret","resetPersistentTask","err","returnToPool","isEmpty","IDirtyChecker","DirtyCheckSettings","framesPerCheck","disabled","throw","tracked","elapsedFrames","DirtyCheckProperty","queueRenderTask","check","delta","isDirty","flush","dirtyChecker","addProperty","removeProperty","PrimitiveObserver","doNotCache","getStringLength","returnUndefined","PropertyAccessor","setValueDirect","IObserverLocator","ITargetObserverLocator","ITargetAccessorLocator","targetObserverLocator","targetAccessorLocator","adapters","isBindingContext","getObservers","observersLookup","createPropertyObserver","getOrCreateObserversLookup","adapter","handles","overridesAccessor","observedArray","observedMap","createObserversLookup","isNode","getLengthObserver","createProperty","subject","pd","getPropertyDescriptor","adapterObserver","getAdapterObserver","computed","givenOverrides","createComputedObserver","cbName","isProxy","createGetterSetter","BindingModeBehavior","originalModes","twoWay","getPostRenderTaskQueue","taskQueueOpts","methodName","originalHandler","wrappedHandler","DebounceBindingBehavior","debouncer","stop","signal","names","lastCall","nextDelay","ThrottleBindingBehavior","throttler","configOrTarget","$target","$prop","Bindable","isBindableAnnotation","bindableLists","bindables","addName","maybeList","addDescription","builder","configOrProp","attribute","primary","propStart","prototypeChain","keysLen","Class","iProto","iDefs","customAttribute","CustomAttribute","templateController","isTemplateController","defaultBindingMode","hooks","INode","IRenderLocation","IDOM","ni","niDOM","addEventListener","appendChild","cloneNode","convertToRenderLocation","createDocumentFragment","createElement","createCustomEvent","dispatchEvent","createNodeObserver","createTemplate","createTextNode","insertBefore","isMarker","isNodeInstance","isRenderLocation","makeTarget","registerElementResolver","removeEventListener","setAttribute","DOM","dom","isInitialized","descriptors","protos","getOwnPropertyDescriptors","NodeSequence","empty","isMounted","isLinked","childNodes","firstChild","lastChild","findTargets","refNode","location","view","hold","$controller","attach","detach","InfrequentMutations","FrequentMutations","ObserveShallow","LifecycleTask","done","canCancel","wait","TaskSlot","IStartTask","TaskType","StartTask","$StartTask","type","_slot","_promiseOrTask","_container","_key","_callback","_task","promiseOrTask","at","slot","ProviderTask","TerminalTask","IStartTaskManager","tasks","startTask","resolveTask","AggregateTerminalTask","PromiseTask","hasStarted","isCancelled","then","nextResult","maybePromiseOrTask","catch","ContinuationTask","antecedent","AggregateContinuationTask","antecedents","hasAsyncWork","ifFactory","elseFactory","elseView","ifView","swap","attachView","release","ensureView","deactivate","updateView","activate","bindView","ifBehavior","viewModel","prevIndices","tailIndices","renderable","hasPendingInstanceMutation","views","normalizedItems","checkCollectionObserver","bindings","forOf","local","normalizeToArray","processViewsKeyed","attachViews","detachViewsByRange","unbindAndRemoveViewsByRange","oldLength","createAndBindAllViews","attachViewsKeyed","offset","applyMutationsToIndices","detachViewsByKey","unbindAndRemoveViewsByKey","createAndBindNewViewsByKey","sortViewsByKey","oldObserver","newObserver","rawCollection","getCollectionObserver","items","iterate","iStart","iEnd","adjustLength","deletedLen","viewScope","newLen","setContextualProperties","fromParent","mapLen","nodes","unlink","copy","synchronizeIndices","seq","maxLen","Int32Array","cursor","low","high","mid","longestIncreasingSubsequence","seqLen","link","isLast","isEven","$index","$first","$last","$middle","$even","$odd","$length","bindChild","isChildrenObserverAnnotation","Children","childrenObserverLists","childrenObservers","options","query","customElement","CustomElement","template","instructions","needsCompile","surrogates","containerless","isStrictBinding","shadowOptions","hasSlots","generateName","generateType","behaviorFor","nameDescriptor","defaultProto","IProjectorLocator","SCRIPT_REGEX","ISanitizer","SanitizeValueConverter","sanitizer","untrustedMarkup","sanitize","parentContainer","componentType","createChild","renderableProvider","elementProvider","instructionProvider","factoryProvider","renderLocationProvider","renderer","IRenderer","getDefinition","targets","host","render","instruction","prepare","addParts","renderingEngine","IRenderingEngine","getViewFactory","ITemplateCompiler","ViewCompileFlags","ITemplateFactory","renderContext","viewModelOrController","createNodeSequence","IInstructionRenderer","templateFactory","compiler","parentContext","templateFromSource","partialDefinition","factorykey","setCacheSize","templateKey","templateFromSourceCore","compiledDefinitionKey","compiledDefinition","compile","createRuntimeCompilationResources","surrogate","defaultChildQuery","defaultChildFilter","defaultChildMap","children","tryStartObserving","projector","filterChildren","subscribeToChildrenChange","onChildrenChanged","vmKind","viewCache","controllers","mountStrategy","createObservers","getBindingContext","getElementTemplate","getElementProjector","canReturnToCache","unmountSynthetic","bindCustomElement","bindCustomAttribute","bindSynthetic","unbindCustomElement","unbindCustomAttribute","unbindSynthetic","attachCustomElement","attachCustomAttribute","attachSynthetic","detachCustomElement","detachCustomAttribute","detachSynthetic","mountCustomElement","mountSynthetic","unmountCustomElement","cacheCustomElement","cacheCustomAttribute","cacheSynthetic","find","bindBindings","bindControllers","endBind","unbinding","unbindControllers","endUnbind","unbindBindings","attaching","attachControllers","detaching","detachControllers","project","take","tryReturnToCache","caching","description","observers","observableNames","getOwnPropertyNames","useProxy","hasChildrenObservers","childObserverNames","childrenDescription","noProxy","isCaching","cacheSize","parentId","doNotOverrideIfAlreadySet","maxCacheSize","parseInt","forSyntheticView","seenViews","WeakSet","notYetSeen","$view","toCustomElementDefinition","Views","definitions","$views","IViewLocator","lifecycleCallbacks","ViewValueConverter","viewLocator","viewNameOrSelector","getViewComponentForObject","IActivator","taskManager","component","mgr","runBeforeRender","runBeforeBind","runBeforeAttach","getController","forCustomElement","initializer","IDOMInitializer","initialize","activator","beforeCreateTask","runBeforeCreate","createTask","combinedAntecedent","createContainer","_isRunning","_isStarting","_isStopping","_root","isRunning","onBeforeStart","onAfterStart","onBeforeStop","onAfterStop","detail","bubbles","cancelable","Aurelia","instructionRenderer","instructionType","decoratedTarget","metadataKeys","ownProperties","instructionRenderers","record","targetInstructions","surrogateInstructions","ensureExpression","parser","srcOrExpr","parse","addBinding","addComponent","getTarget","potentialTarget","setControllerReference","referenceName","$auRefs","$au","ControllersLookup","SetPropertyRenderer","beginComponentOperation","res","childInstructions","forCustomAttribute","renderLocation","childInstruction","refHost","refTargetName","tagName","refTargetController","getRefTarget","DefaultComponents","modelInstanceToBoundComponent","modelTypeToUnboundComponent","availableViews","resolvedViewName","getViewName","getOrCreateBoundComponent","BoundComponent","UnboundComponent","getOrCreateUnboundComponent","getView","requestedName","v","DefaultResources","DefaultRenderers","RuntimeConfiguration","InterpolationInstruction","IteratorBindingInstruction","CallBindingInstruction","RefBindingInstruction","SetPropertyInstruction","HydrateElementInstruction","HydrateAttributeInstruction","HydrateTemplateController","LetElementInstruction","LetBindingInstruction","AttrSyntax","rawName","rawValue","command","CharSpec","chars","isSymbol","isInverted","hasOfNoneInverse","hasOfSingleInverse","hasOfMultipleInverse","hasOfNone","hasOfSingle","hasOfMultiple","other","_pattern","currentRecord","partsRecord","pattern","charSpec","patterns","nextStates","types","isEndpoint","child","equals","findChild","interpretation","childLen","append","StaticSegment","text","specs","DynamicSegment","symbols","spec","SymbolSegment","SegmentTypes","statics","dynamics","ISyntaxInterpreter","SyntaxInterpreter","rootState","initialStates","defOrDefs","currentState","segments","eachChar","states","getNextStates","aTypes","bTypes","findMatches","IAttributePattern","attributePattern","patternDefs","AttributePattern","definitionAnnotationKey","validatePrototype","getPatternDefinitions","IAttributeParser","interpreter","attrPatterns","attrPattern","interpret","bindingCommand","nameOrDefinition","BindingCommand","makeCamelCase","bindable","propName","syntax","SymbolFlags","createMarker","CustomAttributeSymbol","_bindings","PlainAttributeSymbol","BindingSymbol","default","unescapeCode","Access","Precedence","Token","Char","startIndex","lastIndex","currentToken","tokenValue","assignable","currentChar","SyntaxError","SemanticError","parseExpression","access","minPrecedence","nextToken","fromCharCode","parseInterpolation","op","TokenValues","consumeOpt","consume","parseArrayLiteralExpression","parseObjectLiteralExpression","parseTemplate","statement","parseForOfStatement","strings","opToken","tokenRaw","tagged","scanTemplateTail","CharScanners","scanNumber","isFloat","parseFloat","scanTemplate","token","expected","KeywordLookup","true","null","false","in","instanceof","typeof","void","of","codes","decompress","compressed","rangeCount","fill","returnToken","unexpectedCharacter","notMapped","IdParts","Uint8Array","quote","unescaped","buffer","last","unescapedStr","scanString","DefaultBindingSyntax","DefaultBindingLanguage","BindableInfo","attr","bindableInfo","hasPrimary","isPrimary","resources","elementLookup","attributeLookup","commandLookup","optional","IAttrSyntaxTransformer","targetEvent","delegationStrategy","preventDefault","eventManager","$event","AttributeObserver","targetAttribute","hasChanges","flushChanges","classList","style","setProperty","mutationRecords","shouldProcess","attributeName","contains","getPropertyValue","getAttribute","startObservation","stopObservation","subscription","$eMObservers","$mObserver","handleMutation","disconnect","invokeHandleMutation","$scheduler","AttributeNSAccessor","namespace","removeAttributeNS","setAttributeNS","getAttributeNS","defaultMatcher","CheckedObserver","arrayObserver","valueObserver","model","synchronizeElement","elementValue","isRadio","matcher","checked","findIndex","nameIndex","isActive","classesToAdd","getClassesToAdd","addClassesAndUpdateIndex","classString","matches","match","splitClassString","classes","className","DataAttributeAccessor","removeAttribute","ElementPropertyAccessor","findOriginalEventTarget","composedPath","deepPath","stopPropagation","standardStopPropagation","propagationStopped","handleCapturedEvent","orderedCallbacks","capturedCallbacks","parentNode","orderedCallback","handleEvent","handleDelegatedEvent","delegatedCallbacks","ListenerTracker","eventName","capture","DelegateOrCaptureSubscription","decrement","TriggerSubscription","EventSubscriber","events","callbackOrListener","IEventManager","delegatedHandlers","capturedHandlers","handlerEntry","bubbling","increment","capturing","childObserverOptions","childList","subtree","characterData","SelectValueObserver","nodeObserver","multiple","synchronizeOptions","synchronizeValue","option","optionValue","selected","handleNodeChange","styles","cssText","styleTuples","rx","pair","exec","getStyleTuples","getStyleTuplesFromString","getStyleTuplesFromArray","getStyleTuplesFromObject","tuple","ISVGAnalyzer","ValueAttributeObserver","xlinkNS","xmlNS","xmlnsNS","nsAttributes","inputEvents","selectEvents","contentEvents","scrollEvents","overrideProps","svgAnalyzer","nsProps","isDataAttribute","IsDataAttribute","isStandardSvgAttribute","handleSelfEvent","selfEventCallSource","unset","defaultCaptureEventInit","passive","defaultBubbleEventInit","blurDocMap","BlurManager","blurs","createHandler","blur","addListeners","removeListeners","doc","win","navigator","pointerEnabled","linkedMultiple","searchSubTree","linkingContext","manager","createFor","unregister","triggerBlur","els","containsElementOrShadowRoot","linkedWith","links","contextNode","querySelector","body","querySelectorAll","el","onBlur","nodeType","checkTargets","hasChecked","revertCheckage","markChecked","handleMousedown","composed","handleEventTarget","onpointerdown","ontouchstart","onmousedown","onfocus","onblur","Focus","needsApply","valueChanged","activeElement","focus","toTask","originalLoc","strict","currentTarget","callbackContext","targetChanged","oldTarget","newTarget","resolveTarget","activating","activated","deactivating","deactivated","$document","queryContext","HTMLTargetedInstructionType","isHTMLTargetedInstruction","TextBindingInstruction","SetAttributeInstruction","SetClassAttributeInstruction","SetStyleAttributeInstruction","AttributeBindingInstruction","tagOrType","props","allInstructions","hasInstructions","addChildren","createElementForTag","createElementForType","lazyDefinition","engine","mergeInto","composing","lastSubject","properties","reduce","acc","compose","viewPromise","resolveView","onComposed","provideViewFor","lockScope","createView","NodeType","TNode","TElement","THTMLElement","TCustomEvent","TCSSStyleSheet","TShadowRoot","Node","Element","HTMLElement","CustomEvent","CSSStyleSheet","ShadowRoot","destroy","publisher","deep","locationEnd","createComment","locationStart","replaceChild","$start","$nodes","markupOrNode","content","fragment","init","fetch","eventType","evt","MutationObserver","takeRecords","markup","innerHTML","nodeToInsert","referenceNode","nodeName","potentialNode","textContent","removeChild","FragmentNodeSequence","targetNodeList","childNodeList","addToLinked","nextSibling","obtainRefNode","previousSibling","parentRenderContext","SetAttributeRenderer","SetClassAttributeRenderer","addClasses","SetStyleAttributeRenderer","noopShadowDOMStyles","applyTo","IShadowDOMStyles","IShadowDOMGlobalStyles","defaultShadowOptions","shadowRoot","attachShadow","toArray","getRootNode","HostProjector","$component","RuntimeHtmlConfiguration","physicalNode","isTarget","_customAttributes","_plainAttributes","_childNodes","_parts","isContainerless","partName","invalidSurrogateAttribute","attributesToIgnore","hasInlineBindings","isTemplateControllerOf","manifest","attrParser","exprParser","attrSyntaxTransformer","attrSyntax","getBindingCommand","attrInfo","getAttributeInfo","transform","bindPlainAttribute","bindChildNodes","parentManifest","manifestRoot","parentManifestRoot","bindLetElement","elementInfo","getElementInfo","bindAttributes","symbol","manifestProxy","previousController","currentController","declareTemplateController","ensureAttributeOrder","manifestNode","currentTemplate","processTemplateControllers","partOwner","replacePart","proxyNode","processReplacePart","plainAttributes","modelOrValueIndex","checkedIndex","childNode","nextChild","bindManifest","bindText","textNode","wholeText","processInterpolationText","attrRawValue","bindMultiAttribute","customAttributes","valueLength","attrName","attrValue","attrTarget","ITemplateElementFactory","markupCache","firstElementChild","nextElementSibling","attrSyntaxModifier","descriptions","binder","compilation","customAttributeLength","plainAttributeLength","compileCustomAttribute","compilePlainAttribute","compileChildNodes","toDefinition","instructionRows","compileParentNode","instructionRow","compileAttributes","compileBindings","compileParts","compileCustomElement","compilePlainElement","compileTemplateController","controllerInstructionRows","controllerScopeParts","bindingInstructions","compileBinding","attributeInstructions","plainAttributesLength","isOnSurrogate","replaceParts","partScopeParts","partInstructionRows","hasAttribute","shouldDefaultToTwoWay","createMicrotaskFlushRequestor","called","wnd","queueMicrotask","$window","$flush","callFlush","createQueueMicrotaskFlushRequestor","createPromiseFlushRequestor","flip","val","createMutationObserverFlushRequestor","createSetTimeoutFlushRequestor","request","createRequestAnimationFrameFlushRequestor","cancelAnimationFrame","requestAnimationFrame","createPostRequestAnimationFrameFlushRequestor","rafHandle","timeoutHandle","queueFlush","createRequestIdleCallbackFlushRequestor","hasNative","requestIdleCallback","cancelIdleCallback","BrowserScheduler","microTaskTaskQueue","renderTaskQueue","macroTaskTaskQueue","postRenderTaskQueue","idleTaskQueue","yield","yieldIdleTask","yieldPostRenderTask","yieldMacroTask","yieldRenderTask","yieldMicroTask","ownerDocument","RuntimeHtmlBrowserConfiguration","JitHtmlBrowserConfiguration","Queue","pending","processing","allowedExecutionCostWithinTick","currentExecutionCostInCurrentTick","dequeue","itemOrItems","costOrCosts","costs","promises","qItem","cost","reason","useUrlFragmentHash","forwardedState","handlePopstate","ev","enqueue","processCalls","qCall","parameters","suppressPopstate","history","pendingCalls","pathname","search","hash","currentEntry","viewerState","go","navigationEntry","firstEntry","pushNavigatorState","calls","_resolve","LinkHandler","useHref","getEventInfo","shouldHandleEvent","anchor","closestAnchor","targetIsThisWindow","altKey","ctrlKey","metaKey","shiftKey","goto","href","leftButtonClicked","button","targetWindow","arrayRemove","removed","arrIndex","parseQuery","param","kv","decodeURIComponent","mergeParameters","specifiedParameters","parsedQuery","parsedParameters","merged","namedParameters","parameterList","viewport","ownsScope","nextScopeInstructions","componentName","componentInstance","viewportName","parametersString","parametersList","needsViewportDescribed","setComponent","setViewport","setParameters","ComponentAppellationResolver","isName","getName","getType","isInstance","getInstance","owningScope","isComponentName","isComponentType","isComponentInstance","router","getViewport","compareParameters","compareType","ContentStatus","fullStateInstruction","contentStatus","entered","fromCache","fromHistory","reentry","taggedNodes","toComponentType","sameComponent","reentryBehavior","toComponentInstance","previousInstruction","canEnter","typeParameters","nextInstruction","canLeave","stateful","clearTaggedNodes","getElementsByTagName","top","scrollTo","scrollTop","scrollLeft","removeComponent","terminateComponent","unloadComponent","destroyComponent","nextContent","forceRemove","elementResolve","previousViewportState","historyCache","viewportInstruction","instructionResolver","parseViewportInstruction","isClearViewportInstruction","navigation","back","forward","cached","isCacheEqual","equalComponent","refresh","equalParameters","clearState","usedBy","noLink","noHistory","parseViewportInstructions","freeContent","doForceRemove","statefulHistory","some","waitForElement","createComponent","loadComponent","initializeComponent","unloadContent","vp","viewports","alreadyFound","disregardViewports","foundViewports","remainingInstructions","availableViewports","getEnabledViewports","viewportInstructions","remaining","foundViewport","wantComponent","newScope","addViewport","forceDescription","acceptComponent","remainingViewports","withoutViewports","doesntNeedViewportDescribed","rem","addChild","setElement","includeDisabled","allViewports","enabledViewports","reparentViewportInstructions","ViewportHandleResolver","NavigationInstructionResolver","toViewportInstructions","navigationInstructions","viewportComponent","Guard","guard","includeTargets","excludeTargets","include","exclude","navigationInstruction","cvTarget","GuardTypes","ReentryBehavior","guards","before","lastIdentity","guardFunction","modified","outcome","nav","route","linkVisible","linkActive","visible","active","meta","parseRoute","computeLink","consideredActive","execute","update","computeVisible","computeActive","activeChild","routes","components","activeComponents","flattenViewportInstructions","every","stringifyViewportInstructions","addRoute","updateRoutes","newRoute","RegExp","RouteTable","transformFromUrl","transformToUrl","IRouteTransformer","IRouter","routeTransformer","linkHandler","rootScope","navs","addedViewports","statefulHistoryLength","loadedFirst","processingNavigation","lastNavigation","linkCallback","origin","navigatorCallback","processNavigations","navigatorSerializeCallback","async","preservedEntries","excludeComponents","preservedEntry","serialized","alreadyDone","freeComponents","browserNavigatorCallback","browserNavigationEvent","fromBrowser","navigate","qInstruction","reportCallback","instructionNavigation","clearUsedViewports","transformedInstruction","instr","isClearAllViewportsInstruction","clearViewports","doneDefaultViewports","defaultViewports","updatedViewports","alreadyFoundInstructions","findViewports","defaultViewport","defaultInstruction","changedViewports","guardian","passes","cancelNavigation","setNextContent","abortContentChange","addedViewport","updated","clearViewportInstruction","loadContent","replacePaths","updateNav","new","first","repeating","untracked","finalizeContentChange","finalize","separators","store","serializeCallback","replacing","ensureRootScope","closestScope","findScope","closestViewport","parentElement","removeViewport","findNav","addNav","addRoutes","$viewport","cloneViewportInstructions","routeOrInstructions","fullViewportStates","qEntry","navigationFlags","uninitializedEntry","loadState","refreshing","historyMovement","pendingNavigations","movement","newIndex","saveState","getState","storedEntry","toStoredEntry","toStoreableEntry","replaceNavigatorState","previous","storableEntry","popNavigatorState","indexPreserve","previousEntry","storeable","sibling","scopeStart","scopeEnd","noScope","parametersEnd","parameter","action","parseViewportInstructionsWorker","excludeViewport","viewportContext","stringifyViewportInstruction","stringifyAViewportInstruction","excludeCurrentViewport","stringified","stringifyScopedViewportInstructions","scopeContext","newPath","merge","sameViewport","flat","viewportInstances","clones","grouped","parseAViewportInstruction","tokens","pos","seps","findNextToken","instructionString","GotoCustomAttribute","hasHref","updateValue","JSON","stringify","NavCustomElement","ul","li","ulActive","liActive","aActive","ViewportCustomElement","connectViewport","disconnectViewport","configurationOptions","configurationCall","routerConfiguration","with","beforeBind","beforeAttach","loadUrl","RouterConfiguration","customize","AsDateValueConverter","toDateString","metadata","daysInMonth","year","month","getMonth","getFullYear","AuDatePickerCustomElement","currentYear","currentMonth","firstDay","getDay","ceil","day","date","lastDay","0","1","2","3","4","5","6","7","8","9","10","11","DatePickerViewModel","ShellViewModel","app"],"mappings":"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AAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAA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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","function $noop() { return; }\nconst $global = (function () {\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    try {\n        // Not all environments allow eval and Function. Use only as a last resort:\n        // eslint-disable-next-line no-new-func\n        return new Function('return this')();\n    }\n    catch (_a) {\n        // If all fails, give up and create an object.\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        return {};\n    }\n})();\nconst isBrowserLike = (typeof window !== 'undefined'\n    && typeof window.document !== 'undefined');\nconst isWebWorkerLike = (typeof self === 'object'\n    && self.constructor != null\n    && self.constructor.name === 'DedicatedWorkerGlobalScope');\nconst isNodeLike = (typeof process !== 'undefined'\n    && process.versions != null\n    && process.versions.node != null);\n// performance.now polyfill for non-browser envs based on https://github.com/myrne/performance-now\nconst $now = (function () {\n    let getNanoSeconds;\n    let hrtime;\n    let moduleLoadTime;\n    let nodeLoadTime;\n    let upTime;\n    if ($global.performance != null && $global.performance.now != null) {\n        const $performance = $global.performance;\n        return function () {\n            return $performance.now();\n        };\n    }\n    else if ($global.process != null && $global.process.hrtime != null) {\n        const now = function () {\n            return (getNanoSeconds() - nodeLoadTime) / 1e6;\n        };\n        hrtime = $global.process.hrtime;\n        getNanoSeconds = function () {\n            const hr = hrtime();\n            return hr[0] * 1e9 + hr[1];\n        };\n        moduleLoadTime = getNanoSeconds();\n        upTime = $global.process.uptime() * 1e9;\n        nodeLoadTime = moduleLoadTime - upTime;\n        return now;\n    }\n    else {\n        const now = function () {\n            return Date.now() - nodeLoadTime;\n        };\n        nodeLoadTime = Date.now();\n        return now;\n    }\n})();\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst emptyArray = Object.freeze([]);\nconst emptyObject = Object.freeze({});\nconst $PLATFORM = {\n    /**\n     * `true` if there is a `window` variable in the global scope with a `document` property.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a browser, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `window` global is available and likely behaves similar to how it would in a browser.\n     */\n    isBrowserLike,\n    /**\n     * `true` if there is a `self` variable (of type `object`) in the global scope with constructor name `'DedicatedWorkerGlobalScope'`.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a web worker, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `self` global is available and likely behaves similar to how it would in a web worker.\n     */\n    isWebWorkerLike,\n    /**\n     * `true` if there is a `process` variable in the global scope with a `versions` property which has a `node` property.\n     *\n     * NOTE: this is not a guarantee that the code is actually running in nodejs, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `process` global is available and likely behaves similar to how it would in nodejs.\n     */\n    isNodeLike,\n    global: $global,\n    emptyArray,\n    emptyObject,\n    noop: $noop,\n    now: $now,\n    hasOwnProperty,\n    restore() {\n        Object.assign(PLATFORM, $PLATFORM);\n    },\n};\nexport const PLATFORM = { ...$PLATFORM };\n//# sourceMappingURL=platform.js.map","module.exports = \"<template class=\\\"au-date-picker\\\" tabindex=\\\"0\\\" focusin.delegate=\\\"open()\\\">\\n  <input type=\\\"text\\\" value.bind=\\\"value | asDate\\\" />\\n  <div class=\\\"au-date-picker-calendar\\\" if.bind=\\\"state === 1\\\">\\n    <div class=\\\"au-date-picker-header\\\">\\n      <button click.delegate=\\\"setMonth(currentMonth - 1)\\\"><</button>\\n      <span class=\\\"au-date-picker-header-current-year-month\\\">${getMonth(currentMonth)} ${currentYear}</span>\\n      <button click.delegate=\\\"setMonth(currentMonth + 1)\\\">></button>\\n    </div>\\n    <div class=\\\"au-date-picker-dates\\\">\\n      <div class=\\\"au-date-picker-weekday\\\" repeat.for=\\\"weekday of 7\\\">${getWeekday(weekday)}</div>\\n      <div class=\\\"au-date-picker-day\\\" repeat.for=\\\"day of weeksInMonth(currentYear, currentMonth) * 7\\\">${getDate(currentYear, currentMonth, day)}</div>\\n    </div>\\n  </div>\\n  <style>\\n    .au-date-picker {\\n      display: inline-block;\\n    }\\n    .au-date-picker-calendar {\\n      display: flex;\\n      flex-direction: column;\\n      border: 1px solid currentColor;\\n      padding: 0.5rem;\\n    }\\n    .au-date-picker-header {\\n      display: flex;\\n    }\\n    .au-date-picker-header-current-year-month {\\n      margin: auto;\\n    }\\n    .au-date-picker-dates {\\n      display: grid;\\n      grid-template-columns: repeat(7, 1fr);\\n    }\\n    .au-date-picker-weekday {\\n      font-size: 0.8rem;\\n    }\\n    .au-date-picker-day,\\n    .au-date-picker-weekday {\\n      display: flex;\\n      align-items: center;\\n      justify-content: center;\\n      height: 1rem;\\n      width: 1rem;\\n      padding: 0.5rem;\\n      border-radius: 50%;\\n    }\\n    .au-date-picker-day:hover {\\n      background: grey;\\n    }\\n  </style>\\n</template>\\n\";","module.exports = \"<div>\\n  <au-date-picker></au-date-picker>\\n</div>\\n\";","module.exports = \"<div style=\\\"display: flex;\\\">\\n  <ul style=\\\"width: 20vw;\\\">\\n    <li repeat.for=\\\"module of modules\\\">\\n      <a href=\\\"${module}\\\">${module}</a>\\n    </li>\\n  </ul>\\n  <au-viewport style=\\\"width: 75vw;\\\"></au-viewport>\\n</div>\\n\";","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","export var LogLevel;\n(function (LogLevel) {\n    /**\n     * The most detailed information about internal app state.\n     *\n     * Disabled by default and should never be enabled in a production environment.\n     */\n    LogLevel[LogLevel[\"trace\"] = 0] = \"trace\";\n    /**\n     * Information that is useful for debugging during development and has no long-term value.\n     */\n    LogLevel[LogLevel[\"debug\"] = 1] = \"debug\";\n    /**\n     * Information about the general flow of the application that has long-term value.\n     */\n    LogLevel[LogLevel[\"info\"] = 2] = \"info\";\n    /**\n     * Unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n     */\n    LogLevel[LogLevel[\"warn\"] = 3] = \"warn\";\n    /**\n     * Unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n     */\n    LogLevel[LogLevel[\"error\"] = 4] = \"error\";\n    /**\n     * Unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n     */\n    LogLevel[LogLevel[\"fatal\"] = 5] = \"fatal\";\n    /**\n     * No messages should be written.\n     */\n    LogLevel[LogLevel[\"none\"] = 6] = \"none\";\n})(LogLevel || (LogLevel = {}));\nexport const Reporter = {\n    level: 3 /* warn */,\n    write(code, ...params) { return; },\n    error(code, ...params) { return new Error(`Code ${code}`); }\n};\nexport const Tracer = {\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) { return; },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() { return; },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) { return; },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) { return; },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() { return; }\n};\nfunction enableLiveLogging(optionsOrWriter) { return; }\n//# sourceMappingURL=reporter.js.map","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nconst metadataInternalSlot = new WeakMap();\nfunction ensureObject(target) {\n    switch (typeof target) {\n        case 'function':\n            return target;\n        case 'object':\n            if (target === null) {\n                throw new TypeError(`Attempted to perform get() or define() metadata operation on null value.`);\n            }\n            return target;\n        default:\n            throw new TypeError(`Attempted to perform get() or define() metadata operation on ${typeof target} value: ${target}.`);\n    }\n}\nfunction toPropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction toPropertyKey(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction ensurePropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            throw new TypeError(`Invalid metadata propertyKey: ${propertyKey}.`);\n    }\n}\nfunction GetOrCreateMetadataMap(O, P, Create) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let targetMetadata be the value of O's [[Metadata]] internal slot.\n    let targetMetadata = metadataInternalSlot.get(O);\n    // 3. If targetMetadata is undefined, then\n    if (targetMetadata === void 0) {\n        // 3. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 3. b. Set targetMetadata to be a newly created Map object.\n        targetMetadata = new Map();\n        // 3. c. Set the [[Metadata]] internal slot of O to targetMetadata.\n        metadataInternalSlot.set(O, targetMetadata);\n    }\n    // 4. Let metadataMap be ? Invoke(targetMetadata, \"get\", P).\n    let metadataMap = targetMetadata.get(P);\n    // 5. If metadataMap is undefined, then\n    if (metadataMap === void 0) {\n        // 5. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 5. b. Set metadataMap to be a newly created Map object.\n        metadataMap = new Map();\n        // 5. c. Perform ? Invoke(targetMetadata, \"set\", P, metadataMap).\n        targetMetadata.set(P, metadataMap);\n    }\n    // 6. Return metadataMap.\n    return metadataMap;\n}\n// 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\nfunction OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? ToBoolean(? Invoke(metadataMap, \"has\", MetadataKey)).\n    return metadataMap.has(MetadataKey);\n}\n// 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\nfunction OrdinaryHasMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return true.\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return true;\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, Return ? parent.[[HasMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryHasMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return false.\n    return false;\n}\n// 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\nfunction OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return undefined.\n    if (metadataMap === void 0) {\n        return void 0;\n    }\n    // 4. Return ? Invoke(metadataMap, \"get\", MetadataKey).\n    return metadataMap.get(MetadataKey);\n}\n// 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\nfunction OrdinaryGetMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return ? OrdinaryGetOwnMetadata(MetadataKey, O, P).\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, return ? parent.[[GetMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryGetMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return undefined.\n    return void 0;\n}\n// 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\nfunction OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, true).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ true);\n    // 3. Return ? Invoke(metadataMap, \"set\", MetadataKey, MetadataValue).\n    metadataMap.set(MetadataKey, MetadataValue);\n}\n// 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\nfunction OrdinaryOwnMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 3. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 4. If metadataMap is undefined, return keys.\n    if (metadataMap === void 0) {\n        return keys;\n    }\n    // 5. Let keysObj be ? Invoke(metadataMap, \"keys\").\n    const keysObj = metadataMap.keys();\n    // 6. Let iterator be ? GetIterator(keysObj).\n    // 7. Let k be 0.\n    let k = 0;\n    // 8. Repeat\n    for (const key of keysObj) {\n        // 8. a. Let Pk be ! ToString(k).\n        // 8. b. Let next be ? IteratorStep(iterator).\n        // 8. c. If next is false, then\n        // 8. c. i. Let setStatus be ? Set(keys, \"length\", k, true).\n        // 8. c. ii. Assert: setStatus is true.\n        // 8. c. iii. Return keys.\n        // 8. d. Let nextValue be ? IteratorValue(next).\n        // 8. e. Let defineStatus be CreateDataPropertyOrThrow(keys, Pk, nextValue).\n        keys[k] = key;\n        // 8. f. If defineStatus is an abrupt completion, return ? IteratorClose(iterator, defineStatus).\n        // 8. g. Increase k by 1.\n        ++k;\n    }\n    return keys;\n}\n// 3.1.6.1 OrdinaryMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\nfunction OrdinaryMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let ownKeys be ? OrdinaryOwnMetadataKeys(O, P).\n    const ownKeys = OrdinaryOwnMetadataKeys(O, P);\n    // 3. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 4. If parent is null, then return ownKeys.\n    if (parent === null) {\n        return ownKeys;\n    }\n    // 5. Let parentKeys be ? O.[[OrdinaryMetadataKeys]](P).\n    const parentKeys = OrdinaryMetadataKeys(parent, P);\n    // 6. Let ownKeysLen = ? Get(ownKeys, \"length\").\n    const ownKeysLen = ownKeys.length;\n    // 7. If ownKeysLen is 0, return parentKeys.\n    if (ownKeysLen === 0) {\n        return parentKeys;\n    }\n    // 8. Let parentKeysLen = ? Get(parentKeys, \"length\").\n    const parentKeysLen = parentKeys.length;\n    // 9. If parentKeysLen is 0, return ownKeys.\n    if (parentKeysLen === 0) {\n        return ownKeys;\n    }\n    // 10. Let set be a newly created Set object.\n    const set = new Set();\n    // 11. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 12. Let k be 0.\n    let k = 0;\n    // 13. For each element key of ownKeys\n    let key;\n    for (let i = 0; i < ownKeysLen; ++i) {\n        key = ownKeys[i];\n        // 13. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 13. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 13. b. i. Let Pk be ! ToString(k).\n            // 13. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 13. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 13. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 13. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 14. For each element key of parentKeys\n    for (let i = 0; i < parentKeysLen; ++i) {\n        key = parentKeys[i];\n        // 14. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 14. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 14. b. i. Let Pk be ! ToString(k).\n            // 14. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 14. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 14. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 14. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 15. Perform ? Set(keys, \"length\", k).\n    // 16. return keys.\n    return keys;\n}\n// 3.1.8 DeleteMetadata(MetadataKey, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots-deletemetadata\nfunction OrdinaryDeleteMetadata(O, MetadataKey, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? Invoke(metadataMap, \"delete\", MetadataKey).\n    return metadataMap.delete(MetadataKey);\n}\n// 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n// https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n/**\n * A default metadata decorator factory that can be used on a class, class member, or parameter.\n *\n * @param metadataKey - The key for the metadata entry.\n * If `metadataKey` is already defined for the target and target key, the\n * metadataValue for that key will be overwritten.\n * @param metadataValue - The value for the metadata entry.\n * @returns A decorator function.\n */\nfunction metadata(metadataKey, metadataValue) {\n    function decorator(target, propertyKey) {\n        // 1. Assert: F has a [[MetadataKey]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 2. Assert: F has a [[MetadataValue]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 3. If Type(target) is not Object, throw a TypeError exception.\n        // 4. If key is not undefined and IsPropertyKey(key) is false, throw a TypeError exception.\n        // 5. Let metadataKey be the value of F's [[MetadataKey]] internal slot.\n        // 6. Let metadataValue be the value of F's [[MetadataValue]] internal slot.\n        // 7. Perform ? target.[[DefineMetadata]](metadataKey, metadataValue, target, key).\n        OrdinaryDefineOwnMetadata(metadataKey, metadataValue, ensureObject(target), ensurePropertyKeyOrUndefined(propertyKey));\n        // 8. Return undefined.\n    }\n    return decorator;\n}\nfunction decorate(decorators, target, propertyKey, attributes) {\n    if (propertyKey !== void 0) {\n        if (!Array.isArray(decorators)) {\n            throw new TypeError();\n        }\n        if (typeof target !== 'object' || target === null) {\n            throw new TypeError();\n        }\n        if ((typeof attributes !== 'object' || attributes === null) && typeof attributes !== 'function' && attributes !== null && attributes !== void 0) {\n            throw new TypeError();\n        }\n        if (attributes === null) {\n            attributes = void 0;\n        }\n        propertyKey = toPropertyKey(propertyKey);\n        return DecorateProperty(decorators, target, propertyKey, attributes);\n    }\n    else {\n        if (!Array.isArray(decorators)) {\n            throw new TypeError();\n        }\n        if (typeof target !== 'function') {\n            throw new TypeError();\n        }\n        return DecorateConstructor(decorators, target);\n    }\n}\nfunction DecorateConstructor(decorators, target) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target);\n        if (decorated !== void 0 && decorated !== null) {\n            if (typeof decorated !== 'function') {\n                throw new TypeError();\n            }\n            target = decorated;\n        }\n    }\n    return target;\n}\nfunction DecorateProperty(decorators, target, propertyKey, descriptor) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target, propertyKey, descriptor);\n        if (decorated !== void 0 && decorated !== null) {\n            if ((typeof decorated !== 'object' || decorated === null) && typeof decorated !== 'function') {\n                throw new TypeError();\n            }\n            descriptor = decorated;\n        }\n    }\n    return descriptor;\n}\nfunction $define(metadataKey, metadataValue, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[DefineMetadata]](metadataKey, metadataValue, propertyKey).\n    return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, ensureObject(target), toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $has(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[HasMetadata]](metadataKey, propertyKey).\n    return OrdinaryHasMetadata(metadataKey, ensureObject(target), toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $hasOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[HasOwn]](metadataKey, propertyKey).\n    return OrdinaryHasOwnMetadata(metadataKey, ensureObject(target), toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $get(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[GetMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetMetadata(metadataKey, ensureObject(target), toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[GetOwnMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetOwnMetadata(metadataKey, ensureObject(target), toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[GetMetadataKeys]](propertyKey).\n    return OrdinaryMetadataKeys(ensureObject(target), toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwnKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[GetOwnMetadataKeys]](propertyKey).\n    return OrdinaryOwnMetadataKeys(ensureObject(target), toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $delete(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    // 2. Return ? target.[[DeleteMetadata]](metadataKey, propertyKey).\n    return OrdinaryDeleteMetadata(ensureObject(target), metadataKey, toPropertyKeyOrUndefined(propertyKey));\n}\nconst Metadata = {\n    define: $define,\n    has: $has,\n    hasOwn: $hasOwn,\n    get: $get,\n    getOwn: $getOwn,\n    getKeys: $getKeys,\n    getOwnKeys: $getOwnKeys,\n    delete: $delete,\n};\nfunction def(obj, key, value) {\n    Reflect.defineProperty(obj, key, {\n        writable: true,\n        enumerable: false,\n        configurable: true,\n        value,\n    });\n}\ndef(Metadata, '$Internal', metadataInternalSlot);\nconst hasMetadata = 'metadata' in Reflect;\nconst hasDecorate = 'decorate' in Reflect;\nconst hasDefineMetadata = 'defineMetadata' in Reflect;\nconst hasHasMetadata = 'hasMetadata' in Reflect;\nconst hasHasOwnMetadata = 'hasOwnMetadata' in Reflect;\nconst hasGetMetadata = 'getMetadata' in Reflect;\nconst hasGetOwnMetadata = 'getOwnMetadata' in Reflect;\nconst hasGetMetadataKeys = 'getMetadataKeys' in Reflect;\nconst hasGetOwnMetadataKeys = 'getOwnMetadataKeys' in Reflect;\nconst hasDeleteMetadata = 'deleteMetadata' in Reflect;\nconst hasSome = (hasMetadata ||\n    hasDecorate ||\n    hasDefineMetadata ||\n    hasHasMetadata ||\n    hasHasOwnMetadata ||\n    hasGetMetadata ||\n    hasGetOwnMetadata ||\n    hasGetMetadataKeys ||\n    hasGetOwnMetadataKeys ||\n    hasDeleteMetadata);\nconst hasAll = (hasMetadata &&\n    hasDecorate &&\n    hasDefineMetadata &&\n    hasHasMetadata &&\n    hasHasOwnMetadata &&\n    hasGetMetadata &&\n    hasGetOwnMetadata &&\n    hasGetMetadataKeys &&\n    hasGetOwnMetadataKeys &&\n    hasDeleteMetadata);\nif (hasSome && !hasAll) {\n    // This is temporary until we have the reporter / logging component working properly.\n    // We should kind of throw here, but it's a bit harsh to completely stop Aurelia from loading for something that's not guaranteed to fail,\n    // so just log a warning instead.\n    /* eslint-disable no-console, no-undef, @typescript-eslint/ban-ts-ignore */\n    // @ts-ignore\n    console.warn('Partial existing Reflect.metadata polyfill found. Working environment cannot be guaranteed. Please file an issue at https://github.com/aurelia/aurelia/issues so that we can look into compatibility options for this scenario.');\n}\nif (!hasMetadata) {\n    def(Reflect, 'metadata', metadata);\n}\nif (!hasDecorate) {\n    def(Reflect, 'decorate', decorate);\n}\nif (!hasDefineMetadata) {\n    def(Reflect, 'defineMetadata', $define);\n}\nif (!hasHasMetadata) {\n    def(Reflect, 'hasMetadata', $has);\n}\nif (!hasHasOwnMetadata) {\n    def(Reflect, 'hasOwnMetadata', $hasOwn);\n}\nif (!hasGetMetadata) {\n    def(Reflect, 'getMetadata', $get);\n}\nif (!hasGetOwnMetadata) {\n    def(Reflect, 'getOwnMetadata', $getOwn);\n}\nif (!hasGetMetadataKeys) {\n    def(Reflect, 'getMetadataKeys', $getKeys);\n}\nif (!hasGetOwnMetadataKeys) {\n    def(Reflect, 'getOwnMetadataKeys', $getOwnKeys);\n}\nif (!hasDeleteMetadata) {\n    def(Reflect, 'deleteMetadata', $delete);\n}\nexport { Metadata, metadata };\n//# sourceMappingURL=metadata.js.map","import { Metadata } from './metadata';\nimport { PLATFORM } from './platform';\nexport class RuntimeCompilationResources {\n    constructor(context) {\n        this.context = context;\n    }\n    find(kind, name) {\n        const key = kind.keyFrom(name);\n        let resourceResolvers = this.context.resourceResolvers;\n        let resolver = resourceResolvers[key];\n        if (resolver === void 0) {\n            resourceResolvers = this.context.root.resourceResolvers;\n            resolver = resourceResolvers[key];\n        }\n        if (resolver != null && resolver.getFactory) {\n            const factory = resolver.getFactory(this.context);\n            if (factory != null) {\n                // TODO: we may want to log a warning here, or even throw. This would happen if a dependency is registered with a resource-like key\n                // but does not actually have a definition associated via the type's metadata. That *should* generally not happen.\n                const definition = Metadata.getOwn(kind.name, factory.Type);\n                return definition === void 0 ? null : definition;\n            }\n        }\n        return null;\n    }\n    create(kind, name) {\n        const key = kind.keyFrom(name);\n        let resourceResolvers = this.context.resourceResolvers;\n        let resolver = resourceResolvers[key];\n        if (resolver === undefined) {\n            resourceResolvers = this.context.root.resourceResolvers;\n            resolver = resourceResolvers[key];\n        }\n        if (resolver != null) {\n            const instance = resolver.resolve(this.context, this.context);\n            return instance === undefined ? null : instance;\n        }\n        return null;\n    }\n}\nconst annotation = {\n    name: 'au:annotation',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    set(target, prop, value) {\n        Metadata.define(annotation.keyFor(prop), value, target);\n    },\n    get(target, prop) {\n        return Metadata.getOwn(annotation.keyFor(prop), target);\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(annotation.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${annotation.name}:${name}`;\n        }\n        return `${annotation.name}:${name}:${context}`;\n    },\n};\nconst resource = {\n    name: 'au:resource',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    has(target) {\n        return Metadata.hasOwn(resource.name, target);\n    },\n    getAll(target) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            return PLATFORM.emptyArray;\n        }\n        else {\n            return keys.map(k => Metadata.getOwn(k, target));\n        }\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(resource.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${resource.name}:${name}`;\n        }\n        return `${resource.name}:${name}:${context}`;\n    },\n};\nexport const Protocol = {\n    annotation,\n    resource,\n};\n// eslint-disable-next-line @typescript-eslint/unbound-method\nconst hasOwn = Object.prototype.hasOwnProperty;\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override the definition as well as static properties on the type.\n * 2. Definition properties (usually set by the customElement decorator object literal) come next. They override static properties on the type.\n * 3. Static properties on the type come last. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 4. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrDefinitionOrTypeOrDefault(name, def, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = def[name];\n        if (value === void 0) {\n            value = Type[name];\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n            if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n                return getDefault();\n            }\n            return value;\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override static properties on the type.\n * 2. Static properties on the typ. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 3. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrTypeOrDefault(name, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = Type[name];\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n            return getDefault();\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Definition properties.\n * 2. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromDefinitionOrDefault(name, def, getDefault) {\n    const value = def[name];\n    if (value === void 0) {\n        return getDefault();\n    }\n    return value;\n}\n//# sourceMappingURL=resource.js.map","import { PLATFORM } from './platform';\nconst isNumericLookup = {};\n/**\n * Efficiently determine whether the provided property key is numeric\n * (and thus could be an array indexer) or not.\n *\n * Always returns true for values of type `'number'`.\n *\n * Otherwise, only returns true for strings that consist only of positive integers.\n *\n * Results are cached.\n */\nexport function isNumeric(value) {\n    switch (typeof value) {\n        case 'number':\n            return true;\n        case 'string': {\n            const result = isNumericLookup[value];\n            if (result !== void 0) {\n                return result;\n            }\n            const { length } = value;\n            if (length === 0) {\n                return isNumericLookup[value] = false;\n            }\n            let ch = 0;\n            for (let i = 0; i < length; ++i) {\n                ch = value.charCodeAt(i);\n                if (ch < 0x30 /* 0 */ || ch > 0x39 /* 9 */) {\n                    return isNumericLookup[value] = false;\n                }\n            }\n            return isNumericLookup[value] = true;\n        }\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isNumberOrBigInt(value) {\n    switch (typeof value) {\n        case 'number':\n        case 'bigint':\n            return true;\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isStringOrDate(value) {\n    switch (typeof value) {\n        case 'string':\n            return true;\n        case 'object':\n            return value instanceof Date;\n        default:\n            return false;\n    }\n}\n/**\n * Base implementation of camel and kebab cases\n */\nconst baseCase = (function () {\n    let CharKind;\n    (function (CharKind) {\n        CharKind[CharKind[\"none\"] = 0] = \"none\";\n        CharKind[CharKind[\"digit\"] = 1] = \"digit\";\n        CharKind[CharKind[\"upper\"] = 2] = \"upper\";\n        CharKind[CharKind[\"lower\"] = 3] = \"lower\";\n    })(CharKind || (CharKind = {}));\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const isDigit = Object.assign(Object.create(null), {\n        '0': true,\n        '1': true,\n        '2': true,\n        '3': true,\n        '4': true,\n        '5': true,\n        '6': true,\n        '7': true,\n        '8': true,\n        '9': true,\n    });\n    function charToKind(char) {\n        if (char === '') {\n            // We get this if we do charAt() with an index out of range\n            return 0 /* none */;\n        }\n        if (char !== char.toUpperCase()) {\n            return 3 /* lower */;\n        }\n        if (char !== char.toLowerCase()) {\n            return 2 /* upper */;\n        }\n        if (isDigit[char] === true) {\n            return 1 /* digit */;\n        }\n        return 0 /* none */;\n    }\n    return function (input, cb) {\n        const len = input.length;\n        if (len === 0) {\n            return input;\n        }\n        let sep = false;\n        let output = '';\n        let prevKind;\n        let curChar = '';\n        let curKind = 0 /* none */;\n        let nextChar = input.charAt(0);\n        let nextKind = charToKind(nextChar);\n        for (let i = 0; i < len; ++i) {\n            prevKind = curKind;\n            curChar = nextChar;\n            curKind = nextKind;\n            nextChar = input.charAt(i + 1);\n            nextKind = charToKind(nextChar);\n            if (curKind === 0 /* none */) {\n                if (output.length > 0) {\n                    // Only set sep to true if it's not at the beginning of output.\n                    sep = true;\n                }\n            }\n            else {\n                if (!sep && output.length > 0 && curKind === 2 /* upper */) {\n                    // Separate UAFoo into UA Foo.\n                    // Separate uaFOO into ua FOO.\n                    sep = prevKind === 3 /* lower */ || nextKind === 3 /* lower */;\n                }\n                output += cb(curChar, sep);\n                sep = false;\n            }\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to camelCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert DOM attribute names to ViewModel property names.\n *\n * Results are cached.\n */\nexport const camelCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? char.toUpperCase() : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to PascalCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert element names to class names for synthetic types.\n *\n * Results are cached.\n */\nexport const pascalCase = (function () {\n    const cache = Object.create(null);\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = camelCase(input);\n            if (output.length > 0) {\n                output = output[0].toUpperCase() + output.slice(1);\n            }\n            cache[input] = output;\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to kebab-case.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert ViewModel property names to DOM attribute names.\n *\n * Results are cached.\n */\nexport const kebabCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? `-${char.toLowerCase()}` : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently (up to 10x faster than `Array.from`) convert an `ArrayLike` to a real array.\n *\n * Primarily used by Aurelia to convert DOM node lists to arrays.\n */\nexport function toArray(input) {\n    // benchmark: http://jsben.ch/xjsyF\n    const { length } = input;\n    const arr = Array(length);\n    for (let i = 0; i < length; ++i) {\n        arr[i] = input[i];\n    }\n    return arr;\n}\nconst ids = {};\n/**\n * Retrieve the next ID in a sequence for a given string, starting with `1`.\n *\n * Used by Aurelia to assign unique ID's to controllers and resources.\n *\n * Aurelia will always prepend the context name with `au$`, so as long as you avoid\n * using that convention you should be safe from collisions.\n */\nexport function nextId(context) {\n    if (ids[context] === void 0) {\n        ids[context] = 0;\n    }\n    return ++ids[context];\n}\n/**\n * Reset the ID for the given string, so that `nextId` will return `1` again for the next call.\n *\n * Used by Aurelia to reset ID's in between unit tests.\n */\nexport function resetId(context) {\n    ids[context] = 0;\n}\n/**\n * A compare function to pass to `Array.prototype.sort` for sorting numbers.\n * This is needed for numeric sort, since the default sorts them as strings.\n */\nexport function compareNumber(a, b) {\n    return a - b;\n}\nconst emptyArray = PLATFORM.emptyArray;\n/**\n * Efficiently merge and deduplicate the (primitive) values in two arrays.\n *\n * Does not deduplicate existing values in the first array.\n *\n * Guards against null or undefined arrays.\n *\n * Returns `PLATFORM.emptyArray` if both arrays are either `null`, `undefined` or `PLATFORM.emptyArray`\n *\n * @param slice - If `true`, always returns a new array copy (unless neither array is/has a value)\n */\nexport function mergeDistinct(arr1, arr2, slice) {\n    if (arr1 === void 0 || arr1 === null || arr1 === emptyArray) {\n        if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n            return emptyArray;\n        }\n        else {\n            return slice ? arr2.slice(0) : arr2;\n        }\n    }\n    else if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n        return slice ? arr1.slice(0) : arr1;\n    }\n    const lookup = {};\n    const arr3 = slice ? arr1.slice(0) : arr1;\n    let len1 = arr1.length;\n    let len2 = arr2.length;\n    while (len1-- > 0) {\n        lookup[arr1[len1]] = true;\n    }\n    let item;\n    while (len2-- > 0) {\n        item = arr2[len2];\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (lookup[item] === void 0) {\n            arr3.push(item);\n            lookup[item] = true;\n        }\n    }\n    return arr3;\n}\n/**\n * Decorator. (lazily) bind the method to the class instance on first call.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bound(target, key, descriptor) {\n    return {\n        configurable: true,\n        enumerable: descriptor.enumerable,\n        get() {\n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            const boundFn = descriptor.value.bind(this);\n            Reflect.defineProperty(this, key, {\n                value: boundFn,\n                writable: true,\n                configurable: true,\n                enumerable: descriptor.enumerable,\n            });\n            return boundFn;\n        },\n    };\n}\nexport function mergeArrays(...arrays) {\n    const result = [];\n    let k = 0;\n    const arraysLen = arrays.length;\n    let arrayLen = 0;\n    let array;\n    for (let i = 0; i < arraysLen; ++i) {\n        array = arrays[i];\n        if (array !== void 0) {\n            arrayLen = array.length;\n            for (let j = 0; j < arrayLen; ++j) {\n                result[k++] = array[j];\n            }\n        }\n    }\n    return result;\n}\nexport function mergeObjects(...objects) {\n    const result = {};\n    const objectsLen = objects.length;\n    let object;\n    let key;\n    for (let i = 0; i < objectsLen; ++i) {\n        object = objects[i];\n        if (object !== void 0) {\n            for (key in object) {\n                result[key] = object[key];\n            }\n        }\n    }\n    return result;\n}\nexport function firstDefined(...values) {\n    const len = values.length;\n    let value;\n    for (let i = 0; i < len; ++i) {\n        value = values[i];\n        if (value !== void 0) {\n            return value;\n        }\n    }\n    throw new Error(`No default value found`);\n}\nexport const getPrototypeChain = (function () {\n    const functionPrototype = Function.prototype;\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const getPrototypeOf = Object.getPrototypeOf;\n    const cache = new WeakMap();\n    let proto = functionPrototype;\n    let i = 0;\n    let chain = void 0;\n    return function (Type) {\n        chain = cache.get(Type);\n        if (chain === void 0) {\n            cache.set(Type, chain = [proto = Type]);\n            i = 0;\n            while ((proto = getPrototypeOf(proto)) !== functionPrototype) {\n                chain[++i] = proto;\n            }\n        }\n        return chain;\n    };\n})();\nexport function toLookup(...objs) {\n    return Object.assign(Object.create(null), ...objs);\n}\n//# sourceMappingURL=functions.js.map","import { PLATFORM } from './platform';\nimport { Reporter } from './reporter';\nimport { Protocol } from './resource';\nimport { Metadata } from './metadata';\nimport { isNumeric } from './functions';\nfunction cloneArrayWithPossibleProps(source) {\n    const clone = source.slice();\n    const keys = Object.keys(source);\n    const len = keys.length;\n    let key;\n    for (let i = 0; i < len; ++i) {\n        key = keys[i];\n        if (!isNumeric(key)) {\n            clone[key] = source[key];\n        }\n    }\n    return clone;\n}\nexport class DI {\n    constructor() { return; }\n    static createContainer(...params) {\n        if (params.length === 0) {\n            return new Container(null);\n        }\n        else {\n            return new Container(null).register(...params);\n        }\n    }\n    static getDesignParamtypes(Type) {\n        return Metadata.getOwn('design:paramtypes', Type);\n    }\n    static getAnnotationParamtypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        return Metadata.getOwn(key, Type);\n    }\n    static getOrCreateAnnotationParamTypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        let annotationParamtypes = Metadata.getOwn(key, Type);\n        if (annotationParamtypes === void 0) {\n            Metadata.define(key, annotationParamtypes = [], Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return annotationParamtypes;\n    }\n    static getDependencies(Type) {\n        // Note: Every detail of this getDependencies method is pretty deliberate at the moment, and probably not yet 100% tested from every possible angle,\n        // so be careful with making changes here as it can have a huge impact on complex end user apps.\n        // Preferably, only make changes to the dependency resolution process via a RFC.\n        const key = Protocol.annotation.keyFor('di:dependencies');\n        let dependencies = Metadata.getOwn(key, Type);\n        if (dependencies === void 0) {\n            // Type.length is the number of constructor parameters. If this is 0, it could mean the class has an empty constructor\n            // but it could also mean the class has no constructor at all (in which case it inherits the constructor from the prototype).\n            // Non-zero constructor length + no paramtypes means emitDecoratorMetadata is off, or the class has no decorator.\n            // We're not doing anything with the above right now, but it's good to keep in mind for any future issues.\n            const inject = Type.inject;\n            if (inject === void 0) {\n                // design:paramtypes is set by tsc when emitDecoratorMetadata is enabled.\n                const designParamtypes = DI.getDesignParamtypes(Type);\n                // au:annotation:di:paramtypes is set by the parameter decorator from DI.createInterface or by @inject\n                const annotationParamtypes = DI.getAnnotationParamtypes(Type);\n                if (designParamtypes === void 0) {\n                    if (annotationParamtypes === void 0) {\n                        // Only go up the prototype if neither static inject nor any of the paramtypes is defined, as\n                        // there is no sound way to merge a type's deps with its prototype's deps\n                        const Proto = Object.getPrototypeOf(Type);\n                        if (typeof Proto === 'function' && Proto !== Function.prototype) {\n                            dependencies = cloneArrayWithPossibleProps(DI.getDependencies(Proto));\n                        }\n                        else {\n                            dependencies = [];\n                        }\n                    }\n                    else {\n                        // No design:paramtypes so just use the au:annotation:di:paramtypes\n                        dependencies = cloneArrayWithPossibleProps(annotationParamtypes);\n                    }\n                }\n                else if (annotationParamtypes === void 0) {\n                    // No au:annotation:di:paramtypes so just use the design:paramtypes\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                }\n                else {\n                    // We've got both, so merge them (in case of conflict on same index, au:annotation:di:paramtypes take precedence)\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                    let len = annotationParamtypes.length;\n                    let auAnnotationParamtype;\n                    for (let i = 0; i < len; ++i) {\n                        auAnnotationParamtype = annotationParamtypes[i];\n                        if (auAnnotationParamtype !== void 0) {\n                            dependencies[i] = auAnnotationParamtype;\n                        }\n                    }\n                    const keys = Object.keys(annotationParamtypes);\n                    len = keys.length;\n                    let key;\n                    for (let i = 0; i < len; ++i) {\n                        key = keys[i];\n                        if (!isNumeric(key)) {\n                            dependencies[key] = annotationParamtypes[key];\n                        }\n                    }\n                }\n            }\n            else {\n                // Ignore paramtypes if we have static inject\n                dependencies = cloneArrayWithPossibleProps(inject);\n            }\n            Metadata.define(key, dependencies, Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return dependencies;\n    }\n    static createInterface(friendlyName) {\n        const Interface = function (target, property, index) {\n            if (target == null) {\n                throw Reporter.error(16, Interface.friendlyName, Interface); // TODO: add error (trying to resolve an InterfaceSymbol that has no registrations)\n            }\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = Interface;\n            return target;\n        };\n        Interface.friendlyName = friendlyName == null ? 'Interface' : friendlyName;\n        Interface.noDefault = function () {\n            return Interface;\n        };\n        Interface.withDefault = function (configure) {\n            Interface.withDefault = function () {\n                throw Reporter.error(17, Interface);\n            };\n            Interface.register = function (container, key) {\n                const trueKey = key == null ? Interface : key;\n                return configure({\n                    instance(value) {\n                        return container.registerResolver(trueKey, new Resolver(trueKey, 0 /* instance */, value));\n                    },\n                    singleton(value) {\n                        return container.registerResolver(trueKey, new Resolver(trueKey, 1 /* singleton */, value));\n                    },\n                    transient(value) {\n                        return container.registerResolver(trueKey, new Resolver(trueKey, 2 /* transient */, value));\n                    },\n                    callback(value) {\n                        return container.registerResolver(trueKey, new Resolver(trueKey, 3 /* callback */, value));\n                    },\n                    aliasTo(destinationKey) {\n                        return container.registerResolver(trueKey, new Resolver(trueKey, 5 /* alias */, destinationKey));\n                    },\n                });\n            };\n            return Interface;\n        };\n        return Interface;\n    }\n    static inject(...dependencies) {\n        return function (target, key, descriptor) {\n            if (typeof descriptor === 'number') { // It's a parameter decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[descriptor] = dep;\n                }\n            }\n            else if (key) { // It's a property decorator. Not supported by the container without plugins.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target.constructor);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[key] = dep;\n                }\n            }\n            else if (descriptor) { // It's a function decorator (not a Class constructor)\n                const fn = descriptor.value;\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(fn);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n            else { // It's a class decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n        };\n    }\n    /**\n     * Registers the `target` class as a transient dependency; each time the dependency is resolved\n     * a new instance will be created.\n     *\n     * @param target - The class / constructor function to register as transient.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     *\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.transient(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.transient(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    static transient(target) {\n        target.register = function register(container) {\n            const registration = Registration.transient(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    }\n    /**\n     * Registers the `target` class as a singleton dependency; the class will only be created once. Each\n     * consecutive time the dependency is resolved, the same instance will be returned.\n     *\n     * @param target - The class / constructor function to register as a singleton.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.singleton(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.singleton(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    static singleton(target) {\n        target.register = function register(container) {\n            const registration = Registration.singleton(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    }\n}\nexport const IContainer = DI.createInterface('IContainer').noDefault();\nexport const IServiceLocator = IContainer;\nfunction createResolver(getter) {\n    return function (key) {\n        const resolver = function (target, property, descriptor) {\n            DI.inject(resolver)(target, property, descriptor);\n        };\n        resolver.resolve = function (handler, requestor) {\n            return getter(key, handler, requestor);\n        };\n        return resolver;\n    };\n}\nexport const inject = DI.inject;\nfunction transientDecorator(target) {\n    return DI.transient(target);\n}\nexport function transient(target) {\n    return target == null ? transientDecorator : transientDecorator(target);\n}\nfunction singletonDecorator(target) {\n    return DI.singleton(target);\n}\nexport function singleton(target) {\n    return target == null ? singletonDecorator : singletonDecorator(target);\n}\nexport const all = createResolver((key, handler, requestor) => requestor.getAll(key));\nexport const lazy = createResolver((key, handler, requestor) => {\n    let instance = null; // cache locally so that lazy always returns the same instance once resolved\n    return () => {\n        if (instance == null) {\n            instance = requestor.get(key);\n        }\n        return instance;\n    };\n});\nexport const optional = createResolver((key, handler, requestor) => {\n    if (requestor.has(key, true)) {\n        return requestor.get(key);\n    }\n    else {\n        return null;\n    }\n});\n/** @internal */\nexport var ResolverStrategy;\n(function (ResolverStrategy) {\n    ResolverStrategy[ResolverStrategy[\"instance\"] = 0] = \"instance\";\n    ResolverStrategy[ResolverStrategy[\"singleton\"] = 1] = \"singleton\";\n    ResolverStrategy[ResolverStrategy[\"transient\"] = 2] = \"transient\";\n    ResolverStrategy[ResolverStrategy[\"callback\"] = 3] = \"callback\";\n    ResolverStrategy[ResolverStrategy[\"array\"] = 4] = \"array\";\n    ResolverStrategy[ResolverStrategy[\"alias\"] = 5] = \"alias\";\n})(ResolverStrategy || (ResolverStrategy = {}));\n/** @internal */\nexport class Resolver {\n    constructor(key, strategy, state) {\n        this.key = key;\n        this.strategy = strategy;\n        this.state = state;\n    }\n    register(container, key) {\n        return container.registerResolver(key || this.key, this);\n    }\n    resolve(handler, requestor) {\n        switch (this.strategy) {\n            case 0 /* instance */:\n                return this.state;\n            case 1 /* singleton */: {\n                this.strategy = 0 /* instance */;\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                return this.state = factory.construct(requestor);\n            }\n            case 2 /* transient */: {\n                // Always create transients from the requesting container\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                return factory.construct(requestor);\n            }\n            case 3 /* callback */:\n                return this.state(handler, requestor, this);\n            case 4 /* array */:\n                return this.state[0].resolve(handler, requestor);\n            case 5 /* alias */:\n                return handler.get(this.state);\n            default:\n                throw Reporter.error(6, this.strategy);\n        }\n    }\n    getFactory(container) {\n        let resolver;\n        switch (this.strategy) {\n            case 1 /* singleton */:\n            case 2 /* transient */:\n                return container.getFactory(this.state);\n            case 5 /* alias */:\n                resolver = container.getResolver(this.state);\n                if (resolver == null || resolver.getFactory === void 0) {\n                    return null;\n                }\n                return resolver.getFactory(container);\n            default:\n                return null;\n        }\n    }\n}\n/** @internal */\nexport class Factory {\n    constructor(Type, invoker, dependencies) {\n        this.Type = Type;\n        this.invoker = invoker;\n        this.dependencies = dependencies;\n        this.transformers = null;\n    }\n    construct(container, dynamicDependencies) {\n        const transformers = this.transformers;\n        let instance = dynamicDependencies !== void 0\n            ? this.invoker.invokeWithDynamicDependencies(container, this.Type, this.dependencies, dynamicDependencies)\n            : this.invoker.invoke(container, this.Type, this.dependencies);\n        if (transformers == null) {\n            return instance;\n        }\n        for (let i = 0, ii = transformers.length; i < ii; ++i) {\n            instance = transformers[i](instance);\n        }\n        return instance;\n    }\n    registerTransformer(transformer) {\n        if (this.transformers == null) {\n            this.transformers = [];\n        }\n        this.transformers.push(transformer);\n        return true;\n    }\n}\nconst createFactory = (function () {\n    function invokeWithDynamicDependencies(container, Type, staticDependencies, dynamicDependencies) {\n        let i = staticDependencies.length;\n        let args = new Array(i);\n        let lookup;\n        while (i-- > 0) {\n            lookup = staticDependencies[i];\n            if (lookup == null) {\n                throw Reporter.error(7, `Index ${i}.`);\n            }\n            else {\n                args[i] = container.get(lookup);\n            }\n        }\n        if (dynamicDependencies !== void 0) {\n            args = args.concat(dynamicDependencies);\n        }\n        return Reflect.construct(Type, args);\n    }\n    const classInvokers = [\n        {\n            invoke(container, Type) {\n                return new Type();\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]), container.get(deps[4]));\n            },\n            invokeWithDynamicDependencies\n        }\n    ];\n    const fallbackInvoker = {\n        invoke: invokeWithDynamicDependencies,\n        invokeWithDynamicDependencies\n    };\n    return function (Type) {\n        const dependencies = DI.getDependencies(Type);\n        const invoker = classInvokers.length > dependencies.length ? classInvokers[dependencies.length] : fallbackInvoker;\n        return new Factory(Type, invoker, dependencies);\n    };\n})();\nconst containerResolver = {\n    resolve(handler, requestor) {\n        return requestor;\n    }\n};\nfunction isRegistry(obj) {\n    return typeof obj.register === 'function';\n}\nfunction isClass(obj) {\n    return obj.prototype !== void 0;\n}\nconst nextContainerId = (function () {\n    let id = 0;\n    return function () {\n        return ++id;\n    };\n})();\nfunction isResourceKey(key) {\n    return typeof key === 'string' && key.indexOf(':') > 0;\n}\n/** @internal */\nexport class Container {\n    constructor(parent) {\n        this.parent = parent;\n        this.id = nextContainerId();\n        this.registerDepth = 0;\n        if (parent === null) {\n            this.path = this.id.toString();\n            this.root = this;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.create(null);\n        }\n        else {\n            this.path = `${parent.path}.${this.id}`;\n            this.root = parent.root;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.assign(Object.create(null), this.root.resourceResolvers);\n        }\n        this.resolvers.set(IContainer, containerResolver);\n    }\n    register(...params) {\n        if (++this.registerDepth === 100) {\n            throw new Error('Unable to autoregister dependency');\n            // TODO: change to reporter.error and add various possible causes in description.\n            // Most likely cause is trying to register a plain object that does not have a\n            // register method and is not a class constructor\n        }\n        let current;\n        let keys;\n        let value;\n        let j;\n        let jj;\n        for (let i = 0, ii = params.length; i < ii; ++i) {\n            current = params[i];\n            if (isRegistry(current)) {\n                current.register(this);\n            }\n            else if (Protocol.resource.has(current)) {\n                const defs = Protocol.resource.getAll(current);\n                if (defs.length === 1) {\n                    // Fast path for the very common case\n                    defs[0].register(this);\n                }\n                else {\n                    const len = defs.length;\n                    for (let d = 0; d < len; ++d) {\n                        defs[d].register(this);\n                    }\n                }\n            }\n            else if (isClass(current)) {\n                Registration.singleton(current, current).register(this);\n            }\n            else {\n                keys = Object.keys(current);\n                j = 0;\n                jj = keys.length;\n                for (; j < jj; ++j) {\n                    value = current[keys[j]];\n                    // note: we could remove this if-branch and call this.register directly\n                    // - the extra check is just a perf tweak to create fewer unnecessary arrays by the spread operator\n                    if (isRegistry(value)) {\n                        value.register(this);\n                    }\n                    else {\n                        this.register(value);\n                    }\n                }\n            }\n        }\n        --this.registerDepth;\n        return this;\n    }\n    registerResolver(key, resolver) {\n        validateKey(key);\n        const resolvers = this.resolvers;\n        const result = resolvers.get(key);\n        if (result == null) {\n            resolvers.set(key, resolver);\n            if (isResourceKey(key)) {\n                this.resourceResolvers[key] = resolver;\n            }\n        }\n        else if (result instanceof Resolver && result.strategy === 4 /* array */) {\n            result.state.push(resolver);\n        }\n        else {\n            resolvers.set(key, new Resolver(key, 4 /* array */, [result, resolver]));\n        }\n        return resolver;\n    }\n    registerTransformer(key, transformer) {\n        const resolver = this.getResolver(key);\n        if (resolver == null) {\n            return false;\n        }\n        if (resolver.getFactory) {\n            const factory = resolver.getFactory(this);\n            if (factory == null) {\n                return false;\n            }\n            // This type cast is a bit of a hacky one, necessary due to the duplicity of IResolverLike.\n            // Problem is that that interface's type arg can be of type Key, but the getFactory method only works on\n            // type Constructable. So the return type of that optional method has this additional constraint, which\n            // seems to confuse the type checker.\n            return factory.registerTransformer(transformer);\n        }\n        return false;\n    }\n    getResolver(key, autoRegister = true) {\n        validateKey(key);\n        if (key.resolve !== void 0) {\n            return key;\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    return autoRegister ? this.jitRegister(key, current) : null;\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver;\n            }\n        }\n        return null;\n    }\n    has(key, searchAncestors = false) {\n        return this.resolvers.has(key)\n            ? true\n            : searchAncestors && this.parent != null\n                ? this.parent.has(key, true)\n                : false;\n    }\n    get(key) {\n        validateKey(key);\n        if (key.resolve !== void 0) {\n            return key.resolve(this, this);\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    resolver = this.jitRegister(key, current);\n                    return resolver.resolve(current, this);\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver.resolve(current, this);\n            }\n        }\n        throw new Error(`Unable to resolve key: ${key}`);\n    }\n    getAll(key) {\n        validateKey(key);\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (this.parent == null) {\n                    return PLATFORM.emptyArray;\n                }\n                current = current.parent;\n            }\n            else {\n                return buildAllResponse(resolver, current, this);\n            }\n        }\n        return PLATFORM.emptyArray;\n    }\n    getFactory(Type) {\n        const key = Protocol.annotation.keyFor('di:factory');\n        let factory = Metadata.getOwn(key, Type);\n        if (factory === void 0) {\n            Metadata.define(key, factory = createFactory(Type), Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return factory;\n    }\n    createChild() {\n        return new Container(this);\n    }\n    jitRegister(keyAsValue, handler) {\n        if (typeof keyAsValue !== 'function') {\n            throw new Error(`Attempted to jitRegister something that is not a constructor: '${keyAsValue}'. Did you forget to register this resource?`);\n        }\n        if (isRegistry(keyAsValue)) {\n            const registrationResolver = keyAsValue.register(handler, keyAsValue);\n            if (!(registrationResolver instanceof Object) || registrationResolver.resolve == null) {\n                const newResolver = handler.resolvers.get(keyAsValue);\n                if (newResolver != void 0) {\n                    return newResolver;\n                }\n                throw Reporter.error(40); // did not return a valid resolver from the static register method\n            }\n            return registrationResolver;\n        }\n        else if (Protocol.resource.has(keyAsValue)) {\n            const defs = Protocol.resource.getAll(keyAsValue);\n            if (defs.length === 1) {\n                // Fast path for the very common case\n                defs[0].register(handler);\n            }\n            else {\n                const len = defs.length;\n                for (let d = 0; d < len; ++d) {\n                    defs[d].register(handler);\n                }\n            }\n            const newResolver = handler.resolvers.get(keyAsValue);\n            if (newResolver != void 0) {\n                return newResolver;\n            }\n            throw Reporter.error(40); // did not return a valid resolver from the static register method\n        }\n        else {\n            const resolver = new Resolver(keyAsValue, 1 /* singleton */, keyAsValue);\n            handler.resolvers.set(keyAsValue, resolver);\n            return resolver;\n        }\n    }\n}\n/**\n * An implementation of IRegistry that delegates registration to a\n * separately registered class. The ParameterizedRegistry facilitates the\n * passing of parameters to the final registry.\n */\nexport class ParameterizedRegistry {\n    constructor(key, params) {\n        this.key = key;\n        this.params = params;\n    }\n    register(container) {\n        if (container.has(this.key, true)) {\n            const registry = container.get(this.key);\n            registry.register(container, ...this.params);\n        }\n        else {\n            container.register(...this.params.filter(x => typeof x === 'object'));\n        }\n    }\n}\nexport const Registration = {\n    instance(key, value) {\n        return new Resolver(key, 0 /* instance */, value);\n    },\n    singleton(key, value) {\n        return new Resolver(key, 1 /* singleton */, value);\n    },\n    transient(key, value) {\n        return new Resolver(key, 2 /* transient */, value);\n    },\n    callback(key, callback) {\n        return new Resolver(key, 3 /* callback */, callback);\n    },\n    alias(originalKey, aliasKey) {\n        return new Resolver(aliasKey, 5 /* alias */, originalKey);\n    },\n    defer(key, ...params) {\n        return new ParameterizedRegistry(key, params);\n    }\n};\nexport class InstanceProvider {\n    constructor() {\n        this.instance = null;\n    }\n    prepare(instance) {\n        this.instance = instance;\n    }\n    resolve(handler, requestor) {\n        if (this.instance === undefined) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        return this.instance;\n    }\n    dispose() {\n        this.instance = null;\n    }\n}\n/** @internal */\nexport function validateKey(key) {\n    // note: design:paramTypes which will default to Object if the param types cannot be statically analyzed by tsc\n    // this check is intended to properly report on that problem - under no circumstance should Object be a valid key anyway\n    if (key == null || key === Object) {\n        throw Reporter.error(5);\n    }\n}\nfunction buildAllResponse(resolver, handler, requestor) {\n    if (resolver instanceof Resolver && resolver.strategy === 4 /* array */) {\n        const state = resolver.state;\n        let i = state.length;\n        const results = new Array(i);\n        while (i--) {\n            results[i] = state[i].resolve(handler, requestor);\n        }\n        return results;\n    }\n    return [resolver.resolve(handler, requestor)];\n}\n//# sourceMappingURL=di.js.map","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { __decorate, __param } from \"tslib\";\nimport { toLookup } from './functions';\nimport { DI, all, Registration } from './di';\nexport var ColorOptions;\n(function (ColorOptions) {\n    ColorOptions[ColorOptions[\"noColors\"] = 0] = \"noColors\";\n    ColorOptions[ColorOptions[\"colors\"] = 1] = \"colors\";\n})(ColorOptions || (ColorOptions = {}));\nexport const ILogConfig = DI.createInterface('ILogConfig').noDefault();\nexport const ISink = DI.createInterface('ISink').noDefault();\nexport const ILogEventFactory = DI.createInterface('ILogEventFactory').noDefault();\nexport const ILogger = DI.createInterface('ILogger').noDefault();\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\nconst format = toLookup({\n    red(str) {\n        return `\\u001b[31m${str}\\u001b[39m`;\n    },\n    green(str) {\n        return `\\u001b[32m${str}\\u001b[39m`;\n    },\n    yellow(str) {\n        return `\\u001b[33m${str}\\u001b[39m`;\n    },\n    blue(str) {\n        return `\\u001b[34m${str}\\u001b[39m`;\n    },\n    magenta(str) {\n        return `\\u001b[35m${str}\\u001b[39m`;\n    },\n    cyan(str) {\n        return `\\u001b[36m${str}\\u001b[39m`;\n    },\n    white(str) {\n        return `\\u001b[37m${str}\\u001b[39m`;\n    },\n    grey(str) {\n        return `\\u001b[90m${str}\\u001b[39m`;\n    },\n});\nexport class LogConfig {\n    constructor(colorOptions, level) {\n        this.colorOptions = colorOptions;\n        this.level = level;\n    }\n}\nconst getLogLevelString = (function () {\n    const logLevelString = [\n        toLookup({\n            TRC: 'TRC',\n            DBG: 'DBG',\n            INF: 'INF',\n            WRN: 'WRN',\n            ERR: 'ERR',\n            FTL: 'FTL',\n            QQQ: '???',\n        }),\n        toLookup({\n            TRC: format.grey('TRC'),\n            DBG: format.grey('DBG'),\n            INF: format.white('INF'),\n            WRN: format.yellow('WRN'),\n            ERR: format.red('ERR'),\n            FTL: format.red('FTL'),\n            QQQ: format.grey('???'),\n        }),\n    ];\n    return function (level, colorOptions) {\n        if (level <= 0 /* trace */) {\n            return logLevelString[colorOptions].TRC;\n        }\n        if (level <= 1 /* debug */) {\n            return logLevelString[colorOptions].DBG;\n        }\n        if (level <= 2 /* info */) {\n            return logLevelString[colorOptions].INF;\n        }\n        if (level <= 3 /* warn */) {\n            return logLevelString[colorOptions].WRN;\n        }\n        if (level <= 4 /* error */) {\n            return logLevelString[colorOptions].ERR;\n        }\n        if (level <= 5 /* fatal */) {\n            return logLevelString[colorOptions].FTL;\n        }\n        return logLevelString[colorOptions].QQQ;\n    };\n})();\nfunction getScopeString(scope, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return scope.join('.');\n    }\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    return scope.map(format.cyan).join('.');\n}\nfunction getIsoString(timestamp, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return new Date(timestamp).toISOString();\n    }\n    return format.grey(new Date(timestamp).toISOString());\n}\nexport class DefaultLogEvent {\n    constructor(severity, message, optionalParams, scope, colorOptions, timestamp) {\n        this.severity = severity;\n        this.message = message;\n        this.optionalParams = optionalParams;\n        this.scope = scope;\n        this.colorOptions = colorOptions;\n        this.timestamp = timestamp;\n    }\n    toString() {\n        const { severity, message, scope, colorOptions, timestamp } = this;\n        if (scope.length === 0) {\n            return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)}] ${message}`;\n        }\n        return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)} ${getScopeString(scope, colorOptions)}] ${message}`;\n    }\n}\nlet DefaultLogEventFactory = class DefaultLogEventFactory {\n    constructor(config) {\n        this.config = config;\n    }\n    createLogEvent(logger, level, message, optionalParams) {\n        return new DefaultLogEvent(level, message, optionalParams, logger.scope, this.config.colorOptions, Date.now());\n    }\n};\nDefaultLogEventFactory = __decorate([\n    __param(0, ILogConfig)\n], DefaultLogEventFactory);\nexport { DefaultLogEventFactory };\nexport class ConsoleSink {\n    constructor($console) {\n        this.emit = function emit(event) {\n            const optionalParams = event.optionalParams;\n            if (optionalParams === void 0 || optionalParams.length === 0) {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString());\n                    case 2 /* info */:\n                        return $console.info(event.toString());\n                    case 3 /* warn */:\n                        return $console.warn(event.toString());\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString());\n                }\n            }\n            else {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString(), ...optionalParams);\n                    case 2 /* info */:\n                        return $console.info(event.toString(), ...optionalParams);\n                    case 3 /* warn */:\n                        return $console.warn(event.toString(), ...optionalParams);\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString(), ...optionalParams);\n                }\n            }\n        };\n    }\n}\nlet DefaultLogger = class DefaultLogger {\n    constructor(config, factory, sinks, scope = [], parent = null) {\n        this.config = config;\n        this.factory = factory;\n        this.sinks = sinks;\n        this.scope = scope;\n        if (parent === null) {\n            this.root = this;\n            this.parent = this;\n        }\n        else {\n            this.root = parent.root;\n            this.parent = parent;\n        }\n        const sinksLen = sinks.length;\n        let i = 0;\n        const emit = (level, msgOrGetMsg, optionalParams) => {\n            const message = typeof msgOrGetMsg === 'function' ? msgOrGetMsg() : msgOrGetMsg;\n            const event = factory.createLogEvent(this, level, message, optionalParams);\n            for (i = 0; i < sinksLen; ++i) {\n                sinks[i].emit(event);\n            }\n        };\n        this.trace = function trace(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 0 /* trace */) {\n                emit(0 /* trace */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.debug = function debug(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 1 /* debug */) {\n                emit(1 /* debug */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.info = function info(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 2 /* info */) {\n                emit(2 /* info */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.warn = function warn(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 3 /* warn */) {\n                emit(3 /* warn */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.error = function error(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 4 /* error */) {\n                emit(4 /* error */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.fatal = function fatal(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 5 /* fatal */) {\n                emit(5 /* fatal */, messageOrGetMessage, optionalParams);\n            }\n        };\n    }\n    scopeTo(name) {\n        return new DefaultLogger(this.config, this.factory, this.sinks, this.scope.concat(name), this);\n    }\n};\nDefaultLogger = __decorate([\n    __param(0, ILogConfig),\n    __param(1, ILogEventFactory),\n    __param(2, all(ISink))\n], DefaultLogger);\nexport { DefaultLogger };\nexport const LoggerConfiguration = toLookup({\n    create($console, level = 3 /* warn */, colorOptions = 0 /* noColors */) {\n        return toLookup({\n            register(container) {\n                return container.register(Registration.instance(ILogConfig, new LogConfig(colorOptions, level)), Registration.instance(ISink, new ConsoleSink($console)), Registration.singleton(ILogEventFactory, DefaultLogEventFactory), Registration.singleton(ILogger, DefaultLogger));\n            },\n        });\n    },\n});\n//# sourceMappingURL=logger.js.map","function trimDots(ary) {\n    const len = ary.length;\n    let i = 0;\n    let part;\n    for (; i < len; ++i) {\n        part = ary[i];\n        if (part === '.') {\n            ary.splice(i, 1);\n            i -= 1;\n        }\n        else if (part === '..') {\n            // If at the start, or previous value is still ..,\n            // keep them so that when converted to a path it may\n            // still work when converted to a path, even though\n            // as an ID it is less than ideal. In larger point\n            // releases, may be better to just kick out an error.\n            if (i === 0 || (i === 1 && ary[2] === '..') || ary[i - 1] === '..') {\n                continue;\n            }\n            if (i > 0) {\n                ary.splice(i - 1, 2);\n                i -= 2;\n            }\n        }\n    }\n}\n/**\n * Calculates a path relative to a file.\n *\n * @param name - The relative path.\n * @param file - The file path.\n * @returns The calculated path.\n */\nexport function relativeToFile(name, file) {\n    const fileParts = !file ? file : file.split('/');\n    const nameParts = name.trim().split('/');\n    if (nameParts[0].startsWith('.') && fileParts) {\n        // Convert file to array, and lop off the last part,\n        // so that . matches that 'directory' and not name of the file's\n        // module. For instance, file of 'one/two/three', maps to\n        // 'one/two/three.js', but we want the directory, 'one/two' for\n        // this normalization.\n        const normalizedBaseParts = fileParts.slice(0, fileParts.length - 1);\n        nameParts.unshift(...normalizedBaseParts);\n    }\n    trimDots(nameParts);\n    return nameParts.join('/');\n}\n/**\n * Joins two paths.\n *\n * @param path1 - The first path.\n * @param path2 - The second path.\n * @returns The joined path.\n */\nexport function join(path1, path2) {\n    if (!path1) {\n        return path2;\n    }\n    if (!path2) {\n        return path1;\n    }\n    const schemeMatch = /^([^/]*?:)\\//.exec(path1);\n    const scheme = (schemeMatch && schemeMatch.length > 0) ? schemeMatch[1] : '';\n    path1 = path1.slice(scheme.length);\n    let urlPrefix;\n    if (path1.startsWith('///') && scheme === 'file:') {\n        urlPrefix = '///';\n    }\n    else if (path1.startsWith('//')) {\n        urlPrefix = '//';\n    }\n    else if (path1.startsWith('/')) {\n        urlPrefix = '/';\n    }\n    else {\n        urlPrefix = '';\n    }\n    const trailingSlash = path2.endsWith('/') ? '/' : '';\n    const url1 = path1.split('/');\n    const url2 = path2.split('/');\n    const url3 = [];\n    for (let i = 0, ii = url1.length; i < ii; ++i) {\n        if (url1[i] === '..') {\n            url3.pop();\n        }\n        else if (url1[i] !== '.' && url1[i] !== '') {\n            url3.push(url1[i]);\n        }\n    }\n    for (let i = 0, ii = url2.length; i < ii; ++i) {\n        if (url2[i] === '..') {\n            url3.pop();\n        }\n        else if (url2[i] !== '.' && url2[i] !== '') {\n            url3.push(url2[i]);\n        }\n    }\n    return scheme + urlPrefix + url3.join('/') + trailingSlash;\n}\nconst encode = encodeURIComponent;\nconst encodeKey = (k) => encode(k).replace('%24', '$');\n/**\n * Recursively builds part of query string for parameter.\n *\n * @param key - Parameter name for query string.\n * @param value - Parameter value to deserialize.\n * @param traditional - Boolean Use the old URI template standard (RFC6570)\n * @returns Array with serialized parameter(s)\n */\nfunction buildParam(key, value, traditional) {\n    let result = [];\n    if (value == null) {\n        return result;\n    }\n    if (Array.isArray(value)) {\n        for (let i = 0, l = value.length; i < l; i++) {\n            if (traditional) {\n                result.push(`${encodeKey(key)}=${encode(value[i])}`);\n            }\n            else {\n                const arrayKey = `${key}[${(typeof value[i] === 'object' && value[i] != null ? i : '')}]`;\n                result = result.concat(buildParam(arrayKey, value[i]));\n            }\n        }\n    }\n    else if (typeof value === 'object' && !traditional) {\n        for (const propertyName in value) {\n            result = result.concat(buildParam(`${key}[${propertyName}]`, value[propertyName]));\n        }\n    }\n    else {\n        result.push(`${encodeKey(key)}=${encode(value)}`);\n    }\n    return result;\n}\n/**\n * Generate a query string from an object.\n *\n * @param params - Object containing the keys and values to be used.\n * @param traditional - Boolean Use the old URI template standard (RFC6570)\n * @returns The generated query string, excluding leading '?'.\n */\nexport function buildQueryString(params, traditional) {\n    if (params == null) {\n        return '';\n    }\n    const pairs = [];\n    const keys = Object.keys(params).sort();\n    let key;\n    for (let i = 0, len = keys.length; i < len; ++i) {\n        key = keys[i];\n        pairs.push(...buildParam(key, params[key], traditional));\n    }\n    if (pairs.length === 0) {\n        return '';\n    }\n    return pairs.join('&');\n}\n/**\n * Process parameter that was recognized as scalar param (primitive value or shallow array).\n *\n * @param existedParam - Object with previously parsed values for specified key.\n * @param value - Parameter value to append.\n * @returns Initial primitive value or transformed existedParam if parameter was recognized as an array.\n */\nfunction processScalarParam(existedParam, value) {\n    if (Array.isArray(existedParam)) {\n        // value is already an array, so push on the next value.\n        existedParam.push(value);\n        return existedParam;\n    }\n    if (existedParam !== undefined) {\n        // value isn't an array, but since a second value has been specified,\n        // convert value into an array.\n        return [existedParam, value];\n    }\n    // value is a scalar.\n    return value;\n}\n/**\n * Sequentially process parameter that was recognized as complex value (object or array).\n * For each keys part, if the current level is undefined create an\n * object or array based on the type of the next keys part.\n *\n * @param queryParams - root-level result object.\n * @param keys - Collection of keys related to this parameter.\n * @param value - Parameter value to append.\n */\nfunction parseComplexParam(queryParams, keys, value) {\n    let currentParams = queryParams;\n    const keysLastIndex = keys.length - 1;\n    let key;\n    let prevValue;\n    for (let j = 0; j <= keysLastIndex; ++j) {\n        key = (keys[j] === '' ? currentParams.length : keys[j]);\n        if (j < keysLastIndex) {\n            // The value has to be an array or a false value\n            // It can happen that the value is no array if the key was repeated with traditional style like `list=1&list[]=2`\n            if (!currentParams[key] || typeof currentParams[key] === 'object') {\n                prevValue = currentParams[key];\n            }\n            else {\n                prevValue = [currentParams[key]];\n            }\n            if (prevValue) {\n                currentParams = currentParams[key] = prevValue;\n            }\n            else if (isNaN(keys[j + 1])) {\n                // Kinda have no choice here\n                // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n                currentParams = currentParams[key] = {};\n            }\n            else {\n                currentParams = currentParams[key] = [];\n            }\n        }\n        else {\n            currentParams = currentParams[key] = value;\n        }\n    }\n}\n/**\n * Parse a query string into a queryParams object.\n *\n * @param queryString - The query string to parse.\n * @returns Object with keys and values mapped from the query string.\n */\nexport function parseQueryString(queryString) {\n    const queryParams = {};\n    if (!queryString || typeof queryString !== 'string') {\n        return queryParams;\n    }\n    let query = queryString;\n    if (query.startsWith('?')) {\n        query = query.slice(1);\n    }\n    const pairs = query.replace(/\\+/g, ' ').split('&');\n    for (let i = 0; i < pairs.length; i++) {\n        const pair = pairs[i].split('=');\n        const key = decodeURIComponent(pair[0]);\n        if (!key) {\n            continue;\n        }\n        // split object key into its parts\n        let keys = key.split('][');\n        let keysLastIndex = keys.length - 1;\n        // If the first keys part contains [ and the last ends with ], then []\n        // are correctly balanced, split key to parts\n        // Else it's basic key\n        if (keys[0].includes(\"[\") && keys[keysLastIndex].endsWith(\"]\")) {\n            keys[keysLastIndex] = keys[keysLastIndex].replace(/\\]$/, '');\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            keys = keys.shift().split('[').concat(keys); // outer condition already ensures not-null\n            keysLastIndex = keys.length - 1;\n        }\n        else {\n            keysLastIndex = 0;\n        }\n        if (pair.length >= 2) {\n            const value = pair[1] ? decodeURIComponent(pair[1]) : '';\n            if (keysLastIndex) {\n                parseComplexParam(queryParams, keys, value);\n            }\n            else {\n                queryParams[key] = processScalarParam(queryParams[key], value);\n            }\n        }\n        else {\n            queryParams[key] = true;\n        }\n    }\n    return queryParams;\n}\n//# sourceMappingURL=path.js.map","import { PLATFORM } from './platform';\nexport const Profiler = (function () {\n    const now = PLATFORM.now;\n    const timers = [];\n    let profileMap;\n    const profiler = {\n        createTimer,\n        enable,\n        disable,\n        report,\n        enabled: false\n    };\n    return profiler;\n    function createTimer(name) {\n        timers.push(name);\n        let depth = 0;\n        let mark = 0;\n        return {\n            enter,\n            leave\n        };\n        function enter() {\n            if (++depth === 1) {\n                mark = now();\n                ++profileMap[name].topLevelCount;\n            }\n            ++profileMap[name].totalCount;\n        }\n        function leave() {\n            if (--depth === 0) {\n                profileMap[name].duration += (now() - mark);\n            }\n        }\n    }\n    function enable() {\n        profileMap = {};\n        for (const timer of timers) {\n            profileMap[timer] = {\n                name: timer,\n                duration: 0,\n                topLevelCount: 0,\n                totalCount: 0\n            };\n        }\n        profiler.enabled = true;\n    }\n    function disable() {\n        profiler.enabled = false;\n    }\n    function report(cb) {\n        Object.keys(profileMap).map(key => profileMap[key]).sort((a, b) => b.duration - a.duration).forEach(p => {\n            cb(p.name, p.duration, p.topLevelCount, p.totalCount);\n        });\n    }\n})();\n//# sourceMappingURL=profiler.js.map","import { DI } from './di';\nimport { Reporter } from './reporter';\n/**\n * Represents a handler for an EventAggregator event.\n */\nclass Handler {\n    constructor(\n    /** @internal */\n    messageType, \n    /** @internal */\n    callback) {\n        this.messageType = messageType;\n        this.callback = callback;\n    }\n    handle(message) {\n        if (message instanceof this.messageType) {\n            this.callback.call(null, message);\n        }\n    }\n}\nfunction invokeCallback(callback, data, event) {\n    try {\n        callback(data, event);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nfunction invokeHandler(handler, data) {\n    try {\n        handler.handle(data);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nexport const IEventAggregator = DI.createInterface('IEventAggregator').withDefault(x => x.singleton(EventAggregator));\n/**\n * Enables loosely coupled publish/subscribe messaging.\n */\nexport class EventAggregator {\n    constructor() {\n        /** @internal */\n        this.eventLookup = {};\n        /** @internal */\n        this.messageHandlers = [];\n    }\n    publish(channelOrInstance, data) {\n        let subscribers;\n        let i;\n        if (!channelOrInstance) {\n            throw Reporter.error(0); // TODO: create error code for 'Event was invalid.'\n        }\n        if (typeof channelOrInstance === 'string') {\n            const channel = channelOrInstance;\n            subscribers = this.eventLookup[channel];\n            if (subscribers != null) {\n                subscribers = subscribers.slice();\n                i = subscribers.length;\n                while (i--) {\n                    invokeCallback(subscribers[i], data, channel);\n                }\n            }\n        }\n        else {\n            const instance = channelOrInstance;\n            subscribers = this.messageHandlers.slice();\n            i = subscribers.length;\n            while (i--) {\n                invokeHandler(subscribers[i], instance);\n            }\n        }\n    }\n    subscribe(channelOrType, callback) {\n        let handler;\n        let subscribers;\n        if (!channelOrType) {\n            throw Reporter.error(0); // TODO: create error code for 'Event channel/type was invalid.'\n        }\n        if (typeof channelOrType === 'string') {\n            const channel = channelOrType;\n            handler = callback;\n            if (this.eventLookup[channel] === void 0) {\n                this.eventLookup[channel] = [];\n            }\n            subscribers = this.eventLookup[channel];\n        }\n        else {\n            handler = new Handler(channelOrType, callback);\n            subscribers = this.messageHandlers;\n        }\n        subscribers.push(handler);\n        return {\n            dispose() {\n                const idx = subscribers.indexOf(handler);\n                if (idx !== -1) {\n                    subscribers.splice(idx, 1);\n                }\n            }\n        };\n    }\n    subscribeOnce(channelOrType, callback) {\n        const sub = this.subscribe(channelOrType, (data, event) => {\n            sub.dispose();\n            return callback(data, event);\n        });\n        return sub;\n    }\n}\n//# sourceMappingURL=eventaggregator.js.map","// TODO: see if we can de-duplicate these 3 decorators and their functions without killing performance or readability\nexport function subscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._subscriberFlags = 0 /* None */;\n        proto.addSubscriber = addSubscriber;\n        proto.removeSubscriber = removeSubscriber;\n        proto.hasSubscriber = hasSubscriber;\n        proto.hasSubscribers = hasSubscribers;\n        proto.callSubscribers = callSubscribers;\n        if (proto.subscribe === void 0)\n            proto.subscribe = addSubscriber;\n        if (proto.unsubscribe === void 0)\n            proto.unsubscribe = removeSubscriber;\n    };\n}\nexport function proxySubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._proxySubscriberFlags = 0 /* None */;\n        proto.addProxySubscriber = addProxySubscriber;\n        proto.removeProxySubscriber = removeProxySubscriber;\n        proto.hasProxySubscriber = hasProxySubscriber;\n        proto.hasProxySubscribers = hasProxySubscribers;\n        proto.callProxySubscribers = callProxySubscribers;\n        if (proto.subscribeToProxy === void 0)\n            proto.subscribeToProxy = addProxySubscriber;\n        if (proto.unsubscribeFromProxy === void 0)\n            proto.unsubscribeFromProxy = removeProxySubscriber;\n    };\n}\nexport function collectionSubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._collectionSubscriberFlags = 0 /* None */;\n        proto.addCollectionSubscriber = addCollectionSubscriber;\n        proto.removeCollectionSubscriber = removeCollectionSubscriber;\n        proto.hasCollectionSubscriber = hasCollectionSubscriber;\n        proto.hasCollectionSubscribers = hasCollectionSubscribers;\n        proto.callCollectionSubscribers = callCollectionSubscribers;\n        if (proto.subscribeToCollection === void 0)\n            proto.subscribeToCollection = addCollectionSubscriber;\n        if (proto.unsubscribeFromCollection === void 0)\n            proto.unsubscribeFromCollection = removeCollectionSubscriber;\n    };\n}\nfunction addSubscriber(subscriber) {\n    if (this.hasSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._subscriber0 = subscriber;\n        this._subscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._subscriber1 = subscriber;\n        this._subscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._subscriber2 = subscriber;\n        this._subscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._subscribersRest = [subscriber];\n        this._subscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._subscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addProxySubscriber(subscriber) {\n    if (this.hasProxySubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._proxySubscriber0 = subscriber;\n        this._proxySubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._proxySubscriber1 = subscriber;\n        this._proxySubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._proxySubscriber2 = subscriber;\n        this._proxySubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._proxySubscribersRest = [subscriber];\n        this._proxySubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._proxySubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addCollectionSubscriber(subscriber) {\n    if (this.hasCollectionSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._collectionSubscriber0 = subscriber;\n        this._collectionSubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._collectionSubscriber1 = subscriber;\n        this._collectionSubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._collectionSubscriber2 = subscriber;\n        this._collectionSubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._collectionSubscribersRest = [subscriber];\n        this._collectionSubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._collectionSubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction removeSubscriber(subscriber) {\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        this._subscriber0 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        this._subscriber1 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        this._subscriber2 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._subscriberFlags = (this._subscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        this._proxySubscriber0 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        this._proxySubscriber1 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        this._proxySubscriber2 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._proxySubscriberFlags = (this._proxySubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        this._collectionSubscriber0 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        this._collectionSubscriber1 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        this._collectionSubscriber2 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasSubscribers() {\n    return this._subscriberFlags !== 0 /* None */;\n}\nfunction hasProxySubscribers() {\n    return this._proxySubscriberFlags !== 0 /* None */;\n}\nfunction hasCollectionSubscribers() {\n    return this._collectionSubscriberFlags !== 0 /* None */;\n}\nfunction hasSubscriber(subscriber) {\n    // Flags here is just a perf tweak\n    // Compared to not using flags, it's a moderate speed-up when this collection does not have the subscriber;\n    // and minor slow-down when it does, and the former is more common than the latter.\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction callSubscribers(newValue, previousValue, flags) {\n    /**\n     * Note: change handlers may have the side-effect of adding/removing subscribers to this collection during this\n     * callSubscribers invocation, so we're caching them all before invoking any.\n     * Subscribers added during this invocation are not invoked (and they shouldn't be).\n     * Subscribers removed during this invocation will still be invoked (and they also shouldn't be,\n     * however this is accounted for via $isBound and similar flags on the subscriber objects)\n     */\n    const subscriber0 = this._subscriber0;\n    const subscriber1 = this._subscriber1;\n    const subscriber2 = this._subscriber2;\n    let subscribers = this._subscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        callSubscriber(subscriber0, newValue, previousValue, flags, subscriber0.id === void 0 ? 0 : this[subscriber0.id]);\n    }\n    if (subscriber1 !== void 0) {\n        callSubscriber(subscriber1, newValue, previousValue, flags, subscriber1.id === void 0 ? 0 : this[subscriber1.id]);\n    }\n    if (subscriber2 !== void 0) {\n        callSubscriber(subscriber2, newValue, previousValue, flags, subscriber2.id === void 0 ? 0 : this[subscriber2.id]);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                callSubscriber(subscriber, newValue, previousValue, flags, subscriber.id === void 0 ? 0 : this[subscriber.id]);\n            }\n        }\n    }\n}\nfunction callSubscriber(subscriber, newValue, previousValue, flags, ownFlags) {\n    subscriber.handleChange(newValue, previousValue, ((flags | 48 /* update */) ^ 48 /* update */) | ownFlags);\n}\nfunction callProxySubscribers(key, newValue, previousValue, flags) {\n    const subscriber0 = this._proxySubscriber0;\n    const subscriber1 = this._proxySubscriber1;\n    const subscriber2 = this._proxySubscriber2;\n    let subscribers = this._proxySubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleProxyChange(key, newValue, previousValue, flags);\n            }\n        }\n    }\n}\nfunction callCollectionSubscribers(indexMap, flags) {\n    const subscriber0 = this._collectionSubscriber0;\n    const subscriber1 = this._collectionSubscriber1;\n    const subscriber2 = this._collectionSubscriber2;\n    let subscribers = this._collectionSubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleCollectionChange(indexMap, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleCollectionChange(indexMap, flags);\n            }\n        }\n    }\n}\n//# sourceMappingURL=subscriber-collection.js.map","var ProxyObserver_1;\nimport { __decorate } from \"tslib\";\nimport { PLATFORM } from '@aurelia/kernel';\nimport { proxySubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst lookup = new WeakMap();\nlet ProxySubscriberCollection = class ProxySubscriberCollection {\n    constructor(proxy, raw, key) {\n        this.proxy = proxy;\n        this.raw = raw;\n        this.key = key;\n        this.inBatch = false;\n        this.subscribe = this.addSubscriber;\n        this.unsubscribe = this.removeSubscriber;\n        if (raw[key] instanceof Object) { // Ensure we observe array indices and newly created object properties\n            raw[key] = ProxyObserver.getOrCreate(raw[key]).proxy;\n        }\n    }\n    setValue(value, flags) {\n        const oldValue = this.raw[this.key];\n        if (oldValue !== value) {\n            this.raw[this.key] = value;\n            this.callSubscribers(value, oldValue, flags | 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n    getValue() {\n        return this.raw[this.key];\n    }\n    flushBatch(flags) {\n        return;\n    }\n};\nProxySubscriberCollection = __decorate([\n    subscriberCollection()\n], ProxySubscriberCollection);\nexport { ProxySubscriberCollection };\nlet ProxyObserver = ProxyObserver_1 = class ProxyObserver {\n    constructor(obj) {\n        this.raw = obj;\n        this.proxy = new Proxy(obj, this);\n        lookup.set(obj, this.proxy);\n        this.subscribers = {};\n    }\n    static getProxyOrSelf(obj) {\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                return obj;\n            }\n            return proxy;\n        }\n        return obj;\n    }\n    static getRawIfProxy(obj) {\n        const raw = obj.$raw;\n        if (raw === void 0) {\n            return obj;\n        }\n        return raw;\n    }\n    static getOrCreate(obj, key) {\n        let proxyObserver;\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                proxyObserver = new ProxyObserver_1(obj);\n            }\n            else {\n                proxyObserver = proxy.$observer;\n            }\n        }\n        else {\n            proxyObserver = obj.$observer;\n        }\n        if (key === void 0) {\n            return proxyObserver;\n        }\n        let subscribers = proxyObserver.subscribers[key];\n        if (subscribers === void 0) {\n            const raw = this.getRawIfProxy(obj);\n            const proxy = proxyObserver.proxy;\n            subscribers = proxyObserver.subscribers[key] = new ProxySubscriberCollection(proxy, raw, key);\n        }\n        return subscribers;\n    }\n    static isProxy(obj) {\n        return obj.$raw !== void 0;\n    }\n    get(target, p, receiver) {\n        if (p === '$observer') {\n            return this;\n        }\n        if (p === '$raw') {\n            return target;\n        }\n        return target[p];\n    }\n    set(target, p, value, receiver) {\n        const oldValue = target[p];\n        if (oldValue !== value) {\n            target[p] = value;\n            this.callPropertySubscribers(value, oldValue, p);\n            this.callProxySubscribers(p, value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n        return true;\n    }\n    deleteProperty(target, p) {\n        const oldValue = target[p];\n        if (Reflect.deleteProperty(target, p)) {\n            if (oldValue !== void 0) {\n                this.callPropertySubscribers(undefined, oldValue, p);\n                this.callProxySubscribers(p, undefined, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    defineProperty(target, p, attributes) {\n        const oldValue = target[p];\n        if (Reflect.defineProperty(target, p, attributes)) {\n            if (attributes.value !== oldValue) {\n                this.callPropertySubscribers(attributes.value, oldValue, p);\n                this.callProxySubscribers(p, attributes.value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    apply(target, thisArg, argArray = PLATFORM.emptyArray) {\n        // eslint-disable-next-line @typescript-eslint/ban-types\n        return Reflect.apply(target, target, argArray); // Reflect API dictates this\n    }\n    subscribe(subscriber, key) {\n        if (key === void 0) {\n            this.addProxySubscriber(subscriber);\n        }\n        else {\n            let subscribers = this.subscribers[key];\n            if (subscribers === void 0) {\n                subscribers = this.subscribers[key] = new ProxySubscriberCollection(this.proxy, this.raw, key);\n            }\n            subscribers.addSubscriber(subscriber);\n        }\n    }\n    unsubscribe(subscriber, key) {\n        if (key === void 0) {\n            this.removeProxySubscriber(subscriber);\n        }\n        else {\n            const subscribers = this.subscribers[key];\n            if (subscribers !== undefined) {\n                subscribers.removeSubscriber(subscriber);\n            }\n        }\n    }\n    callPropertySubscribers(newValue, oldValue, key) {\n        const subscribers = this.subscribers[key];\n        if (subscribers !== void 0) {\n            subscribers.callSubscribers(newValue, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n};\nProxyObserver = ProxyObserver_1 = __decorate([\n    proxySubscriberCollection()\n], ProxyObserver);\nexport { ProxyObserver };\n//# sourceMappingURL=proxy-observer.js.map","import { __decorate } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { subscriberCollection } from './subscriber-collection';\n/**\n * Observer for the mutation of object property value employing getter-setter strategy.\n * This is used for observing object properties that has no decorator.\n */\nlet SetterObserver = class SetterObserver {\n    constructor(lifecycle, flags, obj, propertyKey) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        this.observing = false;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // If subscribe() has been called, the target property descriptor is replaced by these getter/setter methods,\n            // so calling obj[propertyKey] will actually return this.currentValue.\n            // However, if subscribe() was not yet called (indicated by !this.observing), the target descriptor\n            // is unmodified and we need to explicitly set the property value.\n            // This will happen in one-time, to-view and two-way bindings during $bind, meaning that the $bind will not actually update the target value.\n            // This wasn't visible in vCurrent due to connect-queue always doing a delayed update, so in many cases it didn't matter whether $bind updated the target or not.\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const currentValue = this.currentValue;\n        const oldValue = this.oldValue;\n        this.oldValue = currentValue;\n        this.callSubscribers(currentValue, oldValue, this.persistentFlags | flags);\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            this.currentValue = this.obj[this.propertyKey];\n            if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n                enumerable: true,\n                configurable: true,\n                get: () => {\n                    return this.getValue();\n                },\n                set: value => {\n                    this.setValue(value, 0 /* none */);\n                },\n            })) {\n                Reporter.write(1, this.propertyKey, this.obj);\n            }\n        }\n        this.addSubscriber(subscriber);\n    }\n};\nSetterObserver = __decorate([\n    subscriberCollection()\n], SetterObserver);\nexport { SetterObserver };\n//# sourceMappingURL=setter-observer.js.map","import { PLATFORM, Reporter } from '@aurelia/kernel';\nimport { ProxyObserver } from './proxy-observer';\nimport { SetterObserver } from './setter-observer';\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n    RuntimeError[RuntimeError[\"NilOverrideContext\"] = 252] = \"NilOverrideContext\";\n    RuntimeError[RuntimeError[\"NilParentScope\"] = 253] = \"NilParentScope\";\n})(RuntimeError || (RuntimeError = {}));\nconst marker = Object.freeze({});\n/** @internal */\nexport class InternalObserversLookup {\n    getOrCreate(lifecycle, flags, obj, key) {\n        if (this[key] === void 0) {\n            this[key] = new SetterObserver(lifecycle, flags, obj, key);\n        }\n        return this[key];\n    }\n}\nexport class BindingContext {\n    constructor(keyOrObj, value) {\n        this.$synthetic = true;\n        if (keyOrObj !== void 0) {\n            if (value !== void 0) {\n                // if value is defined then it's just a property and a value to initialize with\n                this[keyOrObj] = value;\n            }\n            else {\n                // can either be some random object or another bindingContext to clone from\n                for (const prop in keyOrObj) {\n                    if (Object.prototype.hasOwnProperty.call(keyOrObj, prop)) {\n                        this[prop] = keyOrObj[prop];\n                    }\n                }\n            }\n        }\n    }\n    static create(flags, keyOrObj, value) {\n        const bc = new BindingContext(keyOrObj, value);\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(bc).proxy;\n        }\n        return bc;\n    }\n    static get(scope, name, ancestor, flags, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */);\n        }\n        let overrideContext = scope.overrideContext;\n        if (ancestor > 0) {\n            // jump up the required number of ancestor contexts (eg $parent.$parent requires two jumps)\n            while (ancestor > 0) {\n                if (overrideContext.parentOverrideContext == null) {\n                    return void 0;\n                }\n                ancestor--;\n                overrideContext = overrideContext.parentOverrideContext;\n            }\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // traverse the context and it's ancestors, searching for a context that has the name.\n        while (overrideContext && !(name in overrideContext) && !(overrideContext.bindingContext && name in overrideContext.bindingContext)) {\n            overrideContext = overrideContext.parentOverrideContext;\n        }\n        if (overrideContext) {\n            // we located a context with the property.  return it.\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // the name wasn't found. see if parent scope traversal is allowed and if so, try that\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (parent.scopeParts.includes(part)) {\n                    const result = this.get(parent, name, ancestor, flags\n                        // unset the flag; only allow one level of scope boundary traversal\n                        & ~67108864 /* allowParentScopeTraversal */\n                        // tell the scope to return null if the name could not be found\n                        | 4194304 /* isTraversingParentScope */);\n                    if (result === marker) {\n                        return scope.bindingContext || scope.overrideContext;\n                    }\n                    else {\n                        return result;\n                    }\n                }\n                else {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope could be found for part \"${part}\"`);\n            }\n        }\n        // still nothing found. return the root binding context (or null\n        // if this is a parent scope traversal, to ensure we fall back to the\n        // correct level)\n        if (flags & 4194304 /* isTraversingParentScope */) {\n            return marker;\n        }\n        return scope.bindingContext || scope.overrideContext;\n    }\n    getObservers(flags) {\n        if (this.$observers == null) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\nexport class Scope {\n    constructor(parentScope, bindingContext, overrideContext) {\n        this.parentScope = parentScope;\n        this.scopeParts = PLATFORM.emptyArray;\n        this.bindingContext = bindingContext;\n        this.overrideContext = overrideContext;\n    }\n    static create(flags, bc, oc) {\n        return new Scope(null, bc, oc == null ? OverrideContext.create(flags, bc, oc) : oc);\n    }\n    static fromOverride(flags, oc) {\n        if (oc == null) {\n            throw Reporter.error(252 /* NilOverrideContext */);\n        }\n        return new Scope(null, oc.bindingContext, oc);\n    }\n    static fromParent(flags, ps, bc) {\n        if (ps == null) {\n            throw Reporter.error(253 /* NilParentScope */);\n        }\n        return new Scope(ps, bc, OverrideContext.create(flags, bc, ps.overrideContext));\n    }\n}\nexport class OverrideContext {\n    constructor(bindingContext, parentOverrideContext) {\n        this.$synthetic = true;\n        this.bindingContext = bindingContext;\n        this.parentOverrideContext = parentOverrideContext;\n    }\n    static create(flags, bc, poc) {\n        return new OverrideContext(bc, poc === void 0 ? null : poc);\n    }\n    getObservers() {\n        if (this.$observers === void 0) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\n//# sourceMappingURL=binding-context.js.map","import { DI } from '@aurelia/kernel';\nexport const ISignaler = DI.createInterface('ISignaler').withDefault(x => x.singleton(Signaler));\n/** @internal */\nexport class Signaler {\n    constructor() {\n        this.signals = Object.create(null);\n    }\n    dispatchSignal(name, flags) {\n        const listeners = this.signals[name];\n        if (listeners === undefined) {\n            return;\n        }\n        for (const listener of listeners.keys()) {\n            listener.handleChange(undefined, undefined, flags | 16 /* updateTargetInstance */);\n        }\n    }\n    addSignalListener(name, listener) {\n        const signals = this.signals;\n        const listeners = signals[name];\n        if (listeners === undefined) {\n            signals[name] = new Set([listener]);\n        }\n        else {\n            listeners.add(listener);\n        }\n    }\n    removeSignalListener(name, listener) {\n        const listeners = this.signals[name];\n        if (listeners) {\n            listeners.delete(listener);\n        }\n    }\n}\n//# sourceMappingURL=signaler.js.map","import { DI, Registration, Metadata, Protocol, } from '@aurelia/kernel';\n/**\n * TargetedInstructionType enum values become the property names for the associated renderers when they are injected\n * into the `Renderer`.\n *\n * Additional instruction types can be added as long as they are 2 characters long and do not clash with existing ones.\n *\n * By convention, the instruction types for a particular runtime start with the same first letter, and the second letter\n * starts counting from letter `a`. The standard runtime instruction types all start with the letter `r`.\n */\nexport var TargetedInstructionType;\n(function (TargetedInstructionType) {\n    TargetedInstructionType[\"hydrateElement\"] = \"ra\";\n    TargetedInstructionType[\"hydrateAttribute\"] = \"rb\";\n    TargetedInstructionType[\"hydrateTemplateController\"] = \"rc\";\n    TargetedInstructionType[\"hydrateLetElement\"] = \"rd\";\n    TargetedInstructionType[\"setProperty\"] = \"re\";\n    TargetedInstructionType[\"interpolation\"] = \"rf\";\n    TargetedInstructionType[\"propertyBinding\"] = \"rg\";\n    TargetedInstructionType[\"callBinding\"] = \"rh\";\n    TargetedInstructionType[\"letBinding\"] = \"ri\";\n    TargetedInstructionType[\"refBinding\"] = \"rj\";\n    TargetedInstructionType[\"iteratorBinding\"] = \"rk\";\n})(TargetedInstructionType || (TargetedInstructionType = {}));\nexport const ITargetedInstruction = DI.createInterface('ITargetedInstruction').noDefault();\nexport function isTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\nexport class HooksDefinition {\n    constructor(target) {\n        this.hasRender = 'render' in target;\n        this.hasCreated = 'created' in target;\n        this.hasBinding = 'binding' in target;\n        this.hasBound = 'bound' in target;\n        this.hasUnbinding = 'unbinding' in target;\n        this.hasUnbound = 'unbound' in target;\n        this.hasAttaching = 'attaching' in target;\n        this.hasAttached = 'attached' in target;\n        this.hasDetaching = 'detaching' in target;\n        this.hasDetached = 'detached' in target;\n        this.hasCaching = 'caching' in target;\n    }\n}\nHooksDefinition.none = new HooksDefinition({});\nexport function alias(...aliases) {\n    return function (target) {\n        const key = Protocol.annotation.keyFor('aliases');\n        const existing = Metadata.getOwn(key, target);\n        if (existing === void 0) {\n            Metadata.define(key, aliases, target);\n        }\n        else {\n            existing.push(...aliases);\n        }\n    };\n}\nexport function registerAliases(aliases, resource, key, container) {\n    for (let i = 0, ii = aliases.length; i < ii; ++i) {\n        Registration.alias(key, resource.keyFrom(aliases[i])).register(container);\n    }\n}\n//# sourceMappingURL=definitions.js.map","import { Registration, Metadata, Protocol, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nexport function bindingBehavior(nameOrDef) {\n    return function (target) {\n        return BindingBehavior.define(nameOrDef, target);\n    };\n}\nexport class BindingBehaviorDefinition {\n    constructor(Type, name, aliases, key) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new BindingBehaviorDefinition(Type, firstDefined(BindingBehavior.getAnnotation(Type, 'name'), name), mergeArrays(BindingBehavior.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingBehavior.keyFrom(name));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, BindingBehavior, key, container);\n    }\n}\nexport const BindingBehavior = {\n    name: Protocol.resource.keyFor('binding-behavior'),\n    keyFrom(name) {\n        return `${BindingBehavior.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingBehavior.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingBehaviorDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingBehavior.name, definition, definition.Type);\n        Metadata.define(BindingBehavior.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingBehavior.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingBehavior.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=binding-behavior.js.map","import { Registration, Metadata, Protocol, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nexport function valueConverter(nameOrDef) {\n    return function (target) {\n        return ValueConverter.define(nameOrDef, target);\n    };\n}\nexport class ValueConverterDefinition {\n    constructor(Type, name, aliases, key) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new ValueConverterDefinition(Type, firstDefined(ValueConverter.getAnnotation(Type, 'name'), name), mergeArrays(ValueConverter.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), ValueConverter.keyFrom(name));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, ValueConverter, key, container);\n    }\n}\nexport const ValueConverter = {\n    name: Protocol.resource.keyFor('value-converter'),\n    keyFrom(name) {\n        return `${ValueConverter.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(ValueConverter.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = ValueConverterDefinition.create(nameOrDef, Type);\n        Metadata.define(ValueConverter.name, definition, definition.Type);\n        Metadata.define(ValueConverter.name, definition, definition);\n        Protocol.resource.appendTo(Type, ValueConverter.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(ValueConverter.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=value-converter.js.map","import { isNumeric, PLATFORM, Reporter, isNumberOrBigInt, isStringOrDate, } from '@aurelia/kernel';\nimport { BindingContext } from '../observation/binding-context';\nimport { ProxyObserver } from '../observation/proxy-observer';\nimport { ISignaler } from '../observation/signaler';\nimport { BindingBehavior, } from '../resources/binding-behavior';\nimport { ValueConverter, } from '../resources/value-converter';\nexport function connects(expr) {\n    return (expr.$kind & 32 /* Connects */) === 32 /* Connects */;\n}\nexport function observes(expr) {\n    return (expr.$kind & 64 /* Observes */) === 64 /* Observes */;\n}\nexport function callsFunction(expr) {\n    return (expr.$kind & 128 /* CallsFunction */) === 128 /* CallsFunction */;\n}\nexport function hasAncestor(expr) {\n    return (expr.$kind & 256 /* HasAncestor */) === 256 /* HasAncestor */;\n}\nexport function isAssignable(expr) {\n    return (expr.$kind & 8192 /* IsAssignable */) === 8192 /* IsAssignable */;\n}\nexport function isLeftHandSide(expr) {\n    return (expr.$kind & 1024 /* IsLeftHandSide */) === 1024 /* IsLeftHandSide */;\n}\nexport function isPrimary(expr) {\n    return (expr.$kind & 512 /* IsPrimary */) === 512 /* IsPrimary */;\n}\nexport function isResource(expr) {\n    return (expr.$kind & 32768 /* IsResource */) === 32768 /* IsResource */;\n}\nexport function hasBind(expr) {\n    return (expr.$kind & 2048 /* HasBind */) === 2048 /* HasBind */;\n}\nexport function hasUnbind(expr) {\n    return (expr.$kind & 4096 /* HasUnbind */) === 4096 /* HasUnbind */;\n}\nexport function isLiteral(expr) {\n    return (expr.$kind & 16384 /* IsLiteral */) === 16384 /* IsLiteral */;\n}\nexport function arePureLiterals(expressions) {\n    if (expressions === void 0 || expressions.length === 0) {\n        return true;\n    }\n    for (let i = 0; i < expressions.length; ++i) {\n        if (!isPureLiteral(expressions[i])) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function isPureLiteral(expr) {\n    if (isLiteral(expr)) {\n        switch (expr.$kind) {\n            case 17955 /* ArrayLiteral */:\n                return arePureLiterals(expr.elements);\n            case 17956 /* ObjectLiteral */:\n                return arePureLiterals(expr.values);\n            case 17958 /* Template */:\n                return arePureLiterals(expr.expressions);\n            case 17925 /* PrimitiveLiteral */:\n                return true;\n        }\n    }\n    return false;\n}\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NoLocator\"] = 202] = \"NoLocator\";\n    RuntimeError[RuntimeError[\"NoBehaviorFound\"] = 203] = \"NoBehaviorFound\";\n    RuntimeError[RuntimeError[\"BehaviorAlreadyApplied\"] = 204] = \"BehaviorAlreadyApplied\";\n    RuntimeError[RuntimeError[\"NoConverterFound\"] = 205] = \"NoConverterFound\";\n    RuntimeError[RuntimeError[\"NoBinding\"] = 206] = \"NoBinding\";\n    RuntimeError[RuntimeError[\"NotAFunction\"] = 207] = \"NotAFunction\";\n    RuntimeError[RuntimeError[\"UnknownOperator\"] = 208] = \"UnknownOperator\";\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n})(RuntimeError || (RuntimeError = {}));\nexport class CustomExpression {\n    constructor(value) {\n        this.value = value;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n}\nexport class BindingBehaviorExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 38962 /* BindingBehavior */;\n        this.behaviorKey = BindingBehavior.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        if (hasBind(this.expression)) {\n            this.expression.bind(flags, scope, binding);\n        }\n        const behaviorKey = this.behaviorKey;\n        const behavior = locator.get(behaviorKey);\n        if (!behavior) {\n            throw Reporter.error(203 /* NoBehaviorFound */, this);\n        }\n        if (binding[behaviorKey] === void 0) {\n            binding[behaviorKey] = behavior;\n            behavior.bind.call(behavior, flags, scope, binding, ...evalList(flags, scope, locator, this.args));\n        }\n        else {\n            Reporter.write(204 /* BehaviorAlreadyApplied */, this);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const behaviorKey = this.behaviorKey;\n        if (binding[behaviorKey] !== void 0) {\n            binding[behaviorKey].unbind(flags, scope, binding);\n            binding[behaviorKey] = void 0;\n        }\n        else {\n            // TODO: this is a temporary hack to make testing repeater keyed mode easier,\n            // we should remove this idempotency again when track-by attribute is implemented\n            Reporter.write(204 /* BehaviorAlreadyApplied */, this);\n        }\n        if (hasUnbind(this.expression)) {\n            this.expression.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitBindingBehavior(this);\n    }\n}\nexport class ValueConverterExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 36913 /* ValueConverter */;\n        this.converterKey = ValueConverter.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('toView' in converter) {\n            const args = this.args;\n            const len = args.length;\n            const result = Array(len + 1);\n            result[0] = this.expression.evaluate(flags, scope, locator, part);\n            for (let i = 0; i < len; ++i) {\n                result[i + 1] = args[i].evaluate(flags, scope, locator, part);\n            }\n            return converter.toView.call(converter, ...result);\n        }\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('fromView' in converter) {\n            value = converter.fromView.call(converter, value, ...(evalList(flags, scope, locator, this.args)));\n        }\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        this.expression.connect(flags, scope, binding, part);\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.addSignalListener(signals[i], binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const locator = binding.locator;\n        const converter = locator.get(this.converterKey);\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.removeSignalListener(signals[i], binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitValueConverter(this);\n    }\n}\nexport class AssignExpression {\n    constructor(target, value) {\n        this.target = target;\n        this.value = value;\n        this.$kind = 8208 /* Assign */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.target.assign(flags, scope, locator, this.value.evaluate(flags, scope, locator), part);\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    assign(flags, scope, locator, value, part) {\n        this.value.assign(flags, scope, locator, value, part);\n        return this.target.assign(flags, scope, locator, value, part);\n    }\n    accept(visitor) {\n        return visitor.visitAssign(this);\n    }\n}\nexport class ConditionalExpression {\n    constructor(condition, yes, no) {\n        this.condition = condition;\n        this.yes = yes;\n        this.no = no;\n        this.$kind = 63 /* Conditional */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return (!!this.condition.evaluate(flags, scope, locator, part))\n            ? this.yes.evaluate(flags, scope, locator, part)\n            : this.no.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const condition = this.condition;\n        if (condition.evaluate(flags, scope, null, part)) {\n            this.condition.connect(flags, scope, binding, part);\n            this.yes.connect(flags, scope, binding, part);\n        }\n        else {\n            this.condition.connect(flags, scope, binding, part);\n            this.no.connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitConditional(this);\n    }\n}\nexport class AccessThisExpression {\n    constructor(ancestor = 0) {\n        this.ancestor = ancestor;\n        this.$kind = 1793 /* AccessThis */;\n    }\n    evaluate(flags, scope, locator, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (!parent.scopeParts.includes(part)) {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope cold be found for part \"${part}\"`);\n            }\n        }\n        let oc = scope.overrideContext;\n        let i = this.ancestor;\n        while (i-- && oc) {\n            oc = oc.parentOverrideContext;\n        }\n        return i < 1 && oc ? oc.bindingContext : void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitAccessThis(this);\n    }\n}\nAccessThisExpression.$this = new AccessThisExpression(0);\nAccessThisExpression.$parent = new AccessThisExpression(1);\nexport class AccessScopeExpression {\n    constructor(name, ancestor = 0) {\n        this.name = name;\n        this.ancestor = ancestor;\n        this.$kind = 10082 /* AccessScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const evaluatedValue = obj[this.name];\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return evaluatedValue;\n        }\n        return evaluatedValue == null ? '' : evaluatedValue;\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n                return value;\n            }\n            else {\n                return obj[this.name] = value;\n            }\n        }\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        binding.observeProperty(flags, context, this.name);\n    }\n    accept(visitor) {\n        return visitor.visitAccessScope(this);\n    }\n}\nexport class AccessMemberExpression {\n    constructor(object, name) {\n        this.object = object;\n        this.name = name;\n        this.$kind = 9323 /* AccessMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return instance == null ? instance : instance[this.name];\n        }\n        return instance ? instance[this.name] : '';\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = this.object.evaluate(flags, scope, locator, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n            }\n            else {\n                obj[this.name] = value;\n            }\n        }\n        else {\n            this.object.assign(flags, scope, locator, { [this.name]: value });\n        }\n        return value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            binding.observeProperty(flags, obj, this.name);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessMember(this);\n    }\n}\nexport class AccessKeyedExpression {\n    constructor(object, key) {\n        this.object = object;\n        this.key = key;\n        this.$kind = 9324 /* AccessKeyed */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (instance instanceof Object) {\n            const key = this.key.evaluate(flags, scope, locator, part);\n            return instance[key];\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, value, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const key = this.key.evaluate(flags, scope, locator, part);\n        return instance[key] = value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            this.key.connect(flags, scope, binding, part);\n            const key = this.key.evaluate(flags, scope, null, part);\n            if (Array.isArray(obj) && isNumeric(key)) {\n                // Only observe array indexers in proxy mode\n                if (flags & 2 /* proxyStrategy */) {\n                    binding.observeProperty(flags, obj, key);\n                }\n            }\n            else {\n                // observe the property represented by the key as long as it's not an array indexer\n                // (note: string indexers behave the same way as numeric indexers as long as they represent numbers)\n                binding.observeProperty(flags, obj, key);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessKeyed(this);\n    }\n}\nexport class CallScopeExpression {\n    constructor(name, args, ancestor = 0) {\n        this.name = name;\n        this.args = args;\n        this.ancestor = ancestor;\n        this.$kind = 1448 /* CallScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const args = evalList(flags, scope, locator, this.args, part);\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const func = getFunction(flags, context, this.name);\n        if (func) {\n            return func.apply(context, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallScope(this);\n    }\n}\nexport class CallMemberExpression {\n    constructor(object, name, args) {\n        this.object = object;\n        this.name = name;\n        this.args = args;\n        this.$kind = 1161 /* CallMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const args = evalList(flags, scope, locator, this.args, part);\n        const func = getFunction(flags, instance, this.name);\n        if (func) {\n            return func.apply(instance, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (getFunction(flags & ~2097152 /* mustEvaluate */, obj, this.name)) {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallMember(this);\n    }\n}\nexport class CallFunctionExpression {\n    constructor(func, args) {\n        this.func = func;\n        this.args = args;\n        this.$kind = 1162 /* CallFunction */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func === 'function') {\n            return func(...evalList(flags, scope, locator, this.args, part));\n        }\n        if (!(flags & 2097152 /* mustEvaluate */) && (func == null)) {\n            return void 0;\n        }\n        throw Reporter.error(207 /* NotAFunction */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const func = this.func.evaluate(flags, scope, null, part);\n        this.func.connect(flags, scope, binding, part);\n        if (typeof func === 'function') {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallFunction(this);\n    }\n}\nexport class BinaryExpression {\n    constructor(operation, left, right) {\n        this.operation = operation;\n        this.left = left;\n        this.right = right;\n        this.$kind = 46 /* Binary */;\n        // what we're doing here is effectively moving the large switch statement from evaluate to the constructor\n        // so that the check only needs to be done once, and evaluate (which is called many times) will have a lot less\n        // work to do; we can do this because the operation can't change after it's parsed\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.left.connect(flags, scope, binding, part);\n        this.right.connect(flags, scope, binding, part);\n    }\n    ['&&'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) && this.right.evaluate(f, s, l, p);\n    }\n    ['||'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) || this.right.evaluate(f, s, l, p);\n    }\n    ['=='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) == this.right.evaluate(f, s, l, p);\n    }\n    ['==='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) === this.right.evaluate(f, s, l, p);\n    }\n    ['!='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) != this.right.evaluate(f, s, l, p);\n    }\n    ['!=='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) !== this.right.evaluate(f, s, l, p);\n    }\n    ['instanceof'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (typeof right === 'function') {\n            return this.left.evaluate(f, s, l, p) instanceof right;\n        }\n        return false;\n    }\n    ['in'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (right instanceof Object) {\n            return this.left.evaluate(f, s, l, p) in right;\n        }\n        return false;\n    }\n    // note: autoConvertAdd (and the null check) is removed because the default spec behavior is already largely similar\n    // and where it isn't, you kind of want it to behave like the spec anyway (e.g. return NaN when adding a number to undefined)\n    // this makes bugs in user code easier to track down for end users\n    // also, skipping these checks and leaving it to the runtime is a nice little perf boost and simplifies our code\n    ['+'](f, s, l, p) {\n        const left = this.left.evaluate(f, s, l, p);\n        const right = this.right.evaluate(f, s, l, p);\n        if ((f & 4 /* isStrictBindingStrategy */) > 0) {\n            return left + right;\n        }\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (!left || !right) {\n            if (isNumberOrBigInt(left) || isNumberOrBigInt(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || 0) + (right || 0);\n            }\n            if (isStringOrDate(left) || isStringOrDate(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || '') + (right || '');\n            }\n        }\n        return left + right;\n    }\n    ['-'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) - this.right.evaluate(f, s, l, p);\n    }\n    ['*'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) * this.right.evaluate(f, s, l, p);\n    }\n    ['/'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) / this.right.evaluate(f, s, l, p);\n    }\n    ['%'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) % this.right.evaluate(f, s, l, p);\n    }\n    ['<'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) < this.right.evaluate(f, s, l, p);\n    }\n    ['>'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) > this.right.evaluate(f, s, l, p);\n    }\n    ['<='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) <= this.right.evaluate(f, s, l, p);\n    }\n    ['>='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) >= this.right.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitBinary(this);\n    }\n}\nexport class UnaryExpression {\n    constructor(operation, expression) {\n        this.operation = operation;\n        this.expression = expression;\n        this.$kind = 39 /* Unary */;\n        // see Binary (we're doing the same thing here)\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    ['void'](f, s, l, p) {\n        return void this.expression.evaluate(f, s, l, p);\n    }\n    ['typeof'](f, s, l, p) {\n        return typeof this.expression.evaluate(f | 4 /* isStrictBindingStrategy */, s, l, p);\n    }\n    ['!'](f, s, l, p) {\n        return !this.expression.evaluate(f, s, l, p);\n    }\n    ['-'](f, s, l, p) {\n        return -this.expression.evaluate(f, s, l, p);\n    }\n    ['+'](f, s, l, p) {\n        return +this.expression.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitUnary(this);\n    }\n}\nexport class PrimitiveLiteralExpression {\n    constructor(value) {\n        this.value = value;\n        this.$kind = 17925 /* PrimitiveLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitPrimitiveLiteral(this);\n    }\n}\nPrimitiveLiteralExpression.$undefined = new PrimitiveLiteralExpression(void 0);\nPrimitiveLiteralExpression.$null = new PrimitiveLiteralExpression(null);\nPrimitiveLiteralExpression.$true = new PrimitiveLiteralExpression(true);\nPrimitiveLiteralExpression.$false = new PrimitiveLiteralExpression(false);\nPrimitiveLiteralExpression.$empty = new PrimitiveLiteralExpression('');\nexport class HtmlLiteralExpression {\n    constructor(parts) {\n        this.parts = parts;\n        this.$kind = 51 /* HtmlLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.parts;\n        let result = '';\n        let value;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            value = elements[i].evaluate(flags, scope, locator, part);\n            if (value == null) {\n                continue;\n            }\n            result += value;\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        for (let i = 0, ii = this.parts.length; i < ii; ++i) {\n            this.parts[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitHtmlLiteral(this);\n    }\n}\nexport class ArrayLiteralExpression {\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 17955 /* ArrayLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.elements;\n        const length = elements.length;\n        const result = Array(length);\n        for (let i = 0; i < length; ++i) {\n            result[i] = elements[i].evaluate(flags, scope, locator, part);\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const elements = this.elements;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            elements[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitArrayLiteral(this);\n    }\n}\nArrayLiteralExpression.$empty = new ArrayLiteralExpression(PLATFORM.emptyArray);\nexport class ObjectLiteralExpression {\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 17956 /* ObjectLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = {};\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            instance[keys[i]] = values[i].evaluate(flags, scope, locator, part);\n        }\n        return instance;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            values[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitObjectLiteral(this);\n    }\n}\nObjectLiteralExpression.$empty = new ObjectLiteralExpression(PLATFORM.emptyArray, PLATFORM.emptyArray);\nexport class TemplateExpression {\n    constructor(cooked, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.expressions = expressions;\n        this.$kind = 17958 /* Template */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const cooked = this.cooked;\n        let result = cooked[0];\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            result += expressions[i].evaluate(flags, scope, locator, part);\n            result += cooked[i + 1];\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding, part);\n            i++;\n        }\n    }\n    accept(visitor) {\n        return visitor.visitTemplate(this);\n    }\n}\nTemplateExpression.$empty = new TemplateExpression(['']);\nexport class TaggedTemplateExpression {\n    constructor(cooked, raw, func, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.func = func;\n        this.expressions = expressions;\n        this.$kind = 1197 /* TaggedTemplate */;\n        cooked.raw = raw;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const len = expressions.length;\n        const results = Array(len);\n        for (let i = 0, ii = len; i < ii; ++i) {\n            results[i] = expressions[i].evaluate(flags, scope, locator, part);\n        }\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func !== 'function') {\n            throw Reporter.error(207 /* NotAFunction */, this);\n        }\n        return func(this.cooked, ...results);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding);\n        }\n        this.func.connect(flags, scope, binding);\n    }\n    accept(visitor) {\n        return visitor.visitTaggedTemplate(this);\n    }\n}\nexport class ArrayBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 65556 /* ArrayBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitArrayBindingPattern(this);\n    }\n}\nexport class ObjectBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 65557 /* ObjectBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitObjectBindingPattern(this);\n    }\n}\nexport class BindingIdentifier {\n    constructor(name) {\n        this.name = name;\n        this.$kind = 65558 /* BindingIdentifier */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.name;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitBindingIdentifier(this);\n    }\n}\nconst toStringTag = Object.prototype.toString;\n// https://tc39.github.io/ecma262/#sec-iteration-statements\n// https://tc39.github.io/ecma262/#sec-for-in-and-for-of-statements\nexport class ForOfStatement {\n    constructor(declaration, iterable) {\n        this.declaration = declaration;\n        this.iterable = iterable;\n        this.$kind = 6199 /* ForOfStatement */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.iterable.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    count(flags, result) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return result.length;\n            case '[object Map]': return result.size;\n            case '[object Set]': return result.size;\n            case '[object Number]': return result;\n            case '[object Null]': return 0;\n            case '[object Undefined]': return 0;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    iterate(flags, result, func) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return $array(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Map]': return $map(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Set]': return $set(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Number]': return $number(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Null]': return;\n            case '[object Undefined]': return;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    connect(flags, scope, binding, part) {\n        this.declaration.connect(flags, scope, binding, part);\n        this.iterable.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (hasBind(this.iterable)) {\n            this.iterable.bind(flags, scope, binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        if (hasUnbind(this.iterable)) {\n            this.iterable.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitForOfStatement(this);\n    }\n}\n/*\n* Note: this implementation is far simpler than the one in vCurrent and might be missing important stuff (not sure yet)\n* so while this implementation is identical to Template and we could reuse that one, we don't want to lock outselves in to potentially the wrong abstraction\n* but this class might be a candidate for removal if it turns out it does provide all we need\n*/\nexport class Interpolation {\n    constructor(parts, expressions = PLATFORM.emptyArray) {\n        this.parts = parts;\n        this.expressions = expressions;\n        this.$kind = 24 /* Interpolation */;\n        this.isMulti = expressions.length > 1;\n        this.firstExpression = expressions[0];\n    }\n    evaluate(flags, scope, locator, part) {\n        if (this.isMulti) {\n            const expressions = this.expressions;\n            const parts = this.parts;\n            let result = parts[0];\n            for (let i = 0, ii = expressions.length; i < ii; ++i) {\n                result += expressions[i].evaluate(flags, scope, locator, part);\n                result += parts[i + 1];\n            }\n            return result;\n        }\n        else {\n            const parts = this.parts;\n            return parts[0] + this.firstExpression.evaluate(flags, scope, locator, part) + parts[1];\n        }\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitInterpolation(this);\n    }\n}\n/// Evaluate the [list] in context of the [scope].\nfunction evalList(flags, scope, locator, list, part) {\n    const len = list.length;\n    const result = Array(len);\n    for (let i = 0; i < len; ++i) {\n        result[i] = list[i].evaluate(flags, scope, locator, part);\n    }\n    return result;\n}\nfunction getFunction(flags, obj, name) {\n    const func = obj == null ? null : obj[name];\n    if (typeof func === 'function') {\n        return func;\n    }\n    if (!(flags & 2097152 /* mustEvaluate */) && func == null) {\n        return null;\n    }\n    throw Reporter.error(207 /* NotAFunction */, obj, name, func);\n}\nconst proxyAndOriginalArray = 2 /* proxyStrategy */ | 8388608 /* isOriginalArray */;\nfunction $array(flags, result, func) {\n    if ((flags & proxyAndOriginalArray) === proxyAndOriginalArray) {\n        // If we're in proxy mode, and the array is the original \"items\" (and not an array we created here to iterate over e.g. a set)\n        // then replace all items (which are Objects) with proxies so their properties are observed in the source view model even if no\n        // observers are explicitly created\n        const rawArray = ProxyObserver.getRawIfProxy(result);\n        const len = rawArray.length;\n        let item;\n        let i = 0;\n        for (; i < len; ++i) {\n            item = rawArray[i];\n            if (item instanceof Object) {\n                item = rawArray[i] = ProxyObserver.getOrCreate(item).proxy;\n            }\n            func(rawArray, i, item);\n        }\n    }\n    else {\n        for (let i = 0, ii = result.length; i < ii; ++i) {\n            func(result, i, result[i]);\n        }\n    }\n}\nfunction $map(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const entry of result.entries()) {\n        arr[++i] = entry;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $set(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const key of result.keys()) {\n        arr[++i] = key;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $number(flags, result, func) {\n    const arr = Array(result);\n    for (let i = 0; i < result; ++i) {\n        arr[i] = i;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\n//# sourceMappingURL=ast.js.map","/*\n* Note: the oneTime binding now has a non-zero value for 2 reasons:\n*  - plays nicer with bitwise operations (more consistent code, more explicit settings)\n*  - allows for potentially having something like BindingMode.oneTime | BindingMode.fromView, where an initial value is set once to the view but updates from the view also propagate back to the view model\n*\n* Furthermore, the \"default\" mode would be for simple \".bind\" expressions to make it explicit for our logic that the default is being used.\n* This essentially adds extra information which binding could use to do smarter things and allows bindingBehaviors that add a mode instead of simply overwriting it\n*/\nexport var BindingMode;\n(function (BindingMode) {\n    BindingMode[BindingMode[\"oneTime\"] = 1] = \"oneTime\";\n    BindingMode[BindingMode[\"toView\"] = 2] = \"toView\";\n    BindingMode[BindingMode[\"fromView\"] = 4] = \"fromView\";\n    BindingMode[BindingMode[\"twoWay\"] = 6] = \"twoWay\";\n    BindingMode[BindingMode[\"default\"] = 8] = \"default\";\n})(BindingMode || (BindingMode = {}));\nexport var BindingStrategy;\n(function (BindingStrategy) {\n    /**\n     * Configures all components \"below\" this one to operate in getterSetter binding mode.\n     * This is the default; if no strategy is specified, this one is implied.\n     *\n     * This strategy is the most compatible, convenient and has the best performance on frequently updated bindings on components that are infrequently replaced.\n     * However, it also consumes the most resources on initialization.\n     */\n    BindingStrategy[BindingStrategy[\"getterSetter\"] = 1] = \"getterSetter\";\n    /**\n     * Configures all components \"below\" this one to operate in proxy binding mode.\n     * No getters/setters are created.\n     *\n     * This strategy consumes significantly fewer resources than `getterSetter` on initialization and has the best performance on infrequently updated bindings on\n     * components that are frequently replaced.\n     * However, it consumes more resources on updates.\n     */\n    BindingStrategy[BindingStrategy[\"proxies\"] = 2] = \"proxies\";\n})(BindingStrategy || (BindingStrategy = {}));\nconst mandatoryStrategy = 1 /* getterSetter */ | 2 /* proxies */;\nexport function ensureValidStrategy(strategy) {\n    if ((strategy & mandatoryStrategy) === 0) {\n        // TODO: probably want to validate that user isn't trying to mix getterSetter/proxy\n        // TODO: also need to make sure that strategy can be changed away from proxies inside the component tree (not here though, but just making a note)\n        return strategy | 1 /* getterSetter */;\n    }\n    return strategy;\n}\nexport var State;\n(function (State) {\n    State[State[\"none\"] = 0] = \"none\";\n    State[State[\"isBinding\"] = 1] = \"isBinding\";\n    State[State[\"isUnbinding\"] = 2] = \"isUnbinding\";\n    State[State[\"isBound\"] = 4] = \"isBound\";\n    State[State[\"isBoundOrBinding\"] = 5] = \"isBoundOrBinding\";\n    State[State[\"isBoundOrUnbinding\"] = 6] = \"isBoundOrUnbinding\";\n    State[State[\"isAttaching\"] = 8] = \"isAttaching\";\n    State[State[\"isDetaching\"] = 16] = \"isDetaching\";\n    State[State[\"isAttached\"] = 32] = \"isAttached\";\n    State[State[\"isAttachedOrAttaching\"] = 40] = \"isAttachedOrAttaching\";\n    State[State[\"isAttachedOrDetaching\"] = 48] = \"isAttachedOrDetaching\";\n    State[State[\"isMounted\"] = 64] = \"isMounted\";\n    State[State[\"isCached\"] = 128] = \"isCached\";\n    State[State[\"needsBind\"] = 256] = \"needsBind\";\n    State[State[\"needsUnbind\"] = 512] = \"needsUnbind\";\n    State[State[\"needsAttach\"] = 1024] = \"needsAttach\";\n    State[State[\"needsDetach\"] = 2048] = \"needsDetach\";\n    State[State[\"needsMount\"] = 4096] = \"needsMount\";\n    State[State[\"needsUnmount\"] = 8192] = \"needsUnmount\";\n    State[State[\"hasLockedScope\"] = 16384] = \"hasLockedScope\";\n    State[State[\"canBeCached\"] = 32768] = \"canBeCached\";\n    State[State[\"inBoundQueue\"] = 65536] = \"inBoundQueue\";\n    State[State[\"inUnboundQueue\"] = 131072] = \"inUnboundQueue\";\n    State[State[\"inAttachedQueue\"] = 262144] = \"inAttachedQueue\";\n    State[State[\"inDetachedQueue\"] = 524288] = \"inDetachedQueue\";\n    State[State[\"inMountQueue\"] = 1048576] = \"inMountQueue\";\n    State[State[\"inUnmountQueue\"] = 2097152] = \"inUnmountQueue\";\n})(State || (State = {}));\nexport var Hooks;\n(function (Hooks) {\n    Hooks[Hooks[\"none\"] = 1] = \"none\";\n    Hooks[Hooks[\"hasCreated\"] = 2] = \"hasCreated\";\n    Hooks[Hooks[\"hasBinding\"] = 4] = \"hasBinding\";\n    Hooks[Hooks[\"hasBound\"] = 8] = \"hasBound\";\n    Hooks[Hooks[\"hasAttaching\"] = 16] = \"hasAttaching\";\n    Hooks[Hooks[\"hasAttached\"] = 32] = \"hasAttached\";\n    Hooks[Hooks[\"hasDetaching\"] = 64] = \"hasDetaching\";\n    Hooks[Hooks[\"hasDetached\"] = 128] = \"hasDetached\";\n    Hooks[Hooks[\"hasUnbinding\"] = 256] = \"hasUnbinding\";\n    Hooks[Hooks[\"hasUnbound\"] = 512] = \"hasUnbound\";\n    Hooks[Hooks[\"hasRender\"] = 1024] = \"hasRender\";\n    Hooks[Hooks[\"hasCaching\"] = 2048] = \"hasCaching\";\n})(Hooks || (Hooks = {}));\nexport var LifecycleFlags;\n(function (LifecycleFlags) {\n    LifecycleFlags[LifecycleFlags[\"none\"] = 0] = \"none\";\n    // Bitmask for flags that need to be stored on a binding during $bind for mutation\n    // callbacks outside of $bind\n    LifecycleFlags[LifecycleFlags[\"persistentBindingFlags\"] = 2080374799] = \"persistentBindingFlags\";\n    LifecycleFlags[LifecycleFlags[\"allowParentScopeTraversal\"] = 67108864] = \"allowParentScopeTraversal\";\n    LifecycleFlags[LifecycleFlags[\"observeLeafPropertiesOnly\"] = 134217728] = \"observeLeafPropertiesOnly\";\n    LifecycleFlags[LifecycleFlags[\"targetObserverFlags\"] = 805306383] = \"targetObserverFlags\";\n    LifecycleFlags[LifecycleFlags[\"noTargetObserverQueue\"] = 268435456] = \"noTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"persistentTargetObserverQueue\"] = 536870912] = \"persistentTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"secondaryExpression\"] = 1073741824] = \"secondaryExpression\";\n    LifecycleFlags[LifecycleFlags[\"bindingStrategy\"] = 15] = \"bindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"getterSetterStrategy\"] = 1] = \"getterSetterStrategy\";\n    LifecycleFlags[LifecycleFlags[\"proxyStrategy\"] = 2] = \"proxyStrategy\";\n    LifecycleFlags[LifecycleFlags[\"isStrictBindingStrategy\"] = 4] = \"isStrictBindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"update\"] = 48] = \"update\";\n    LifecycleFlags[LifecycleFlags[\"updateTargetInstance\"] = 16] = \"updateTargetInstance\";\n    LifecycleFlags[LifecycleFlags[\"updateSourceExpression\"] = 32] = \"updateSourceExpression\";\n    LifecycleFlags[LifecycleFlags[\"from\"] = 524224] = \"from\";\n    LifecycleFlags[LifecycleFlags[\"fromFlush\"] = 960] = \"fromFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromAsyncFlush\"] = 64] = \"fromAsyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromSyncFlush\"] = 128] = \"fromSyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromTick\"] = 256] = \"fromTick\";\n    LifecycleFlags[LifecycleFlags[\"fromBatch\"] = 512] = \"fromBatch\";\n    LifecycleFlags[LifecycleFlags[\"fromStartTask\"] = 1024] = \"fromStartTask\";\n    LifecycleFlags[LifecycleFlags[\"fromStopTask\"] = 2048] = \"fromStopTask\";\n    LifecycleFlags[LifecycleFlags[\"fromBind\"] = 4096] = \"fromBind\";\n    LifecycleFlags[LifecycleFlags[\"fromUnbind\"] = 8192] = \"fromUnbind\";\n    LifecycleFlags[LifecycleFlags[\"fromAttach\"] = 16384] = \"fromAttach\";\n    LifecycleFlags[LifecycleFlags[\"fromDetach\"] = 32768] = \"fromDetach\";\n    LifecycleFlags[LifecycleFlags[\"fromCache\"] = 65536] = \"fromCache\";\n    LifecycleFlags[LifecycleFlags[\"fromDOMEvent\"] = 131072] = \"fromDOMEvent\";\n    LifecycleFlags[LifecycleFlags[\"fromLifecycleTask\"] = 262144] = \"fromLifecycleTask\";\n    LifecycleFlags[LifecycleFlags[\"allowPublishRoundtrip\"] = 524288] = \"allowPublishRoundtrip\";\n    LifecycleFlags[LifecycleFlags[\"isPublishing\"] = 1048576] = \"isPublishing\";\n    LifecycleFlags[LifecycleFlags[\"mustEvaluate\"] = 2097152] = \"mustEvaluate\";\n    LifecycleFlags[LifecycleFlags[\"isTraversingParentScope\"] = 4194304] = \"isTraversingParentScope\";\n    LifecycleFlags[LifecycleFlags[\"isOriginalArray\"] = 8388608] = \"isOriginalArray\";\n    LifecycleFlags[LifecycleFlags[\"isCollectionMutation\"] = 16777216] = \"isCollectionMutation\";\n    LifecycleFlags[LifecycleFlags[\"reorderNodes\"] = 33554432] = \"reorderNodes\";\n})(LifecycleFlags || (LifecycleFlags = {}));\nexport var ExpressionKind;\n(function (ExpressionKind) {\n    ExpressionKind[ExpressionKind[\"Connects\"] = 32] = \"Connects\";\n    ExpressionKind[ExpressionKind[\"Observes\"] = 64] = \"Observes\";\n    ExpressionKind[ExpressionKind[\"CallsFunction\"] = 128] = \"CallsFunction\";\n    ExpressionKind[ExpressionKind[\"HasAncestor\"] = 256] = \"HasAncestor\";\n    ExpressionKind[ExpressionKind[\"IsPrimary\"] = 512] = \"IsPrimary\";\n    ExpressionKind[ExpressionKind[\"IsLeftHandSide\"] = 1024] = \"IsLeftHandSide\";\n    ExpressionKind[ExpressionKind[\"HasBind\"] = 2048] = \"HasBind\";\n    ExpressionKind[ExpressionKind[\"HasUnbind\"] = 4096] = \"HasUnbind\";\n    ExpressionKind[ExpressionKind[\"IsAssignable\"] = 8192] = \"IsAssignable\";\n    ExpressionKind[ExpressionKind[\"IsLiteral\"] = 16384] = \"IsLiteral\";\n    ExpressionKind[ExpressionKind[\"IsResource\"] = 32768] = \"IsResource\";\n    ExpressionKind[ExpressionKind[\"IsForDeclaration\"] = 65536] = \"IsForDeclaration\";\n    ExpressionKind[ExpressionKind[\"Type\"] = 31] = \"Type\";\n    // ---------------------------------------------------------------------------------------------------------------------------\n    ExpressionKind[ExpressionKind[\"AccessThis\"] = 1793] = \"AccessThis\";\n    ExpressionKind[ExpressionKind[\"AccessScope\"] = 10082] = \"AccessScope\";\n    ExpressionKind[ExpressionKind[\"ArrayLiteral\"] = 17955] = \"ArrayLiteral\";\n    ExpressionKind[ExpressionKind[\"ObjectLiteral\"] = 17956] = \"ObjectLiteral\";\n    ExpressionKind[ExpressionKind[\"PrimitiveLiteral\"] = 17925] = \"PrimitiveLiteral\";\n    ExpressionKind[ExpressionKind[\"Template\"] = 17958] = \"Template\";\n    ExpressionKind[ExpressionKind[\"Unary\"] = 39] = \"Unary\";\n    ExpressionKind[ExpressionKind[\"CallScope\"] = 1448] = \"CallScope\";\n    ExpressionKind[ExpressionKind[\"CallMember\"] = 1161] = \"CallMember\";\n    ExpressionKind[ExpressionKind[\"CallFunction\"] = 1162] = \"CallFunction\";\n    ExpressionKind[ExpressionKind[\"AccessMember\"] = 9323] = \"AccessMember\";\n    ExpressionKind[ExpressionKind[\"AccessKeyed\"] = 9324] = \"AccessKeyed\";\n    ExpressionKind[ExpressionKind[\"TaggedTemplate\"] = 1197] = \"TaggedTemplate\";\n    ExpressionKind[ExpressionKind[\"Binary\"] = 46] = \"Binary\";\n    ExpressionKind[ExpressionKind[\"Conditional\"] = 63] = \"Conditional\";\n    ExpressionKind[ExpressionKind[\"Assign\"] = 8208] = \"Assign\";\n    ExpressionKind[ExpressionKind[\"ValueConverter\"] = 36913] = \"ValueConverter\";\n    ExpressionKind[ExpressionKind[\"BindingBehavior\"] = 38962] = \"BindingBehavior\";\n    ExpressionKind[ExpressionKind[\"HtmlLiteral\"] = 51] = \"HtmlLiteral\";\n    ExpressionKind[ExpressionKind[\"ArrayBindingPattern\"] = 65556] = \"ArrayBindingPattern\";\n    ExpressionKind[ExpressionKind[\"ObjectBindingPattern\"] = 65557] = \"ObjectBindingPattern\";\n    ExpressionKind[ExpressionKind[\"BindingIdentifier\"] = 65558] = \"BindingIdentifier\";\n    ExpressionKind[ExpressionKind[\"ForOfStatement\"] = 6199] = \"ForOfStatement\";\n    ExpressionKind[ExpressionKind[\"Interpolation\"] = 24] = \"Interpolation\"; //\n})(ExpressionKind || (ExpressionKind = {}));\n//# sourceMappingURL=flags.js.map","import { __decorate, __param } from \"tslib\";\nimport { DI, Registration, } from '@aurelia/kernel';\nexport var ViewModelKind;\n(function (ViewModelKind) {\n    ViewModelKind[ViewModelKind[\"customElement\"] = 0] = \"customElement\";\n    ViewModelKind[ViewModelKind[\"customAttribute\"] = 1] = \"customAttribute\";\n    ViewModelKind[ViewModelKind[\"synthetic\"] = 2] = \"synthetic\";\n})(ViewModelKind || (ViewModelKind = {}));\nexport const IController = DI.createInterface('IController').noDefault();\n/**\n * Describing characteristics of a mounting operation a controller will perform\n */\nexport var MountStrategy;\n(function (MountStrategy) {\n    MountStrategy[MountStrategy[\"insertBefore\"] = 1] = \"insertBefore\";\n    MountStrategy[MountStrategy[\"append\"] = 2] = \"append\";\n})(MountStrategy || (MountStrategy = {}));\nexport const IViewFactory = DI.createInterface('IViewFactory').noDefault();\nexport const ILifecycle = DI.createInterface('ILifecycle').withDefault(x => x.singleton(Lifecycle));\nlet BoundQueue = class BoundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevBound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextBound = controller; // implied by boundHead not being undefined\n        }\n        this.tail = controller;\n        controller.state |= 65536 /* inBoundQueue */;\n    }\n    remove(controller) {\n        if (controller.prevBound !== void 0) {\n            controller.prevBound.nextBound = controller.nextBound;\n        }\n        if (controller.nextBound !== void 0) {\n            controller.nextBound.prevBound = controller.prevBound;\n        }\n        controller.prevBound = void 0;\n        controller.nextBound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevBound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextBound;\n        }\n        controller.state = (controller.state | 65536 /* inBoundQueue */) ^ 65536 /* inBoundQueue */;\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.state = (cur.state | 65536 /* inBoundQueue */) ^ 65536 /* inBoundQueue */;\n                cur.bound(flags);\n                next = cur.nextBound;\n                cur.nextBound = void 0;\n                cur.prevBound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nBoundQueue = __decorate([\n    __param(0, ILifecycle)\n], BoundQueue);\nexport { BoundQueue };\nlet UnboundQueue = class UnboundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnbound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnbound = controller; // implied by unboundHead not being undefined\n        }\n        this.tail = controller;\n        controller.state |= 131072 /* inUnboundQueue */;\n    }\n    remove(controller) {\n        if (controller.prevUnbound !== void 0) {\n            controller.prevUnbound.nextUnbound = controller.nextUnbound;\n        }\n        if (controller.nextUnbound !== void 0) {\n            controller.nextUnbound.prevUnbound = controller.prevUnbound;\n        }\n        controller.prevUnbound = void 0;\n        controller.nextUnbound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnbound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnbound;\n        }\n        controller.state = (controller.state | 131072 /* inUnboundQueue */) ^ 131072 /* inUnboundQueue */;\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.state = (cur.state | 131072 /* inUnboundQueue */) ^ 131072 /* inUnboundQueue */;\n                cur.unbound(flags);\n                next = cur.nextUnbound;\n                cur.nextUnbound = void 0;\n                cur.prevUnbound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnboundQueue = __decorate([\n    __param(0, ILifecycle)\n], UnboundQueue);\nexport { UnboundQueue };\nlet AttachedQueue = class AttachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.mount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevAttached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextAttached = controller; // implied by attachedHead not being undefined\n        }\n        this.tail = controller;\n        controller.state |= 262144 /* inAttachedQueue */;\n    }\n    remove(controller) {\n        if (controller.prevAttached !== void 0) {\n            controller.prevAttached.nextAttached = controller.nextAttached;\n        }\n        if (controller.nextAttached !== void 0) {\n            controller.nextAttached.prevAttached = controller.prevAttached;\n        }\n        controller.prevAttached = void 0;\n        controller.nextAttached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevAttached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextAttached;\n        }\n        controller.state = (controller.state | 262144 /* inAttachedQueue */) ^ 262144 /* inAttachedQueue */;\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.state = (cur.state | 262144 /* inAttachedQueue */) ^ 262144 /* inAttachedQueue */;\n                cur.attached(flags);\n                next = cur.nextAttached;\n                cur.nextAttached = void 0;\n                cur.prevAttached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nAttachedQueue = __decorate([\n    __param(0, ILifecycle)\n], AttachedQueue);\nexport { AttachedQueue };\nlet DetachedQueue = class DetachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.unmount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevDetached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextDetached = controller; // implied by detachedHead not being undefined\n        }\n        this.tail = controller;\n        controller.state |= 524288 /* inDetachedQueue */;\n    }\n    remove(controller) {\n        if (controller.prevDetached !== void 0) {\n            controller.prevDetached.nextDetached = controller.nextDetached;\n        }\n        if (controller.nextDetached !== void 0) {\n            controller.nextDetached.prevDetached = controller.prevDetached;\n        }\n        controller.prevDetached = void 0;\n        controller.nextDetached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevDetached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextDetached;\n        }\n        controller.state = (controller.state | 524288 /* inDetachedQueue */) ^ 524288 /* inDetachedQueue */;\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.state = (cur.state | 524288 /* inDetachedQueue */) ^ 524288 /* inDetachedQueue */;\n                cur.detached(flags);\n                next = cur.nextDetached;\n                cur.nextDetached = void 0;\n                cur.prevDetached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nDetachedQueue = __decorate([\n    __param(0, ILifecycle)\n], DetachedQueue);\nexport { DetachedQueue };\nlet MountQueue = class MountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if ((controller.state & 2097152 /* inUnmountQueue */) > 0) {\n            this.lifecycle.unmount.remove(controller);\n            console.log(`in unmount queue during mountQueue.add, so removing`, this);\n            return;\n        }\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevMount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextMount = controller; // implied by mountHead not being undefined\n        }\n        this.tail = controller;\n        controller.state |= 1048576 /* inMountQueue */;\n    }\n    remove(controller) {\n        if (controller.prevMount !== void 0) {\n            controller.prevMount.nextMount = controller.nextMount;\n        }\n        if (controller.nextMount !== void 0) {\n            controller.nextMount.prevMount = controller.prevMount;\n        }\n        controller.prevMount = void 0;\n        controller.nextMount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevMount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextMount;\n        }\n        controller.state = (controller.state | 1048576 /* inMountQueue */) ^ 1048576 /* inMountQueue */;\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.state = (cur.state | 1048576 /* inMountQueue */) ^ 1048576 /* inMountQueue */;\n                ++i;\n                cur.mount(flags);\n                next = cur.nextMount;\n                cur.nextMount = void 0;\n                cur.prevMount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nMountQueue = __decorate([\n    __param(0, ILifecycle)\n], MountQueue);\nexport { MountQueue };\nlet UnmountQueue = class UnmountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if ((controller.state & 1048576 /* inMountQueue */) > 0) {\n            this.lifecycle.mount.remove(controller);\n            return;\n        }\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnmount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnmount = controller; // implied by unmountHead not being undefined\n        }\n        this.tail = controller;\n        controller.state |= 2097152 /* inUnmountQueue */;\n    }\n    remove(controller) {\n        if (controller.prevUnmount !== void 0) {\n            controller.prevUnmount.nextUnmount = controller.nextUnmount;\n        }\n        if (controller.nextUnmount !== void 0) {\n            controller.nextUnmount.prevUnmount = controller.prevUnmount;\n        }\n        controller.prevUnmount = void 0;\n        controller.nextUnmount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnmount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnmount;\n        }\n        controller.state = (controller.state | 2097152 /* inUnmountQueue */) ^ 2097152 /* inUnmountQueue */;\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.state = (cur.state | 2097152 /* inUnmountQueue */) ^ 2097152 /* inUnmountQueue */;\n                ++i;\n                cur.unmount(flags);\n                next = cur.nextUnmount;\n                cur.nextUnmount = void 0;\n                cur.prevUnmount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnmountQueue = __decorate([\n    __param(0, ILifecycle)\n], UnmountQueue);\nexport { UnmountQueue };\nlet BatchQueue = class BatchQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.queue = [];\n        this.depth = 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(requestor) {\n        this.queue.push(requestor);\n    }\n    remove(requestor) {\n        const index = this.queue.indexOf(requestor);\n        if (index > -1) {\n            this.queue.splice(index, 1);\n        }\n    }\n    process(flags) {\n        flags |= 512 /* fromBatch */;\n        while (this.queue.length > 0) {\n            const batch = this.queue.slice();\n            this.queue = [];\n            const { length } = batch;\n            for (let i = 0; i < length; ++i) {\n                batch[i].flushBatch(flags);\n            }\n        }\n    }\n};\nBatchQueue = __decorate([\n    __param(0, ILifecycle)\n], BatchQueue);\nexport { BatchQueue };\nexport class Lifecycle {\n    constructor() {\n        this.batch = new BatchQueue(this);\n        this.mount = new MountQueue(this);\n        this.unmount = new UnmountQueue(this);\n        this.bound = new BoundQueue(this);\n        this.unbound = new UnboundQueue(this);\n        this.attached = new AttachedQueue(this);\n        this.detached = new DetachedQueue(this);\n    }\n    static register(container) {\n        return Registration.singleton(ILifecycle, this).register(container);\n    }\n}\n//# sourceMappingURL=lifecycle.js.map","// TODO: add connect-queue (or something similar) back in when everything else is working, to improve startup time\nconst slice = Array.prototype.slice;\nconst slotNames = [];\nconst versionSlotNames = [];\nlet lastSlot = -1;\nfunction ensureEnoughSlotNames(currentSlot) {\n    if (currentSlot === lastSlot) {\n        lastSlot += 5;\n        const ii = slotNames.length = versionSlotNames.length = lastSlot + 1;\n        for (let i = currentSlot + 1; i < ii; ++i) {\n            slotNames[i] = `_observer${i}`;\n            versionSlotNames[i] = `_observerVersion${i}`;\n        }\n    }\n}\nensureEnoughSlotNames(-1);\n/** @internal */\nexport function addObserver(observer) {\n    // find the observer.\n    const observerSlots = this.observerSlots == null ? 0 : this.observerSlots;\n    let i = observerSlots;\n    while (i-- && this[slotNames[i]] !== observer)\n        ;\n    // if we are not already observing, put the observer in an open slot and subscribe.\n    if (i === -1) {\n        i = 0;\n        while (this[slotNames[i]]) {\n            i++;\n        }\n        this[slotNames[i]] = observer;\n        observer.subscribe(this);\n        observer[this.id] |= 16 /* updateTargetInstance */;\n        // increment the slot count.\n        if (i === observerSlots) {\n            this.observerSlots = i + 1;\n        }\n    }\n    // set the \"version\" when the observer was used.\n    if (this.version == null) {\n        this.version = 0;\n    }\n    this[versionSlotNames[i]] = this.version;\n    ensureEnoughSlotNames(i);\n}\n/** @internal */\nexport function observeProperty(flags, obj, propertyName) {\n    const observer = this.observerLocator.getObserver(flags, obj, propertyName);\n    /* Note: we need to cast here because we can indeed get an accessor instead of an observer,\n     *  in which case the call to observer.subscribe will throw. It's not very clean and we can solve this in 2 ways:\n     *  1. Fail earlier: only let the locator resolve observers from .getObserver, and throw if no branches are left (e.g. it would otherwise return an accessor)\n     *  2. Fail silently (without throwing): give all accessors a no-op subscribe method\n     *\n     * We'll probably want to implement some global configuration (like a \"strict\" toggle) so users can pick between enforced correctness vs. ease-of-use\n     */\n    this.addObserver(observer);\n}\n/** @internal */\nexport function unobserve(all) {\n    const slots = this.observerSlots;\n    let slotName;\n    let observer;\n    if (all === true) {\n        for (let i = 0; i < slots; ++i) {\n            slotName = slotNames[i];\n            observer = this[slotName];\n            if (observer != null) {\n                this[slotName] = void 0;\n                observer.unsubscribe(this);\n                observer[this.id] &= ~16 /* updateTargetInstance */;\n            }\n        }\n    }\n    else {\n        const version = this.version;\n        for (let i = 0; i < slots; ++i) {\n            if (this[versionSlotNames[i]] !== version) {\n                slotName = slotNames[i];\n                observer = this[slotName];\n                if (observer != null) {\n                    this[slotName] = void 0;\n                    observer.unsubscribe(this);\n                    observer[this.id] &= ~16 /* updateTargetInstance */;\n                }\n            }\n        }\n    }\n}\nfunction connectableDecorator(target) {\n    const proto = target.prototype;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'observeProperty'))\n        proto.observeProperty = observeProperty;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'unobserve'))\n        proto.unobserve = unobserve;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'addObserver'))\n        proto.addObserver = addObserver;\n    return target;\n}\nexport function connectable(target) {\n    return target == null ? connectableDecorator : connectableDecorator(target);\n}\nlet value = 0;\nconnectable.assignIdTo = (instance) => {\n    instance.id = ++value;\n};\n//# sourceMappingURL=connectable.js.map","import { __decorate } from \"tslib\";\nimport { Reporter, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nimport { ILifecycle } from '../lifecycle';\nimport { hasBind, hasUnbind, } from './ast';\nimport { connectable, } from './connectable';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\nlet PropertyBinding = class PropertyBinding {\n    constructor(sourceExpression, target, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.targetObserver = void 0;\n        this.persistentFlags = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags, this.$scope, this.locator, value, this.part);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if ((this.$state & 4 /* isBound */) === 0) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if ((flags & 16 /* updateTargetInstance */) > 0) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this, this.part);\n                this.unobserve(false);\n            }\n            return;\n        }\n        if ((flags & 32 /* updateSourceExpression */) > 0) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Force property binding to always be strict\n        flags |= 4 /* isStrictBindingStrategy */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            if (this.mode & fromView) {\n                targetObserver = this.targetObserver = this.observerLocator.getObserver(flags, this.target, this.targetProperty);\n            }\n            else {\n                targetObserver = this.targetObserver = this.observerLocator.getAccessor(flags, this.target, this.targetProperty);\n            }\n        }\n        if (this.mode !== BindingMode.oneTime && targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver.subscribe(this);\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this);\n        }\n        this.$scope = void 0;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nPropertyBinding = __decorate([\n    connectable()\n], PropertyBinding);\nexport { PropertyBinding };\n//# sourceMappingURL=property-binding.js.map\n","import { hasBind, hasUnbind, } from './ast';\nexport class CallBinding {\n    constructor(sourceExpression, target, targetProperty, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.locator = locator;\n        this.$state = 0 /* none */;\n        this.targetObserver = observerLocator.getObserver(0 /* none */, target, targetProperty);\n    }\n    callSource(args) {\n        const overrideContext = this.$scope.overrideContext;\n        Object.assign(overrideContext, args);\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        for (const prop in args) {\n            Reflect.deleteProperty(overrideContext, prop);\n        }\n        return result;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this);\n        }\n        this.targetObserver.setValue(($args) => this.callSource($args), flags);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this);\n        }\n        this.$scope = void 0;\n        this.targetObserver.setValue(null, flags);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=call-binding.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nimport { AccessMemberExpression, AccessScopeExpression, CallMemberExpression, CallScopeExpression, PrimitiveLiteralExpression, } from './ast';\nexport const IExpressionParser = DI.createInterface('IExpressionParser').withDefault(x => x.singleton(ExpressionParser));\n/** @internal */\nexport class ExpressionParser {\n    constructor() {\n        this.expressionLookup = Object.create(null);\n        this.forOfLookup = Object.create(null);\n        this.interpolationLookup = Object.create(null);\n    }\n    parse(expression, bindingType) {\n        switch (bindingType) {\n            case 2048 /* Interpolation */: {\n                let found = this.interpolationLookup[expression];\n                if (found === void 0) {\n                    found = this.interpolationLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            case 539 /* ForCommand */: {\n                let found = this.forOfLookup[expression];\n                if (found === void 0) {\n                    found = this.forOfLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            default: {\n                // Allow empty strings for normal bindings and those that are empty by default (such as a custom attribute without an equals sign)\n                // But don't cache it, because empty strings are always invalid for any other type of binding\n                if (expression.length === 0 && (bindingType & (53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */))) {\n                    return PrimitiveLiteralExpression.$empty;\n                }\n                let found = this.expressionLookup[expression];\n                if (found === void 0) {\n                    found = this.expressionLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n        }\n    }\n    cache(expressions) {\n        const { forOfLookup, expressionLookup, interpolationLookup } = this;\n        for (const expression in expressions) {\n            const expr = expressions[expression];\n            switch (expr.$kind) {\n                case 24 /* Interpolation */:\n                    interpolationLookup[expression] = expr;\n                    break;\n                case 6199 /* ForOfStatement */:\n                    forOfLookup[expression] = expr;\n                    break;\n                default:\n                    expressionLookup[expression] = expr;\n            }\n        }\n    }\n    parseCore(expression, bindingType) {\n        try {\n            const parts = expression.split('.');\n            const firstPart = parts[0];\n            let current;\n            if (firstPart.endsWith('()')) {\n                current = new CallScopeExpression(firstPart.replace('()', ''), PLATFORM.emptyArray);\n            }\n            else {\n                current = new AccessScopeExpression(parts[0]);\n            }\n            let index = 1;\n            while (index < parts.length) {\n                const currentPart = parts[index];\n                if (currentPart.endsWith('()')) {\n                    current = new CallMemberExpression(current, currentPart.replace('()', ''), PLATFORM.emptyArray);\n                }\n                else {\n                    current = new AccessMemberExpression(current, parts[index]);\n                }\n                index++;\n            }\n            return current;\n        }\n        catch (e) {\n            throw Reporter.error(3, e);\n        }\n    }\n}\n/* eslint-disable @typescript-eslint/indent */\nexport var BindingType;\n(function (BindingType) {\n    BindingType[BindingType[\"None\"] = 0] = \"None\";\n    BindingType[BindingType[\"IgnoreCustomAttr\"] = 4096] = \"IgnoreCustomAttr\";\n    BindingType[BindingType[\"Interpolation\"] = 2048] = \"Interpolation\";\n    BindingType[BindingType[\"IsRef\"] = 5376] = \"IsRef\";\n    BindingType[BindingType[\"IsIterator\"] = 512] = \"IsIterator\";\n    BindingType[BindingType[\"IsCustom\"] = 256] = \"IsCustom\";\n    BindingType[BindingType[\"IsFunction\"] = 128] = \"IsFunction\";\n    BindingType[BindingType[\"IsEvent\"] = 64] = \"IsEvent\";\n    BindingType[BindingType[\"IsProperty\"] = 32] = \"IsProperty\";\n    BindingType[BindingType[\"IsCommand\"] = 16] = \"IsCommand\";\n    BindingType[BindingType[\"IsPropertyCommand\"] = 48] = \"IsPropertyCommand\";\n    BindingType[BindingType[\"IsEventCommand\"] = 80] = \"IsEventCommand\";\n    BindingType[BindingType[\"DelegationStrategyDelta\"] = 6] = \"DelegationStrategyDelta\";\n    BindingType[BindingType[\"Command\"] = 15] = \"Command\";\n    BindingType[BindingType[\"OneTimeCommand\"] = 49] = \"OneTimeCommand\";\n    BindingType[BindingType[\"ToViewCommand\"] = 50] = \"ToViewCommand\";\n    BindingType[BindingType[\"FromViewCommand\"] = 51] = \"FromViewCommand\";\n    BindingType[BindingType[\"TwoWayCommand\"] = 52] = \"TwoWayCommand\";\n    BindingType[BindingType[\"BindCommand\"] = 53] = \"BindCommand\";\n    BindingType[BindingType[\"TriggerCommand\"] = 4182] = \"TriggerCommand\";\n    BindingType[BindingType[\"CaptureCommand\"] = 4183] = \"CaptureCommand\";\n    BindingType[BindingType[\"DelegateCommand\"] = 4184] = \"DelegateCommand\";\n    BindingType[BindingType[\"CallCommand\"] = 153] = \"CallCommand\";\n    BindingType[BindingType[\"OptionsCommand\"] = 26] = \"OptionsCommand\";\n    BindingType[BindingType[\"ForCommand\"] = 539] = \"ForCommand\";\n    BindingType[BindingType[\"CustomCommand\"] = 284] = \"CustomCommand\";\n})(BindingType || (BindingType = {}));\n/* eslint-enable @typescript-eslint/indent */\n//# sourceMappingURL=expression-parser.js.map","import { __decorate } from \"tslib\";\nimport { BindingMode, } from '../flags';\nimport { connectable, } from './connectable';\nconst { toView, oneTime } = BindingMode;\nexport class MultiInterpolationBinding {\n    constructor(observerLocator, interpolation, target, targetProperty, mode, locator) {\n        this.observerLocator = observerLocator;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.locator = locator;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        // Note: the child expressions of an Interpolation expression are full Aurelia expressions, meaning they may include\n        // value converters and binding behaviors.\n        // Each expression represents one ${interpolation}, and for each we create a child TextBinding unless there is only one,\n        // in which case the renderer will create the TextBinding directly\n        const expressions = interpolation.expressions;\n        const parts = this.parts = Array(expressions.length);\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            parts[i] = new InterpolationBinding(expressions[i], interpolation, target, targetProperty, mode, observerLocator, locator, i === 0);\n        }\n    }\n    ;\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].$bind(flags, scope, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        this.$scope = void 0;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].$unbind(flags);\n        }\n    }\n}\nlet InterpolationBinding = class InterpolationBinding {\n    constructor(sourceExpression, interpolation, target, targetProperty, mode, observerLocator, locator, isFirst) {\n        this.sourceExpression = sourceExpression;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.isFirst = isFirst;\n        this.$state = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.targetObserver = observerLocator.getAccessor(0 /* none */, target, targetProperty);\n    }\n    updateTarget(value, flags) {\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        const previousValue = this.targetObserver.getValue();\n        const newValue = this.interpolation.evaluate(flags, this.$scope, this.locator, this.part);\n        if (newValue !== previousValue) {\n            this.updateTarget(newValue, flags);\n        }\n        if ((this.mode & oneTime) === 0) {\n            this.version++;\n            this.sourceExpression.connect(flags, this.$scope, this, this.part);\n            this.unobserve(false);\n        }\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this);\n        }\n        if (this.mode !== BindingMode.oneTime && this.targetObserver.bind) {\n            this.targetObserver.bind(flags);\n        }\n        // since the interpolation already gets the whole value, we only need to let the first\n        // text binding do the update if there are multiple\n        if (this.isFirst) {\n            this.updateTarget(this.interpolation.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this);\n        }\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        this.$scope = void 0;\n        this.unobserve(true);\n    }\n};\nInterpolationBinding = __decorate([\n    connectable()\n], InterpolationBinding);\nexport { InterpolationBinding };\n//# sourceMappingURL=interpolation-binding.js.map","import { __decorate } from \"tslib\";\nimport { Reporter, } from '@aurelia/kernel';\nimport { ILifecycle, } from '../lifecycle';\nimport { connectable, } from './connectable';\nlet LetBinding = class LetBinding {\n    constructor(sourceExpression, targetProperty, observerLocator, locator, toBindingContext = false) {\n        this.sourceExpression = sourceExpression;\n        this.targetProperty = targetProperty;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.toBindingContext = toBindingContext;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.target = null;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const { target, targetProperty } = this;\n            const previousValue = target[targetProperty];\n            const newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            if (newValue !== previousValue) {\n                target[targetProperty] = newValue;\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        this.target = (this.toBindingContext ? scope.bindingContext : scope.overrideContext);\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this);\n        }\n        // sourceExpression might have been changed during bind\n        this.target[this.targetProperty] = this.sourceExpression.evaluate(flags | 4096 /* fromBind */, scope, this.locator, part);\n        this.sourceExpression.connect(flags, scope, this, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this);\n        }\n        this.$scope = void 0;\n        this.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nLetBinding = __decorate([\n    connectable()\n], LetBinding);\nexport { LetBinding };\n//# sourceMappingURL=let-binding.js.map","import { hasBind, hasUnbind, } from './ast';\nexport class RefBinding {\n    constructor(sourceExpression, target, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.locator = locator;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this);\n        }\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, this.target, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        let sourceExpression = this.sourceExpression;\n        if (sourceExpression.evaluate(flags, this.$scope, this.locator, this.part) === this.target) {\n            sourceExpression.assign(flags, this.$scope, this.locator, null, this.part);\n        }\n        // source expression might have been modified durring assign, via a BB\n        sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this);\n        }\n        this.$scope = void 0;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=ref-binding.js.map","/** @internal */\nexport var SubscriberFlags;\n(function (SubscriberFlags) {\n    SubscriberFlags[SubscriberFlags[\"None\"] = 0] = \"None\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber0\"] = 1] = \"Subscriber0\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber1\"] = 2] = \"Subscriber1\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber2\"] = 4] = \"Subscriber2\";\n    SubscriberFlags[SubscriberFlags[\"SubscribersRest\"] = 8] = \"SubscribersRest\";\n    SubscriberFlags[SubscriberFlags[\"Any\"] = 15] = \"Any\";\n})(SubscriberFlags || (SubscriberFlags = {}));\nexport var DelegationStrategy;\n(function (DelegationStrategy) {\n    DelegationStrategy[DelegationStrategy[\"none\"] = 0] = \"none\";\n    DelegationStrategy[DelegationStrategy[\"capturing\"] = 1] = \"capturing\";\n    DelegationStrategy[DelegationStrategy[\"bubbling\"] = 2] = \"bubbling\";\n})(DelegationStrategy || (DelegationStrategy = {}));\nexport var CollectionKind;\n(function (CollectionKind) {\n    CollectionKind[CollectionKind[\"indexed\"] = 8] = \"indexed\";\n    CollectionKind[CollectionKind[\"keyed\"] = 4] = \"keyed\";\n    CollectionKind[CollectionKind[\"array\"] = 9] = \"array\";\n    CollectionKind[CollectionKind[\"map\"] = 6] = \"map\";\n    CollectionKind[CollectionKind[\"set\"] = 7] = \"set\";\n})(CollectionKind || (CollectionKind = {}));\nexport function copyIndexMap(existing, deletedItems) {\n    const { length } = existing;\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = existing[i];\n        ++i;\n    }\n    if (deletedItems !== void 0) {\n        arr.deletedItems = deletedItems.slice(0);\n    }\n    else if (existing.deletedItems !== void 0) {\n        arr.deletedItems = existing.deletedItems.slice(0);\n    }\n    else {\n        arr.deletedItems = [];\n    }\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function createIndexMap(length = 0) {\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = i++;\n    }\n    arr.deletedItems = [];\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function cloneIndexMap(indexMap) {\n    const clone = indexMap.slice();\n    clone.deletedItems = indexMap.deletedItems.slice();\n    clone.isIndexMap = true;\n    return clone;\n}\nexport function isIndexMap(value) {\n    return value instanceof Array && value.isIndexMap === true;\n}\n//# sourceMappingURL=observation.js.map","import { __decorate } from \"tslib\";\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionLengthObserver = class CollectionLengthObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.length;\n    }\n    getValue() {\n        return this.obj.length;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionLengthObserver = __decorate([\n    subscriberCollection()\n], CollectionLengthObserver);\nexport { CollectionLengthObserver };\n//# sourceMappingURL=collection-length-observer.js.map","import { __decorate } from \"tslib\";\nimport { createIndexMap } from '../observation';\nimport { CollectionLengthObserver } from './collection-length-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\n// https://tc39.github.io/ecma262/#sec-sortcompare\nfunction sortCompare(x, y) {\n    if (x === y) {\n        return 0;\n    }\n    x = x === null ? 'null' : x.toString();\n    y = y === null ? 'null' : y.toString();\n    return x < y ? -1 : 1;\n}\nfunction preSortCompare(x, y) {\n    if (x === void 0) {\n        if (y === void 0) {\n            return 0;\n        }\n        else {\n            return 1;\n        }\n    }\n    if (y === void 0) {\n        return -1;\n    }\n    return 0;\n}\nfunction insertionSort(arr, indexMap, from, to, compareFn) {\n    let velement, ielement, vtmp, itmp, order;\n    let i, j;\n    for (i = from + 1; i < to; i++) {\n        velement = arr[i];\n        ielement = indexMap[i];\n        for (j = i - 1; j >= from; j--) {\n            vtmp = arr[j];\n            itmp = indexMap[j];\n            order = compareFn(vtmp, velement);\n            if (order > 0) {\n                arr[j + 1] = vtmp;\n                indexMap[j + 1] = itmp;\n            }\n            else {\n                break;\n            }\n        }\n        arr[j + 1] = velement;\n        indexMap[j + 1] = ielement;\n    }\n}\nfunction quickSort(arr, indexMap, from, to, compareFn) {\n    let thirdIndex = 0, i = 0;\n    let v0, v1, v2;\n    let i0, i1, i2;\n    let c01, c02, c12;\n    let vtmp, itmp;\n    let vpivot, ipivot, lowEnd, highStart;\n    let velement, ielement, order, vtopElement;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        if (to - from <= 10) {\n            insertionSort(arr, indexMap, from, to, compareFn);\n            return;\n        }\n        thirdIndex = from + ((to - from) >> 1);\n        v0 = arr[from];\n        i0 = indexMap[from];\n        v1 = arr[to - 1];\n        i1 = indexMap[to - 1];\n        v2 = arr[thirdIndex];\n        i2 = indexMap[thirdIndex];\n        c01 = compareFn(v0, v1);\n        if (c01 > 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v1;\n            i0 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        c02 = compareFn(v0, v2);\n        if (c02 >= 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v2;\n            i0 = i2;\n            v2 = v1;\n            i2 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        else {\n            c12 = compareFn(v1, v2);\n            if (c12 > 0) {\n                vtmp = v1;\n                itmp = i1;\n                v1 = v2;\n                i1 = i2;\n                v2 = vtmp;\n                i2 = itmp;\n            }\n        }\n        arr[from] = v0;\n        indexMap[from] = i0;\n        arr[to - 1] = v2;\n        indexMap[to - 1] = i2;\n        vpivot = v1;\n        ipivot = i1;\n        lowEnd = from + 1;\n        highStart = to - 1;\n        arr[thirdIndex] = arr[lowEnd];\n        indexMap[thirdIndex] = indexMap[lowEnd];\n        arr[lowEnd] = vpivot;\n        indexMap[lowEnd] = ipivot;\n        partition: for (i = lowEnd + 1; i < highStart; i++) {\n            velement = arr[i];\n            ielement = indexMap[i];\n            order = compareFn(velement, vpivot);\n            if (order < 0) {\n                arr[i] = arr[lowEnd];\n                indexMap[i] = indexMap[lowEnd];\n                arr[lowEnd] = velement;\n                indexMap[lowEnd] = ielement;\n                lowEnd++;\n            }\n            else if (order > 0) {\n                do {\n                    highStart--;\n                    // eslint-disable-next-line eqeqeq\n                    if (highStart == i) {\n                        break partition;\n                    }\n                    vtopElement = arr[highStart];\n                    order = compareFn(vtopElement, vpivot);\n                } while (order > 0);\n                arr[i] = arr[highStart];\n                indexMap[i] = indexMap[highStart];\n                arr[highStart] = velement;\n                indexMap[highStart] = ielement;\n                if (order < 0) {\n                    velement = arr[i];\n                    ielement = indexMap[i];\n                    arr[i] = arr[lowEnd];\n                    indexMap[i] = indexMap[lowEnd];\n                    arr[lowEnd] = velement;\n                    indexMap[lowEnd] = ielement;\n                    lowEnd++;\n                }\n            }\n        }\n        if (to - highStart < lowEnd - from) {\n            quickSort(arr, indexMap, highStart, to, compareFn);\n            to = lowEnd;\n        }\n        else {\n            quickSort(arr, indexMap, from, lowEnd, compareFn);\n            from = highStart;\n        }\n    }\n}\nconst proto = Array.prototype;\nconst $push = proto.push;\nconst $unshift = proto.unshift;\nconst $pop = proto.pop;\nconst $shift = proto.shift;\nconst $splice = proto.splice;\nconst $reverse = proto.reverse;\nconst $sort = proto.sort;\nconst native = { push: $push, unshift: $unshift, pop: $pop, shift: $shift, splice: $splice, reverse: $reverse, sort: $sort };\nconst methods = ['push', 'unshift', 'pop', 'shift', 'splice', 'reverse', 'sort'];\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-array.prototype.push\n    push: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === void 0) {\n            return $push.apply($this, args);\n        }\n        const len = $this.length;\n        const argCount = args.length;\n        if (argCount === 0) {\n            return len;\n        }\n        $this.length = o.indexMap.length = len + argCount;\n        let i = len;\n        while (i < $this.length) {\n            $this[i] = args[i - len];\n            o.indexMap[i] = -2;\n            i++;\n        }\n        o.notify();\n        return $this.length;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.unshift\n    unshift: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === void 0) {\n            return $unshift.apply($this, args);\n        }\n        const argCount = args.length;\n        const inserts = new Array(argCount);\n        let i = 0;\n        while (i < argCount) {\n            inserts[i++] = -2;\n        }\n        $unshift.apply(o.indexMap, inserts);\n        const len = $unshift.apply($this, args);\n        o.notify();\n        return len;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.pop\n    pop: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === void 0) {\n            return $pop.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $pop.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        const index = indexMap.length - 1;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        $pop.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.shift\n    shift: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === void 0) {\n            return $shift.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $shift.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        if (indexMap[0] > -1) {\n            indexMap.deletedItems.push(indexMap[0]);\n        }\n        $shift.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.splice\n    splice: function (...args) {\n        const start = args[0];\n        const deleteCount = args[1];\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === void 0) {\n            return $splice.apply($this, args);\n        }\n        const len = this.length;\n        const relativeStart = start | 0;\n        const actualStart = relativeStart < 0 ? Math.max((len + relativeStart), 0) : Math.min(relativeStart, len);\n        const indexMap = o.indexMap;\n        const argCount = args.length;\n        const actualDeleteCount = argCount === 0 ? 0 : argCount === 1 ? len - actualStart : deleteCount;\n        if (actualDeleteCount > 0) {\n            let i = actualStart;\n            const to = i + actualDeleteCount;\n            while (i < to) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n        }\n        if (argCount > 2) {\n            const itemCount = argCount - 2;\n            const inserts = new Array(itemCount);\n            let i = 0;\n            while (i < itemCount) {\n                inserts[i++] = -2;\n            }\n            $splice.call(indexMap, start, deleteCount, ...inserts);\n        }\n        else {\n            $splice.apply(indexMap, args);\n        }\n        const deleted = $splice.apply($this, args);\n        o.notify();\n        return deleted;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.reverse\n    reverse: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === void 0) {\n            $reverse.call($this);\n            return this;\n        }\n        const len = $this.length;\n        const middle = (len / 2) | 0;\n        let lower = 0;\n        while (lower !== middle) {\n            const upper = len - lower - 1;\n            const lowerValue = $this[lower];\n            const lowerIndex = o.indexMap[lower];\n            const upperValue = $this[upper];\n            const upperIndex = o.indexMap[upper];\n            $this[lower] = upperValue;\n            o.indexMap[lower] = upperIndex;\n            $this[upper] = lowerValue;\n            o.indexMap[upper] = lowerIndex;\n            lower++;\n        }\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.sort\n    // https://github.com/v8/v8/blob/master/src/js/array.js\n    sort: function (compareFn) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === void 0) {\n            $sort.call($this, compareFn);\n            return this;\n        }\n        const len = $this.length;\n        if (len < 2) {\n            return this;\n        }\n        quickSort($this, o.indexMap, 0, len, preSortCompare);\n        let i = 0;\n        while (i < len) {\n            if ($this[i] === void 0) {\n                break;\n            }\n            i++;\n        }\n        if (compareFn === void 0 || typeof compareFn !== 'function' /* spec says throw a TypeError, should we do that too? */) {\n            compareFn = sortCompare;\n        }\n        quickSort($this, o.indexMap, 0, i, compareFn);\n        o.notify();\n        return this;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableArrayObservationCalled = false;\nexport function enableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nlet ArrayObserver = class ArrayObserver {\n    constructor(flags, lifecycle, array) {\n        if (!enableArrayObservationCalled) {\n            enableArrayObservationCalled = true;\n            enableArrayObservation();\n        }\n        this.inBatch = false;\n        this.collection = array;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(array.length);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        Reflect.defineProperty(array, '$observer', {\n            value: this,\n            enumerable: false,\n            writable: true,\n            configurable: true,\n        });\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionLengthObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const indexMap = this.indexMap;\n        const length = this.collection.length;\n        this.indexMap = createIndexMap(length);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(length, 16 /* updateTargetInstance */);\n        }\n    }\n};\nArrayObserver = __decorate([\n    collectionSubscriberCollection()\n], ArrayObserver);\nexport { ArrayObserver };\nexport function getArrayObserver(flags, lifecycle, array) {\n    if (array.$observer === void 0) {\n        array.$observer = new ArrayObserver(flags, lifecycle, array);\n    }\n    return array.$observer;\n}\n/**\n * Applies offsets to the non-negative indices in the IndexMap\n * based on added and deleted items relative to those indices.\n *\n * e.g. turn `[-2, 0, 1]` into `[-2, 1, 2]`, allowing the values at the indices to be\n * used for sorting/reordering items if needed\n */\nexport function applyMutationsToIndices(indexMap) {\n    let offset = 0;\n    let j = 0;\n    const len = indexMap.length;\n    for (let i = 0; i < len; ++i) {\n        while (indexMap.deletedItems[j] <= i - offset) {\n            ++j;\n            --offset;\n        }\n        if (indexMap[i] === -2) {\n            ++offset;\n        }\n        else {\n            indexMap[i] += offset;\n        }\n    }\n}\n/**\n * After `applyMutationsToIndices`, this function can be used to reorder items in a derived\n * array (e.g.  the items in the `views` in the repeater are derived from the `items` property)\n */\nexport function synchronizeIndices(items, indexMap) {\n    const copy = items.slice();\n    const len = indexMap.length;\n    let to = 0;\n    let from = 0;\n    while (to < len) {\n        from = indexMap[to];\n        if (from !== -2) {\n            items[to] = copy[from];\n        }\n        ++to;\n    }\n}\n//# sourceMappingURL=array-observer.js.map","import { __decorate } from \"tslib\";\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionSizeObserver = class CollectionSizeObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.size;\n    }\n    getValue() {\n        return this.obj.size;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionSizeObserver = __decorate([\n    subscriberCollection()\n], CollectionSizeObserver);\nexport { CollectionSizeObserver };\n//# sourceMappingURL=collection-size-observer.js.map","import { __decorate } from \"tslib\";\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst proto = Map.prototype;\nconst $set = proto.set;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { set: $set, clear: $clear, delete: $delete };\nconst methods = ['set', 'clear', 'delete'];\n// note: we can't really do much with Map due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, map/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-map.prototype.map\n    set: function (key, value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === undefined) {\n            $set.call($this, key, value);\n            return this;\n        }\n        const oldValue = $this.get(key);\n        const oldSize = $this.size;\n        $set.call($this, key, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            let i = 0;\n            for (const entry of $this.entries()) {\n                if (entry[0] === key) {\n                    if (entry[1] !== oldValue) {\n                        o.indexMap.deletedItems.push(o.indexMap[i]);\n                        o.indexMap[i] = -2;\n                        o.notify();\n                    }\n                    return this;\n                }\n                i++;\n            }\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            ++i;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableMapObservationCalled = false;\nexport function enableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet MapObserver = class MapObserver {\n    constructor(flags, lifecycle, map) {\n        if (!enableMapObservationCalled) {\n            enableMapObservationCalled = true;\n            enableMapObservation();\n        }\n        this.inBatch = false;\n        this.collection = map;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(map.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        map.$observer = this;\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nMapObserver = __decorate([\n    collectionSubscriberCollection()\n], MapObserver);\nexport { MapObserver };\nexport function getMapObserver(flags, lifecycle, map) {\n    if (map.$observer === void 0) {\n        map.$observer = new MapObserver(flags, lifecycle, map);\n    }\n    return map.$observer;\n}\n//# sourceMappingURL=map-observer.js.map","import { __decorate } from \"tslib\";\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst proto = Set.prototype;\nconst $add = proto.add;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { add: $add, clear: $clear, delete: $delete };\nconst methods = ['add', 'clear', 'delete'];\n// note: we can't really do much with Set due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, add/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-set.prototype.add\n    add: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === undefined) {\n            $add.call($this, value);\n            return this;\n        }\n        const oldSize = $this.size;\n        $add.call($this, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = $this.$observer;\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            i++;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableSetObservationCalled = false;\nexport function enableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet SetObserver = class SetObserver {\n    constructor(flags, lifecycle, observedSet) {\n        if (!enableSetObservationCalled) {\n            enableSetObservationCalled = true;\n            enableSetObservation();\n        }\n        this.inBatch = false;\n        this.collection = observedSet;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(observedSet.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observedSet.$observer = this;\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nSetObserver = __decorate([\n    collectionSubscriberCollection()\n], SetObserver);\nexport { SetObserver };\nexport function getSetObserver(flags, lifecycle, observedSet) {\n    if (observedSet.$observer === void 0) {\n        observedSet.$observer = new SetObserver(flags, lifecycle, observedSet);\n    }\n    return observedSet.$observer;\n}\n//# sourceMappingURL=set-observer.js.map","import { __decorate } from \"tslib\";\nimport { PLATFORM, Reporter } from '@aurelia/kernel';\nimport { subscriberCollection } from './subscriber-collection';\nexport function computed(config) {\n    return function (target, key) {\n        /**\n         * The 'computed' property defined on prototype needs to be non-enumerable to prevent getting this in loops,\n         * iterating over object properties, such as for..in.\n         *\n         * The 'value' of the property should not have any prototype. Otherwise if by mistake the target passed\n         * here is `Object`, then we are in soup. Because then every instance of `Object` will have the `computed`\n         * property, including the `value` (in the descriptor of the property), when assigned `{}`. This might\n         * lead to infinite recursion for the cases as mentioned above.\n         */\n        if (!target.computed) {\n            Reflect.defineProperty(target, 'computed', {\n                writable: true,\n                configurable: true,\n                enumerable: false,\n                value: Object.create(null)\n            });\n        }\n        target.computed[key] = config;\n    };\n}\nconst computedOverrideDefaults = { static: false, volatile: false };\n/* @internal */\nexport function createComputedObserver(flags, observerLocator, dirtyChecker, lifecycle, instance, propertyName, descriptor) {\n    if (descriptor.configurable === false) {\n        return dirtyChecker.createProperty(instance, propertyName);\n    }\n    if (descriptor.get) {\n        const { constructor: { prototype: { computed: givenOverrides } } } = instance;\n        const overrides = givenOverrides && givenOverrides[propertyName] || computedOverrideDefaults;\n        if (descriptor.set) {\n            if (overrides.volatile) {\n                return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n            }\n            return new CustomSetterObserver(instance, propertyName, descriptor);\n        }\n        return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n    }\n    throw Reporter.error(18, propertyName);\n}\n// Used when the getter is dependent solely on changes that happen within the setter.\nlet CustomSetterObserver = class CustomSetterObserver {\n    constructor(obj, propertyKey, descriptor) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.observing = false;\n    }\n    setValue(newValue) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.descriptor.set.call(this.obj, newValue); // Non-null is implied because descriptors without setters won't end up here\n        if (this.currentValue !== newValue) {\n            this.oldValue = this.currentValue;\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, this.oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.observing) {\n            this.convertProperty();\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n    }\n    convertProperty() {\n        this.observing = true;\n        this.currentValue = this.obj[this.propertyKey];\n        const set = (newValue) => { this.setValue(newValue); };\n        Reflect.defineProperty(this.obj, this.propertyKey, { set, get: this.descriptor.get });\n    }\n};\nCustomSetterObserver = __decorate([\n    subscriberCollection()\n], CustomSetterObserver);\nexport { CustomSetterObserver };\n// Used when there is no setter, and the getter is dependent on other properties of the object;\n// Used when there is a setter but the value of the getter can change based on properties set outside of the setter.\nlet GetterObserver = class GetterObserver {\n    constructor(flags, overrides, obj, propertyKey, descriptor, observerLocator) {\n        this.overrides = overrides;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.propertyDeps = [];\n        this.collectionDeps = [];\n        this.subscriberCount = 0;\n        this.isCollecting = false;\n        this.proxy = new Proxy(obj, createGetterTraps(flags, observerLocator, this));\n        const get = () => this.getValue();\n        Reflect.defineProperty(obj, propertyKey, { get, set: descriptor.set });\n    }\n    addPropertyDep(subscribable) {\n        if (!this.propertyDeps.includes(subscribable)) {\n            this.propertyDeps.push(subscribable);\n        }\n    }\n    addCollectionDep(subscribable) {\n        if (!this.collectionDeps.includes(subscribable)) {\n            this.collectionDeps.push(subscribable);\n        }\n    }\n    getValue() {\n        if (this.subscriberCount === 0 || this.isCollecting) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.proxy, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.obj, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        return this.currentValue;\n    }\n    subscribe(subscriber) {\n        this.addSubscriber(subscriber);\n        if (++this.subscriberCount === 1) {\n            this.getValueAndCollectDependencies(true);\n        }\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (--this.subscriberCount === 0) {\n            this.unsubscribeAllDependencies();\n        }\n    }\n    handleChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    handleCollectionChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    getValueAndCollectDependencies(requireCollect) {\n        const dynamicDependencies = !this.overrides.static || requireCollect;\n        if (dynamicDependencies) {\n            this.unsubscribeAllDependencies();\n            this.isCollecting = true;\n        }\n        this.currentValue = this.getValue();\n        if (dynamicDependencies) {\n            this.propertyDeps.forEach(x => { x.subscribe(this); });\n            this.collectionDeps.forEach(x => { x.subscribeToCollection(this); });\n            this.isCollecting = false;\n        }\n        return this.currentValue;\n    }\n    doNotCollect(key) {\n        return !this.isCollecting || key === '$observers';\n    }\n    unsubscribeAllDependencies() {\n        this.propertyDeps.forEach(x => { x.unsubscribe(this); });\n        this.propertyDeps.length = 0;\n        this.collectionDeps.forEach(x => { x.unsubscribeFromCollection(this); });\n        this.collectionDeps.length = 0;\n    }\n};\nGetterObserver = __decorate([\n    subscriberCollection()\n], GetterObserver);\nexport { GetterObserver };\nconst toStringTag = Object.prototype.toString;\nfunction createGetterTraps(flags, observerLocator, observer) {\n    const traps = {\n        get: function (target, key, receiver) {\n            if (observer.doNotCollect(key)) {\n                return Reflect.get(target, key, receiver);\n            }\n            // The length and iterator properties need to be invoked on the original object (for Map and Set\n            // at least) or they will throw.\n            switch (toStringTag.call(target)) {\n                case '[object Array]':\n                    observer.addCollectionDep(observerLocator.getArrayObserver(flags, target));\n                    if (key === 'length') {\n                        return Reflect.get(target, key, target);\n                    }\n                case '[object Map]':\n                    observer.addCollectionDep(observerLocator.getMapObserver(flags, target));\n                    if (key === 'size') {\n                        return Reflect.get(target, key, target);\n                    }\n                case '[object Set]':\n                    observer.addCollectionDep(observerLocator.getSetObserver(flags, target));\n                    if (key === 'size') {\n                        return Reflect.get(target, key, target);\n                    }\n                default:\n                    observer.addPropertyDep(observerLocator.getObserver(flags, target, key));\n            }\n            return proxyOrValue(flags, target, key, observerLocator, observer);\n        }\n    };\n    return traps;\n}\nfunction proxyOrValue(flags, target, key, observerLocator, observer) {\n    const value = Reflect.get(target, key, target);\n    if (typeof value === 'function') {\n        // eslint-disable-next-line @typescript-eslint/ban-types\n        return target[key].bind(target); // We need Function's bind() method here\n    }\n    if (typeof value !== 'object' || value === null) {\n        return value;\n    }\n    return new Proxy(value, createGetterTraps(flags, observerLocator, observer));\n}\n//# sourceMappingURL=computed-observer.js.map","import { __decorate } from \"tslib\";\nimport { PLATFORM, DI, bound, Registration } from '@aurelia/kernel';\nconst defaultClockSettings = {\n    forceUpdateInterval: 10,\n    now: PLATFORM.now,\n};\nconst { enter, leave, trace, } = (function () {\n    const enabled = false;\n    let depth = 0;\n    function round(num) {\n        return ((num * 10 + .5) | 0) / 10;\n    }\n    function log(prefix, obj, method) {\n        if (obj instanceof TaskQueue) {\n            const processing = obj['processingSize'];\n            const pending = obj['pendingSize'];\n            const delayed = obj['delayedSize'];\n            const flushReq = obj['flushRequested'];\n            const prio = obj['priority'];\n            const info = `processing=${processing} pending=${pending} delayed=${delayed} flushReq=${flushReq} prio=${prio}`;\n            console.log(`${prefix}[Q.${method}] ${info}`);\n        }\n        else {\n            const id = obj['id'];\n            const created = round(obj['createdTime']);\n            const queue = round(obj['queueTime']);\n            const preempt = obj['preempt'];\n            const reusable = obj['reusable'];\n            const persistent = obj['persistent'];\n            const status = obj['_status'];\n            const info = `id=${id} created=${created} queue=${queue} preempt=${preempt} persistent=${persistent} reusable=${reusable} status=${status}`;\n            console.log(`${prefix}[T.${method}] ${info}`);\n        }\n    }\n    function $enter(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(depth++)}> `, obj, method);\n        }\n    }\n    function $leave(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(--depth)}< `, obj, method);\n        }\n    }\n    function $trace(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(depth)}- `, obj, method);\n        }\n    }\n    return {\n        enter: $enter,\n        leave: $leave,\n        trace: $trace,\n    };\n})();\nexport const IClock = DI.createInterface('IClock').withDefault(x => x.instance(globalClock));\nexport class Clock {\n    constructor(opts) {\n        const { now, forceUpdateInterval } = { ...defaultClockSettings, ...opts };\n        this.now = function (highRes = false) {\n            // if (++requests === forceUpdateInterval || highRes) {\n            //   requests = 0;\n            //   timestamp = now();\n            // }\n            // return timestamp;\n            return now();\n        };\n    }\n    static register(container) {\n        return Registration.singleton(IClock, this).register(container);\n    }\n}\nexport const globalClock = new Clock();\nexport var TaskQueuePriority;\n(function (TaskQueuePriority) {\n    TaskQueuePriority[TaskQueuePriority[\"microTask\"] = 0] = \"microTask\";\n    TaskQueuePriority[TaskQueuePriority[\"render\"] = 1] = \"render\";\n    TaskQueuePriority[TaskQueuePriority[\"macroTask\"] = 2] = \"macroTask\";\n    TaskQueuePriority[TaskQueuePriority[\"postRender\"] = 3] = \"postRender\";\n    TaskQueuePriority[TaskQueuePriority[\"idle\"] = 4] = \"idle\";\n})(TaskQueuePriority || (TaskQueuePriority = {}));\nexport const IScheduler = DI.createInterface('IScheduler').noDefault();\nconst createPromise = (function () {\n    let $resolve = void 0;\n    let $reject = void 0;\n    function executor(resolve, reject) {\n        $resolve = resolve;\n        $reject = reject;\n    }\n    return function () {\n        const p = new Promise(executor);\n        p.resolve = $resolve;\n        p.reject = $reject;\n        $resolve = void 0;\n        $reject = void 0;\n        return p;\n    };\n})();\nconst defaultQueueTaskOptions = {\n    delay: 0,\n    preempt: false,\n    priority: 1 /* render */,\n    persistent: false,\n    reusable: true,\n};\nexport class TaskQueue {\n    constructor({ clock, priority, scheduler }) {\n        this.processingSize = 0;\n        this.processingHead = void 0;\n        this.processingTail = void 0;\n        this.pendingSize = 0;\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.delayedSize = 0;\n        this.delayedHead = void 0;\n        this.delayedTail = void 0;\n        this.flushRequested = false;\n        this.yieldPromise = void 0;\n        this.taskPool = [];\n        this.taskPoolSize = 0;\n        this.lastRequest = 0;\n        this.microTaskRequestFlushTask = null;\n        this.priority = priority;\n        this.scheduler = scheduler;\n        this.clock = clock;\n    }\n    get isEmpty() {\n        return this.processingSize === 0 && this.pendingSize === 0 && this.delayedSize === 0;\n    }\n    flush() {\n        enter(this, 'flush');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.clock.now(true);\n        this.flushRequested = false;\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        while (this.processingSize > 0) {\n            this.processingHead.run();\n        }\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        if (this.processingSize > 0) {\n            this.requestFlush();\n        }\n        else if (this.delayedSize > 0) {\n            if (this.priority <= 0 /* microTask */) {\n                // MicroTasks are not clamped so we have to clamp them with setTimeout or they'll block forever\n                this.microTaskRequestFlushTask = this.scheduler.getTaskQueue(2 /* macroTask */).queueTask(this.requestFlush);\n            }\n            else {\n                // Otherwise just let this queue handle itself\n                this.requestFlush();\n            }\n        }\n        if (this.yieldPromise !== void 0) {\n            let noMoreFiniteWork = true;\n            let cur = this.processingHead;\n            while (cur !== void 0) {\n                if (!cur.persistent) {\n                    noMoreFiniteWork = false;\n                    break;\n                }\n                cur = cur.next;\n            }\n            if (noMoreFiniteWork) {\n                cur = this.pendingHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                cur = this.delayedHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                const p = this.yieldPromise;\n                this.yieldPromise = void 0;\n                p.resolve();\n            }\n        }\n        leave(this, 'flush');\n    }\n    cancel() {\n        enter(this, 'cancel');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.scheduler.cancelFlush(this);\n        this.flushRequested = false;\n        leave(this, 'cancel');\n    }\n    yield() {\n        enter(this, 'yield');\n        if (this.processingSize === 0 && this.pendingSize === 0 && this.delayedSize === 0) {\n            leave(this, 'yield empty');\n            return Promise.resolve();\n        }\n        if (this.yieldPromise === void 0) {\n            this.yieldPromise = createPromise();\n        }\n        leave(this, 'yield task');\n        return this.yieldPromise;\n    }\n    queueTask(callback, opts) {\n        enter(this, 'queueTask');\n        const { delay, preempt, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        if (preempt) {\n            if (delay > 0) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with a greater-than-zero delay`);\n            }\n            if (persistent) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with persistent`);\n            }\n        }\n        if (persistent && this.priority === 0 /* microTask */) {\n            throw new Error(`Invalid arguments: cannot queue persistent tasks on the micro task queue`);\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        const time = this.clock.now();\n        let task;\n        if (reusable) {\n            const taskPool = this.taskPool;\n            const index = this.taskPoolSize - 1;\n            if (index >= 0) {\n                task = taskPool[index];\n                taskPool[index] = (void 0);\n                this.taskPoolSize = index;\n                task.reuse(time, delay, preempt, persistent, callback);\n            }\n            else {\n                task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n            }\n        }\n        else {\n            task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n        }\n        if (preempt) {\n            if (this.processingSize++ === 0) {\n                this.processingHead = this.processingTail = task;\n            }\n            else {\n                this.processingTail = (task.prev = this.processingTail).next = task;\n            }\n        }\n        else if (delay === 0) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n            }\n        }\n        leave(this, 'queueTask');\n        return task;\n    }\n    take(task) {\n        enter(this, 'take');\n        if (task.status !== 'pending') {\n            leave(this, 'take error');\n            throw new Error('Can only take pending tasks.');\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        task.taskQueue.remove(task);\n        if (task.preempt) {\n            this.addToProcessing(task);\n        }\n        else if (task.queueTime <= this.clock.now()) {\n            this.addToPending(task);\n        }\n        else {\n            this.addToDelayed(task);\n        }\n        leave(this, 'take');\n    }\n    remove(task) {\n        enter(this, 'remove');\n        if (task.preempt) {\n            // Fast path - preempt task can only ever end up in the processing queue\n            this.removeFromProcessing(task);\n            leave(this, 'remove processing fast');\n            return;\n        }\n        if (task.queueTime > this.clock.now()) {\n            // Fast path - task with queueTime in the future can only ever be in the delayed queue\n            this.removeFromDelayed(task);\n            leave(this, 'remove delayed fast');\n            return;\n        }\n        // Scan everything (we can make this faster by using the queueTime property, but this is good enough for now)\n        let cur = this.processingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromProcessing(task);\n                leave(this, 'remove processing slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.pendingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromPending(task);\n                leave(this, 'remove pending slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.delayedHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromDelayed(task);\n                leave(this, 'remove delayed slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        leave(this, 'remove error');\n        throw new Error(`Task #${task.id} could not be found`);\n    }\n    returnToPool(task) {\n        trace(this, 'returnToPool');\n        this.taskPool[this.taskPoolSize++] = task;\n    }\n    resetPersistentTask(task) {\n        enter(this, 'resetPersistentTask');\n        task.reset(this.clock.now());\n        if (task.createdTime === task.queueTime) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n                task.next = void 0;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n                task.next = void 0;\n            }\n        }\n        leave(this, 'resetPersistentTask');\n    }\n    finish(task) {\n        enter(this, 'finish');\n        if (task.next !== void 0) {\n            task.next.prev = task.prev;\n        }\n        if (task.prev !== void 0) {\n            task.prev.next = task.next;\n        }\n        leave(this, 'finish');\n    }\n    removeFromProcessing(task) {\n        enter(this, 'removeFromProcessing');\n        if (this.processingHead === task) {\n            this.processingHead = task.next;\n        }\n        if (this.processingTail === task) {\n            this.processingTail = task.prev;\n        }\n        --this.processingSize;\n        this.finish(task);\n        leave(this, 'removeFromProcessing');\n    }\n    removeFromPending(task) {\n        enter(this, 'removeFromPending');\n        if (this.pendingHead === task) {\n            this.pendingHead = task.next;\n        }\n        if (this.pendingTail === task) {\n            this.pendingTail = task.prev;\n        }\n        --this.pendingSize;\n        this.finish(task);\n        leave(this, 'removeFromPending');\n    }\n    removeFromDelayed(task) {\n        enter(this, 'removeFromDelayed');\n        if (this.delayedHead === task) {\n            this.delayedHead = task.next;\n        }\n        if (this.delayedTail === task) {\n            this.delayedTail = task.prev;\n        }\n        --this.delayedSize;\n        this.finish(task);\n        leave(this, 'removeFromDelayed');\n    }\n    addToProcessing(task) {\n        enter(this, 'addToProcessing');\n        if (this.processingSize++ === 0) {\n            this.processingHead = this.processingTail = task;\n        }\n        else {\n            this.processingTail = (task.prev = this.processingTail).next = task;\n        }\n        leave(this, 'addToProcessing');\n    }\n    addToPending(task) {\n        enter(this, 'addToPending');\n        if (this.pendingSize++ === 0) {\n            this.pendingHead = this.pendingTail = task;\n        }\n        else {\n            this.pendingTail = (task.prev = this.pendingTail).next = task;\n        }\n        leave(this, 'addToPending');\n    }\n    addToDelayed(task) {\n        enter(this, 'addToDelayed');\n        if (this.delayedSize++ === 0) {\n            this.delayedHead = this.delayedTail = task;\n        }\n        else {\n            this.delayedTail = (task.prev = this.delayedTail).next = task;\n        }\n        leave(this, 'addToDelayed');\n    }\n    movePendingToProcessing() {\n        enter(this, 'movePendingToProcessing');\n        // Add the previously pending tasks to the currently processing tasks\n        if (this.processingSize === 0) {\n            this.processingHead = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize = this.pendingSize;\n        }\n        else {\n            this.processingTail.next = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize += this.pendingSize;\n        }\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.pendingSize = 0;\n        leave(this, 'movePendingToProcessing');\n    }\n    moveDelayedToProcessing() {\n        enter(this, 'moveDelayedToProcessing');\n        const time = this.clock.now(true);\n        // Add any delayed tasks whose delay have expired to the currently processing tasks\n        const delayedHead = this.delayedHead;\n        if (delayedHead.queueTime <= time) {\n            let delayedTail = delayedHead;\n            let next = delayedTail.next;\n            let count = 1;\n            while (next !== void 0 && next.queueTime <= time) {\n                delayedTail = next;\n                next = delayedTail.next;\n                ++count;\n            }\n            if (this.processingSize === 0) {\n                this.processingHead = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize = count;\n            }\n            else {\n                this.processingTail.next = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize += count;\n            }\n            this.delayedHead = next;\n            this.delayedSize -= count;\n            if (this.delayedSize === 0) {\n                this.delayedTail = void 0;\n            }\n        }\n        leave(this, 'moveDelayedToProcessing');\n    }\n    requestFlush() {\n        enter(this, 'requestFlush');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        if (!this.flushRequested) {\n            this.flushRequested = true;\n            this.lastRequest = this.clock.now(true);\n            this.scheduler.requestFlush(this);\n        }\n        leave(this, 'requestFlush');\n    }\n}\n__decorate([\n    bound\n], TaskQueue.prototype, \"requestFlush\", null);\nexport class TaskAbortError extends Error {\n    constructor(task) {\n        super('Task was canceled.');\n        this.task = task;\n    }\n}\nlet id = 0;\nexport class Task {\n    constructor(taskQueue, createdTime, queueTime, preempt, persistent, reusable, callback) {\n        this.taskQueue = taskQueue;\n        this.createdTime = createdTime;\n        this.queueTime = queueTime;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.reusable = reusable;\n        this.callback = callback;\n        this.id = ++id;\n        this.next = void 0;\n        this.prev = void 0;\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        this._status = 'pending';\n        trace(this, 'constructor');\n        this.priority = taskQueue.priority;\n    }\n    get result() {\n        const result = this._result;\n        if (result === void 0) {\n            switch (this._status) {\n                case 'pending': {\n                    const promise = this._result = createPromise();\n                    this.resolve = promise.resolve;\n                    this.reject = promise.reject;\n                    return promise;\n                }\n                case 'running':\n                    throw new Error('Trying to await task from within task will cause a deadlock.');\n                case 'completed':\n                    return this._result = Promise.resolve();\n                case 'canceled':\n                    return this._result = Promise.reject(new TaskAbortError(this));\n            }\n        }\n        return result;\n    }\n    get status() {\n        return this._status;\n    }\n    run() {\n        enter(this, 'run');\n        if (this._status !== 'pending') {\n            leave(this, 'run error');\n            throw new Error(`Cannot run task in ${this._status} state`);\n        }\n        // this.persistent could be changed while the task is running (this can only be done by the task itself if canceled, and is a valid way of stopping a loop)\n        // so we deliberately reference this.persistent instead of the local variable, but we keep it around to know whether the task *was* persistent before running it,\n        // so we can set the correct cancelation state.\n        const persistent = this.persistent;\n        const reusable = this.reusable;\n        const taskQueue = this.taskQueue;\n        const callback = this.callback;\n        const resolve = this.resolve;\n        const reject = this.reject;\n        const createdTime = this.createdTime;\n        taskQueue.remove(this);\n        this._status = 'running';\n        try {\n            const ret = callback(globalClock.now() - createdTime);\n            if (this.persistent) {\n                taskQueue.resetPersistentTask(this);\n            }\n            else if (persistent) {\n                // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n                this._status = 'canceled';\n            }\n            else {\n                this._status = 'completed';\n            }\n            if (resolve !== void 0) {\n                resolve(ret);\n            }\n        }\n        catch (err) {\n            if (reject !== void 0) {\n                reject(err);\n            }\n            else {\n                throw err;\n            }\n        }\n        finally {\n            if (!this.persistent) {\n                this.dispose();\n                if (reusable) {\n                    taskQueue.returnToPool(this);\n                }\n            }\n            leave(this, 'run finally');\n        }\n    }\n    cancel() {\n        enter(this, 'cancel');\n        if (this._status === 'pending') {\n            const taskQueue = this.taskQueue;\n            const reusable = this.reusable;\n            const reject = this.reject;\n            taskQueue.remove(this);\n            if (taskQueue.isEmpty) {\n                taskQueue.cancel();\n            }\n            this._status = 'canceled';\n            if (reject !== void 0) {\n                reject(new TaskAbortError(this));\n            }\n            this.dispose();\n            if (reusable) {\n                taskQueue.returnToPool(this);\n            }\n            leave(this, 'cancel true =pending');\n            return true;\n        }\n        else if (this._status === 'running' && this.persistent) {\n            this.persistent = false;\n            leave(this, 'cancel true =running+persistent');\n            return true;\n        }\n        leave(this, 'cancel false');\n        return false;\n    }\n    reset(time) {\n        enter(this, 'reset');\n        const delay = this.queueTime - this.createdTime;\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this._status = 'pending';\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        leave(this, 'reset');\n    }\n    reuse(time, delay, preempt, persistent, callback) {\n        enter(this, 'reuse');\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.callback = callback;\n        this._status = 'pending';\n        leave(this, 'reuse');\n    }\n    dispose() {\n        trace(this, 'dispose');\n        this.prev = void 0;\n        this.next = void 0;\n        this.callback = (void 0);\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n    }\n}\n//# sourceMappingURL=scheduler.js.map","import { __decorate, __param } from \"tslib\";\nimport { DI, Reporter } from '@aurelia/kernel';\nimport { subscriberCollection } from './subscriber-collection';\nimport { IScheduler } from '../scheduler';\nexport const IDirtyChecker = DI.createInterface('IDirtyChecker').withDefault(x => x.singleton(DirtyChecker));\nexport const DirtyCheckSettings = {\n    /**\n     * Default: `6`\n     *\n     * Adjust the global dirty check frequency.\n     * Measures in \"frames per check\", such that (given an FPS of 60):\n     * - A value of 1 will result in 60 dirty checks per second\n     * - A value of 6 will result in 10 dirty checks per second\n     */\n    framesPerCheck: 6,\n    /**\n     * Default: `false`\n     *\n     * Disable dirty-checking entirely. Properties that cannot be observed without dirty checking\n     * or an adapter, will simply not be observed.\n     */\n    disabled: false,\n    /**\n     * Default: `true`\n     *\n     * Log a warning message to the console if a property is being dirty-checked.\n     */\n    warn: true,\n    /**\n     * Default: `false`\n     *\n     * Throw an error if a property is being dirty-checked.\n     */\n    throw: false,\n    /**\n     * Resets all dirty checking settings to the framework's defaults.\n     */\n    resetToDefault() {\n        this.framesPerCheck = 6;\n        this.disabled = false;\n        this.warn = true;\n        this.throw = false;\n    }\n};\n/** @internal */\nlet DirtyChecker = class DirtyChecker {\n    constructor(scheduler) {\n        this.scheduler = scheduler;\n        this.tracked = [];\n        this.task = null;\n        this.elapsedFrames = 0;\n    }\n    createProperty(obj, propertyName) {\n        if (DirtyCheckSettings.throw) {\n            throw Reporter.error(800, propertyName); // TODO: create/organize error code\n        }\n        if (DirtyCheckSettings.warn) {\n            Reporter.write(801, propertyName);\n        }\n        return new DirtyCheckProperty(this, obj, propertyName);\n    }\n    addProperty(property) {\n        this.tracked.push(property);\n        if (this.tracked.length === 1) {\n            this.task = this.scheduler.queueRenderTask(() => this.check(), { persistent: true });\n        }\n    }\n    removeProperty(property) {\n        this.tracked.splice(this.tracked.indexOf(property), 1);\n        if (this.tracked.length === 0) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    check(delta) {\n        if (DirtyCheckSettings.disabled) {\n            return;\n        }\n        if (++this.elapsedFrames < DirtyCheckSettings.framesPerCheck) {\n            return;\n        }\n        this.elapsedFrames = 0;\n        const tracked = this.tracked;\n        const len = tracked.length;\n        let current;\n        let i = 0;\n        for (; i < len; ++i) {\n            current = tracked[i];\n            if (current.isDirty()) {\n                current.flush(256 /* fromTick */);\n            }\n        }\n    }\n};\nDirtyChecker = __decorate([\n    __param(0, IScheduler)\n], DirtyChecker);\nexport { DirtyChecker };\nlet DirtyCheckProperty = class DirtyCheckProperty {\n    constructor(dirtyChecker, obj, propertyKey) {\n        this.dirtyChecker = dirtyChecker;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n    }\n    isDirty() {\n        return this.oldValue !== this.obj[this.propertyKey];\n    }\n    flush(flags) {\n        const oldValue = this.oldValue;\n        const newValue = this.obj[this.propertyKey];\n        this.callSubscribers(newValue, oldValue, flags | 16 /* updateTargetInstance */);\n        this.oldValue = newValue;\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.oldValue = this.obj[this.propertyKey];\n            this.dirtyChecker.addProperty(this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        if (this.removeSubscriber(subscriber) && !this.hasSubscribers()) {\n            this.dirtyChecker.removeProperty(this);\n        }\n    }\n};\nDirtyCheckProperty = __decorate([\n    subscriberCollection()\n], DirtyCheckProperty);\nexport { DirtyCheckProperty };\n//# sourceMappingURL=dirty-checker.js.map","import { PLATFORM } from '@aurelia/kernel';\nconst slice = Array.prototype.slice;\nconst noop = PLATFORM.noop;\n// note: string.length is the only property of any primitive that is not a function,\n// so we can hardwire it to that and simply return undefined for anything else\n// note#2: a modified primitive constructor prototype would not work (and really, it shouldn't..)\nexport class PrimitiveObserver {\n    constructor(obj, propertyKey) {\n        this.doNotCache = true;\n        // we don't need to store propertyName because only 'length' can return a useful value\n        if (propertyKey === 'length') {\n            // deliberately not checking for typeof string as users probably still want to know via an error that their string is undefined\n            this.obj = obj;\n            this.getValue = this.getStringLength;\n        }\n        else {\n            this.getValue = this.returnUndefined;\n        }\n    }\n    getStringLength() {\n        return this.obj.length;\n    }\n    returnUndefined() {\n        return undefined;\n    }\n}\nPrimitiveObserver.prototype.setValue = noop;\nPrimitiveObserver.prototype.subscribe = noop;\nPrimitiveObserver.prototype.unsubscribe = noop;\nPrimitiveObserver.prototype.dispose = noop;\n//# sourceMappingURL=primitive-observer.js.map","export class PropertyAccessor {\n    constructor(obj, propertyKey) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        if (obj.$observers !== void 0\n            && obj.$observers[propertyKey] !== void 0\n            && obj.$observers[propertyKey].setValue !== void 0) {\n            this.setValue = this.setValueDirect;\n        }\n    }\n    getValue() {\n        return this.obj[this.propertyKey];\n    }\n    setValue(value, flags) {\n        this.obj[this.propertyKey] = value;\n    }\n    setValueDirect(value, flags) {\n        this.obj.$observers[this.propertyKey].setValue(value, flags);\n    }\n}\n//# sourceMappingURL=property-accessor.js.map","import { __decorate, __param } from \"tslib\";\nimport { DI, Registration, Reporter, } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { getArrayObserver } from './array-observer';\nimport { createComputedObserver } from './computed-observer';\nimport { IDirtyChecker } from './dirty-checker';\nimport { getMapObserver } from './map-observer';\nimport { PrimitiveObserver } from './primitive-observer';\nimport { PropertyAccessor } from './property-accessor';\nimport { ProxyObserver } from './proxy-observer';\nimport { getSetObserver } from './set-observer';\nimport { SetterObserver } from './setter-observer';\nimport { IScheduler } from '../scheduler';\nconst toStringTag = Object.prototype.toString;\nexport const IObserverLocator = DI.createInterface('IObserverLocator').noDefault();\nexport const ITargetObserverLocator = DI.createInterface('ITargetObserverLocator').noDefault();\nexport const ITargetAccessorLocator = DI.createInterface('ITargetAccessorLocator').noDefault();\nfunction getPropertyDescriptor(subject, name) {\n    let pd = Object.getOwnPropertyDescriptor(subject, name);\n    let proto = Object.getPrototypeOf(subject);\n    while (pd == null && proto != null) {\n        pd = Object.getOwnPropertyDescriptor(proto, name);\n        proto = Object.getPrototypeOf(proto);\n    }\n    return pd;\n}\n/** @internal */\nlet ObserverLocator = class ObserverLocator {\n    constructor(lifecycle, scheduler, dirtyChecker, targetObserverLocator, targetAccessorLocator) {\n        this.lifecycle = lifecycle;\n        this.scheduler = scheduler;\n        this.dirtyChecker = dirtyChecker;\n        this.targetObserverLocator = targetObserverLocator;\n        this.targetAccessorLocator = targetAccessorLocator;\n        this.adapters = [];\n    }\n    static register(container) {\n        return Registration.singleton(IObserverLocator, this).register(container);\n    }\n    getObserver(flags, obj, propertyName) {\n        if (flags & 2 /* proxyStrategy */ && typeof obj === 'object') {\n            return ProxyObserver.getOrCreate(obj, propertyName); // TODO: fix typings (and ensure proper contracts ofc)\n        }\n        if (isBindingContext(obj)) {\n            return obj.getObservers(flags).getOrCreate(this.lifecycle, flags, obj, propertyName);\n        }\n        let observersLookup = obj.$observers;\n        if (observersLookup && propertyName in observersLookup) {\n            return observersLookup[propertyName];\n        }\n        const observer = this.createPropertyObserver(flags, obj, propertyName);\n        if (!observer.doNotCache) {\n            if (observersLookup === void 0) {\n                observersLookup = this.getOrCreateObserversLookup(obj);\n            }\n            observersLookup[propertyName] = observer;\n        }\n        return observer;\n    }\n    addAdapter(adapter) {\n        this.adapters.push(adapter);\n    }\n    getAccessor(flags, obj, propertyName) {\n        if (this.targetAccessorLocator.handles(flags, obj)) {\n            if (this.targetObserverLocator.overridesAccessor(flags, obj, propertyName)) {\n                return this.getObserver(flags, obj, propertyName);\n            }\n            return this.targetAccessorLocator.getAccessor(flags, this.scheduler, this.lifecycle, obj, propertyName);\n        }\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(obj, propertyName);\n        }\n        return new PropertyAccessor(obj, propertyName);\n    }\n    getArrayObserver(flags, observedArray) {\n        return getArrayObserver(flags, this.lifecycle, observedArray);\n    }\n    getMapObserver(flags, observedMap) {\n        return getMapObserver(flags, this.lifecycle, observedMap);\n    }\n    getSetObserver(flags, observedSet) {\n        return getSetObserver(flags, this.lifecycle, observedSet);\n    }\n    getOrCreateObserversLookup(obj) {\n        return obj.$observers || this.createObserversLookup(obj);\n    }\n    createObserversLookup(obj) {\n        const value = {};\n        if (!Reflect.defineProperty(obj, '$observers', {\n            enumerable: false,\n            configurable: false,\n            writable: false,\n            value: value\n        })) {\n            Reporter.write(0, obj);\n        }\n        return value;\n    }\n    getAdapterObserver(flags, obj, propertyName, descriptor) {\n        for (let i = 0, ii = this.adapters.length; i < ii; i++) {\n            const adapter = this.adapters[i];\n            const observer = adapter.getObserver(flags, obj, propertyName, descriptor);\n            if (observer != null) {\n                return observer;\n            }\n        }\n        return null;\n    }\n    createPropertyObserver(flags, obj, propertyName) {\n        if (!(obj instanceof Object)) {\n            return new PrimitiveObserver(obj, propertyName);\n        }\n        let isNode = false;\n        if (this.targetObserverLocator.handles(flags, obj)) {\n            const observer = this.targetObserverLocator.getObserver(flags, this.scheduler, this.lifecycle, this, obj, propertyName);\n            if (observer != null) {\n                return observer;\n            }\n            isNode = true;\n        }\n        const tag = toStringTag.call(obj);\n        switch (tag) {\n            case '[object Array]':\n                if (propertyName === 'length') {\n                    return this.getArrayObserver(flags, obj).getLengthObserver();\n                }\n                return this.dirtyChecker.createProperty(obj, propertyName);\n            case '[object Map]':\n                if (propertyName === 'size') {\n                    return this.getMapObserver(flags, obj).getLengthObserver();\n                }\n                return this.dirtyChecker.createProperty(obj, propertyName);\n            case '[object Set]':\n                if (propertyName === 'size') {\n                    return this.getSetObserver(flags, obj).getLengthObserver();\n                }\n                return this.dirtyChecker.createProperty(obj, propertyName);\n        }\n        const descriptor = getPropertyDescriptor(obj, propertyName);\n        if (descriptor && (descriptor.get || descriptor.set)) {\n            if (descriptor.get && descriptor.get.getObserver) {\n                return descriptor.get.getObserver(obj);\n            }\n            // attempt to use an adapter before resorting to dirty checking.\n            const adapterObserver = this.getAdapterObserver(flags, obj, propertyName, descriptor);\n            if (adapterObserver) {\n                return adapterObserver;\n            }\n            if (isNode) {\n                // TODO: use MutationObserver\n                return this.dirtyChecker.createProperty(obj, propertyName);\n            }\n            return createComputedObserver(flags, this, this.dirtyChecker, this.lifecycle, obj, propertyName, descriptor);\n        }\n        return new SetterObserver(this.lifecycle, flags, obj, propertyName);\n    }\n};\nObserverLocator = __decorate([\n    __param(0, ILifecycle),\n    __param(1, IScheduler),\n    __param(2, IDirtyChecker),\n    __param(3, ITargetObserverLocator),\n    __param(4, ITargetAccessorLocator)\n], ObserverLocator);\nexport { ObserverLocator };\nexport function getCollectionObserver(flags, lifecycle, collection) {\n    // If the collection is wrapped by a proxy then `$observer` will return the proxy observer instead of the collection observer, which is not what we want\n    // when we ask for getCollectionObserver\n    const rawCollection = collection instanceof Object ? ProxyObserver.getRawIfProxy(collection) : collection;\n    switch (toStringTag.call(collection)) {\n        case '[object Array]':\n            return getArrayObserver(flags, lifecycle, rawCollection);\n        case '[object Map]':\n            return getMapObserver(flags, lifecycle, rawCollection);\n        case '[object Set]':\n            return getSetObserver(flags, lifecycle, rawCollection);\n    }\n    return void 0;\n}\nfunction isBindingContext(obj) {\n    return obj.$synthetic === true;\n}\n//# sourceMappingURL=observer-locator.js.map","var SelfObserver_1;\nimport { __decorate } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { ProxyObserver } from './proxy-observer';\nimport { subscriberCollection } from './subscriber-collection';\nlet SelfObserver = SelfObserver_1 = class SelfObserver {\n    constructor(lifecycle, flags, obj, propertyKey, cbName) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        let isProxy = false;\n        if (ProxyObserver.isProxy(obj)) {\n            isProxy = true;\n            obj.$observer.subscribe(this, propertyKey);\n            this.obj = obj.$raw;\n        }\n        else {\n            this.obj = obj;\n        }\n        this.callback = this.obj[cbName];\n        if (this.callback === void 0) {\n            this.observing = false;\n        }\n        else {\n            this.observing = true;\n            this.currentValue = obj[propertyKey];\n            if (!isProxy) {\n                this.createGetterSetter();\n            }\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    handleChange(newValue, oldValue, flags) {\n        this.setValue(newValue, flags);\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n                // eslint-disable-next-line sonarjs/no-collapsible-if\n                if ((flags & 4096 /* fromBind */) === 0 || (flags & 32 /* updateSourceExpression */) > 0) {\n                    const callback = this.callback;\n                    if (callback !== void 0) {\n                        callback.call(this.obj, newValue, currentValue, this.persistentFlags | flags);\n                    }\n                }\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // See SetterObserver.setValue for explanation\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            this.currentValue = this.obj[this.propertyKey];\n            this.createGetterSetter();\n        }\n        this.addSubscriber(subscriber);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => {\n                return this.currentValue;\n            },\n            set: value => {\n                this.setValue(value, 0 /* none */);\n            },\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nSelfObserver = SelfObserver_1 = __decorate([\n    subscriberCollection()\n], SelfObserver);\nexport { SelfObserver };\n//# sourceMappingURL=self-observer.js.map","import { __decorate } from \"tslib\";\nimport { BindingMode } from '../../flags';\nimport { bindingBehavior } from '../binding-behavior';\nexport class BindingModeBehavior {\n    constructor(mode) {\n        this.mode = mode;\n        this.originalModes = new WeakMap();\n    }\n    bind(flags, scope, binding) {\n        this.originalModes.set(binding, binding.mode);\n        binding.mode = this.mode;\n    }\n    unbind(flags, scope, binding) {\n        binding.mode = this.originalModes.get(binding);\n    }\n}\nlet OneTimeBindingBehavior = class OneTimeBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.oneTime);\n    }\n};\nOneTimeBindingBehavior = __decorate([\n    bindingBehavior('oneTime')\n], OneTimeBindingBehavior);\nexport { OneTimeBindingBehavior };\nlet ToViewBindingBehavior = class ToViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.toView);\n    }\n};\nToViewBindingBehavior = __decorate([\n    bindingBehavior('toView')\n], ToViewBindingBehavior);\nexport { ToViewBindingBehavior };\nlet FromViewBindingBehavior = class FromViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.fromView);\n    }\n};\nFromViewBindingBehavior = __decorate([\n    bindingBehavior('fromView')\n], FromViewBindingBehavior);\nexport { FromViewBindingBehavior };\nlet TwoWayBindingBehavior = class TwoWayBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.twoWay);\n    }\n};\nTwoWayBindingBehavior = __decorate([\n    bindingBehavior('twoWay')\n], TwoWayBindingBehavior);\nexport { TwoWayBindingBehavior };\n//# sourceMappingURL=binding-mode.js.map","import { __decorate } from \"tslib\";\nimport { bindingBehavior } from '../binding-behavior';\nimport { IScheduler } from '../../scheduler';\nclass Debouncer {\n    constructor(binding, delay) {\n        this.binding = binding;\n        const taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        const taskQueueOpts = { delay };\n        // TODO: expose binding API that tells the outside what method name is the primary change handler\n        // Or expose some kind of `decorate` or `applyBehavior` api. This monkey patching is bad and needs to go.\n        const methodName = this.methodName = 'callSource' in binding ? 'callSource' : 'handleChange';\n        let task = null;\n        const originalHandler = this.originalHandler = binding[methodName];\n        this.wrappedHandler = (...args) => {\n            if (task !== null) {\n                task.cancel();\n            }\n            task = taskQueue.queueTask(() => originalHandler.call(binding, ...args), taskQueueOpts);\n        };\n    }\n    start() {\n        this.binding[this.methodName] = this.wrappedHandler;\n    }\n    stop() {\n        this.binding[this.methodName] = this.originalHandler;\n    }\n}\nconst lookup = new WeakMap();\nlet DebounceBindingBehavior = class DebounceBindingBehavior {\n    bind(flags, scope, binding, delay = 200) {\n        let debouncer = lookup.get(binding);\n        if (debouncer === void 0) {\n            debouncer = new Debouncer(binding, delay);\n            lookup.set(binding, debouncer);\n        }\n        debouncer.start();\n    }\n    unbind(flags, scope, binding) {\n        // The binding exists so it can't have been garbage-collected and a binding can only unbind if it was bound first,\n        // so we know for sure the debouncer exists in the lookup.\n        const debouncer = lookup.get(binding);\n        debouncer.stop();\n    }\n};\nDebounceBindingBehavior = __decorate([\n    bindingBehavior('debounce')\n], DebounceBindingBehavior);\nexport { DebounceBindingBehavior };\n//# sourceMappingURL=debounce.js.map","import { __decorate, __param } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { ISignaler } from '../../observation/signaler';\nimport { bindingBehavior } from '../binding-behavior';\nlet SignalBindingBehavior = class SignalBindingBehavior {\n    constructor(signaler) {\n        this.signaler = signaler;\n    }\n    bind(flags, scope, binding, ...args) {\n        if (!binding.updateTarget) {\n            throw Reporter.error(11);\n        }\n        if (arguments.length === 4) {\n            const name = args[0];\n            this.signaler.addSignalListener(name, binding);\n            binding.signal = name;\n        }\n        else if (arguments.length > 4) {\n            const names = Array.prototype.slice.call(args.length + 3, 3);\n            let i = names.length;\n            while (i--) {\n                const name = names[i];\n                this.signaler.addSignalListener(name, binding);\n            }\n            binding.signal = names;\n        }\n        else {\n            throw Reporter.error(12);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const name = binding.signal;\n        binding.signal = null;\n        if (Array.isArray(name)) {\n            const names = name;\n            let i = names.length;\n            while (i--) {\n                this.signaler.removeSignalListener(names[i], binding);\n            }\n        }\n        else {\n            this.signaler.removeSignalListener(name, binding);\n        }\n    }\n};\nSignalBindingBehavior = __decorate([\n    bindingBehavior('signal'),\n    __param(0, ISignaler)\n], SignalBindingBehavior);\nexport { SignalBindingBehavior };\n//# sourceMappingURL=signals.js.map","import { __decorate } from \"tslib\";\nimport { bindingBehavior } from '../binding-behavior';\nimport { IScheduler, IClock } from '../../scheduler';\nclass Throttler {\n    constructor(binding, delay) {\n        this.binding = binding;\n        const clock = binding.locator.get(IClock);\n        const taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        const taskQueueOpts = { delay };\n        const methodName = this.methodName = 'callSource' in binding ? 'callSource' : 'handleChange';\n        let task = null;\n        let lastCall = 0;\n        let nextDelay = 0;\n        const originalHandler = this.originalHandler = binding[methodName];\n        this.wrappedHandler = (...args) => {\n            nextDelay = lastCall + delay - clock.now();\n            if (nextDelay > 0) {\n                if (task !== null) {\n                    task.cancel();\n                }\n                taskQueueOpts.delay = nextDelay;\n                task = taskQueue.queueTask(() => {\n                    lastCall = clock.now();\n                    originalHandler.call(binding, ...args);\n                }, taskQueueOpts);\n            }\n            else {\n                lastCall = clock.now();\n                originalHandler.call(binding, ...args);\n            }\n        };\n    }\n    start() {\n        this.binding[this.methodName] = this.wrappedHandler;\n    }\n    stop() {\n        this.binding[this.methodName] = this.originalHandler;\n    }\n}\nconst lookup = new WeakMap();\nlet ThrottleBindingBehavior = class ThrottleBindingBehavior {\n    bind(flags, scope, binding, delay = 200) {\n        let throttler = lookup.get(binding);\n        if (throttler === void 0) {\n            throttler = new Throttler(binding, delay);\n            lookup.set(binding, throttler);\n        }\n        throttler.start();\n    }\n    unbind(flags, scope, binding) {\n        // The binding exists so it can't have been garbage-collected and a binding can only unbind if it was bound first,\n        // so we know for sure the throttler exists in the lookup.\n        const throttler = lookup.get(binding);\n        throttler.stop();\n    }\n};\nThrottleBindingBehavior = __decorate([\n    bindingBehavior('throttle')\n], ThrottleBindingBehavior);\nexport { ThrottleBindingBehavior };\n//# sourceMappingURL=throttle.js.map","import { __decorate } from \"tslib\";\nimport { kebabCase, Metadata, Protocol, firstDefined, getPrototypeChain, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nexport function bindable(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @bindable\n            // Invocation with or w/o opts:\n            // - @bindable()\n            // - @bindable({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Bindable.name, BindableDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Bindable.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @bindable\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @bindable('bar')\n        // Direct call:\n        // - @bindable('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @bindable()\n    // - @bindable({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isBindableAnnotation(key) {\n    return key.startsWith(Bindable.name);\n}\nexport const Bindable = {\n    name: Protocol.annotation.keyFor('bindable'),\n    keyFrom(name) {\n        return `${Bindable.name}:${name}`;\n    },\n    from(...bindableLists) {\n        const bindables = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            bindables[name] = BindableDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            bindables[name] = def instanceof BindableDefinition ? def : BindableDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof BindableDefinition) {\n                bindables[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList[name]));\n            }\n        }\n        bindableLists.forEach(addList);\n        return bindables;\n    },\n    for(Type) {\n        let def;\n        const builder = {\n            add(configOrProp) {\n                let prop;\n                let config;\n                if (typeof configOrProp === 'string') {\n                    prop = configOrProp;\n                    config = { property: prop };\n                }\n                else {\n                    prop = configOrProp.property;\n                    config = configOrProp;\n                }\n                def = BindableDefinition.create(prop, config);\n                if (!Metadata.hasOwn(Bindable.name, Type, prop)) {\n                    Protocol.annotation.appendTo(Type, Bindable.keyFrom(prop));\n                }\n                Metadata.define(Bindable.name, def, Type, prop);\n                return builder;\n            },\n            mode(mode) {\n                def.mode = mode;\n                return builder;\n            },\n            callback(callback) {\n                def.callback = callback;\n                return builder;\n            },\n            attribute(attribute) {\n                def.attribute = attribute;\n                return builder;\n            },\n            primary() {\n                def.primary = true;\n                return builder;\n            },\n        };\n        return builder;\n    },\n    getAll(Type) {\n        const propStart = Bindable.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isBindableAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Bindable.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class BindableDefinition {\n    constructor(attribute, callback, mode, primary, property) {\n        this.attribute = attribute;\n        this.callback = callback;\n        this.mode = mode;\n        this.primary = primary;\n        this.property = property;\n    }\n    static create(prop, def = {}) {\n        return new BindableDefinition(firstDefined(def.attribute, kebabCase(prop)), firstDefined(def.callback, `${prop}Changed`), firstDefined(def.mode, BindingMode.toView), firstDefined(def.primary, false), firstDefined(def.property, prop));\n    }\n}\n/* eslint-disable @typescript-eslint/no-unused-vars,spaced-comment */\n/**\n * This function serves two purposes:\n * - A playground for contributors to try their changes to the APIs.\n * - Cause the API surface to be properly type-checked and protected against accidental type regressions.\n *\n * It will be automatically removed by dead code elimination.\n */\nfunction apiTypeCheck() {\n    let Foo = \n    // > expected error - class decorator only accepts a string\n    //@bindable({})\n    class Foo {\n    };\n    __decorate([\n        bindable,\n        bindable(),\n        bindable({})\n        // > expected error - 'property' does not exist on decorator input object\n        //@bindable({ property: 'prop' })\n        ,\n        bindable({ mode: BindingMode.twoWay }),\n        bindable({ callback: 'propChanged' }),\n        bindable({ attribute: 'prop' }),\n        bindable({ primary: true }),\n        bindable({ mode: BindingMode.twoWay, callback: 'propChanged', attribute: 'prop', primary: true })\n    ], Foo.prototype, \"prop\", void 0);\n    Foo = __decorate([\n        bindable('prop')\n        // > expected error - class decorator only accepts a string\n        //@bindable({})\n    ], Foo);\n    Bindable.for(Foo)\n        // > expected error - there is no add() function with only optional params on the fluent api\n        //.add()\n        // > expected error - 'property' is a required property on the fluent api\n        //.add({})\n        .add({ property: 'prop' })\n        .add({ property: 'prop', mode: BindingMode.twoWay })\n        .add({ property: 'prop', callback: 'propChanged' })\n        .add({ property: 'prop', attribute: 'prop' })\n        .add({ property: 'prop', primary: true })\n        .add({ property: 'prop', mode: BindingMode.twoWay, callback: 'propChanged', attribute: 'prop', primary: true })\n        .add('prop')\n        // > expected error - the add() method that accepts an object literal does not return a fluent api\n        //.add({ property: 'prop' }).mode(BindingMode.twoWay)\n        //.add({ property: 'prop' }).callback('propChanged')\n        //.add({ property: 'prop' }).attribute('prop')\n        //.add({ property: 'prop' }).primary()\n        // > expected error - fluent api methods can only be invoked once per bindable\n        //.add('prop').mode(BindingMode.twoWay).mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').callback('propChanged') // etc\n        // > expected error - wrong invocation order\n        //.add('prop').callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').primary().mode(BindingMode.twoWay)  // etc\n        .add('prop').mode(BindingMode.twoWay)\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop').primary()\n        .add('prop').callback('propChanged')\n        .add('prop').callback('propChanged').attribute('prop')\n        .add('prop').callback('propChanged').attribute('prop').primary()\n        .add('prop').attribute('prop')\n        .add('prop').attribute('prop').primary()\n        .add('prop').primary();\n}\n/* eslint-enable @typescript-eslint/no-unused-vars,spaced-comment */\n//# sourceMappingURL=bindable.js.map","import { Registration, Protocol, Metadata, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { HooksDefinition, registerAliases, } from '../definitions';\nimport { BindingMode, } from '../flags';\nimport { Bindable } from '../templating/bindable';\nexport function customAttribute(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(nameOrDef, target);\n    };\n}\nexport function templateController(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(typeof nameOrDef === 'string'\n            ? { isTemplateController: true, name: nameOrDef }\n            : { isTemplateController: true, ...nameOrDef }, target);\n    };\n}\nexport class CustomAttributeDefinition {\n    constructor(Type, name, aliases, key, defaultBindingMode, isTemplateController, bindables, strategy, hooks) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.defaultBindingMode = defaultBindingMode;\n        this.isTemplateController = isTemplateController;\n        this.bindables = bindables;\n        this.strategy = strategy;\n        this.hooks = hooks;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new CustomAttributeDefinition(Type, firstDefined(CustomAttribute.getAnnotation(Type, 'name'), name), mergeArrays(CustomAttribute.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), CustomAttribute.keyFrom(name), firstDefined(CustomAttribute.getAnnotation(Type, 'defaultBindingMode'), def.defaultBindingMode, Type.defaultBindingMode, BindingMode.toView), firstDefined(CustomAttribute.getAnnotation(Type, 'isTemplateController'), def.isTemplateController, Type.isTemplateController, false), Bindable.from(...Bindable.getAll(Type), CustomAttribute.getAnnotation(Type, 'bindables'), Type.bindables, def.bindables), firstDefined(CustomAttribute.getAnnotation(Type, 'strategy'), def.strategy, Type.strategy, 1 /* getterSetter */), firstDefined(CustomAttribute.getAnnotation(Type, 'hooks'), def.hooks, Type.hooks, new HooksDefinition(Type.prototype)));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, CustomAttribute, key, container);\n    }\n}\nexport const CustomAttribute = {\n    name: Protocol.resource.keyFor('custom-attribute'),\n    keyFrom(name) {\n        return `${CustomAttribute.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomAttribute.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomAttributeDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomAttribute.name, definition, definition.Type);\n        Metadata.define(CustomAttribute.name, definition, definition);\n        Protocol.resource.appendTo(Type, CustomAttribute.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomAttribute.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=custom-attribute.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nexport const INode = DI.createInterface('INode').noDefault();\nexport const IRenderLocation = DI.createInterface('IRenderLocation').noDefault();\nexport const IDOM = DI.createInterface('IDOM').noDefault();\nconst ni = function (...args) {\n    throw Reporter.error(1000); // TODO: create error code (not implemented exception)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n}; // this function doesn't need typing because it is never directly called\nconst niDOM = {\n    addEventListener: ni,\n    appendChild: ni,\n    cloneNode: ni,\n    convertToRenderLocation: ni,\n    createDocumentFragment: ni,\n    createElement: ni,\n    createCustomEvent: ni,\n    dispatchEvent: ni,\n    createNodeObserver: ni,\n    createTemplate: ni,\n    createTextNode: ni,\n    insertBefore: ni,\n    isMarker: ni,\n    isNodeInstance: ni,\n    isRenderLocation: ni,\n    makeTarget: ni,\n    registerElementResolver: ni,\n    remove: ni,\n    removeEventListener: ni,\n    setAttribute: ni\n};\nexport const DOM = {\n    ...niDOM,\n    scheduler: (void 0),\n    get isInitialized() {\n        return Reflect.get(this, '$initialized') === true;\n    },\n    initialize(dom) {\n        if (this.isInitialized) {\n            throw Reporter.error(1001); // TODO: create error code (already initialized, check isInitialized property and call destroy() if you want to assign a different dom)\n        }\n        const descriptors = {};\n        const protos = [dom];\n        let proto = Object.getPrototypeOf(dom);\n        while (proto && proto !== Object.prototype) {\n            protos.unshift(proto);\n            proto = Object.getPrototypeOf(proto);\n        }\n        for (proto of protos) {\n            Object.assign(descriptors, Object.getOwnPropertyDescriptors(proto));\n        }\n        const keys = [];\n        let key;\n        let descriptor;\n        for (key in descriptors) {\n            descriptor = descriptors[key];\n            if (descriptor.configurable && descriptor.writable) {\n                Reflect.defineProperty(this, key, descriptor);\n                keys.push(key);\n            }\n        }\n        Reflect.set(this, '$domKeys', keys);\n        Reflect.set(this, '$initialized', true);\n    },\n    destroy() {\n        if (!this.isInitialized) {\n            throw Reporter.error(1002); // TODO: create error code (already destroyed)\n        }\n        const keys = Reflect.get(this, '$domKeys');\n        keys.forEach(key => {\n            Reflect.deleteProperty(this, key);\n        });\n        Object.assign(this, niDOM);\n        Reflect.set(this, '$domKeys', PLATFORM.emptyArray);\n        Reflect.set(this, '$initialized', false);\n    }\n};\n// This is an implementation of INodeSequence that represents \"no DOM\" to render.\n// It's used in various places to avoid null and to encode\n// the explicit idea of \"no view\".\nconst emptySequence = {\n    isMounted: false,\n    isLinked: false,\n    next: void 0,\n    childNodes: PLATFORM.emptyArray,\n    firstChild: null,\n    lastChild: null,\n    findTargets() { return PLATFORM.emptyArray; },\n    insertBefore(refNode) { },\n    appendTo(parent) { },\n    remove() { },\n    addToLinked() { },\n    unlink() { },\n    link(next) { },\n};\nexport const NodeSequence = {\n    empty: emptySequence\n};\n//# sourceMappingURL=dom.js.map","import { __decorate, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nclass FlagsTemplateController {\n    constructor(factory, location, flags) {\n        this.factory = factory;\n        this.flags = flags;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    binding(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | this.flags, this.$controller.scope);\n    }\n    attaching(flags) {\n        this.view.attach(flags);\n    }\n    detaching(flags) {\n        this.view.detach(flags);\n    }\n    unbinding(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n}\nlet InfrequentMutations = class InfrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 268435456 /* noTargetObserverQueue */);\n    }\n};\nInfrequentMutations = __decorate([\n    templateController('infrequent-mutations'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation)\n], InfrequentMutations);\nexport { InfrequentMutations };\nlet FrequentMutations = class FrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 536870912 /* persistentTargetObserverQueue */);\n    }\n};\nFrequentMutations = __decorate([\n    templateController('frequent-mutations'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation)\n], FrequentMutations);\nexport { FrequentMutations };\nlet ObserveShallow = class ObserveShallow extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 134217728 /* observeLeafPropertiesOnly */);\n    }\n};\nObserveShallow = __decorate([\n    templateController('observe-shallow'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation)\n], ObserveShallow);\nexport { ObserveShallow };\n//# sourceMappingURL=flags.js.map","import { __decorate, __param } from \"tslib\";\nimport { DI, IServiceLocator, Registration, } from '@aurelia/kernel';\nexport const LifecycleTask = {\n    done: {\n        done: true,\n        canCancel() { return false; },\n        cancel() { return; },\n        wait() { return Promise.resolve(); }\n    }\n};\nexport var TaskSlot;\n(function (TaskSlot) {\n    TaskSlot[TaskSlot[\"beforeCreate\"] = 0] = \"beforeCreate\";\n    TaskSlot[TaskSlot[\"beforeRender\"] = 1] = \"beforeRender\";\n    TaskSlot[TaskSlot[\"beforeBind\"] = 2] = \"beforeBind\";\n    TaskSlot[TaskSlot[\"beforeAttach\"] = 3] = \"beforeAttach\";\n})(TaskSlot || (TaskSlot = {}));\nexport const IStartTask = DI.createInterface('IStartTask').noDefault();\nvar TaskType;\n(function (TaskType) {\n    TaskType[TaskType[\"with\"] = 0] = \"with\";\n    TaskType[TaskType[\"from\"] = 1] = \"from\";\n})(TaskType || (TaskType = {}));\n// eslint-disable-next-line @typescript-eslint/class-name-casing\nexport const StartTask = class $StartTask {\n    constructor(type) {\n        this.type = type;\n        this._slot = void 0;\n        this._promiseOrTask = void 0;\n        this._container = void 0;\n        this._key = void 0;\n        this._callback = void 0;\n        this._task = void 0;\n    }\n    get slot() {\n        if (this._slot === void 0) {\n            throw new Error('StartTask.slot is not set');\n        }\n        return this._slot;\n    }\n    get promiseOrTask() {\n        if (this._promiseOrTask === void 0) {\n            throw new Error('StartTask.promiseOrTask is not set');\n        }\n        return this._promiseOrTask;\n    }\n    get container() {\n        if (this._container === void 0) {\n            throw new Error('StartTask.container is not set');\n        }\n        return this._container;\n    }\n    get key() {\n        if (this._key === void 0) {\n            throw new Error('StartTask.key is not set');\n        }\n        return this._key;\n    }\n    get callback() {\n        if (this._callback === void 0) {\n            throw new Error('StartTask.callback is not set');\n        }\n        return this._callback;\n    }\n    get task() {\n        if (this._task === void 0) {\n            throw new Error('StartTask.task is not set');\n        }\n        return this._task;\n    }\n    static with(key) {\n        const task = new $StartTask(0 /* with */);\n        task._key = key;\n        return task;\n    }\n    static from(promiseOrTask) {\n        const task = new $StartTask(1 /* from */);\n        task._promiseOrTask = promiseOrTask;\n        return task;\n    }\n    beforeCreate() {\n        return this.at(0 /* beforeCreate */);\n    }\n    beforeRender() {\n        return this.at(1 /* beforeRender */);\n    }\n    beforeBind() {\n        return this.at(2 /* beforeBind */);\n    }\n    beforeAttach() {\n        return this.at(3 /* beforeAttach */);\n    }\n    at(slot) {\n        this._slot = slot;\n        return this;\n    }\n    call(fn) {\n        this._callback = fn;\n        return this;\n    }\n    register(container) {\n        return this._container = container.register(Registration.instance(IStartTask, this));\n    }\n    resolveTask() {\n        if (this._task === void 0) {\n            switch (this.type) {\n                case 0 /* with */:\n                    this._task = new ProviderTask(this.container, this.key, this.callback);\n                    break;\n                case 1 /* from */:\n                    this._task = new TerminalTask(this.promiseOrTask);\n                    break;\n            }\n        }\n        return this.task;\n    }\n};\nexport const IStartTaskManager = DI.createInterface('IStartTaskManager').noDefault();\nlet StartTaskManager = class StartTaskManager {\n    constructor(locator) {\n        this.locator = locator;\n    }\n    static register(container) {\n        return Registration.singleton(IStartTaskManager, this).register(container);\n    }\n    runBeforeCreate(locator = this.locator) {\n        return this.run(0 /* beforeCreate */, locator);\n    }\n    runBeforeRender(locator = this.locator) {\n        return this.run(1 /* beforeRender */, locator);\n    }\n    runBeforeBind(locator = this.locator) {\n        return this.run(2 /* beforeBind */, locator);\n    }\n    runBeforeAttach(locator = this.locator) {\n        return this.run(3 /* beforeAttach */, locator);\n    }\n    run(slot, locator = this.locator) {\n        const tasks = locator.getAll(IStartTask)\n            .filter(startTask => startTask.slot === slot)\n            .map(startTask => startTask.resolveTask())\n            .filter(task => !task.done);\n        if (tasks.length === 0) {\n            return LifecycleTask.done;\n        }\n        return new AggregateTerminalTask(tasks);\n    }\n};\nStartTaskManager = __decorate([\n    __param(0, IServiceLocator)\n], StartTaskManager);\nexport { StartTaskManager };\nexport class PromiseTask {\n    constructor(promise, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = promise.then(value => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            if (next !== null) {\n                const nextResult = next.call(context, value, ...args);\n                if (nextResult === void 0) {\n                    this.done = true;\n                }\n                else {\n                    const nextPromise = nextResult.then instanceof Function\n                        ? nextResult\n                        : nextResult.wait();\n                    return nextPromise.then(() => {\n                        this.done = true;\n                    });\n                }\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class ProviderTask {\n    constructor(container, key, callback) {\n        this.container = container;\n        this.key = key;\n        this.callback = callback;\n        this.done = false;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        if (this.promise === void 0) {\n            const instance = this.container.get(this.key);\n            const maybePromiseOrTask = this.callback.call(void 0, instance);\n            this.promise = maybePromiseOrTask === void 0\n                ? Promise.resolve()\n                : maybePromiseOrTask.then instanceof Function\n                    ? maybePromiseOrTask\n                    : maybePromiseOrTask.wait();\n            this.promise = this.promise.then(() => {\n                this.done = true;\n                this.container = (void 0);\n                this.key = (void 0);\n                this.callback = (void 0);\n            }).catch(e => { throw e; });\n        }\n        return this.promise;\n    }\n}\nexport class ContinuationTask {\n    constructor(antecedent, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        const promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise = promise.then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                const nextPromise = nextResult.then instanceof Function\n                    ? nextResult\n                    : nextResult.wait();\n                return nextPromise.then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class TerminalTask {\n    constructor(antecedent) {\n        this.done = false;\n        this.promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise.then(() => {\n            this.done = true;\n        }).catch(e => { throw e; });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateContinuationTask {\n    constructor(antecedents, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                return nextResult.wait().then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateTerminalTask {\n    constructor(antecedents) {\n        this.done = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            this.done = true;\n        });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport function hasAsyncWork(value) {\n    return !(value === void 0 || value.done === true);\n}\n//# sourceMappingURL=lifecycle-task.js.map","import { __decorate, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { ContinuationTask, LifecycleTask, PromiseTask } from '../../lifecycle-task';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet If = class If {\n    constructor(ifFactory, location) {\n        this.ifFactory = ifFactory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.elseFactory = void 0;\n        this.elseView = void 0;\n        this.ifView = void 0;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.value = false;\n    }\n    ;\n    binding(flags) {\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n        return this.task;\n    }\n    attaching(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    detaching(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    unbinding(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        if (this.ifView !== void 0 && this.ifView.release(flags)) {\n            this.ifView = void 0;\n        }\n        if (this.elseView !== void 0 && this.elseView.release(flags)) {\n            this.elseView = void 0;\n        }\n        this.view = void 0;\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n    }\n    /** @internal */\n    updateView(value, flags) {\n        let view;\n        if (value) {\n            view = this.ifView = this.ensureView(this.ifView, this.ifFactory, flags);\n        }\n        else if (this.elseFactory != void 0) {\n            view = this.elseView = this.ensureView(this.elseView, this.elseFactory, flags);\n        }\n        else {\n            view = void 0;\n        }\n        return view;\n    }\n    /** @internal */\n    ensureView(view, factory, flags) {\n        if (view === void 0) {\n            view = factory.create(flags);\n        }\n        view.hold(this.location, 1 /* insertBefore */);\n        return view;\n    }\n    swap(value, flags) {\n        let task = LifecycleTask.done;\n        if ((value === true && this.elseView !== void 0)\n            || (value !== true && this.ifView !== void 0)) {\n            task = this.deactivate(flags);\n        }\n        if (task.done) {\n            const view = this.updateView(value, flags);\n            task = this.activate(view, flags);\n        }\n        else {\n            task = new PromiseTask(task.wait().then(() => this.updateView(value, flags)), this.activate, this, flags);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags); // TODO: link this up with unbind\n        const task = view.unbind(flags);\n        view.parent = void 0;\n        return task;\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if ((this.$controller.state & 32 /* isAttached */) === 0) {\n            return task;\n        }\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.view.parent = this.$controller;\n            return this.view.bind(flags, this.$controller.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n            this.view.attach(flags);\n        }\n    }\n};\n__decorate([\n    bindable\n], If.prototype, \"value\", void 0);\nIf = __decorate([\n    templateController('if'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation)\n], If);\nexport { If };\nlet Else = class Else {\n    constructor(factory) {\n        this.factory = factory;\n        this.id = nextId('au$component');\n    }\n    link(ifBehavior) {\n        if (ifBehavior instanceof If) {\n            ifBehavior.elseFactory = this.factory;\n        }\n        else if (ifBehavior.viewModel instanceof If) {\n            ifBehavior.viewModel.elseFactory = this.factory;\n        }\n        else {\n            throw new Error(`Unsupported IfBehavior`); // TODO: create error code\n        }\n    }\n};\nElse = __decorate([\n    templateController('else'),\n    __param(0, IViewFactory)\n], Else);\nexport { Else };\n//# sourceMappingURL=if.js.map","import { __decorate, __param } from \"tslib\";\nimport { compareNumber, nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IController, IViewFactory } from '../../lifecycle';\nimport { AggregateContinuationTask, ContinuationTask, LifecycleTask, } from '../../lifecycle-task';\nimport { applyMutationsToIndices, synchronizeIndices } from '../../observation/array-observer';\nimport { BindingContext, Scope } from '../../observation/binding-context';\nimport { getCollectionObserver } from '../../observation/observer-locator';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nconst isMountedOrAttached = 64 /* isMounted */ | 32 /* isAttached */;\nlet Repeat = class Repeat {\n    constructor(location, renderable, factory) {\n        this.location = location;\n        this.renderable = renderable;\n        this.factory = factory;\n        this.id = nextId('au$component');\n        this.hasPendingInstanceMutation = false;\n        this.observer = void 0;\n        this.views = [];\n        this.key = void 0;\n        this.task = LifecycleTask.done;\n        this.normalizedItems = void 0;\n    }\n    binding(flags) {\n        this.checkCollectionObserver(flags);\n        const bindings = this.renderable.bindings;\n        const { length } = bindings;\n        let binding;\n        for (let i = 0; i < length; ++i) {\n            binding = bindings[i];\n            if (binding.target === this && binding.targetProperty === 'items') {\n                this.forOf = binding.sourceExpression;\n                break;\n            }\n        }\n        this.local = this.forOf.declaration.evaluate(flags, this.$controller.scope, null);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n        return this.task;\n    }\n    attaching(flags) {\n        if (this.task.done) {\n            this.attachViews(void 0, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachViews, this, void 0, flags);\n        }\n    }\n    detaching(flags) {\n        if (this.task.done) {\n            this.detachViewsByRange(0, this.views.length, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.detachViewsByRange, this, 0, this.views.length, flags);\n        }\n    }\n    unbinding(flags) {\n        this.checkCollectionObserver(flags);\n        if (this.task.done) {\n            this.task = this.unbindAndRemoveViewsByRange(0, this.views.length, flags, false);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, this.views.length, flags, false);\n        }\n        return this.task;\n    }\n    // called by SetterObserver\n    itemsChanged(flags) {\n        flags |= this.$controller.flags;\n        this.checkCollectionObserver(flags);\n        flags |= 16 /* updateTargetInstance */;\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n    }\n    // called by a CollectionObserver\n    handleCollectionChange(indexMap, flags) {\n        flags |= this.$controller.flags;\n        flags |= (960 /* fromFlush */ | 16 /* updateTargetInstance */);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(indexMap, flags);\n    }\n    processViewsKeyed(indexMap, flags) {\n        const oldLength = this.views.length;\n        if (indexMap === void 0) {\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                this.detachViewsByRange(0, oldLength, flags);\n                if (this.task.done) {\n                    this.task = this.unbindAndRemoveViewsByRange(0, oldLength, flags, false);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, oldLength, flags, false);\n                }\n                if (this.task.done) {\n                    this.task = this.createAndBindAllViews(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindAllViews, this, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.attachViewsKeyed(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.attachViewsKeyed, this, flags);\n                }\n            }\n        }\n        else {\n            applyMutationsToIndices(indexMap);\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                // first detach+unbind+(remove from array) the deleted view indices\n                if (indexMap.deletedItems.length > 0) {\n                    indexMap.deletedItems.sort(compareNumber);\n                    if (this.task.done) {\n                        this.detachViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.detachViewsByKey, this, indexMap, flags);\n                    }\n                    if (this.task.done) {\n                        this.task = this.unbindAndRemoveViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByKey, this, indexMap, flags);\n                    }\n                }\n                // then insert new views at the \"added\" indices to bring the views array in aligment with indexMap size\n                if (this.task.done) {\n                    this.task = this.createAndBindNewViewsByKey(indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindNewViewsByKey, this, indexMap, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.sortViewsByKey(oldLength, indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.sortViewsByKey, this, oldLength, indexMap, flags);\n                }\n            }\n        }\n    }\n    // todo: subscribe to collection from inner expression\n    checkCollectionObserver(flags) {\n        const oldObserver = this.observer;\n        if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            const newObserver = this.observer = getCollectionObserver(flags, this.$controller.lifecycle, this.items);\n            if (oldObserver !== newObserver && oldObserver) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n            if (newObserver) {\n                newObserver.subscribeToCollection(this);\n            }\n        }\n        else {\n            if (oldObserver !== void 0) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n        }\n    }\n    normalizeToArray(flags) {\n        const items = this.items;\n        if (items instanceof Array) {\n            this.normalizedItems = items;\n            return;\n        }\n        const forOf = this.forOf;\n        if (forOf === void 0) {\n            return;\n        }\n        const normalizedItems = [];\n        this.forOf.iterate(flags, items, (arr, index, item) => {\n            normalizedItems[index] = item;\n        });\n        this.normalizedItems = normalizedItems;\n    }\n    detachViewsByRange(iStart, iEnd, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.detached.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.detached.end(flags);\n    }\n    unbindAndRemoveViewsByRange(iStart, iEnd, flags, adjustLength) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.unbound.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        if (adjustLength) {\n            this.views.length = iStart;\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.unbound.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.unbound.end, this.$controller.lifecycle.unbound, flags);\n    }\n    detachViewsByKey(indexMap, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.detached.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        for (let i = 0; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.detached.end(flags);\n    }\n    unbindAndRemoveViewsByKey(indexMap, flags) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.unbound.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        let i = 0;\n        for (; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        i = 0;\n        let j = 0;\n        for (; i < deletedLen; ++i) {\n            j = deleted[i] - i;\n            this.views.splice(j, 1);\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.unbound.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.unbound.end, this.$controller.lifecycle.unbound, flags);\n    }\n    createAndBindAllViews(flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.bound.begin();\n        const part = $controller.part;\n        const factory = this.factory;\n        const local = this.local;\n        const items = this.items;\n        const newLen = this.forOf.count(flags, items);\n        const views = this.views = Array(newLen);\n        this.forOf.iterate(flags, items, (arr, i, item) => {\n            view = views[i] = factory.create(flags);\n            view.parent = $controller;\n            viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, item));\n            setContextualProperties(viewScope.overrideContext, i, newLen);\n            task = view.bind(flags, viewScope, part);\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        });\n        if (tasks === undefined) {\n            lifecycle.bound.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.bound.end, lifecycle.bound, flags);\n    }\n    createAndBindNewViewsByKey(indexMap, flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const factory = this.factory;\n        const views = this.views;\n        const local = this.local;\n        const normalizedItems = this.normalizedItems;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.bound.begin();\n        const part = $controller.part;\n        const mapLen = indexMap.length;\n        for (let i = 0; i < mapLen; ++i) {\n            if (indexMap[i] === -2) {\n                view = factory.create(flags);\n                // TODO: test with map/set/undefined/null, make sure we can use strong typing here as well, etc\n                view.parent = $controller;\n                viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, normalizedItems[i]));\n                setContextualProperties(viewScope.overrideContext, i, mapLen);\n                // update all the rest oc\n                task = view.bind(flags, viewScope, part);\n                views.splice(i, 0, view);\n                if (!task.done) {\n                    if (tasks === undefined) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (views.length !== mapLen) {\n            // TODO: create error code and use reporter with more informative message\n            throw new Error(`viewsLen=${views.length}, mapLen=${mapLen}`);\n        }\n        if (tasks === undefined) {\n            lifecycle.bound.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.bound.end, lifecycle.bound, flags);\n    }\n    attachViews(indexMap, flags) {\n        let view;\n        const views = this.views;\n        const location = this.location;\n        const lifecycle = this.$controller.lifecycle;\n        lifecycle.attached.begin();\n        if (indexMap === void 0) {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                view = views[i];\n                view.hold(location, 1 /* insertBefore */);\n                view.nodes.unlink();\n                view.attach(flags);\n            }\n        }\n        else {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                if (indexMap[i] !== i) {\n                    view = views[i];\n                    view.hold(location, 1 /* insertBefore */);\n                    view.nodes.unlink();\n                    view.attach(flags);\n                }\n            }\n        }\n        lifecycle.attached.end(flags);\n    }\n    attachViewsKeyed(flags) {\n        let view;\n        const { views, location } = this;\n        this.$controller.lifecycle.attached.begin();\n        for (let i = 0, ii = views.length; i < ii; ++i) {\n            view = views[i];\n            view.hold(location, 1 /* insertBefore */);\n            view.nodes.unlink();\n            view.attach(flags);\n        }\n        this.$controller.lifecycle.attached.end(flags);\n    }\n    sortViewsByKey(oldLength, indexMap, flags) {\n        // TODO: integrate with tasks\n        const location = this.location;\n        const views = this.views;\n        const newLen = indexMap.length;\n        synchronizeIndices(views, indexMap);\n        // this algorithm retrieves the indices of the longest increasing subsequence of items in the repeater\n        // the items on those indices are not moved; this minimizes the number of DOM operations that need to be performed\n        const seq = longestIncreasingSubsequence(indexMap);\n        const seqLen = seq.length;\n        this.$controller.lifecycle.attached.begin();\n        flags |= 33554432 /* reorderNodes */;\n        let next;\n        let j = seqLen - 1;\n        let i = newLen - 1;\n        let view;\n        for (; i >= 0; --i) {\n            view = views[i];\n            if (indexMap[i] === -2) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.hold(location, 1 /* insertBefore */);\n                view.attach(flags);\n            }\n            else if (j < 0 || seqLen === 1 || i !== seq[j]) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.attach(flags);\n            }\n            else {\n                if (oldLength !== newLen) {\n                    setContextualProperties(view.scope.overrideContext, i, newLen);\n                }\n                --j;\n            }\n            next = views[i + 1];\n            if (next !== void 0) {\n                view.nodes.link(next.nodes);\n            }\n            else {\n                view.nodes.link(location);\n            }\n        }\n        this.$controller.lifecycle.attached.end(flags);\n    }\n};\n__decorate([\n    bindable\n], Repeat.prototype, \"items\", void 0);\nRepeat = __decorate([\n    templateController('repeat'),\n    __param(0, IRenderLocation),\n    __param(1, IController),\n    __param(2, IViewFactory)\n], Repeat);\nexport { Repeat };\nlet prevIndices;\nlet tailIndices;\nlet maxLen = 0;\n// Based on inferno's lis_algorithm @ https://github.com/infernojs/inferno/blob/master/packages/inferno/src/DOM/patching.ts#L732\n// with some tweaks to make it just a bit faster + account for IndexMap (and some names changes for readability)\n/** @internal */\nexport function longestIncreasingSubsequence(indexMap) {\n    const len = indexMap.length;\n    if (len > maxLen) {\n        maxLen = len;\n        prevIndices = new Int32Array(len);\n        tailIndices = new Int32Array(len);\n    }\n    let cursor = 0;\n    let cur = 0;\n    let prev = 0;\n    let i = 0;\n    let j = 0;\n    let low = 0;\n    let high = 0;\n    let mid = 0;\n    for (; i < len; i++) {\n        cur = indexMap[i];\n        if (cur !== -2) {\n            j = prevIndices[cursor];\n            prev = indexMap[j];\n            if (prev !== -2 && prev < cur) {\n                tailIndices[i] = j;\n                prevIndices[++cursor] = i;\n                continue;\n            }\n            low = 0;\n            high = cursor;\n            while (low < high) {\n                mid = (low + high) >> 1;\n                prev = indexMap[prevIndices[mid]];\n                if (prev !== -2 && prev < cur) {\n                    low = mid + 1;\n                }\n                else {\n                    high = mid;\n                }\n            }\n            prev = indexMap[prevIndices[low]];\n            if (cur < prev || prev === -2) {\n                if (low > 0) {\n                    tailIndices[i] = prevIndices[low - 1];\n                }\n                prevIndices[low] = i;\n            }\n        }\n    }\n    i = ++cursor;\n    const result = new Int32Array(i);\n    cur = prevIndices[cursor - 1];\n    while (cursor-- > 0) {\n        result[cursor] = cur;\n        cur = tailIndices[cur];\n    }\n    while (i-- > 0)\n        prevIndices[i] = 0;\n    return result;\n}\nfunction setContextualProperties(oc, index, length) {\n    const isFirst = index === 0;\n    const isLast = index === length - 1;\n    const isEven = index % 2 === 0;\n    oc.$index = index;\n    oc.$first = isFirst;\n    oc.$last = isLast;\n    oc.$middle = !isFirst && !isLast;\n    oc.$even = isEven;\n    oc.$odd = !isEven;\n    oc.$length = length;\n}\n//# sourceMappingURL=repeat.js.map","import { __decorate, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nlet Replaceable = class Replaceable {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    binding(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | 67108864 /* allowParentScopeTraversal */, this.$controller.scope, this.factory.name);\n    }\n    attaching(flags) {\n        this.view.attach(flags);\n    }\n    detaching(flags) {\n        this.view.detach(flags);\n    }\n    unbinding(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n};\nReplaceable = __decorate([\n    templateController('replaceable'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation)\n], Replaceable);\nexport { Replaceable };\n//# sourceMappingURL=replaceable.js.map","import { __decorate, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nimport { bindable } from '../../templating/bindable';\nimport { Scope } from '../../observation/binding-context';\nlet With = class With {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.bindChild(4096 /* fromBind */);\n        }\n    }\n    binding(flags) {\n        this.view.parent = this.$controller;\n        this.bindChild(flags);\n    }\n    attaching(flags) {\n        this.view.attach(flags);\n    }\n    detaching(flags) {\n        this.view.detach(flags);\n    }\n    unbinding(flags) {\n        this.view.unbind(flags);\n        this.view.parent = void 0;\n    }\n    bindChild(flags) {\n        const scope = Scope.fromParent(flags, this.$controller.scope, this.value === void 0 ? {} : this.value);\n        this.view.bind(flags, scope, this.$controller.part);\n    }\n};\n__decorate([\n    bindable\n], With.prototype, \"value\", void 0);\nWith = __decorate([\n    templateController('with'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation)\n], With);\nexport { With };\n//# sourceMappingURL=with.js.map","/* eslint-disable @typescript-eslint/no-use-before-define */\nimport { Protocol, Metadata, firstDefined, getPrototypeChain } from '@aurelia/kernel';\nexport function children(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @children\n            // Invocation with or w/o opts:\n            // - @children()\n            // - @children({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Children.name, ChildrenDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Children.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @children\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @children('bar')\n        // Direct call:\n        // - @children('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @children()\n    // - @children({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isChildrenObserverAnnotation(key) {\n    return key.startsWith(Children.name);\n}\nexport const Children = {\n    name: Protocol.annotation.keyFor('children-observer'),\n    keyFrom(name) {\n        return `${Children.name}:${name}`;\n    },\n    from(...childrenObserverLists) {\n        const childrenObservers = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            childrenObservers[name] = ChildrenDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            childrenObservers[name] = ChildrenDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof ChildrenDefinition) {\n                childrenObservers[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList));\n            }\n        }\n        childrenObserverLists.forEach(addList);\n        return childrenObservers;\n    },\n    getAll(Type) {\n        const propStart = Children.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isChildrenObserverAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Children.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class ChildrenDefinition {\n    constructor(callback, property, options, query, filter, map) {\n        this.callback = callback;\n        this.property = property;\n        this.options = options;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n    }\n    static create(prop, def = {}) {\n        return new ChildrenDefinition(firstDefined(def.callback, `${prop}Changed`), firstDefined(def.property, prop), def.options, def.query, def.filter, def.map);\n    }\n}\n//# sourceMappingURL=children.js.map","import { DI, Registration, Protocol, Metadata, mergeArrays, fromDefinitionOrDefault, pascalCase, fromAnnotationOrTypeOrDefault, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases, HooksDefinition, } from '../definitions';\nimport { Bindable } from '../templating/bindable';\nimport { Children } from '../templating/children';\nexport function customElement(nameOrDef) {\n    return function (target) {\n        return CustomElement.define(nameOrDef, target);\n    };\n}\nexport function useShadowDOM(targetOrOptions) {\n    if (targetOrOptions === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', { mode: 'open' });\n        };\n    }\n    if (typeof targetOrOptions !== 'function') {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', targetOrOptions);\n        };\n    }\n    CustomElement.annotate(targetOrOptions, 'shadowOptions', { mode: 'open' });\n}\nexport function containerless(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'containerless', true);\n        };\n    }\n    CustomElement.annotate(target, 'containerless', true);\n}\nexport function strict(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'isStrictBinding', true);\n        };\n    }\n    CustomElement.annotate(target, 'isStrictBinding', true);\n}\nexport class CustomElementDefinition {\n    constructor(Type, name, aliases, key, cache, template, instructions, dependencies, needsCompile, surrogates, bindables, childrenObservers, containerless, isStrictBinding, shadowOptions, hasSlots, strategy, hooks, scopeParts) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.cache = cache;\n        this.template = template;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.needsCompile = needsCompile;\n        this.surrogates = surrogates;\n        this.bindables = bindables;\n        this.childrenObservers = childrenObservers;\n        this.containerless = containerless;\n        this.isStrictBinding = isStrictBinding;\n        this.shadowOptions = shadowOptions;\n        this.hasSlots = hasSlots;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.scopeParts = scopeParts;\n    }\n    static create(nameOrDef, Type = null) {\n        if (Type === null) {\n            const def = nameOrDef;\n            if (typeof def === 'string') {\n                throw new Error(`Cannot create a custom element definition with only a name and no type: ${nameOrDef}`);\n            }\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            const name = fromDefinitionOrDefault('name', def, CustomElement.generateName);\n            if (typeof def.Type === 'function') {\n                // This needs to be a clone (it will usually be the compiler calling this signature)\n                // TODO: we need to make sure it's documented that passing in the type via the definition (while passing in null\n                // as the \"Type\" parameter) effectively skips type analysis, so it should only be used this way for cloning purposes.\n                Type = def.Type;\n            }\n            else {\n                Type = CustomElement.generateType(pascalCase(name));\n            }\n            return new CustomElementDefinition(Type, name, mergeArrays(def.aliases), fromDefinitionOrDefault('key', def, () => CustomElement.keyFrom(name)), fromDefinitionOrDefault('cache', def, () => 0), fromDefinitionOrDefault('template', def, () => null), mergeArrays(def.instructions), mergeArrays(def.dependencies), fromDefinitionOrDefault('needsCompile', def, () => true), mergeArrays(def.surrogates), Bindable.from(def.bindables), Children.from(def.childrenObservers), fromDefinitionOrDefault('containerless', def, () => false), fromDefinitionOrDefault('isStrictBinding', def, () => false), fromDefinitionOrDefault('shadowOptions', def, () => null), fromDefinitionOrDefault('hasSlots', def, () => false), fromDefinitionOrDefault('strategy', def, () => 1 /* getterSetter */), fromDefinitionOrDefault('hooks', def, () => HooksDefinition.none), mergeArrays(def.scopeParts));\n        }\n        // If a type is passed in, we ignore the Type property on the definition if it exists.\n        // TODO: document this behavior\n        if (typeof nameOrDef === 'string') {\n            return new CustomElementDefinition(Type, nameOrDef, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), Type.aliases), CustomElement.keyFrom(nameOrDef), fromAnnotationOrTypeOrDefault('cache', Type, () => 0), fromAnnotationOrTypeOrDefault('template', Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), Type.dependencies), fromAnnotationOrTypeOrDefault('needsCompile', Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers), fromAnnotationOrTypeOrDefault('containerless', Type, () => false), fromAnnotationOrTypeOrDefault('isStrictBinding', Type, () => false), fromAnnotationOrTypeOrDefault('shadowOptions', Type, () => null), fromAnnotationOrTypeOrDefault('hasSlots', Type, () => false), fromAnnotationOrTypeOrDefault('strategy', Type, () => 1 /* getterSetter */), \n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), Type.scopeParts));\n        }\n        // This is the typical default behavior, e.g. from regular CustomElement.define invocations or from @customElement deco\n        // The ViewValueConverter also uses this signature and passes in a definition where everything except for the 'hooks'\n        // property needs to be copied. So we have that exception for 'hooks', but we may need to revisit that default behavior\n        // if this turns out to be too opinionated.\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const name = fromDefinitionOrDefault('name', nameOrDef, CustomElement.generateName);\n        return new CustomElementDefinition(Type, name, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), nameOrDef.aliases, Type.aliases), CustomElement.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('cache', nameOrDef, Type, () => 0), fromAnnotationOrDefinitionOrTypeOrDefault('template', nameOrDef, Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), nameOrDef.instructions, Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), nameOrDef.dependencies, Type.dependencies), fromAnnotationOrDefinitionOrTypeOrDefault('needsCompile', nameOrDef, Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), nameOrDef.surrogates, Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables, nameOrDef.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers, nameOrDef.childrenObservers), fromAnnotationOrDefinitionOrTypeOrDefault('containerless', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('isStrictBinding', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('shadowOptions', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('hasSlots', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', nameOrDef, Type, () => 1 /* getterSetter */), \n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), nameOrDef.scopeParts, Type.scopeParts));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, CustomElement, key, container);\n    }\n}\nexport const CustomElement = {\n    name: Protocol.resource.keyFor('custom-element'),\n    keyFrom(name) {\n        return `${CustomElement.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomElement.name, value);\n    },\n    behaviorFor(node) {\n        return node.$controller;\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomElementDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        Metadata.define(CustomElement.name, definition, definition);\n        Protocol.resource.appendTo(definition.Type, CustomElement.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomElement.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n    generateName: (function () {\n        let id = 0;\n        return function () {\n            return `unnamed-${++id}`;\n        };\n    })(),\n    generateType: (function () {\n        const nameDescriptor = {\n            value: '',\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const defaultProto = {};\n        return function (name, proto = defaultProto) {\n            // Anonymous class ensures that minification cannot cause unintended side-effects, and keeps the class\n            // looking similarly from the outside (when inspected via debugger, etc).\n            const Type = class {\n            };\n            // Define the name property so that Type.name can be used by end users / plugin authors if they really need to,\n            // even when minified.\n            nameDescriptor.value = name;\n            Reflect.defineProperty(Type, 'name', nameDescriptor);\n            // Assign anything from the prototype that was passed in\n            if (proto !== defaultProto) {\n                Object.assign(Type.prototype, proto);\n            }\n            return Type;\n        };\n    })(),\n};\nexport const IProjectorLocator = DI.createInterface('IProjectorLocator').noDefault();\n//# sourceMappingURL=custom-element.js.map","import { __decorate, __param } from \"tslib\";\nimport { DI } from '@aurelia/kernel';\nimport { valueConverter } from '../value-converter';\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\nexport const ISanitizer = DI.createInterface('ISanitizer').withDefault(x => x.singleton(class {\n    sanitize(input) {\n        return input.replace(SCRIPT_REGEX, '');\n    }\n}));\n/**\n * Simple html sanitization converter to preserve whitelisted elements and attributes on a bound property containing html.\n */\nlet SanitizeValueConverter = class SanitizeValueConverter {\n    constructor(sanitizer) {\n        this.sanitizer = sanitizer;\n    }\n    /**\n     * Process the provided markup that flows to the view.\n     *\n     * @param untrustedMarkup - The untrusted markup to be sanitized.\n     */\n    toView(untrustedMarkup) {\n        if (untrustedMarkup == null) {\n            return null;\n        }\n        return this.sanitizer.sanitize(untrustedMarkup);\n    }\n};\nSanitizeValueConverter = __decorate([\n    valueConverter('sanitize'),\n    __param(0, ISanitizer)\n], SanitizeValueConverter);\nexport { SanitizeValueConverter };\n//# sourceMappingURL=sanitize.js.map","import { InstanceProvider, Reporter, RuntimeCompilationResources, } from '@aurelia/kernel';\nimport { ITargetedInstruction } from './definitions';\nimport { IDOM, IRenderLocation } from './dom';\nimport { IController, IViewFactory } from './lifecycle';\nimport { IRenderer, IRenderingEngine } from './rendering-engine';\nimport { CustomElement } from './resources/custom-element';\nexport class RenderContext {\n    constructor(dom, parentContainer, dependencies, componentType) {\n        this.dom = dom;\n        this.parentContainer = parentContainer;\n        this.dependencies = dependencies;\n        this.componentType = componentType;\n        const container = (this.container = parentContainer.createChild());\n        const renderableProvider = (this.renderableProvider = new InstanceProvider());\n        const elementProvider = (this.elementProvider = new InstanceProvider());\n        const instructionProvider = (this.instructionProvider = new InstanceProvider());\n        const factoryProvider = (this.factoryProvider = new ViewFactoryProvider());\n        const renderLocationProvider = (this.renderLocationProvider = new InstanceProvider());\n        this.renderer = container.get(IRenderer);\n        dom.registerElementResolver(container, elementProvider);\n        container.registerResolver(IViewFactory, factoryProvider);\n        container.registerResolver(IController, renderableProvider);\n        container.registerResolver(ITargetedInstruction, instructionProvider);\n        container.registerResolver(IRenderLocation, renderLocationProvider);\n        if (dependencies != void 0) {\n            container.register(...dependencies);\n        }\n        // If the element has a view, support Recursive Components by adding self to own view template container.\n        if (componentType) {\n            CustomElement.getDefinition(componentType).register(container);\n        }\n    }\n    get id() {\n        return this.container.id;\n    }\n    get path() {\n        return this.container.path;\n    }\n    get parentId() {\n        return this.parentContainer.id;\n    }\n    // #region IServiceLocator api\n    has(key, searchAncestors) {\n        return this.container.has(key, searchAncestors);\n    }\n    get(key) {\n        return this.container.get(key);\n    }\n    getAll(key) {\n        return this.container.getAll(key);\n    }\n    // #endregion\n    // #region IContainer api\n    register(...params) {\n        return this.container.register(...params);\n    }\n    registerResolver(key, resolver) {\n        return this.container.registerResolver(key, resolver);\n    }\n    registerTransformer(key, transformer) {\n        return this.container.registerTransformer(key, transformer);\n    }\n    getResolver(key, autoRegister) {\n        return this.container.getResolver(key, autoRegister);\n    }\n    getFactory(key) {\n        return this.container.getFactory(key);\n    }\n    createChild() {\n        return this.container.createChild();\n    }\n    // #endregion\n    render(flags, controller, targets, definition, host, parts) {\n        this.renderer.render(flags, this.dom, this, controller, targets, definition, host, parts);\n    }\n    beginComponentOperation(renderable, target, instruction, factory, parts, location) {\n        this.renderableProvider.prepare(renderable);\n        this.elementProvider.prepare(target);\n        this.instructionProvider.prepare(instruction);\n        if (factory) {\n            this.factoryProvider.prepare(factory, parts);\n        }\n        if (location) {\n            this.renderLocationProvider.prepare(location);\n        }\n        return this;\n    }\n    dispose() {\n        this.factoryProvider.dispose();\n        this.renderableProvider.dispose();\n        this.instructionProvider.dispose();\n        this.elementProvider.dispose();\n        this.renderLocationProvider.dispose();\n    }\n    createRuntimeCompilationResources() {\n        return new RuntimeCompilationResources(this.container);\n    }\n}\n/** @internal */\nexport class ViewFactoryProvider {\n    prepare(factory, parts) {\n        this.factory = factory;\n        factory.addParts(parts);\n    }\n    resolve(handler, requestor) {\n        const factory = this.factory;\n        if (factory == null) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        if (!factory.name || !factory.name.length) { // unmet invariant: factory must have a name\n            throw Reporter.error(51); // TODO: organize error codes\n        }\n        const found = factory.parts[factory.name];\n        if (found) {\n            const renderingEngine = handler.get(IRenderingEngine);\n            const dom = handler.get(IDOM);\n            return renderingEngine.getViewFactory(dom, found, requestor);\n        }\n        return factory;\n    }\n    dispose() {\n        this.factory = null;\n    }\n}\n//# sourceMappingURL=render-context.js.map","var ChildrenObserver_1;\nimport { __decorate, __param } from \"tslib\";\nimport { DI, IContainer, Reporter, Metadata, } from '@aurelia/kernel';\nimport { ILifecycle, } from './lifecycle';\nimport { subscriberCollection } from './observation/subscriber-collection';\nimport { RenderContext } from './render-context';\nimport { CustomElement, CustomElementDefinition, } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nimport { ViewFactory } from './templating/view';\nexport const ITemplateCompiler = DI.createInterface('ITemplateCompiler').noDefault();\nexport var ViewCompileFlags;\n(function (ViewCompileFlags) {\n    ViewCompileFlags[ViewCompileFlags[\"none\"] = 1] = \"none\";\n    ViewCompileFlags[ViewCompileFlags[\"surrogate\"] = 2] = \"surrogate\";\n    ViewCompileFlags[ViewCompileFlags[\"shadowDOM\"] = 4] = \"shadowDOM\";\n})(ViewCompileFlags || (ViewCompileFlags = {}));\nexport const ITemplateFactory = DI.createInterface('ITemplateFactory').noDefault();\n// This is the main implementation of ITemplate.\n// It is used to create instances of IController based on a compiled CustomElementDefinition.\n// TemplateDefinitions are hand-coded today, but will ultimately be the output of the\n// TemplateCompiler either through a JIT or AOT process.\n// Essentially, CompiledTemplate wraps up the small bit of code that is needed to take a CustomElementDefinition\n// and create instances of it on demand.\nexport class CompiledTemplate {\n    constructor(dom, definition, factory, renderContext) {\n        this.dom = dom;\n        this.definition = definition;\n        this.factory = factory;\n        this.renderContext = renderContext;\n    }\n    render(viewModelOrController, host, parts, flags = 0 /* none */) {\n        const controller = viewModelOrController instanceof Controller\n            ? viewModelOrController\n            : viewModelOrController.$controller;\n        if (controller == void 0) {\n            throw new Error(`Controller is missing from the view model`); // TODO: create error code\n        }\n        const nodes = controller.nodes = this.factory.createNodeSequence();\n        controller.context = this.renderContext;\n        controller.scopeParts = this.definition.scopeParts;\n        controller.isStrictBinding = this.definition.isStrictBinding;\n        flags |= this.definition.strategy;\n        this.renderContext.render(flags, controller, nodes.findTargets(), this.definition, host, parts);\n    }\n}\nexport const IInstructionRenderer = DI.createInterface('IInstructionRenderer').noDefault();\nexport const IRenderer = DI.createInterface('IRenderer').noDefault();\nexport const IRenderingEngine = DI.createInterface('IRenderingEngine').withDefault(x => x.singleton(RenderingEngine));\n/** @internal */\nlet RenderingEngine = class RenderingEngine {\n    constructor(container, templateFactory, lifecycle, compiler) {\n        this.container = container;\n        this.templateFactory = templateFactory;\n        this.lifecycle = lifecycle;\n        this.compiler = compiler;\n    }\n    getElementTemplate(dom, definition, parentContext, componentType) {\n        if (definition == void 0) {\n            return void 0;\n        }\n        if (parentContext == void 0) {\n            parentContext = this.container;\n        }\n        return this.templateFromSource(dom, definition, parentContext, componentType);\n    }\n    getViewFactory(dom, partialDefinition, parentContext) {\n        if (partialDefinition == void 0) {\n            throw new Error(`No definition provided`); // TODO: create error code\n        }\n        let definition;\n        if (partialDefinition instanceof CustomElementDefinition) {\n            definition = partialDefinition;\n        }\n        else if (Metadata.hasOwn(CustomElement.name, partialDefinition)) {\n            definition = Metadata.getOwn(CustomElement.name, partialDefinition);\n        }\n        else {\n            definition = CustomElementDefinition.create(partialDefinition);\n            // Make sure the full definition can be retrieved both from the partialDefinition as well as its dynamically created class\n            Metadata.define(CustomElement.name, definition, partialDefinition);\n            Metadata.define(CustomElement.name, definition, definition.Type);\n        }\n        if (parentContext == void 0) {\n            parentContext = this.container;\n        }\n        const factorykey = CustomElement.keyFrom(`${parentContext.path}:factory`);\n        let factory = Metadata.getOwn(factorykey, definition);\n        if (factory === void 0) {\n            const template = this.templateFromSource(dom, definition, parentContext, void 0);\n            factory = new ViewFactory(definition.name, template, this.lifecycle);\n            factory.setCacheSize(definition.cache, true);\n            Metadata.define(factorykey, factory, definition);\n        }\n        return factory;\n    }\n    templateFromSource(dom, definition, parentContext, componentType) {\n        const templateKey = CustomElement.keyFrom(`${parentContext.path}:template`);\n        let template = Metadata.getOwn(templateKey, definition);\n        if (template === void 0) {\n            template = this.templateFromSourceCore(dom, definition, parentContext, componentType);\n            Metadata.define(templateKey, template, definition);\n        }\n        return template;\n    }\n    templateFromSourceCore(dom, definition, parentContext, componentType) {\n        const renderContext = new RenderContext(dom, parentContext, definition.dependencies, componentType);\n        if (definition.template != void 0 && definition.needsCompile) {\n            const compiledDefinitionKey = CustomElement.keyFrom(`${parentContext.path}:compiled-definition`);\n            let compiledDefinition = Metadata.getOwn(compiledDefinitionKey, definition);\n            if (compiledDefinition === void 0) {\n                compiledDefinition = this.compiler.compile(dom, definition, renderContext.createRuntimeCompilationResources(), ViewCompileFlags.surrogate);\n                Metadata.define(compiledDefinitionKey, compiledDefinition, definition);\n            }\n            return this.templateFactory.create(renderContext, compiledDefinition);\n        }\n        return this.templateFactory.create(renderContext, definition);\n    }\n};\nRenderingEngine = __decorate([\n    __param(0, IContainer),\n    __param(1, ITemplateFactory),\n    __param(2, ILifecycle),\n    __param(3, ITemplateCompiler)\n], RenderingEngine);\nexport { RenderingEngine };\n/** @internal */\nlet ChildrenObserver = ChildrenObserver_1 = class ChildrenObserver {\n    constructor(controller, obj, flags, propertyKey, cbName, query = defaultChildQuery, filter = defaultChildFilter, map = defaultChildMap, options) {\n        this.controller = controller;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n        this.options = options;\n        this.observing = false;\n        this.children = (void 0);\n        this.callback = obj[cbName];\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.createGetterSetter();\n    }\n    getValue() {\n        this.tryStartObserving();\n        return this.children;\n    }\n    setValue(newValue) { }\n    subscribe(subscriber) {\n        this.tryStartObserving();\n        this.addSubscriber(subscriber);\n    }\n    tryStartObserving() {\n        if (!this.observing) {\n            this.observing = true;\n            const projector = this.controller.projector;\n            this.children = filterChildren(projector, this.query, this.filter, this.map);\n            projector.subscribeToChildrenChange(() => { this.onChildrenChanged(); }, this.options);\n        }\n    }\n    onChildrenChanged() {\n        this.children = filterChildren(this.controller.projector, this.query, this.filter, this.map);\n        if (this.callback !== void 0) {\n            this.callback.call(this.obj);\n        }\n        this.callSubscribers(this.children, undefined, this.persistentFlags | 16 /* updateTargetInstance */);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => this.getValue(),\n            set: () => { },\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nChildrenObserver = ChildrenObserver_1 = __decorate([\n    subscriberCollection()\n], ChildrenObserver);\nexport { ChildrenObserver };\nfunction defaultChildQuery(projector) {\n    return projector.children;\n}\nfunction defaultChildFilter(node, controller, viewModel) {\n    return !!viewModel;\n}\nfunction defaultChildMap(node, controller, viewModel) {\n    return viewModel;\n}\n/** @internal */\nexport function filterChildren(projector, query, filter, map) {\n    const nodes = query(projector);\n    const children = [];\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n        const node = nodes[i];\n        const controller = CustomElement.behaviorFor(node);\n        const viewModel = controller ? controller.viewModel : null;\n        if (filter(node, controller, viewModel)) {\n            children.push(map(node, controller, viewModel));\n        }\n    }\n    return children;\n}\n//# sourceMappingURL=rendering-engine.js.map","import { mergeDistinct, nextId, PLATFORM, } from '@aurelia/kernel';\nimport { HooksDefinition } from '../definitions';\nimport { IDOM } from '../dom';\nimport { ILifecycle, } from '../lifecycle';\nimport { AggregateContinuationTask, ContinuationTask, hasAsyncWork, LifecycleTask, } from '../lifecycle-task';\nimport { Scope, } from '../observation/binding-context';\nimport { ProxyObserver, } from '../observation/proxy-observer';\nimport { SelfObserver, } from '../observation/self-observer';\nimport { ChildrenObserver, IRenderingEngine, } from '../rendering-engine';\nimport { IProjectorLocator, CustomElement } from '../resources/custom-element';\nimport { CustomAttribute } from '../resources/custom-attribute';\nexport class Controller {\n    // todo: refactor\n    constructor(vmKind, flags, viewCache, lifecycle, viewModel, parentContext, host, options) {\n        this.vmKind = vmKind;\n        this.flags = flags;\n        this.viewCache = viewCache;\n        this.lifecycle = lifecycle;\n        this.viewModel = viewModel;\n        this.parentContext = parentContext;\n        this.host = host;\n        this.id = nextId('au$component');\n        this.nextBound = void 0;\n        this.nextUnbound = void 0;\n        this.prevBound = void 0;\n        this.prevUnbound = void 0;\n        this.nextAttached = void 0;\n        this.nextDetached = void 0;\n        this.prevAttached = void 0;\n        this.prevDetached = void 0;\n        this.nextMount = void 0;\n        this.nextUnmount = void 0;\n        this.prevMount = void 0;\n        this.prevUnmount = void 0;\n        this.parent = void 0;\n        this.bindings = void 0;\n        this.controllers = void 0;\n        this.state = 0 /* none */;\n        this.mountStrategy = 1 /* insertBefore */;\n        switch (vmKind) {\n            case 2 /* synthetic */: {\n                if (viewCache == void 0) {\n                    // TODO: create error code\n                    throw new Error(`No IViewCache was provided when rendering a synthetic view.`);\n                }\n                this.hooks = HooksDefinition.none;\n                this.bindingContext = void 0; // stays undefined\n                this.host = void 0; // stays undefined\n                this.vmKind = 2 /* synthetic */;\n                this.scopeParts = void 0; // will be populated during ITemplate.render() immediately after the constructor is done\n                this.isStrictBinding = false; // will be populated during ITemplate.render() immediately after the constructor is done\n                this.scope = void 0; // will be populated during bindSynthetic()\n                this.projector = void 0; // stays undefined\n                this.nodes = void 0; // will be populated during ITemplate.render() immediately after the constructor is done\n                this.context = void 0; // will be populated during ITemplate.render() immediately after the constructor is done\n                this.location = void 0; // should be set with `hold(location)` by the consumer\n                break;\n            }\n            case 0 /* customElement */: {\n                if (parentContext == void 0) {\n                    // TODO: create error code\n                    throw new Error(`No parentContext was provided when rendering a custom element.`);\n                }\n                if (viewModel == void 0) {\n                    // TODO: create error code\n                    throw new Error(`No viewModel was provided when rendering a custom elemen.`);\n                }\n                if (host == void 0) {\n                    // TODO: create error code\n                    throw new Error(`No host element was provided when rendering a custom element.`);\n                }\n                const Type = viewModel.constructor;\n                const definition = CustomElement.getDefinition(Type);\n                flags |= definition.strategy;\n                createObservers(this, definition, flags, viewModel);\n                this.hooks = definition.hooks;\n                this.bindingContext = getBindingContext(flags, viewModel);\n                const renderingEngine = parentContext.get(IRenderingEngine);\n                let instruction;\n                let parts;\n                let template = void 0;\n                if (this.hooks.hasRender) {\n                    const result = this.bindingContext.render(flags, host, options.parts == void 0\n                        ? PLATFORM.emptyObject\n                        : options.parts, parentContext);\n                    if (result != void 0 && 'getElementTemplate' in result) {\n                        template = result.getElementTemplate(renderingEngine, Type, parentContext);\n                    }\n                }\n                else {\n                    template = renderingEngine.getElementTemplate(parentContext.get(IDOM), definition, parentContext, Type);\n                }\n                if (template !== void 0) {\n                    if (template.definition == null ||\n                        template.definition.instructions.length === 0 ||\n                        template.definition.instructions[0].length === 0 ||\n                        (template.definition.instructions[0][0].parts == void 0)) {\n                        if (options.parts == void 0) {\n                            parts = PLATFORM.emptyObject;\n                        }\n                        else {\n                            parts = options.parts;\n                        }\n                    }\n                    else {\n                        instruction = template.definition.instructions[0][0];\n                        if (options.parts == void 0) {\n                            parts = instruction.parts;\n                        }\n                        else {\n                            parts = { ...options.parts, ...instruction.parts };\n                        }\n                    }\n                    template.render(this, host, parts);\n                }\n                this.scope = Scope.create(flags, this.bindingContext, null);\n                this.projector = parentContext.get(IProjectorLocator).getElementProjector(parentContext.get(IDOM), this, host, template !== void 0 ? template.definition : definition);\n                this.location = void 0;\n                viewModel.$controller = this;\n                if (this.hooks.hasCreated) {\n                    this.bindingContext.created(flags);\n                }\n                break;\n            }\n            case 1 /* customAttribute */: {\n                if (parentContext == void 0) {\n                    // TODO: create error code\n                    throw new Error(`No parentContext was provided when rendering a custom element or attribute.`);\n                }\n                if (viewModel == void 0) {\n                    // TODO: create error code\n                    throw new Error(`No viewModel was provided when rendering a custom elemen.`);\n                }\n                const Type = viewModel.constructor;\n                const definition = CustomAttribute.getDefinition(Type);\n                flags |= definition.strategy;\n                createObservers(this, definition, flags, viewModel);\n                this.hooks = definition.hooks;\n                this.bindingContext = getBindingContext(flags, viewModel);\n                this.scope = void 0;\n                this.projector = void 0;\n                this.nodes = void 0;\n                this.context = void 0;\n                this.location = void 0;\n                viewModel.$controller = this;\n                if (this.hooks.hasCreated) {\n                    this.bindingContext.created(flags);\n                }\n                break;\n            }\n            default:\n                throw new Error(`Invalid ViewModelKind: ${vmKind}`);\n        }\n    }\n    static forCustomElement(viewModel, parentContext, host, flags = 0 /* none */, options = PLATFORM.emptyObject) {\n        let controller = Controller.lookup.get(viewModel);\n        if (controller === void 0) {\n            controller = new Controller(0 /* customElement */, flags, void 0, parentContext.get(ILifecycle), viewModel, parentContext, host, options);\n            this.lookup.set(viewModel, controller);\n        }\n        return controller;\n    }\n    static forCustomAttribute(viewModel, parentContext, flags = 0 /* none */) {\n        let controller = Controller.lookup.get(viewModel);\n        if (controller === void 0) {\n            controller = new Controller(1 /* customAttribute */, flags | 4 /* isStrictBindingStrategy */, void 0, parentContext.get(ILifecycle), viewModel, parentContext, void 0, PLATFORM.emptyObject);\n            this.lookup.set(viewModel, controller);\n        }\n        return controller;\n    }\n    static forSyntheticView(viewCache, lifecycle, flags = 0 /* none */) {\n        return new Controller(2 /* synthetic */, flags, viewCache, lifecycle, void 0, void 0, void 0, PLATFORM.emptyObject);\n    }\n    lockScope(scope) {\n        this.scope = scope;\n        this.state |= 16384 /* hasLockedScope */;\n    }\n    hold(location, mountStrategy) {\n        this.state = (this.state | 32768 /* canBeCached */) ^ 32768 /* canBeCached */;\n        this.location = location;\n        this.mountStrategy = mountStrategy;\n    }\n    release(flags) {\n        this.state |= 32768 /* canBeCached */;\n        if ((this.state & 32 /* isAttached */) > 0) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            return this.viewCache.canReturnToCache(this); // non-null is implied by the hook\n        }\n        return this.unmountSynthetic(flags);\n    }\n    bind(flags, scope, part) {\n        this.part = part;\n        // TODO: benchmark which of these techniques is fastest:\n        // - the current one (enum with switch)\n        // - set the name of the method in the constructor, e.g. this.bindMethod = 'bindCustomElement'\n        //    and then doing this[this.bindMethod](flags, scope) instead of switch (eliminates branching\n        //    but computed property access might be harmful to browser optimizations)\n        // - make bind() a property and set it to one of the 3 methods in the constructor,\n        //    e.g. this.bind = this.bindCustomElement (eliminates branching + reduces call stack depth by 1,\n        //    but might make the call site megamorphic)\n        flags |= 4096 /* fromBind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.bindCustomElement(flags, scope);\n            case 1 /* customAttribute */:\n                return this.bindCustomAttribute(flags, scope);\n            case 2 /* synthetic */:\n                return this.bindSynthetic(flags, scope);\n        }\n    }\n    unbind(flags) {\n        flags |= 8192 /* fromUnbind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.unbindCustomElement(flags);\n            case 1 /* customAttribute */:\n                return this.unbindCustomAttribute(flags);\n            case 2 /* synthetic */:\n                return this.unbindSynthetic(flags);\n        }\n    }\n    bound(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.bound(flags); // non-null is implied by the hook\n    }\n    unbound(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.unbound(flags); // non-null is implied by the hook\n    }\n    attach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) > 0 && (flags & 33554432 /* reorderNodes */) === 0) {\n            return;\n        }\n        flags |= 16384 /* fromAttach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.attachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.attachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.attachSynthetic(flags);\n        }\n    }\n    detach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return;\n        }\n        flags |= 32768 /* fromDetach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.detachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.detachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.detachSynthetic(flags);\n        }\n    }\n    attached(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.attached(flags); // non-null is implied by the hook\n    }\n    detached(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.detached(flags); // non-null is implied by the hook\n    }\n    mount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.mountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.mountSynthetic(flags);\n        }\n    }\n    unmount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.unmountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.unmountSynthetic(flags);\n        }\n    }\n    cache(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.cacheCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.cacheCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.cacheSynthetic(flags);\n        }\n    }\n    getTargetAccessor(propertyName) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const binding = bindings.find(b => b.targetProperty === propertyName);\n            if (binding !== void 0) {\n                return binding.targetObserver;\n            }\n        }\n        return void 0;\n    }\n    // #region bind/unbind\n    bindCustomElement(flags, scope) {\n        const $scope = this.scope;\n        $scope.parentScope = scope === void 0 ? null : scope;\n        $scope.scopeParts = this.scopeParts;\n        if ((this.state & 4 /* isBound */) > 0) {\n            return LifecycleTask.done;\n        }\n        flags |= 4096 /* fromBind */;\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.bound.begin();\n        this.bindBindings(flags, $scope);\n        if (this.hooks.hasBinding) {\n            const ret = this.bindingContext.binding(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.bindControllers, this, flags, $scope);\n            }\n        }\n        return this.bindControllers(flags, $scope);\n    }\n    bindCustomAttribute(flags, scope) {\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        this.state |= 1 /* isBinding */;\n        this.scope = scope;\n        this.lifecycle.bound.begin();\n        if (this.hooks.hasBinding) {\n            const ret = this.bindingContext.binding(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endBind, this, flags);\n            }\n        }\n        this.endBind(flags);\n        return LifecycleTask.done;\n    }\n    bindSynthetic(flags, scope) {\n        if (scope == void 0) {\n            throw new Error(`Scope is null or undefined`); // TODO: create error code\n        }\n        scope.scopeParts = mergeDistinct(scope.scopeParts, this.scopeParts, false);\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope || (this.state & 16384 /* hasLockedScope */) > 0) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        if ((this.state & 16384 /* hasLockedScope */) === 0) {\n            this.scope = scope;\n        }\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.bound.begin();\n        this.bindBindings(flags, scope);\n        return this.bindControllers(flags, scope);\n    }\n    bindBindings(flags, scope) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const { length } = bindings;\n            if (this.isStrictBinding) {\n                flags |= 4 /* isStrictBindingStrategy */;\n            }\n            for (let i = 0; i < length; ++i) {\n                bindings[i].$bind(flags, scope, this.part);\n            }\n        }\n    }\n    bindControllers(flags, scope) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].parent = this;\n                task = controllers[i].bind(flags, scope, this.part);\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.endBind(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.endBind, this, flags);\n    }\n    endBind(flags) {\n        if (this.hooks.hasBound) {\n            this.lifecycle.bound.add(this);\n        }\n        this.state = this.state ^ 1 /* isBinding */ | 4 /* isBound */;\n        this.lifecycle.bound.end(flags);\n    }\n    unbindCustomElement(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.scope.parentScope = null;\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.unbound.begin();\n        if (this.hooks.hasUnbinding) {\n            const ret = this.bindingContext.unbinding(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.unbindControllers, this, flags);\n            }\n        }\n        return this.unbindControllers(flags);\n    }\n    unbindCustomAttribute(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.unbound.begin();\n        if (this.hooks.hasUnbinding) {\n            const ret = this.bindingContext.unbinding(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endUnbind, this, flags);\n            }\n        }\n        this.endUnbind(flags);\n        return LifecycleTask.done;\n    }\n    unbindSynthetic(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.unbound.begin();\n        return this.unbindControllers(flags);\n    }\n    unbindBindings(flags) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            for (let i = bindings.length - 1; i >= 0; --i) {\n                bindings[i].$unbind(flags);\n            }\n        }\n        this.endUnbind(flags);\n    }\n    unbindControllers(flags) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                task = controllers[i].unbind(flags);\n                controllers[i].parent = void 0;\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.unbindBindings(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.unbindBindings, this, flags);\n    }\n    endUnbind(flags) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */:\n                this.scope = void 0;\n                break;\n            case 2 /* synthetic */:\n                if ((this.state & 16384 /* hasLockedScope */) === 0) {\n                    this.scope = void 0;\n                }\n        }\n        if (this.hooks.hasUnbound) {\n            this.lifecycle.unbound.add(this);\n        }\n        this.state = (this.state | 6 /* isBoundOrUnbinding */) ^ 6 /* isBoundOrUnbinding */;\n        this.lifecycle.unbound.end(flags);\n    }\n    // #endregion\n    // #region attach/detach\n    attachCustomElement(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.mount.add(this);\n        this.lifecycle.attached.begin();\n        if (this.hooks.hasAttaching) {\n            this.bindingContext.attaching(flags);\n        }\n        this.attachControllers(flags);\n        if (this.hooks.hasAttached) {\n            this.lifecycle.attached.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.attached.end(flags);\n    }\n    attachCustomAttribute(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.attached.begin();\n        if (this.hooks.hasAttaching) {\n            this.bindingContext.attaching(flags);\n        }\n        if (this.hooks.hasAttached) {\n            this.lifecycle.attached.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.attached.end(flags);\n    }\n    attachSynthetic(flags) {\n        if (((this.state & 32 /* isAttached */) > 0 && flags & 33554432 /* reorderNodes */) > 0) {\n            this.lifecycle.mount.add(this);\n        }\n        else {\n            flags |= 16384 /* fromAttach */;\n            this.state |= 8 /* isAttaching */;\n            this.lifecycle.mount.add(this);\n            this.lifecycle.attached.begin();\n            this.attachControllers(flags);\n            this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n            this.lifecycle.attached.end(flags);\n        }\n    }\n    detachCustomElement(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.detached.begin();\n        this.lifecycle.unmount.add(this);\n        if (this.hooks.hasDetaching) {\n            this.bindingContext.detaching(flags);\n        }\n        this.detachControllers(flags);\n        if (this.hooks.hasDetached) {\n            this.lifecycle.detached.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.detached.end(flags);\n    }\n    detachCustomAttribute(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.detached.begin();\n        if (this.hooks.hasDetaching) {\n            this.bindingContext.detaching(flags);\n        }\n        if (this.hooks.hasDetached) {\n            this.lifecycle.detached.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.detached.end(flags);\n    }\n    detachSynthetic(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.detached.begin();\n        this.lifecycle.unmount.add(this);\n        this.detachControllers(flags);\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.detached.end(flags);\n    }\n    attachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].attach(flags);\n            }\n        }\n    }\n    detachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                controllers[i].detach(flags);\n            }\n        }\n    }\n    // #endregion\n    // #region mount/unmount/cache\n    mountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) > 0) {\n            return;\n        }\n        this.state |= 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.project(this.nodes); // non-null is implied by the hook\n    }\n    mountSynthetic(flags) {\n        const nodes = this.nodes; // non null is implied by the hook\n        const location = this.location; // non null is implied by the hook\n        this.state |= 64 /* isMounted */;\n        switch (this.mountStrategy) {\n            case 2 /* append */:\n                nodes.appendTo(location);\n                break;\n            default:\n                nodes.insertBefore(location);\n        }\n    }\n    unmountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.take(this.nodes); // non-null is implied by the hook\n    }\n    unmountSynthetic(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return false;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.nodes.remove(); // non-null is implied by the hook\n        this.nodes.unlink();\n        if ((this.state & 32768 /* canBeCached */) > 0) {\n            this.state = (this.state | 32768 /* canBeCached */) ^ 32768 /* canBeCached */;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            if (this.viewCache.tryReturnToCache(this)) { // non-null is implied by the hook\n                this.state |= 128 /* isCached */;\n                return true;\n            }\n        }\n        return false;\n    }\n    cacheCustomElement(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n    }\n    cacheCustomAttribute(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n    cacheSynthetic(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n}\nController.lookup = new WeakMap();\nfunction createObservers(controller, description, flags, instance) {\n    const hasLookup = instance.$observers != void 0;\n    const observers = hasLookup ? instance.$observers : {};\n    const bindables = description.bindables;\n    const observableNames = Object.getOwnPropertyNames(bindables);\n    const useProxy = (flags & 2 /* proxyStrategy */) > 0;\n    const lifecycle = controller.lifecycle;\n    const hasChildrenObservers = 'childrenObservers' in description;\n    const length = observableNames.length;\n    let name;\n    for (let i = 0; i < length; ++i) {\n        name = observableNames[i];\n        if (observers[name] == void 0) {\n            observers[name] = new SelfObserver(lifecycle, flags, useProxy ? ProxyObserver.getOrCreate(instance).proxy : instance, name, bindables[name].callback);\n        }\n    }\n    if (hasChildrenObservers) {\n        const childrenObservers = description.childrenObservers;\n        if (childrenObservers) {\n            const childObserverNames = Object.getOwnPropertyNames(childrenObservers);\n            const { length } = childObserverNames;\n            let name;\n            for (let i = 0; i < length; ++i) {\n                name = childObserverNames[i];\n                if (observers[name] == void 0) {\n                    const childrenDescription = childrenObservers[name];\n                    observers[name] = new ChildrenObserver(controller, instance, flags, name, childrenDescription.callback, childrenDescription.query, childrenDescription.filter, childrenDescription.map, childrenDescription.options);\n                }\n            }\n        }\n    }\n    if (!useProxy || hasChildrenObservers) {\n        Reflect.defineProperty(instance, '$observers', {\n            enumerable: false,\n            value: observers\n        });\n    }\n}\nfunction getBindingContext(flags, instance) {\n    if (instance.noProxy === true || (flags & 2 /* proxyStrategy */) === 0) {\n        return instance;\n    }\n    return ProxyObserver.getOrCreate(instance).proxy;\n}\n//# sourceMappingURL=controller.js.map","import { DI, PLATFORM, Registration, Reporter, Metadata, Protocol } from '@aurelia/kernel';\nimport { Scope } from '../observation/binding-context';\nimport { CustomElement, CustomElementDefinition } from '../resources/custom-element';\nimport { Controller } from './controller';\nexport class ViewFactory {\n    constructor(name, template, lifecycle) {\n        this.name = name;\n        this.template = template;\n        this.lifecycle = lifecycle;\n        this.isCaching = false;\n        this.parts = PLATFORM.emptyObject;\n        this.cache = null;\n        this.cacheSize = -1;\n    }\n    get parentContextId() {\n        return this.template.renderContext.parentId;\n    }\n    setCacheSize(size, doNotOverrideIfAlreadySet) {\n        if (size) {\n            if (size === '*') {\n                size = ViewFactory.maxCacheSize;\n            }\n            else if (typeof size === 'string') {\n                size = parseInt(size, 10);\n            }\n            if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n                this.cacheSize = size;\n            }\n        }\n        if (this.cacheSize > 0) {\n            this.cache = [];\n        }\n        else {\n            this.cache = null;\n        }\n        this.isCaching = this.cacheSize > 0;\n    }\n    canReturnToCache(controller) {\n        return this.cache != null && this.cache.length < this.cacheSize;\n    }\n    tryReturnToCache(controller) {\n        if (this.canReturnToCache(controller)) {\n            controller.cache(0 /* none */);\n            this.cache.push(controller);\n            return true;\n        }\n        return false;\n    }\n    create(flags) {\n        const cache = this.cache;\n        let controller;\n        if (cache != null && cache.length > 0) {\n            controller = cache.pop();\n            controller.state = (controller.state | 128 /* isCached */) ^ 128 /* isCached */;\n            return controller;\n        }\n        controller = Controller.forSyntheticView(this, this.lifecycle, flags);\n        this.template.render(controller, null, this.parts, flags);\n        if (!controller.nodes) {\n            throw Reporter.error(90);\n        }\n        return controller;\n    }\n    addParts(parts) {\n        if (Object.keys(parts).length > 0) {\n            this.parts = { ...this.parts, ...parts };\n        }\n    }\n}\nViewFactory.maxCacheSize = 0xFFFF;\nconst seenViews = new WeakSet();\nfunction notYetSeen($view) {\n    return !seenViews.has($view);\n}\nfunction toCustomElementDefinition($view) {\n    seenViews.add($view);\n    return CustomElementDefinition.create($view);\n}\nexport const Views = {\n    name: Protocol.resource.keyFor('views'),\n    has(value) {\n        return typeof value === 'function' && (Metadata.hasOwn(Views.name, value) || '$views' in value);\n    },\n    get(value) {\n        if (typeof value === 'function' && '$views' in value) {\n            // TODO: a `get` operation with side effects is not a good thing. Should refactor this to a proper resource kind.\n            const $views = value.$views;\n            const definitions = $views.filter(notYetSeen).map(toCustomElementDefinition);\n            for (const def of definitions) {\n                Views.add(value, def);\n            }\n        }\n        let views = Metadata.getOwn(Views.name, value);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [], value);\n        }\n        return views;\n    },\n    add(Type, partialDefinition) {\n        const definition = CustomElementDefinition.create(partialDefinition);\n        let views = Metadata.getOwn(Views.name, Type);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [definition], Type);\n        }\n        else {\n            views.push(definition);\n        }\n        return views;\n    },\n};\nexport function view(v) {\n    return function (target) {\n        Views.add(target, v);\n    };\n}\nexport const IViewLocator = DI.createInterface('IViewLocator')\n    .noDefault();\nconst lifecycleCallbacks = [\n    'binding',\n    'bound',\n    'attaching',\n    'attached',\n    'detaching',\n    'caching',\n    'detached',\n    'unbinding',\n    'unbound'\n];\nexport class ViewLocator {\n    constructor() {\n        this.modelInstanceToBoundComponent = new WeakMap();\n        this.modelTypeToUnboundComponent = new Map();\n    }\n    static register(container) {\n        return Registration.singleton(IViewLocator, this).register(container);\n    }\n    getViewComponentForObject(object, viewNameOrSelector) {\n        if (object) {\n            const availableViews = Views.has(object.constructor) ? Views.get(object.constructor) : [];\n            const resolvedViewName = typeof viewNameOrSelector === 'function'\n                ? viewNameOrSelector(object, availableViews)\n                : this.getViewName(availableViews, viewNameOrSelector);\n            return this.getOrCreateBoundComponent(object, availableViews, resolvedViewName);\n        }\n        return null;\n    }\n    getOrCreateBoundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelInstanceToBoundComponent.get(object);\n        let BoundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelInstanceToBoundComponent.set(object, lookup);\n        }\n        else {\n            BoundComponent = lookup[resolvedViewName];\n        }\n        if (BoundComponent === void 0) {\n            const UnboundComponent = this.getOrCreateUnboundComponent(object, availableViews, resolvedViewName);\n            BoundComponent = CustomElement.define(CustomElement.getDefinition(UnboundComponent), class extends UnboundComponent {\n                constructor() {\n                    super(object);\n                }\n            });\n            lookup[resolvedViewName] = BoundComponent;\n        }\n        return BoundComponent;\n    }\n    getOrCreateUnboundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelTypeToUnboundComponent.get(object.constructor);\n        let UnboundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelTypeToUnboundComponent.set(object.constructor, lookup);\n        }\n        else {\n            UnboundComponent = lookup[resolvedViewName];\n        }\n        if (UnboundComponent === void 0) {\n            UnboundComponent = CustomElement.define(this.getView(availableViews, resolvedViewName), class {\n                constructor(viewModel) {\n                    this.viewModel = viewModel;\n                }\n                created(flags) {\n                    this.$controller.scope = Scope.fromParent(flags, this.$controller.scope, this.viewModel);\n                    if (this.viewModel.created) {\n                        this.viewModel.created(flags);\n                    }\n                }\n            });\n            const proto = UnboundComponent.prototype;\n            lifecycleCallbacks.forEach(x => {\n                if (x in object) {\n                    const fn = function (flags) { return this.viewModel[x](flags); };\n                    Reflect.defineProperty(fn, 'name', { configurable: true, value: x });\n                    proto[x] = fn;\n                }\n            });\n            lookup[resolvedViewName] = UnboundComponent;\n        }\n        return UnboundComponent;\n    }\n    getViewName(views, requestedName) {\n        if (requestedName) {\n            return requestedName;\n        }\n        if (views.length === 1) {\n            return views[0].name;\n        }\n        return 'default-view';\n    }\n    getView(views, name) {\n        const v = views.find(x => x.name === name);\n        if (v === void 0) {\n            // TODO: Use Reporter\n            throw new Error(`Could not find view: ${name}`);\n        }\n        return v;\n    }\n}\n//# sourceMappingURL=view.js.map","import { __decorate, __param } from \"tslib\";\nimport { IViewLocator } from '../../templating/view';\nimport { valueConverter } from '../value-converter';\nlet ViewValueConverter = class ViewValueConverter {\n    constructor(viewLocator) {\n        this.viewLocator = viewLocator;\n    }\n    toView(object, viewNameOrSelector) {\n        return this.viewLocator.getViewComponentForObject(object, viewNameOrSelector);\n    }\n};\nViewValueConverter = __decorate([\n    valueConverter('view'),\n    __param(0, IViewLocator)\n], ViewValueConverter);\nexport { ViewValueConverter };\n//# sourceMappingURL=view.js.map","import { DI, Registration, } from '@aurelia/kernel';\nimport { ContinuationTask, IStartTaskManager, } from './lifecycle-task';\nimport { Controller } from './templating/controller';\nexport const IActivator = DI.createInterface('IActivator').withDefault(x => x.singleton(Activator));\n/** @internal */\nexport class Activator {\n    constructor(taskManager) {\n        this.taskManager = taskManager;\n    }\n    static register(container) {\n        return Registration.singleton(IActivator, this).register(container);\n    }\n    activate(host, component, locator, flags = 1024 /* fromStartTask */, parentScope) {\n        flags = flags === void 0 ? 0 /* none */ : flags;\n        const mgr = this.taskManager;\n        let task = mgr.runBeforeRender();\n        if (task.done) {\n            this.render(host, component, locator, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.render, this, host, component, locator, flags);\n        }\n        if (task.done) {\n            task = mgr.runBeforeBind();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeBind, mgr);\n        }\n        if (task.done) {\n            task = this.bind(component, flags, parentScope);\n        }\n        else {\n            task = new ContinuationTask(task, this.bind, this, component, flags, parentScope);\n        }\n        if (task.done) {\n            task = mgr.runBeforeAttach();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeAttach, mgr);\n        }\n        if (task.done) {\n            this.attach(component, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attach, this, component, flags);\n        }\n        return task;\n    }\n    deactivate(component, flags = 2048 /* fromStopTask */) {\n        const controller = this.getController(component);\n        controller.detach(flags | 32768 /* fromDetach */);\n        return controller.unbind(flags | 8192 /* fromUnbind */);\n    }\n    render(host, component, locator, flags) {\n        Controller.forCustomElement(component, locator, host, flags);\n    }\n    bind(component, flags, parentScope) {\n        return this.getController(component).bind(flags | 4096 /* fromBind */, parentScope);\n    }\n    attach(component, flags) {\n        this.getController(component).attach(flags | 16384 /* fromAttach */);\n    }\n    getController(component) {\n        return Controller.forCustomElement(component, (void 0), (void 0));\n    }\n}\nActivator.inject = [IStartTaskManager];\n//# sourceMappingURL=activator.js.map","import { DI, PLATFORM, Registration } from '@aurelia/kernel';\nimport { IActivator } from './activator';\nimport { INode } from './dom';\nimport { ILifecycle, } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, LifecycleTask, } from './lifecycle-task';\nimport { CustomElement, } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nexport class CompositionRoot {\n    constructor(config, container) {\n        this.config = config;\n        if (config.host != void 0) {\n            if (container.has(INode, false)) {\n                this.container = container.createChild();\n            }\n            else {\n                this.container = container;\n            }\n            Registration.instance(INode, config.host).register(this.container);\n            this.host = config.host;\n        }\n        else if (container.has(INode, true)) {\n            this.container = container;\n            this.host = container.get(INode);\n        }\n        else {\n            throw new Error(`No host element found.`);\n        }\n        this.strategy = config.strategy != void 0 ? config.strategy : 1 /* getterSetter */;\n        const initializer = this.container.get(IDOMInitializer);\n        this.dom = initializer.initialize(config);\n        this.lifecycle = this.container.get(ILifecycle);\n        this.activator = this.container.get(IActivator);\n        const taskManager = this.container.get(IStartTaskManager);\n        const beforeCreateTask = taskManager.runBeforeCreate();\n        if (beforeCreateTask.done) {\n            this.task = LifecycleTask.done;\n            this.create();\n        }\n        else {\n            this.task = new ContinuationTask(beforeCreateTask, this.create, this);\n        }\n    }\n    activate(antecedent) {\n        const { task, host, viewModel, container, activator, strategy } = this;\n        const flags = strategy | 1024 /* fromStartTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.activate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.activate(host, viewModel, container, flags, void 0);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        return this.task;\n    }\n    deactivate(antecedent) {\n        const { task, viewModel, activator, strategy } = this;\n        const flags = strategy | 2048 /* fromStopTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.deactivate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.deactivate(viewModel, flags);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.deactivate, activator, viewModel, flags);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        return this.task;\n    }\n    create() {\n        const config = this.config;\n        this.viewModel = CustomElement.isType(config.component)\n            ? this.container.get(config.component)\n            : config.component;\n        this.controller = Controller.forCustomElement(this.viewModel, this.container, this.host, this.strategy);\n    }\n}\nexport class Aurelia {\n    constructor(container = DI.createContainer()) {\n        this.container = container;\n        this.task = LifecycleTask.done;\n        this._isRunning = false;\n        this._isStarting = false;\n        this._isStopping = false;\n        this._root = void 0;\n        this.next = (void 0);\n        Registration.instance(Aurelia, this).register(container);\n    }\n    get isRunning() {\n        return this._isRunning;\n    }\n    get isStarting() {\n        return this._isStarting;\n    }\n    get isStopping() {\n        return this._isStopping;\n    }\n    get root() {\n        if (this._root == void 0) {\n            if (this.next == void 0) {\n                throw new Error(`root is not defined`); // TODO: create error code\n            }\n            return this.next;\n        }\n        return this._root;\n    }\n    register(...params) {\n        this.container.register(...params);\n        return this;\n    }\n    app(config) {\n        this.next = new CompositionRoot(config, this.container);\n        if (this.isRunning) {\n            this.start();\n        }\n        return this;\n    }\n    start(root = this.next) {\n        if (root == void 0) {\n            throw new Error(`There is no composition root`); // TODO: create error code\n        }\n        this.stop(root);\n        if (this.task.done) {\n            this.onBeforeStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onBeforeStart, this, root);\n        }\n        this.task = this.root.activate(this.task);\n        if (this.task.done) {\n            this.task = this.onAfterStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onAfterStart, this, root);\n        }\n        return this.task;\n    }\n    stop(root = this._root) {\n        if (this._isRunning && root != void 0) {\n            if (this.task.done) {\n                this.onBeforeStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onBeforeStop, this, root);\n            }\n            this.task = root.deactivate(this.task);\n            if (this.task.done) {\n                this.task = this.onAfterStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onAfterStop, this, root);\n            }\n        }\n        return this.task;\n    }\n    wait() {\n        return this.task.wait();\n    }\n    onBeforeStart(root) {\n        Reflect.set(root.host, '$aurelia', this);\n        this._root = root;\n        this._isStarting = true;\n    }\n    onAfterStart(root) {\n        this._isRunning = true;\n        this._isStarting = false;\n        this.dispatchEvent(root, 'aurelia-composed', root.dom);\n        this.dispatchEvent(root, 'au-started', root.host);\n        return LifecycleTask.done;\n    }\n    onBeforeStop(root) {\n        this._isRunning = false;\n        this._isStopping = true;\n    }\n    onAfterStop(root) {\n        Reflect.deleteProperty(root.host, '$aurelia');\n        this._root = void 0;\n        this._isStopping = false;\n        this.dispatchEvent(root, 'au-stopped', root.host);\n        return LifecycleTask.done;\n    }\n    dispatchEvent(root, name, target) {\n        target = 'dispatchEvent' in target ? target : root.dom;\n        target.dispatchEvent(root.dom.createCustomEvent(name, { detail: this, bubbles: true, cancelable: true }));\n    }\n}\nPLATFORM.global.Aurelia = Aurelia;\nexport const IDOMInitializer = DI.createInterface('IDOMInitializer').noDefault();\n//# sourceMappingURL=aurelia.js.map","import { __decorate, __param } from \"tslib\";\nimport { all, Registration, Reporter, Metadata, } from '@aurelia/kernel';\nimport { CallBinding } from './binding/call-binding';\nimport { IExpressionParser } from './binding/expression-parser';\nimport { InterpolationBinding, MultiInterpolationBinding } from './binding/interpolation-binding';\nimport { LetBinding } from './binding/let-binding';\nimport { PropertyBinding } from './binding/property-binding';\nimport { RefBinding } from './binding/ref-binding';\nimport { BindingMode } from './flags';\nimport { IObserverLocator } from './observation/observer-locator';\nimport { IInstructionRenderer, IRenderer, IRenderingEngine } from './rendering-engine';\nimport { CustomAttribute, } from './resources/custom-attribute';\nimport { CustomElement, } from './resources/custom-element';\nimport { Controller, } from './templating/controller';\nexport function instructionRenderer(instructionType) {\n    return function decorator(target) {\n        // wrap the constructor to set the instructionType to the instance (for better performance than when set on the prototype)\n        const decoratedTarget = function (...args) {\n            const instance = new target(...args);\n            instance.instructionType = instructionType;\n            return instance;\n        };\n        // make sure we register the decorated constructor with DI\n        decoratedTarget.register = function register(container) {\n            Registration.singleton(IInstructionRenderer, decoratedTarget).register(container);\n        };\n        // copy over any metadata such as annotations (set by preceding decorators) as well as static properties set by the user\n        // also copy the name, to be less confusing to users (so they can still use constructor.name for whatever reason)\n        // the length (number of ctor arguments) is copied for the same reason\n        const metadataKeys = Metadata.getOwnKeys(target);\n        for (const key of metadataKeys) {\n            Metadata.define(key, Metadata.getOwn(key, target), decoratedTarget);\n        }\n        const ownProperties = Object.getOwnPropertyDescriptors(target);\n        Object.keys(ownProperties).filter(prop => prop !== 'prototype').forEach(prop => {\n            Reflect.defineProperty(decoratedTarget, prop, ownProperties[prop]);\n        });\n        return decoratedTarget;\n    };\n}\n/* @internal */\nlet Renderer = class Renderer {\n    constructor(instructionRenderers) {\n        const record = this.instructionRenderers = {};\n        instructionRenderers.forEach(item => {\n            // Binding the functions to the renderer instances and calling the functions directly,\n            // prevents the `render` call sites from going megamorphic.\n            // Consumes slightly more memory but significantly less CPU.\n            record[item.instructionType] = item.render.bind(item);\n        });\n    }\n    static register(container) {\n        return Registration.singleton(IRenderer, this).register(container);\n    }\n    render(flags, dom, context, renderable, targets, definition, host, parts) {\n        const targetInstructions = definition.instructions;\n        const instructionRenderers = this.instructionRenderers;\n        if (targets.length !== targetInstructions.length) {\n            if (targets.length > targetInstructions.length) {\n                throw Reporter.error(30);\n            }\n            else {\n                throw Reporter.error(31);\n            }\n        }\n        let instructions;\n        let target;\n        let current;\n        for (let i = 0, ii = targets.length; i < ii; ++i) {\n            instructions = targetInstructions[i];\n            target = targets[i];\n            for (let j = 0, jj = instructions.length; j < jj; ++j) {\n                current = instructions[j];\n                instructionRenderers[current.type](flags, dom, context, renderable, target, current, parts);\n            }\n        }\n        if (host) {\n            const surrogateInstructions = definition.surrogates;\n            for (let i = 0, ii = surrogateInstructions.length; i < ii; ++i) {\n                current = surrogateInstructions[i];\n                instructionRenderers[current.type](flags, dom, context, renderable, host, current, parts);\n            }\n        }\n    }\n};\nRenderer = __decorate([\n    __param(0, all(IInstructionRenderer))\n], Renderer);\nexport { Renderer };\nexport function ensureExpression(parser, srcOrExpr, bindingType) {\n    if (typeof srcOrExpr === 'string') {\n        return parser.parse(srcOrExpr, bindingType);\n    }\n    return srcOrExpr;\n}\nexport function addBinding(renderable, binding) {\n    if (renderable.bindings == void 0) {\n        renderable.bindings = [binding];\n    }\n    else {\n        renderable.bindings.push(binding);\n    }\n}\nexport function addComponent(renderable, component) {\n    if (renderable.controllers == void 0) {\n        renderable.controllers = [component];\n    }\n    else {\n        renderable.controllers.push(component);\n    }\n}\nexport function getTarget(potentialTarget) {\n    if (potentialTarget.bindingContext !== void 0) {\n        return potentialTarget.bindingContext;\n    }\n    return potentialTarget;\n}\nexport function getRefTarget(refHost, refTargetName) {\n    if (refTargetName === 'element') {\n        return refHost;\n    }\n    const $auRefs = refHost.$au;\n    if ($auRefs === void 0) {\n        // todo: code error code, this message is from v1\n        throw new Error(`No Aurelia APIs are defined for the element: \"${refHost.tagName}\".`);\n    }\n    let refTargetController;\n    switch (refTargetName) {\n        case 'controller':\n            // this means it supports returning undefined\n            return refHost.$controller;\n        case 'view':\n            // todo: returns node sequences for fun?\n            throw new Error('Not supported API');\n        case 'view-model':\n            // this means it supports returning undefined\n            return refHost.$controller.viewModel;\n        default:\n            refTargetController = $auRefs[refTargetName];\n            if (refTargetController === void 0) {\n                throw new Error(`Attempted to reference \"${refTargetName}\", but it was not found amongst the target's API.`);\n            }\n            return refTargetController.viewModel;\n    }\n}\nfunction setControllerReference(controller, host, referenceName) {\n    let $auRefs = host.$au;\n    if ($auRefs === void 0) {\n        $auRefs = host.$au = new ControllersLookup();\n    }\n    $auRefs[referenceName] = controller;\n}\nclass ControllersLookup {\n}\nlet SetPropertyRenderer = \n/** @internal */\nclass SetPropertyRenderer {\n    render(flags, dom, context, renderable, target, instruction) {\n        const obj = getTarget(target);\n        if (obj.$observers !== void 0 && obj.$observers[instruction.to] !== void 0) {\n            obj.$observers[instruction.to].setValue(instruction.value, 4096 /* fromBind */);\n        }\n        else {\n            obj[instruction.to] = instruction.value;\n        }\n    }\n};\nSetPropertyRenderer = __decorate([\n    instructionRenderer(\"re\" /* setProperty */)\n    /** @internal */\n], SetPropertyRenderer);\nexport { SetPropertyRenderer };\nlet CustomElementRenderer = \n/** @internal */\nclass CustomElementRenderer {\n    render(flags, dom, context, renderable, target, instruction) {\n        const operation = context.beginComponentOperation(renderable, target, instruction, null, null, target, true);\n        const component = context.get(CustomElement.keyFrom(instruction.res));\n        const instructionRenderers = context.get(IRenderer).instructionRenderers;\n        const childInstructions = instruction.instructions;\n        const controller = Controller.forCustomElement(component, context, target, flags, instruction);\n        setControllerReference(controller, controller.host, instruction.res);\n        let current;\n        for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n            current = childInstructions[i];\n            instructionRenderers[current.type](flags, dom, context, renderable, controller, current);\n        }\n        addComponent(renderable, controller);\n        operation.dispose();\n    }\n};\nCustomElementRenderer = __decorate([\n    instructionRenderer(\"ra\" /* hydrateElement */)\n    /** @internal */\n], CustomElementRenderer);\nexport { CustomElementRenderer };\nlet CustomAttributeRenderer = \n/** @internal */\nclass CustomAttributeRenderer {\n    render(flags, dom, context, renderable, target, instruction) {\n        const operation = context.beginComponentOperation(renderable, target, instruction);\n        const component = context.get(CustomAttribute.keyFrom(instruction.res));\n        const instructionRenderers = context.get(IRenderer).instructionRenderers;\n        const childInstructions = instruction.instructions;\n        const controller = Controller.forCustomAttribute(component, context, flags);\n        setControllerReference(controller, target, instruction.res);\n        let current;\n        for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n            current = childInstructions[i];\n            instructionRenderers[current.type](flags, dom, context, renderable, controller, current);\n        }\n        addComponent(renderable, controller);\n        operation.dispose();\n    }\n};\nCustomAttributeRenderer = __decorate([\n    instructionRenderer(\"rb\" /* hydrateAttribute */)\n    /** @internal */\n], CustomAttributeRenderer);\nexport { CustomAttributeRenderer };\nlet TemplateControllerRenderer = \n/** @internal */\nclass TemplateControllerRenderer {\n    constructor(renderingEngine, observerLocator) {\n        this.renderingEngine = renderingEngine;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction, parts) {\n        const factory = this.renderingEngine.getViewFactory(dom, instruction.def, context);\n        const renderLocation = dom.convertToRenderLocation(target);\n        const operation = context.beginComponentOperation(renderable, target, instruction, factory, parts, renderLocation, false);\n        const component = context.get(CustomAttribute.keyFrom(instruction.res));\n        const instructionRenderers = context.get(IRenderer).instructionRenderers;\n        const childInstructions = instruction.instructions;\n        if (instruction.parts !== void 0) {\n            if (parts === void 0) {\n                // Just assign it, no need to create new variables\n                parts = instruction.parts;\n            }\n            else {\n                // Create a new object because we shouldn't accidentally put child information in the parent part object.\n                // If the parts conflict, the instruction's parts overwrite the passed-in parts because they were declared last.\n                parts = {\n                    ...parts,\n                    ...instruction.parts,\n                };\n            }\n        }\n        const controller = Controller.forCustomAttribute(component, context, flags);\n        if (instruction.link) {\n            const controllers = renderable.controllers;\n            component.link(controllers[controllers.length - 1]);\n        }\n        setControllerReference(controller, renderLocation, instruction.res);\n        let current;\n        for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n            current = childInstructions[i];\n            instructionRenderers[current.type](flags, dom, context, renderable, controller, current);\n        }\n        addComponent(renderable, controller);\n        operation.dispose();\n    }\n};\nTemplateControllerRenderer = __decorate([\n    instructionRenderer(\"rc\" /* hydrateTemplateController */)\n    /** @internal */\n    ,\n    __param(0, IRenderingEngine),\n    __param(1, IObserverLocator)\n], TemplateControllerRenderer);\nexport { TemplateControllerRenderer };\nlet LetElementRenderer = \n/** @internal */\nclass LetElementRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        dom.remove(target);\n        const childInstructions = instruction.instructions;\n        const toBindingContext = instruction.toBindingContext;\n        let childInstruction;\n        let expr;\n        let binding;\n        for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n            childInstruction = childInstructions[i];\n            expr = ensureExpression(this.parser, childInstruction.from, 48 /* IsPropertyCommand */);\n            binding = new LetBinding(expr, childInstruction.to, this.observerLocator, context, toBindingContext);\n            addBinding(renderable, binding);\n        }\n    }\n};\nLetElementRenderer = __decorate([\n    instructionRenderer(\"rd\" /* hydrateLetElement */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], LetElementRenderer);\nexport { LetElementRenderer };\nlet CallBindingRenderer = \n/** @internal */\nclass CallBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 153 /* CallCommand */);\n        const binding = new CallBinding(expr, getTarget(target), instruction.to, this.observerLocator, context);\n        addBinding(renderable, binding);\n    }\n};\nCallBindingRenderer = __decorate([\n    instructionRenderer(\"rh\" /* callBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], CallBindingRenderer);\nexport { CallBindingRenderer };\nlet RefBindingRenderer = \n/** @internal */\nclass RefBindingRenderer {\n    constructor(parser) {\n        this.parser = parser;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 5376 /* IsRef */);\n        const binding = new RefBinding(expr, getRefTarget(target, instruction.to), context);\n        addBinding(renderable, binding);\n    }\n};\nRefBindingRenderer = __decorate([\n    instructionRenderer(\"rj\" /* refBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser)\n], RefBindingRenderer);\nexport { RefBindingRenderer };\nlet InterpolationBindingRenderer = \n/** @internal */\nclass InterpolationBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = new MultiInterpolationBinding(this.observerLocator, expr, getTarget(target), instruction.to, BindingMode.toView, context);\n        }\n        else {\n            binding = new InterpolationBinding(expr.firstExpression, expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context, true);\n        }\n        addBinding(renderable, binding);\n    }\n};\nInterpolationBindingRenderer = __decorate([\n    instructionRenderer(\"rf\" /* interpolation */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], InterpolationBindingRenderer);\nexport { InterpolationBindingRenderer };\nlet PropertyBindingRenderer = \n/** @internal */\nclass PropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | instruction.mode);\n        const binding = new PropertyBinding(expr, getTarget(target), instruction.to, instruction.mode, this.observerLocator, context);\n        addBinding(renderable, binding);\n    }\n};\nPropertyBindingRenderer = __decorate([\n    instructionRenderer(\"rg\" /* propertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], PropertyBindingRenderer);\nexport { PropertyBindingRenderer };\nlet IteratorBindingRenderer = \n/** @internal */\nclass IteratorBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 539 /* ForCommand */);\n        const binding = new PropertyBinding(expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context);\n        addBinding(renderable, binding);\n    }\n};\nIteratorBindingRenderer = __decorate([\n    instructionRenderer(\"rk\" /* iteratorBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], IteratorBindingRenderer);\nexport { IteratorBindingRenderer };\n//# sourceMappingURL=renderer.js.map","import { DI } from '@aurelia/kernel';\nimport { Lifecycle } from './lifecycle';\nimport { StartTaskManager } from './lifecycle-task';\nimport { ObserverLocator } from './observation/observer-locator';\nimport { CallBindingRenderer, CustomAttributeRenderer, CustomElementRenderer, InterpolationBindingRenderer, IteratorBindingRenderer, LetElementRenderer, PropertyBindingRenderer, RefBindingRenderer, Renderer, SetPropertyRenderer, TemplateControllerRenderer } from './renderer';\nimport { FromViewBindingBehavior, OneTimeBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior } from './resources/binding-behaviors/binding-mode';\nimport { DebounceBindingBehavior } from './resources/binding-behaviors/debounce';\nimport { SignalBindingBehavior } from './resources/binding-behaviors/signals';\nimport { ThrottleBindingBehavior } from './resources/binding-behaviors/throttle';\nimport { FrequentMutations, InfrequentMutations, ObserveShallow } from './resources/custom-attributes/flags';\nimport { Else, If } from './resources/custom-attributes/if';\nimport { Repeat } from './resources/custom-attributes/repeat';\nimport { Replaceable } from './resources/custom-attributes/replaceable';\nimport { With } from './resources/custom-attributes/with';\nimport { SanitizeValueConverter } from './resources/value-converters/sanitize';\nimport { ViewValueConverter } from './resources/value-converters/view';\nimport { ViewLocator } from './templating/view';\nimport { Clock } from './scheduler';\nexport const IObserverLocatorRegistration = ObserverLocator;\nexport const ILifecycleRegistration = Lifecycle;\nexport const IRendererRegistration = Renderer;\nexport const IStartTaskManagerRegistration = StartTaskManager;\nexport const IViewLocatorRegistration = ViewLocator;\nexport const IClockRegistration = Clock;\n/**\n * Default implementations for the following interfaces:\n * - `IObserverLocator`\n * - `ILifecycle`\n * - `IRenderer`\n * - `IStartTaskManager`\n * - `IViewLocator`\n * - `IClockRegistration`\n * - `ISchedulerRegistration`\n */\nexport const DefaultComponents = [\n    IObserverLocatorRegistration,\n    ILifecycleRegistration,\n    IRendererRegistration,\n    IStartTaskManagerRegistration,\n    IViewLocatorRegistration,\n    IClockRegistration,\n];\nexport const FrequentMutationsRegistration = FrequentMutations;\nexport const InfrequentMutationsRegistration = InfrequentMutations;\nexport const ObserveShallowRegistration = ObserveShallow;\nexport const IfRegistration = If;\nexport const ElseRegistration = Else;\nexport const RepeatRegistration = Repeat;\nexport const ReplaceableRegistration = Replaceable;\nexport const WithRegistration = With;\nexport const SanitizeValueConverterRegistration = SanitizeValueConverter;\nexport const ViewValueConverterRegistration = ViewValueConverter;\nexport const DebounceBindingBehaviorRegistration = DebounceBindingBehavior;\nexport const OneTimeBindingBehaviorRegistration = OneTimeBindingBehavior;\nexport const ToViewBindingBehaviorRegistration = ToViewBindingBehavior;\nexport const FromViewBindingBehaviorRegistration = FromViewBindingBehavior;\nexport const SignalBindingBehaviorRegistration = SignalBindingBehavior;\nexport const ThrottleBindingBehaviorRegistration = ThrottleBindingBehavior;\nexport const TwoWayBindingBehaviorRegistration = TwoWayBindingBehavior;\n/**\n * Default resources:\n * - Template controllers (`if`/`else`, `repeat`, `replaceable`, `with`)\n * - Value Converters (`sanitize`)\n * - Binding Behaviors (`oneTime`, `toView`, `fromView`, `twoWay`, `signal`, `debounce`, `throttle`)\n */\nexport const DefaultResources = [\n    FrequentMutationsRegistration,\n    InfrequentMutationsRegistration,\n    ObserveShallowRegistration,\n    IfRegistration,\n    ElseRegistration,\n    RepeatRegistration,\n    ReplaceableRegistration,\n    WithRegistration,\n    SanitizeValueConverterRegistration,\n    ViewValueConverterRegistration,\n    DebounceBindingBehaviorRegistration,\n    OneTimeBindingBehaviorRegistration,\n    ToViewBindingBehaviorRegistration,\n    FromViewBindingBehaviorRegistration,\n    SignalBindingBehaviorRegistration,\n    ThrottleBindingBehaviorRegistration,\n    TwoWayBindingBehaviorRegistration\n];\nexport const CallBindingRendererRegistration = CallBindingRenderer;\nexport const CustomAttributeRendererRegistration = CustomAttributeRenderer;\nexport const CustomElementRendererRegistration = CustomElementRenderer;\nexport const InterpolationBindingRendererRegistration = InterpolationBindingRenderer;\nexport const IteratorBindingRendererRegistration = IteratorBindingRenderer;\nexport const LetElementRendererRegistration = LetElementRenderer;\nexport const PropertyBindingRendererRegistration = PropertyBindingRenderer;\nexport const RefBindingRendererRegistration = RefBindingRenderer;\nexport const SetPropertyRendererRegistration = SetPropertyRenderer;\nexport const TemplateControllerRendererRegistration = TemplateControllerRenderer;\n/**\n * Default renderers for:\n * - PropertyBinding: `bind`, `one-time`, `to-view`, `from-view`, `two-way`\n * - IteratorBinding: `for`\n * - CallBinding: `call`\n * - RefBinding: `ref`\n * - InterpolationBinding: `${}`\n * - SetProperty\n * - `customElement` hydration\n * - `customAttribute` hydration\n * - `templateController` hydration\n * - `let` element hydration\n */\nexport const DefaultRenderers = [\n    PropertyBindingRendererRegistration,\n    IteratorBindingRendererRegistration,\n    CallBindingRendererRegistration,\n    RefBindingRendererRegistration,\n    InterpolationBindingRendererRegistration,\n    SetPropertyRendererRegistration,\n    CustomElementRendererRegistration,\n    CustomAttributeRendererRegistration,\n    TemplateControllerRendererRegistration,\n    LetElementRendererRegistration\n];\n/**\n * A DI configuration object containing environment/runtime-agnostic registrations:\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { BindingMode } from './flags';\nexport class InterpolationInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rf\" /* interpolation */;\n    }\n}\nexport class OneTimeBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.oneTime;\n        this.oneTime = true;\n    }\n}\nexport class ToViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.toView;\n        this.oneTime = false;\n    }\n}\nexport class FromViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.fromView;\n        this.oneTime = false;\n    }\n}\nexport class TwoWayBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.twoWay;\n        this.oneTime = false;\n    }\n}\nexport class IteratorBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rk\" /* iteratorBinding */;\n    }\n}\nexport class CallBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rh\" /* callBinding */;\n    }\n}\nexport class RefBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rj\" /* refBinding */;\n        this.type = \"rj\" /* refBinding */;\n    }\n}\nexport class SetPropertyInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"re\" /* setProperty */;\n    }\n}\nexport class HydrateElementInstruction {\n    constructor(res, instructions, parts) {\n        this.res = res;\n        this.instructions = instructions;\n        this.parts = parts;\n        this.type = \"ra\" /* hydrateElement */;\n    }\n}\nexport class HydrateAttributeInstruction {\n    constructor(res, instructions) {\n        this.res = res;\n        this.instructions = instructions;\n        this.type = \"rb\" /* hydrateAttribute */;\n    }\n}\nexport class HydrateTemplateController {\n    constructor(def, res, instructions, link, parts) {\n        this.def = def;\n        this.res = res;\n        this.instructions = instructions;\n        this.link = link;\n        this.parts = parts;\n        this.type = \"rc\" /* hydrateTemplateController */;\n    }\n}\nexport class LetElementInstruction {\n    constructor(instructions, toBindingContext) {\n        this.instructions = instructions;\n        this.toBindingContext = toBindingContext;\n        this.type = \"rd\" /* hydrateLetElement */;\n    }\n}\nexport class LetBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"ri\" /* letBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","export class AttrSyntax {\n    constructor(rawName, rawValue, target, command) {\n        this.rawName = rawName;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.command = command;\n    }\n}\n//# sourceMappingURL=ast.js.map","import { DI, Metadata, PLATFORM, Protocol, Registration, Reporter } from '@aurelia/kernel';\n/** @internal */\nexport class CharSpec {\n    constructor(chars, repeat, isSymbol, isInverted) {\n        this.chars = chars;\n        this.repeat = repeat;\n        this.isSymbol = isSymbol;\n        this.isInverted = isInverted;\n        if (isInverted) {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNoneInverse;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingleInverse;\n                    break;\n                default:\n                    this.has = this.hasOfMultipleInverse;\n            }\n        }\n        else {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNone;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingle;\n                    break;\n                default:\n                    this.has = this.hasOfMultiple;\n            }\n        }\n    }\n    equals(other) {\n        return this.chars === other.chars\n            && this.repeat === other.repeat\n            && this.isSymbol === other.isSymbol\n            && this.isInverted === other.isInverted;\n    }\n    hasOfMultiple(char) {\n        return this.chars.includes(char);\n    }\n    hasOfSingle(char) {\n        return this.chars === char;\n    }\n    hasOfNone(char) {\n        return false;\n    }\n    hasOfMultipleInverse(char) {\n        return !this.chars.includes(char);\n    }\n    hasOfSingleInverse(char) {\n        return this.chars !== char;\n    }\n    hasOfNoneInverse(char) {\n        return true;\n    }\n}\nexport class Interpretation {\n    constructor() {\n        this.parts = PLATFORM.emptyArray;\n        this._pattern = '';\n        this.currentRecord = {};\n        this.partsRecord = {};\n    }\n    get pattern() {\n        const value = this._pattern;\n        if (value === '') {\n            return null;\n        }\n        else {\n            return value;\n        }\n    }\n    set pattern(value) {\n        if (value == null) {\n            this._pattern = '';\n            this.parts = PLATFORM.emptyArray;\n        }\n        else {\n            this._pattern = value;\n            this.parts = this.partsRecord[value];\n        }\n    }\n    append(pattern, ch) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] === undefined) {\n            currentRecord[pattern] = ch;\n        }\n        else {\n            currentRecord[pattern] += ch;\n        }\n    }\n    next(pattern) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] !== undefined) {\n            const { partsRecord } = this;\n            if (partsRecord[pattern] === undefined) {\n                partsRecord[pattern] = [currentRecord[pattern]];\n            }\n            else {\n                partsRecord[pattern].push(currentRecord[pattern]);\n            }\n            currentRecord[pattern] = undefined;\n        }\n    }\n}\n/** @internal */\nexport class State {\n    constructor(charSpec, ...patterns) {\n        this.charSpec = charSpec;\n        this.nextStates = [];\n        this.types = null;\n        this.isEndpoint = false;\n        this.patterns = patterns;\n    }\n    get pattern() {\n        return this.isEndpoint ? this.patterns[0] : null;\n    }\n    findChild(charSpec) {\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let child = null;\n        for (let i = 0; i < len; ++i) {\n            child = nextStates[i];\n            if (charSpec.equals(child.charSpec)) {\n                return child;\n            }\n        }\n        return null;\n    }\n    append(charSpec, pattern) {\n        const { patterns } = this;\n        if (!patterns.includes(pattern)) {\n            patterns.push(pattern);\n        }\n        let state = this.findChild(charSpec);\n        if (state == null) {\n            state = new State(charSpec, pattern);\n            this.nextStates.push(state);\n            if (charSpec.repeat) {\n                state.nextStates.push(state);\n            }\n        }\n        return state;\n    }\n    findMatches(ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const results = [];\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let childLen = 0;\n        let child = null;\n        let i = 0;\n        let j = 0;\n        for (; i < len; ++i) {\n            child = nextStates[i];\n            if (child.charSpec.has(ch)) {\n                results.push(child);\n                childLen = child.patterns.length;\n                j = 0;\n                if (child.charSpec.isSymbol) {\n                    for (; j < childLen; ++j) {\n                        interpretation.next(child.patterns[j]);\n                    }\n                }\n                else {\n                    for (; j < childLen; ++j) {\n                        interpretation.append(child.patterns[j], ch);\n                    }\n                }\n            }\n        }\n        return results;\n    }\n}\n/** @internal */\nexport class StaticSegment {\n    constructor(text) {\n        this.text = text;\n        this.text = text;\n        const len = this.len = text.length;\n        const specs = this.specs = [];\n        for (let i = 0; i < len; ++i) {\n            specs.push(new CharSpec(text[i], false, false, false));\n        }\n    }\n    eachChar(callback) {\n        const { len, specs } = this;\n        for (let i = 0; i < len; ++i) {\n            callback(specs[i]);\n        }\n    }\n}\n/** @internal */\nexport class DynamicSegment {\n    constructor(symbols) {\n        this.text = 'PART';\n        this.spec = new CharSpec(symbols, true, false, true);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SymbolSegment {\n    constructor(text) {\n        this.text = text;\n        this.spec = new CharSpec(text, false, true, false);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SegmentTypes {\n    constructor() {\n        this.statics = 0;\n        this.dynamics = 0;\n        this.symbols = 0;\n    }\n}\nexport const ISyntaxInterpreter = DI.createInterface('ISyntaxInterpreter').withDefault(x => x.singleton(SyntaxInterpreter));\n/** @internal */\nexport class SyntaxInterpreter {\n    constructor() {\n        this.rootState = new State(null);\n        this.initialStates = [this.rootState];\n    }\n    add(defOrDefs) {\n        let i = 0;\n        if (Array.isArray(defOrDefs)) {\n            const ii = defOrDefs.length;\n            for (; i < ii; ++i) {\n                this.add(defOrDefs[i]);\n            }\n            return;\n        }\n        let currentState = this.rootState;\n        const def = defOrDefs;\n        const pattern = def.pattern;\n        const types = new SegmentTypes();\n        const segments = this.parse(def, types);\n        const len = segments.length;\n        const callback = (ch) => {\n            currentState = currentState.append(ch, pattern);\n        };\n        for (i = 0; i < len; ++i) {\n            segments[i].eachChar(callback);\n        }\n        currentState.types = types;\n        currentState.isEndpoint = true;\n    }\n    interpret(name) {\n        const interpretation = new Interpretation();\n        let states = this.initialStates;\n        const len = name.length;\n        for (let i = 0; i < len; ++i) {\n            states = this.getNextStates(states, name.charAt(i), interpretation);\n            if (states.length === 0) {\n                break;\n            }\n        }\n        states.sort((a, b) => {\n            if (a.isEndpoint) {\n                if (!b.isEndpoint) {\n                    return -1;\n                }\n            }\n            else if (b.isEndpoint) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n            const aTypes = a.types;\n            const bTypes = b.types;\n            if (aTypes.statics !== bTypes.statics) {\n                return bTypes.statics - aTypes.statics;\n            }\n            if (aTypes.dynamics !== bTypes.dynamics) {\n                return bTypes.dynamics - aTypes.dynamics;\n            }\n            if (aTypes.symbols !== bTypes.symbols) {\n                return bTypes.symbols - aTypes.symbols;\n            }\n            return 0;\n        });\n        if (states.length > 0) {\n            const state = states[0];\n            if (!state.charSpec.isSymbol) {\n                interpretation.next(state.pattern);\n            }\n            interpretation.pattern = state.pattern;\n        }\n        return interpretation;\n    }\n    getNextStates(states, ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const nextStates = [];\n        let state = null;\n        const len = states.length;\n        for (let i = 0; i < len; ++i) {\n            state = states[i];\n            nextStates.push(...state.findMatches(ch, interpretation));\n        }\n        return nextStates;\n    }\n    parse(def, types) {\n        const result = [];\n        const pattern = def.pattern;\n        const len = pattern.length;\n        let i = 0;\n        let start = 0;\n        let c = '';\n        while (i < len) {\n            c = pattern.charAt(i);\n            if (!def.symbols.includes(c)) {\n                if (i === start) {\n                    if (c === 'P' && pattern.slice(i, i + 4) === 'PART') {\n                        start = i = (i + 4);\n                        result.push(new DynamicSegment(def.symbols));\n                        ++types.dynamics;\n                    }\n                    else {\n                        ++i;\n                    }\n                }\n                else {\n                    ++i;\n                }\n            }\n            else if (i !== start) {\n                result.push(new StaticSegment(pattern.slice(start, i)));\n                ++types.statics;\n                start = i;\n            }\n            else {\n                result.push(new SymbolSegment(pattern.slice(start, i + 1)));\n                ++types.symbols;\n                start = ++i;\n            }\n        }\n        if (start !== i) {\n            result.push(new StaticSegment(pattern.slice(start, i)));\n            ++types.statics;\n        }\n        return result;\n    }\n}\nfunction validatePrototype(handler, patternDefs) {\n    for (const def of patternDefs) {\n        // note: we're intentionally not throwing here\n        if (!(def.pattern in handler)) {\n            Reporter.write(401, def.pattern); // TODO: organize error codes\n        }\n        else if (typeof handler[def.pattern] !== 'function') {\n            Reporter.write(402, def.pattern); // TODO: organize error codes\n        }\n    }\n}\nexport const IAttributePattern = DI.createInterface('IAttributePattern').noDefault();\nexport function attributePattern(...patternDefs) {\n    return function decorator(target) {\n        return AttributePattern.define(patternDefs, target);\n    };\n}\nexport class AttributePatternResourceDefinition {\n    constructor(Type) {\n        this.Type = Type;\n        this.name = (void 0);\n    }\n    register(container) {\n        Registration.singleton(IAttributePattern, this.Type).register(container);\n    }\n}\nexport const AttributePattern = Object.freeze({\n    name: Protocol.resource.keyFor('attribute-pattern'),\n    definitionAnnotationKey: 'attribute-pattern-definitions',\n    define(patternDefs, Type) {\n        validatePrototype(Type.prototype, patternDefs);\n        const definition = new AttributePatternResourceDefinition(Type);\n        const { name, definitionAnnotationKey } = AttributePattern;\n        Metadata.define(name, definition, Type);\n        Protocol.resource.appendTo(Type, name);\n        Protocol.annotation.set(Type, definitionAnnotationKey, patternDefs);\n        Protocol.annotation.appendTo(Type, definitionAnnotationKey);\n        return Type;\n    },\n    getPatternDefinitions(Type) {\n        return Protocol.annotation.get(Type, AttributePattern.definitionAnnotationKey);\n    }\n});\n//# sourceMappingURL=attribute-pattern.js.map","import { __decorate, __param } from \"tslib\";\nimport { all, DI } from '@aurelia/kernel';\nimport { AttrSyntax } from './ast';\nimport { AttributePattern, IAttributePattern, ISyntaxInterpreter } from './attribute-pattern';\nexport const IAttributeParser = DI.createInterface('IAttributeParser').withDefault(x => x.singleton(AttributeParser));\n/** @internal */\nlet AttributeParser = class AttributeParser {\n    constructor(interpreter, attrPatterns) {\n        this.interpreter = interpreter;\n        this.cache = {};\n        this.interpreter = interpreter;\n        const patterns = this.patterns = {};\n        attrPatterns.forEach(attrPattern => {\n            const defs = AttributePattern.getPatternDefinitions(attrPattern.constructor);\n            interpreter.add(defs);\n            defs.forEach(def => {\n                patterns[def.pattern] = attrPattern;\n            });\n        });\n    }\n    parse(name, value) {\n        let interpretation = this.cache[name];\n        if (interpretation == null) {\n            interpretation = this.cache[name] = this.interpreter.interpret(name);\n        }\n        const pattern = interpretation.pattern;\n        if (pattern == null) {\n            return new AttrSyntax(name, value, name, null);\n        }\n        else {\n            return this.patterns[pattern][pattern](name, value, interpretation.parts);\n        }\n    }\n};\nAttributeParser = __decorate([\n    __param(0, ISyntaxInterpreter),\n    __param(1, all(IAttributePattern))\n], AttributeParser);\nexport { AttributeParser };\n//# sourceMappingURL=attribute-parser.js.map","import { __decorate } from \"tslib\";\nimport { AttrSyntax } from './ast';\nimport { attributePattern } from './attribute-pattern';\nlet DotSeparatedAttributePattern = class DotSeparatedAttributePattern {\n    ['PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[1]);\n    }\n    ['PART.PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[2]);\n    }\n};\nDotSeparatedAttributePattern = __decorate([\n    attributePattern({ pattern: 'PART.PART', symbols: '.' }, { pattern: 'PART.PART.PART', symbols: '.' })\n], DotSeparatedAttributePattern);\nexport { DotSeparatedAttributePattern };\nlet RefAttributePattern = class RefAttributePattern {\n    ['ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, 'element', 'ref');\n    }\n    ['PART.ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'ref');\n    }\n};\nRefAttributePattern = __decorate([\n    attributePattern({ pattern: 'ref', symbols: '' }, { pattern: 'PART.ref', symbols: '.' })\n], RefAttributePattern);\nexport { RefAttributePattern };\nlet ColonPrefixedBindAttributePattern = class ColonPrefixedBindAttributePattern {\n    [':PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'bind');\n    }\n};\nColonPrefixedBindAttributePattern = __decorate([\n    attributePattern({ pattern: ':PART', symbols: ':' })\n], ColonPrefixedBindAttributePattern);\nexport { ColonPrefixedBindAttributePattern };\nlet AtPrefixedTriggerAttributePattern = class AtPrefixedTriggerAttributePattern {\n    ['@PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'trigger');\n    }\n};\nAtPrefixedTriggerAttributePattern = __decorate([\n    attributePattern({ pattern: '@PART', symbols: '@' })\n], AtPrefixedTriggerAttributePattern);\nexport { AtPrefixedTriggerAttributePattern };\n//# sourceMappingURL=attribute-patterns.js.map","import { camelCase, Registration, mergeArrays, Protocol, firstDefined, Metadata } from '@aurelia/kernel';\nimport { registerAliases } from '@aurelia/runtime';\nexport function bindingCommand(nameOrDefinition) {\n    return function (target) {\n        return BindingCommand.define(nameOrDefinition, target);\n    };\n}\nexport class BindingCommandDefinition {\n    constructor(Type, name, aliases, key, type) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.type = type;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new BindingCommandDefinition(Type, firstDefined(BindingCommand.getAnnotation(Type, 'name'), name), mergeArrays(BindingCommand.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingCommand.keyFrom(name), firstDefined(BindingCommand.getAnnotation(Type, 'type'), def.type, Type.type, null));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, BindingCommand, key, container);\n    }\n}\nexport const BindingCommand = {\n    name: Protocol.resource.keyFor('binding-command'),\n    keyFrom(name) {\n        return `${BindingCommand.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingCommand.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingCommandDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingCommand.name, definition, definition.Type);\n        Metadata.define(BindingCommand.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingCommand.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingCommand.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\nexport function getTarget(binding, makeCamelCase) {\n    if (binding.flags & 256 /* isBinding */) {\n        return binding.bindable.propName;\n    }\n    else if (makeCamelCase) {\n        return camelCase(binding.syntax.target);\n    }\n    else {\n        return binding.syntax.target;\n    }\n}\n//# sourceMappingURL=binding-command.js.map","export var SymbolFlags;\n(function (SymbolFlags) {\n    SymbolFlags[SymbolFlags[\"type\"] = 511] = \"type\";\n    SymbolFlags[SymbolFlags[\"isTemplateController\"] = 1] = \"isTemplateController\";\n    SymbolFlags[SymbolFlags[\"isReplacePart\"] = 2] = \"isReplacePart\";\n    SymbolFlags[SymbolFlags[\"isCustomAttribute\"] = 4] = \"isCustomAttribute\";\n    SymbolFlags[SymbolFlags[\"isPlainAttribute\"] = 8] = \"isPlainAttribute\";\n    SymbolFlags[SymbolFlags[\"isCustomElement\"] = 16] = \"isCustomElement\";\n    SymbolFlags[SymbolFlags[\"isLetElement\"] = 32] = \"isLetElement\";\n    SymbolFlags[SymbolFlags[\"isPlainElement\"] = 64] = \"isPlainElement\";\n    SymbolFlags[SymbolFlags[\"isText\"] = 128] = \"isText\";\n    SymbolFlags[SymbolFlags[\"isBinding\"] = 256] = \"isBinding\";\n    SymbolFlags[SymbolFlags[\"hasMarker\"] = 512] = \"hasMarker\";\n    SymbolFlags[SymbolFlags[\"hasTemplate\"] = 1024] = \"hasTemplate\";\n    SymbolFlags[SymbolFlags[\"hasAttributes\"] = 2048] = \"hasAttributes\";\n    SymbolFlags[SymbolFlags[\"hasBindings\"] = 4096] = \"hasBindings\";\n    SymbolFlags[SymbolFlags[\"hasChildNodes\"] = 8192] = \"hasChildNodes\";\n    SymbolFlags[SymbolFlags[\"hasParts\"] = 16384] = \"hasParts\";\n})(SymbolFlags || (SymbolFlags = {}));\nfunction createMarker(dom) {\n    const marker = dom.createElement('au-m');\n    dom.makeTarget(marker);\n    return marker;\n}\n/**\n * A html attribute that is associated with a registered resource, specifically a template controller.\n */\nexport class TemplateControllerSymbol {\n    constructor(dom, syntax, info, partName, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 1 /* isTemplateController */ | 512 /* hasMarker */;\n        this.physicalNode = null;\n        this.template = null;\n        this.templateController = null;\n        this._bindings = null;\n        this._parts = null;\n        this.partName = info.name === 'replaceable' ? partName : null;\n        this.marker = createMarker(dom);\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\n/**\n * Wrapper for an element (with all of its attributes, regardless of the order in which they are declared)\n * that has a replace attribute on it.\n *\n * This element will be lifted from the DOM just like a template controller.\n */\nexport class ReplacePartSymbol {\n    constructor(name, physicalNode = null, parent = null, template = null) {\n        this.name = name;\n        this.physicalNode = physicalNode;\n        this.parent = parent;\n        this.template = template;\n        this.flags = 2 /* isReplacePart */;\n    }\n}\n/**\n * A html attribute that is associated with a registered resource, but not a template controller.\n */\nexport class CustomAttributeSymbol {\n    constructor(syntax, info, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 4 /* isCustomAttribute */;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * An attribute, with either a binding command or an interpolation, whose target is the html\n * attribute of the element.\n *\n * This will never target a bindable property of a custom attribute or element;\n */\nexport class PlainAttributeSymbol {\n    constructor(syntax, command, expression) {\n        this.syntax = syntax;\n        this.command = command;\n        this.expression = expression;\n        this.flags = 8 /* isPlainAttribute */;\n    }\n}\n/**\n * Either an attribute on an custom element that maps to a declared bindable property of that element,\n * a single-value bound custom attribute, or one of several bindables that were extracted from the attribute\n * value of a custom attribute with multiple bindings usage.\n *\n * This will always target a bindable property of a custom attribute or element;\n */\nexport class BindingSymbol {\n    constructor(command, bindable, expression, rawValue, target) {\n        this.command = command;\n        this.bindable = bindable;\n        this.expression = expression;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.flags = 256 /* isBinding */;\n    }\n}\n/**\n * A html element that is associated with a registered resource either via its (lowerCase) `nodeName`\n * or the value of its `as-element` attribute.\n */\nexport class CustomElementSymbol {\n    constructor(dom, physicalNode, info, res = info.name, bindables = info.bindables) {\n        this.physicalNode = physicalNode;\n        this.info = info;\n        this.res = res;\n        this.bindables = bindables;\n        this.flags = 16 /* isCustomElement */;\n        this.isTarget = true;\n        this.templateController = null;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._bindings = null;\n        this._childNodes = null;\n        this._parts = null;\n        if (info.containerless) {\n            this.isContainerless = true;\n            this.marker = createMarker(dom);\n            this.flags |= 512 /* hasMarker */;\n        }\n        else {\n            this.isContainerless = false;\n            this.marker = null;\n        }\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\nexport class LetElementSymbol {\n    constructor(dom, physicalNode, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.marker = marker;\n        this.flags = 32 /* isLetElement */ | 512 /* hasMarker */;\n        this.toBindingContext = false;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * A normal html element that may or may not have attribute behaviors and/or child node behaviors.\n *\n * It is possible for a PlainElementSymbol to not yield any instructions during compilation.\n */\nexport class PlainElementSymbol {\n    constructor(dom, physicalNode) {\n        this.physicalNode = physicalNode;\n        this.flags = 64 /* isPlainElement */;\n        this.isTarget = false;\n        this.templateController = null;\n        this.hasSlots = false;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._childNodes = null;\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n}\n/**\n * A standalone text node that has an interpolation.\n */\nexport class TextSymbol {\n    constructor(dom, physicalNode, interpolation, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.interpolation = interpolation;\n        this.marker = marker;\n        this.flags = 128 /* isText */ | 512 /* hasMarker */;\n    }\n}\n//# sourceMappingURL=semantic-model.js.map","import { __decorate } from \"tslib\";\nimport { BindingMode, CallBindingInstruction, FromViewBindingInstruction, IteratorBindingInstruction, OneTimeBindingInstruction, ToViewBindingInstruction, TwoWayBindingInstruction, } from '@aurelia/runtime';\nimport { bindingCommand, getTarget, } from './binding-command';\nimport { BindingSymbol, } from './semantic-model';\nlet OneTimeBindingCommand = class OneTimeBindingCommand {\n    constructor() {\n        this.bindingType = 49 /* OneTimeCommand */;\n    }\n    compile(binding) {\n        return new OneTimeBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nOneTimeBindingCommand = __decorate([\n    bindingCommand('one-time')\n], OneTimeBindingCommand);\nexport { OneTimeBindingCommand };\nlet ToViewBindingCommand = class ToViewBindingCommand {\n    constructor() {\n        this.bindingType = 50 /* ToViewCommand */;\n    }\n    compile(binding) {\n        return new ToViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nToViewBindingCommand = __decorate([\n    bindingCommand('to-view')\n], ToViewBindingCommand);\nexport { ToViewBindingCommand };\nlet FromViewBindingCommand = class FromViewBindingCommand {\n    constructor() {\n        this.bindingType = 51 /* FromViewCommand */;\n    }\n    compile(binding) {\n        return new FromViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nFromViewBindingCommand = __decorate([\n    bindingCommand('from-view')\n], FromViewBindingCommand);\nexport { FromViewBindingCommand };\nlet TwoWayBindingCommand = class TwoWayBindingCommand {\n    constructor() {\n        this.bindingType = 52 /* TwoWayCommand */;\n    }\n    compile(binding) {\n        return new TwoWayBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTwoWayBindingCommand = __decorate([\n    bindingCommand('two-way')\n], TwoWayBindingCommand);\nexport { TwoWayBindingCommand };\nlet DefaultBindingCommand = class DefaultBindingCommand {\n    constructor() {\n        this.bindingType = 53 /* BindCommand */;\n    }\n    compile(binding) {\n        let mode = BindingMode.default;\n        if (binding instanceof BindingSymbol) {\n            mode = binding.bindable.mode;\n        }\n        else {\n            const command = binding.syntax.command;\n            switch (command) {\n                case 'bind':\n                case 'to-view':\n                    mode = BindingMode.toView;\n                    break;\n                case 'one-time':\n                    mode = BindingMode.oneTime;\n                    break;\n                case 'from-view':\n                    mode = BindingMode.fromView;\n                    break;\n                case 'two-way':\n                    mode = BindingMode.twoWay;\n                    break;\n            }\n        }\n        switch (mode) {\n            case BindingMode.default:\n            case BindingMode.toView:\n                return ToViewBindingCommand.prototype.compile(binding);\n            case BindingMode.oneTime:\n                return OneTimeBindingCommand.prototype.compile(binding);\n            case BindingMode.fromView:\n                return FromViewBindingCommand.prototype.compile(binding);\n            case BindingMode.twoWay:\n                return TwoWayBindingCommand.prototype.compile(binding);\n        }\n    }\n};\nDefaultBindingCommand = __decorate([\n    bindingCommand('bind')\n], DefaultBindingCommand);\nexport { DefaultBindingCommand };\nlet CallBindingCommand = class CallBindingCommand {\n    constructor() {\n        this.bindingType = 153 /* CallCommand */;\n    }\n    compile(binding) {\n        return new CallBindingInstruction(binding.expression, getTarget(binding, true));\n    }\n};\nCallBindingCommand = __decorate([\n    bindingCommand('call')\n], CallBindingCommand);\nexport { CallBindingCommand };\nlet ForBindingCommand = class ForBindingCommand {\n    constructor() {\n        this.bindingType = 539 /* ForCommand */;\n    }\n    compile(binding) {\n        return new IteratorBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nForBindingCommand = __decorate([\n    bindingCommand('for')\n], ForBindingCommand);\nexport { ForBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","export function unescapeCode(code) {\n    switch (code) {\n        case 98 /* LowerB */: return 8 /* Backspace */;\n        case 116 /* LowerT */: return 9 /* Tab */;\n        case 110 /* LowerN */: return 10 /* LineFeed */;\n        case 118 /* LowerV */: return 11 /* VerticalTab */;\n        case 102 /* LowerF */: return 12 /* FormFeed */;\n        case 114 /* LowerR */: return 13 /* CarriageReturn */;\n        case 34 /* DoubleQuote */: return 34 /* DoubleQuote */;\n        case 39 /* SingleQuote */: return 39 /* SingleQuote */;\n        case 92 /* Backslash */: return 92 /* Backslash */;\n        default: return code;\n    }\n}\nexport var Access;\n(function (Access) {\n    Access[Access[\"Reset\"] = 0] = \"Reset\";\n    Access[Access[\"Ancestor\"] = 511] = \"Ancestor\";\n    Access[Access[\"This\"] = 512] = \"This\";\n    Access[Access[\"Scope\"] = 1024] = \"Scope\";\n    Access[Access[\"Member\"] = 2048] = \"Member\";\n    Access[Access[\"Keyed\"] = 4096] = \"Keyed\";\n})(Access || (Access = {}));\nexport var Precedence;\n(function (Precedence) {\n    Precedence[Precedence[\"Variadic\"] = 61] = \"Variadic\";\n    Precedence[Precedence[\"Assign\"] = 62] = \"Assign\";\n    Precedence[Precedence[\"Conditional\"] = 63] = \"Conditional\";\n    Precedence[Precedence[\"LogicalOR\"] = 64] = \"LogicalOR\";\n    Precedence[Precedence[\"LogicalAND\"] = 128] = \"LogicalAND\";\n    Precedence[Precedence[\"Equality\"] = 192] = \"Equality\";\n    Precedence[Precedence[\"Relational\"] = 256] = \"Relational\";\n    Precedence[Precedence[\"Additive\"] = 320] = \"Additive\";\n    Precedence[Precedence[\"Multiplicative\"] = 384] = \"Multiplicative\";\n    Precedence[Precedence[\"Binary\"] = 448] = \"Binary\";\n    Precedence[Precedence[\"LeftHandSide\"] = 449] = \"LeftHandSide\";\n    Precedence[Precedence[\"Primary\"] = 450] = \"Primary\";\n    Precedence[Precedence[\"Unary\"] = 451] = \"Unary\";\n})(Precedence || (Precedence = {}));\n/** @internal */\nexport var Token;\n(function (Token) {\n    Token[Token[\"EOF\"] = 1572864] = \"EOF\";\n    Token[Token[\"ExpressionTerminal\"] = 1048576] = \"ExpressionTerminal\";\n    Token[Token[\"AccessScopeTerminal\"] = 524288] = \"AccessScopeTerminal\";\n    Token[Token[\"ClosingToken\"] = 262144] = \"ClosingToken\";\n    Token[Token[\"OpeningToken\"] = 131072] = \"OpeningToken\";\n    Token[Token[\"BinaryOp\"] = 65536] = \"BinaryOp\";\n    Token[Token[\"UnaryOp\"] = 32768] = \"UnaryOp\";\n    Token[Token[\"LeftHandSide\"] = 16384] = \"LeftHandSide\";\n    Token[Token[\"StringOrNumericLiteral\"] = 12288] = \"StringOrNumericLiteral\";\n    Token[Token[\"NumericLiteral\"] = 8192] = \"NumericLiteral\";\n    Token[Token[\"StringLiteral\"] = 4096] = \"StringLiteral\";\n    Token[Token[\"IdentifierName\"] = 3072] = \"IdentifierName\";\n    Token[Token[\"Keyword\"] = 2048] = \"Keyword\";\n    Token[Token[\"Identifier\"] = 1024] = \"Identifier\";\n    Token[Token[\"Contextual\"] = 512] = \"Contextual\";\n    Token[Token[\"Precedence\"] = 448] = \"Precedence\";\n    Token[Token[\"Type\"] = 63] = \"Type\";\n    Token[Token[\"FalseKeyword\"] = 2048] = \"FalseKeyword\";\n    Token[Token[\"TrueKeyword\"] = 2049] = \"TrueKeyword\";\n    Token[Token[\"NullKeyword\"] = 2050] = \"NullKeyword\";\n    Token[Token[\"UndefinedKeyword\"] = 2051] = \"UndefinedKeyword\";\n    Token[Token[\"ThisScope\"] = 3076] = \"ThisScope\";\n    Token[Token[\"ParentScope\"] = 3077] = \"ParentScope\";\n    Token[Token[\"OpenParen\"] = 671750] = \"OpenParen\";\n    Token[Token[\"OpenBrace\"] = 131079] = \"OpenBrace\";\n    Token[Token[\"Dot\"] = 16392] = \"Dot\";\n    Token[Token[\"CloseBrace\"] = 1835017] = \"CloseBrace\";\n    Token[Token[\"CloseParen\"] = 1835018] = \"CloseParen\";\n    Token[Token[\"Comma\"] = 1572875] = \"Comma\";\n    Token[Token[\"OpenBracket\"] = 671756] = \"OpenBracket\";\n    Token[Token[\"CloseBracket\"] = 1835021] = \"CloseBracket\";\n    Token[Token[\"Colon\"] = 1572878] = \"Colon\";\n    Token[Token[\"Question\"] = 1572879] = \"Question\";\n    Token[Token[\"Ampersand\"] = 1572880] = \"Ampersand\";\n    Token[Token[\"Bar\"] = 1572883] = \"Bar\";\n    Token[Token[\"BarBar\"] = 1638548] = \"BarBar\";\n    Token[Token[\"AmpersandAmpersand\"] = 1638613] = \"AmpersandAmpersand\";\n    Token[Token[\"EqualsEquals\"] = 1638678] = \"EqualsEquals\";\n    Token[Token[\"ExclamationEquals\"] = 1638679] = \"ExclamationEquals\";\n    Token[Token[\"EqualsEqualsEquals\"] = 1638680] = \"EqualsEqualsEquals\";\n    Token[Token[\"ExclamationEqualsEquals\"] = 1638681] = \"ExclamationEqualsEquals\";\n    Token[Token[\"LessThan\"] = 1638746] = \"LessThan\";\n    Token[Token[\"GreaterThan\"] = 1638747] = \"GreaterThan\";\n    Token[Token[\"LessThanEquals\"] = 1638748] = \"LessThanEquals\";\n    Token[Token[\"GreaterThanEquals\"] = 1638749] = \"GreaterThanEquals\";\n    Token[Token[\"InKeyword\"] = 1640798] = \"InKeyword\";\n    Token[Token[\"InstanceOfKeyword\"] = 1640799] = \"InstanceOfKeyword\";\n    Token[Token[\"Plus\"] = 623008] = \"Plus\";\n    Token[Token[\"Minus\"] = 623009] = \"Minus\";\n    Token[Token[\"TypeofKeyword\"] = 34850] = \"TypeofKeyword\";\n    Token[Token[\"VoidKeyword\"] = 34851] = \"VoidKeyword\";\n    Token[Token[\"Asterisk\"] = 1638884] = \"Asterisk\";\n    Token[Token[\"Percent\"] = 1638885] = \"Percent\";\n    Token[Token[\"Slash\"] = 1638886] = \"Slash\";\n    Token[Token[\"Equals\"] = 1048615] = \"Equals\";\n    Token[Token[\"Exclamation\"] = 32808] = \"Exclamation\";\n    Token[Token[\"TemplateTail\"] = 540713] = \"TemplateTail\";\n    Token[Token[\"TemplateContinuation\"] = 540714] = \"TemplateContinuation\";\n    Token[Token[\"OfKeyword\"] = 1051179] = \"OfKeyword\";\n})(Token || (Token = {}));\nexport var Char;\n(function (Char) {\n    Char[Char[\"Null\"] = 0] = \"Null\";\n    Char[Char[\"Backspace\"] = 8] = \"Backspace\";\n    Char[Char[\"Tab\"] = 9] = \"Tab\";\n    Char[Char[\"LineFeed\"] = 10] = \"LineFeed\";\n    Char[Char[\"VerticalTab\"] = 11] = \"VerticalTab\";\n    Char[Char[\"FormFeed\"] = 12] = \"FormFeed\";\n    Char[Char[\"CarriageReturn\"] = 13] = \"CarriageReturn\";\n    Char[Char[\"Space\"] = 32] = \"Space\";\n    Char[Char[\"Exclamation\"] = 33] = \"Exclamation\";\n    Char[Char[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n    Char[Char[\"Dollar\"] = 36] = \"Dollar\";\n    Char[Char[\"Percent\"] = 37] = \"Percent\";\n    Char[Char[\"Ampersand\"] = 38] = \"Ampersand\";\n    Char[Char[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    Char[Char[\"OpenParen\"] = 40] = \"OpenParen\";\n    Char[Char[\"CloseParen\"] = 41] = \"CloseParen\";\n    Char[Char[\"Asterisk\"] = 42] = \"Asterisk\";\n    Char[Char[\"Plus\"] = 43] = \"Plus\";\n    Char[Char[\"Comma\"] = 44] = \"Comma\";\n    Char[Char[\"Minus\"] = 45] = \"Minus\";\n    Char[Char[\"Dot\"] = 46] = \"Dot\";\n    Char[Char[\"Slash\"] = 47] = \"Slash\";\n    Char[Char[\"Semicolon\"] = 59] = \"Semicolon\";\n    Char[Char[\"Backtick\"] = 96] = \"Backtick\";\n    Char[Char[\"OpenBracket\"] = 91] = \"OpenBracket\";\n    Char[Char[\"Backslash\"] = 92] = \"Backslash\";\n    Char[Char[\"CloseBracket\"] = 93] = \"CloseBracket\";\n    Char[Char[\"Caret\"] = 94] = \"Caret\";\n    Char[Char[\"Underscore\"] = 95] = \"Underscore\";\n    Char[Char[\"OpenBrace\"] = 123] = \"OpenBrace\";\n    Char[Char[\"Bar\"] = 124] = \"Bar\";\n    Char[Char[\"CloseBrace\"] = 125] = \"CloseBrace\";\n    Char[Char[\"Colon\"] = 58] = \"Colon\";\n    Char[Char[\"LessThan\"] = 60] = \"LessThan\";\n    Char[Char[\"Equals\"] = 61] = \"Equals\";\n    Char[Char[\"GreaterThan\"] = 62] = \"GreaterThan\";\n    Char[Char[\"Question\"] = 63] = \"Question\";\n    Char[Char[\"Zero\"] = 48] = \"Zero\";\n    Char[Char[\"One\"] = 49] = \"One\";\n    Char[Char[\"Two\"] = 50] = \"Two\";\n    Char[Char[\"Three\"] = 51] = \"Three\";\n    Char[Char[\"Four\"] = 52] = \"Four\";\n    Char[Char[\"Five\"] = 53] = \"Five\";\n    Char[Char[\"Six\"] = 54] = \"Six\";\n    Char[Char[\"Seven\"] = 55] = \"Seven\";\n    Char[Char[\"Eight\"] = 56] = \"Eight\";\n    Char[Char[\"Nine\"] = 57] = \"Nine\";\n    Char[Char[\"UpperA\"] = 65] = \"UpperA\";\n    Char[Char[\"UpperB\"] = 66] = \"UpperB\";\n    Char[Char[\"UpperC\"] = 67] = \"UpperC\";\n    Char[Char[\"UpperD\"] = 68] = \"UpperD\";\n    Char[Char[\"UpperE\"] = 69] = \"UpperE\";\n    Char[Char[\"UpperF\"] = 70] = \"UpperF\";\n    Char[Char[\"UpperG\"] = 71] = \"UpperG\";\n    Char[Char[\"UpperH\"] = 72] = \"UpperH\";\n    Char[Char[\"UpperI\"] = 73] = \"UpperI\";\n    Char[Char[\"UpperJ\"] = 74] = \"UpperJ\";\n    Char[Char[\"UpperK\"] = 75] = \"UpperK\";\n    Char[Char[\"UpperL\"] = 76] = \"UpperL\";\n    Char[Char[\"UpperM\"] = 77] = \"UpperM\";\n    Char[Char[\"UpperN\"] = 78] = \"UpperN\";\n    Char[Char[\"UpperO\"] = 79] = \"UpperO\";\n    Char[Char[\"UpperP\"] = 80] = \"UpperP\";\n    Char[Char[\"UpperQ\"] = 81] = \"UpperQ\";\n    Char[Char[\"UpperR\"] = 82] = \"UpperR\";\n    Char[Char[\"UpperS\"] = 83] = \"UpperS\";\n    Char[Char[\"UpperT\"] = 84] = \"UpperT\";\n    Char[Char[\"UpperU\"] = 85] = \"UpperU\";\n    Char[Char[\"UpperV\"] = 86] = \"UpperV\";\n    Char[Char[\"UpperW\"] = 87] = \"UpperW\";\n    Char[Char[\"UpperX\"] = 88] = \"UpperX\";\n    Char[Char[\"UpperY\"] = 89] = \"UpperY\";\n    Char[Char[\"UpperZ\"] = 90] = \"UpperZ\";\n    Char[Char[\"LowerA\"] = 97] = \"LowerA\";\n    Char[Char[\"LowerB\"] = 98] = \"LowerB\";\n    Char[Char[\"LowerC\"] = 99] = \"LowerC\";\n    Char[Char[\"LowerD\"] = 100] = \"LowerD\";\n    Char[Char[\"LowerE\"] = 101] = \"LowerE\";\n    Char[Char[\"LowerF\"] = 102] = \"LowerF\";\n    Char[Char[\"LowerG\"] = 103] = \"LowerG\";\n    Char[Char[\"LowerH\"] = 104] = \"LowerH\";\n    Char[Char[\"LowerI\"] = 105] = \"LowerI\";\n    Char[Char[\"LowerJ\"] = 106] = \"LowerJ\";\n    Char[Char[\"LowerK\"] = 107] = \"LowerK\";\n    Char[Char[\"LowerL\"] = 108] = \"LowerL\";\n    Char[Char[\"LowerM\"] = 109] = \"LowerM\";\n    Char[Char[\"LowerN\"] = 110] = \"LowerN\";\n    Char[Char[\"LowerO\"] = 111] = \"LowerO\";\n    Char[Char[\"LowerP\"] = 112] = \"LowerP\";\n    Char[Char[\"LowerQ\"] = 113] = \"LowerQ\";\n    Char[Char[\"LowerR\"] = 114] = \"LowerR\";\n    Char[Char[\"LowerS\"] = 115] = \"LowerS\";\n    Char[Char[\"LowerT\"] = 116] = \"LowerT\";\n    Char[Char[\"LowerU\"] = 117] = \"LowerU\";\n    Char[Char[\"LowerV\"] = 118] = \"LowerV\";\n    Char[Char[\"LowerW\"] = 119] = \"LowerW\";\n    Char[Char[\"LowerX\"] = 120] = \"LowerX\";\n    Char[Char[\"LowerY\"] = 121] = \"LowerY\";\n    Char[Char[\"LowerZ\"] = 122] = \"LowerZ\";\n})(Char || (Char = {}));\n//# sourceMappingURL=common.js.map","import { Reporter } from '@aurelia/kernel';\nimport { AccessKeyedExpression, AccessMemberExpression, AccessScopeExpression, AccessThisExpression, ArrayBindingPattern, ArrayLiteralExpression, AssignExpression, BinaryExpression, BindingBehaviorExpression, BindingIdentifier, CallFunctionExpression, CallMemberExpression, CallScopeExpression, ConditionalExpression, CustomExpression, ForOfStatement, Interpolation, ObjectBindingPattern, ObjectLiteralExpression, PrimitiveLiteralExpression, TaggedTemplateExpression, TemplateExpression, UnaryExpression, ValueConverterExpression } from '@aurelia/runtime';\nimport { unescapeCode } from './common';\nconst $false = PrimitiveLiteralExpression.$false;\nconst $true = PrimitiveLiteralExpression.$true;\nconst $null = PrimitiveLiteralExpression.$null;\nconst $undefined = PrimitiveLiteralExpression.$undefined;\nconst $this = AccessThisExpression.$this;\nconst $parent = AccessThisExpression.$parent;\n/** @internal */\nexport class ParserState {\n    constructor(input) {\n        this.input = input;\n        this.index = 0;\n        this.startIndex = 0;\n        this.lastIndex = 0;\n        this.currentToken = 1572864 /* EOF */;\n        this.tokenValue = '';\n        this.assignable = true;\n        this.length = input.length;\n        this.currentChar = input.charCodeAt(0);\n    }\n    get tokenRaw() {\n        return this.input.slice(this.startIndex, this.index);\n    }\n}\nconst $state = new ParserState('');\nvar SyntaxError;\n(function (SyntaxError) {\n    SyntaxError[SyntaxError[\"InvalidExpressionStart\"] = 100] = \"InvalidExpressionStart\";\n    SyntaxError[SyntaxError[\"UnconsumedToken\"] = 101] = \"UnconsumedToken\";\n    SyntaxError[SyntaxError[\"DoubleDot\"] = 102] = \"DoubleDot\";\n    SyntaxError[SyntaxError[\"InvalidMemberExpression\"] = 103] = \"InvalidMemberExpression\";\n    SyntaxError[SyntaxError[\"UnexpectedEndOfExpression\"] = 104] = \"UnexpectedEndOfExpression\";\n    SyntaxError[SyntaxError[\"ExpectedIdentifier\"] = 105] = \"ExpectedIdentifier\";\n    SyntaxError[SyntaxError[\"InvalidForDeclaration\"] = 106] = \"InvalidForDeclaration\";\n    SyntaxError[SyntaxError[\"InvalidObjectLiteralPropertyDefinition\"] = 107] = \"InvalidObjectLiteralPropertyDefinition\";\n    SyntaxError[SyntaxError[\"UnterminatedQuote\"] = 108] = \"UnterminatedQuote\";\n    SyntaxError[SyntaxError[\"UnterminatedTemplate\"] = 109] = \"UnterminatedTemplate\";\n    SyntaxError[SyntaxError[\"MissingExpectedToken\"] = 110] = \"MissingExpectedToken\";\n    SyntaxError[SyntaxError[\"UnexpectedCharacter\"] = 111] = \"UnexpectedCharacter\";\n    SyntaxError[SyntaxError[\"MissingValueConverter\"] = 112] = \"MissingValueConverter\";\n    SyntaxError[SyntaxError[\"MissingBindingBehavior\"] = 113] = \"MissingBindingBehavior\";\n})(SyntaxError || (SyntaxError = {}));\nvar SemanticError;\n(function (SemanticError) {\n    SemanticError[SemanticError[\"NotAssignable\"] = 150] = \"NotAssignable\";\n    SemanticError[SemanticError[\"UnexpectedForOf\"] = 151] = \"UnexpectedForOf\";\n})(SemanticError || (SemanticError = {}));\nexport function parseExpression(input, bindingType) {\n    $state.input = input;\n    $state.length = input.length;\n    $state.index = 0;\n    $state.currentChar = input.charCodeAt(0);\n    return parse($state, 0 /* Reset */, 61 /* Variadic */, bindingType === void 0 ? 53 /* BindCommand */ : bindingType);\n}\n/** @internal */\n// JUSTIFICATION: This is performance-critical code which follows a subset of the well-known ES spec.\n// Knowing the spec, or parsers in general, will help with understanding this code and it is therefore not the\n// single source of information for being able to figure it out.\n// It generally does not need to change unless the spec changes or spec violations are found, or optimization\n// opportunities are found (which would likely not fix these warnings in any case).\n// It's therefore not considered to have any tangible impact on the maintainability of the code base.\n// For reference, most of the parsing logic is based on: https://tc39.github.io/ecma262/#sec-ecmascript-language-expressions\n// eslint-disable-next-line max-lines-per-function\nexport function parse(state, access, minPrecedence, bindingType) {\n    if (bindingType === 284 /* CustomCommand */) {\n        return new CustomExpression(state.input);\n    }\n    if (state.index === 0) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseInterpolation(state);\n        }\n        nextToken(state);\n        if (state.currentToken & 1048576 /* ExpressionTerminal */) {\n            throw Reporter.error(100 /* InvalidExpressionStart */, { state });\n        }\n    }\n    state.assignable = 448 /* Binary */ > minPrecedence;\n    let result = void 0;\n    if (state.currentToken & 32768 /* UnaryOp */) {\n        /** parseUnaryExpression\n         * https://tc39.github.io/ecma262/#sec-unary-operators\n         *\n         * UnaryExpression :\n         * 1. LeftHandSideExpression\n         * 2. void UnaryExpression\n         * 3. typeof UnaryExpression\n         * 4. + UnaryExpression\n         * 5. - UnaryExpression\n         * 6. ! UnaryExpression\n         *\n         * IsValidAssignmentTarget\n         * 2,3,4,5,6 = false\n         * 1 = see parseLeftHandSideExpression\n         *\n         * Note: technically we should throw on ++ / -- / +++ / ---, but there's nothing to gain from that\n         */\n        const op = TokenValues[state.currentToken & 63 /* Type */];\n        nextToken(state);\n        result = new UnaryExpression(op, parse(state, access, 449 /* LeftHandSide */, bindingType));\n        state.assignable = false;\n    }\n    else {\n        /** parsePrimaryExpression\n         * https://tc39.github.io/ecma262/#sec-primary-expression\n         *\n         * PrimaryExpression :\n         * 1. this\n         * 2. IdentifierName\n         * 3. Literal\n         * 4. ArrayLiteralExpression\n         * 5. ObjectLiteralExpression\n         * 6. TemplateLiteral\n         * 7. ParenthesizedExpression\n         *\n         * Literal :\n         * NullLiteral\n         * BooleanLiteral\n         * NumericLiteral\n         * StringLiteral\n         *\n         * ParenthesizedExpression :\n         * ( AssignmentExpression )\n         *\n         * IsValidAssignmentTarget\n         * 1,3,4,5,6,7 = false\n         * 2 = true\n         */\n        primary: switch (state.currentToken) {\n            case 3077 /* ParentScope */: // $parent\n                state.assignable = false;\n                do {\n                    nextToken(state);\n                    access++; // ancestor\n                    if (consumeOpt(state, 16392 /* Dot */)) {\n                        if (state.currentToken === 16392 /* Dot */) {\n                            throw Reporter.error(102 /* DoubleDot */, { state });\n                        }\n                        else if (state.currentToken === 1572864 /* EOF */) {\n                            throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                        }\n                    }\n                    else if (state.currentToken & 524288 /* AccessScopeTerminal */) {\n                        const ancestor = access & 511 /* Ancestor */;\n                        result = ancestor === 0 ? $this : ancestor === 1 ? $parent : new AccessThisExpression(ancestor);\n                        access = 512 /* This */;\n                        break primary;\n                    }\n                    else {\n                        throw Reporter.error(103 /* InvalidMemberExpression */, { state });\n                    }\n                } while (state.currentToken === 3077 /* ParentScope */);\n            // falls through\n            case 1024 /* Identifier */: // identifier\n                if (bindingType & 512 /* IsIterator */) {\n                    result = new BindingIdentifier(state.tokenValue);\n                }\n                else {\n                    result = new AccessScopeExpression(state.tokenValue, access & 511 /* Ancestor */);\n                    access = 1024 /* Scope */;\n                }\n                state.assignable = true;\n                nextToken(state);\n                break;\n            case 3076 /* ThisScope */: // $this\n                state.assignable = false;\n                nextToken(state);\n                result = $this;\n                access = 512 /* This */;\n                break;\n            case 671750 /* OpenParen */: // parenthesized expression\n                nextToken(state);\n                result = parse(state, 0 /* Reset */, 62 /* Assign */, bindingType);\n                consume(state, 1835018 /* CloseParen */);\n                access = 0 /* Reset */;\n                break;\n            case 671756 /* OpenBracket */:\n                result = parseArrayLiteralExpression(state, access, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 131079 /* OpenBrace */:\n                result = parseObjectLiteralExpression(state, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 540713 /* TemplateTail */:\n                result = new TemplateExpression([state.tokenValue]);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 540714 /* TemplateContinuation */:\n                result = parseTemplate(state, access, bindingType, result, false);\n                access = 0 /* Reset */;\n                break;\n            case 4096 /* StringLiteral */:\n            case 8192 /* NumericLiteral */:\n                result = new PrimitiveLiteralExpression(state.tokenValue);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 2050 /* NullKeyword */:\n            case 2051 /* UndefinedKeyword */:\n            case 2049 /* TrueKeyword */:\n            case 2048 /* FalseKeyword */:\n                result = TokenValues[state.currentToken & 63 /* Type */];\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            default:\n                if (state.index >= state.length) {\n                    throw Reporter.error(104 /* UnexpectedEndOfExpression */, { state });\n                }\n                else {\n                    throw Reporter.error(101 /* UnconsumedToken */, { state });\n                }\n        }\n        if (bindingType & 512 /* IsIterator */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseForOfStatement(state, result);\n        }\n        if (449 /* LeftHandSide */ < minPrecedence) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        /** parseMemberExpression (Token.Dot, Token.OpenBracket, Token.TemplateContinuation)\n         * MemberExpression :\n         * 1. PrimaryExpression\n         * 2. MemberExpression [ AssignmentExpression ]\n         * 3. MemberExpression . IdentifierName\n         * 4. MemberExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,4 = false\n         * 2,3 = true\n         *\n         *\n         * parseCallExpression (Token.OpenParen)\n         * CallExpression :\n         * 1. MemberExpression Arguments\n         * 2. CallExpression Arguments\n         * 3. CallExpression [ AssignmentExpression ]\n         * 4. CallExpression . IdentifierName\n         * 5. CallExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,2,5 = false\n         * 3,4 = true\n         */\n        let name = state.tokenValue;\n        while ((state.currentToken & 16384 /* LeftHandSide */) > 0) {\n            const args = [];\n            let strings;\n            switch (state.currentToken) {\n                case 16392 /* Dot */:\n                    state.assignable = true;\n                    nextToken(state);\n                    if ((state.currentToken & 3072 /* IdentifierName */) === 0) {\n                        throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                    }\n                    name = state.tokenValue;\n                    nextToken(state);\n                    // Change $This to $Scope, change $Scope to $Member, keep $Member as-is, change $Keyed to $Member, disregard other flags\n                    access = ((access & (512 /* This */ | 1024 /* Scope */)) << 1) | (access & 2048 /* Member */) | ((access & 4096 /* Keyed */) >> 1);\n                    if (state.currentToken === 671750 /* OpenParen */) {\n                        if (access === 0 /* Reset */) { // if the left hand side is a literal, make sure we parse a CallMemberExpression\n                            access = 2048 /* Member */;\n                        }\n                        continue;\n                    }\n                    if (access & 1024 /* Scope */) {\n                        result = new AccessScopeExpression(name, result.ancestor);\n                    }\n                    else { // if it's not $Scope, it's $Member\n                        result = new AccessMemberExpression(result, name);\n                    }\n                    continue;\n                case 671756 /* OpenBracket */:\n                    state.assignable = true;\n                    nextToken(state);\n                    access = 4096 /* Keyed */;\n                    result = new AccessKeyedExpression(result, parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                    consume(state, 1835021 /* CloseBracket */);\n                    break;\n                case 671750 /* OpenParen */:\n                    state.assignable = false;\n                    nextToken(state);\n                    while (state.currentToken !== 1835018 /* CloseParen */) {\n                        args.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                        if (!consumeOpt(state, 1572875 /* Comma */)) {\n                            break;\n                        }\n                    }\n                    consume(state, 1835018 /* CloseParen */);\n                    if (access & 1024 /* Scope */) {\n                        result = new CallScopeExpression(name, args, result.ancestor);\n                    }\n                    else if (access & 2048 /* Member */) {\n                        result = new CallMemberExpression(result, name, args);\n                    }\n                    else {\n                        result = new CallFunctionExpression(result, args);\n                    }\n                    access = 0;\n                    break;\n                case 540713 /* TemplateTail */:\n                    state.assignable = false;\n                    strings = [state.tokenValue];\n                    result = new TaggedTemplateExpression(strings, strings, result);\n                    nextToken(state);\n                    break;\n                case 540714 /* TemplateContinuation */:\n                    result = parseTemplate(state, access, bindingType, result, true);\n                default:\n            }\n        }\n    }\n    if (448 /* Binary */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseBinaryExpression\n     * https://tc39.github.io/ecma262/#sec-multiplicative-operators\n     *\n     * MultiplicativeExpression : (local precedence 6)\n     * UnaryExpression\n     * MultiplicativeExpression * / % UnaryExpression\n     *\n     * AdditiveExpression : (local precedence 5)\n     * MultiplicativeExpression\n     * AdditiveExpression + - MultiplicativeExpression\n     *\n     * RelationalExpression : (local precedence 4)\n     * AdditiveExpression\n     * RelationalExpression < > <= >= instanceof in AdditiveExpression\n     *\n     * EqualityExpression : (local precedence 3)\n     * RelationalExpression\n     * EqualityExpression == != === !== RelationalExpression\n     *\n     * LogicalANDExpression : (local precedence 2)\n     * EqualityExpression\n     * LogicalANDExpression && EqualityExpression\n     *\n     * LogicalORExpression : (local precedence 1)\n     * LogicalANDExpression\n     * LogicalORExpression || LogicalANDExpression\n     */\n    while ((state.currentToken & 65536 /* BinaryOp */) > 0) {\n        const opToken = state.currentToken;\n        if ((opToken & 448 /* Precedence */) <= minPrecedence) {\n            break;\n        }\n        nextToken(state);\n        result = new BinaryExpression(TokenValues[opToken & 63 /* Type */], result, parse(state, access, opToken & 448 /* Precedence */, bindingType));\n        state.assignable = false;\n    }\n    if (63 /* Conditional */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /**\n     * parseConditionalExpression\n     * https://tc39.github.io/ecma262/#prod-ConditionalExpression\n     *\n     * ConditionalExpression :\n     * 1. BinaryExpression\n     * 2. BinaryExpression ? AssignmentExpression : AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1572879 /* Question */)) {\n        const yes = parse(state, access, 62 /* Assign */, bindingType);\n        consume(state, 1572878 /* Colon */);\n        result = new ConditionalExpression(result, yes, parse(state, access, 62 /* Assign */, bindingType));\n        state.assignable = false;\n    }\n    if (62 /* Assign */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseAssignmentExpression\n     * https://tc39.github.io/ecma262/#prod-AssignmentExpression\n     * Note: AssignmentExpression here is equivalent to ES Expression because we don't parse the comma operator\n     *\n     * AssignmentExpression :\n     * 1. ConditionalExpression\n     * 2. LeftHandSideExpression = AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1048615 /* Equals */)) {\n        if (!state.assignable) {\n            throw Reporter.error(150 /* NotAssignable */, { state });\n        }\n        result = new AssignExpression(result, parse(state, access, 62 /* Assign */, bindingType));\n    }\n    if (61 /* Variadic */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseValueConverter\n     */\n    while (consumeOpt(state, 1572883 /* Bar */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(112);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new ValueConverterExpression(result, name, args);\n    }\n    /** parseBindingBehavior\n     */\n    while (consumeOpt(state, 1572880 /* Ampersand */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(113);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new BindingBehaviorExpression(result, name, args);\n    }\n    if (state.currentToken !== 1572864 /* EOF */) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        if (state.tokenRaw === 'of') {\n            throw Reporter.error(151 /* UnexpectedForOf */, { state });\n        }\n        throw Reporter.error(101 /* UnconsumedToken */, { state });\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return result;\n}\n/**\n * parseArrayLiteralExpression\n * https://tc39.github.io/ecma262/#prod-ArrayLiteralExpression\n *\n * ArrayLiteralExpression :\n * [ Elision(opt) ]\n * [ ElementList ]\n * [ ElementList, Elision(opt) ]\n *\n * ElementList :\n * Elision(opt) AssignmentExpression\n * ElementList, Elision(opt) AssignmentExpression\n *\n * Elision :\n * ,\n * Elision ,\n */\nfunction parseArrayLiteralExpression(state, access, bindingType) {\n    nextToken(state);\n    const elements = new Array();\n    while (state.currentToken !== 1835021 /* CloseBracket */) {\n        if (consumeOpt(state, 1572875 /* Comma */)) {\n            elements.push($undefined);\n            if (state.currentToken === 1835021 /* CloseBracket */) {\n                break;\n            }\n        }\n        else {\n            elements.push(parse(state, access, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            if (consumeOpt(state, 1572875 /* Comma */)) {\n                if (state.currentToken === 1835021 /* CloseBracket */) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n    }\n    consume(state, 1835021 /* CloseBracket */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ArrayBindingPattern(elements);\n    }\n    else {\n        state.assignable = false;\n        return new ArrayLiteralExpression(elements);\n    }\n}\nfunction parseForOfStatement(state, result) {\n    if ((result.$kind & 65536 /* IsForDeclaration */) === 0) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    if (state.currentToken !== 1051179 /* OfKeyword */) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    nextToken(state);\n    const declaration = result;\n    const statement = parse(state, 0 /* Reset */, 61 /* Variadic */, 0 /* None */);\n    return new ForOfStatement(declaration, statement);\n}\n/**\n * parseObjectLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * ObjectLiteralExpression :\n * { }\n * { PropertyDefinitionList }\n *\n * PropertyDefinitionList :\n * PropertyDefinition\n * PropertyDefinitionList, PropertyDefinition\n *\n * PropertyDefinition :\n * IdentifierName\n * PropertyName : AssignmentExpression\n *\n * PropertyName :\n * IdentifierName\n * StringLiteral\n * NumericLiteral\n */\nfunction parseObjectLiteralExpression(state, bindingType) {\n    const keys = new Array();\n    const values = new Array();\n    nextToken(state);\n    while (state.currentToken !== 1835017 /* CloseBrace */) {\n        keys.push(state.tokenValue);\n        // Literal = mandatory colon\n        if (state.currentToken & 12288 /* StringOrNumericLiteral */) {\n            nextToken(state);\n            consume(state, 1572878 /* Colon */);\n            values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n        }\n        else if (state.currentToken & 3072 /* IdentifierName */) {\n            // IdentifierName = optional colon\n            const { currentChar, currentToken, index } = state;\n            nextToken(state);\n            if (consumeOpt(state, 1572878 /* Colon */)) {\n                values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            }\n            else {\n                // Shorthand\n                state.currentChar = currentChar;\n                state.currentToken = currentToken;\n                state.index = index;\n                values.push(parse(state, 0 /* Reset */, 450 /* Primary */, bindingType & ~512 /* IsIterator */));\n            }\n        }\n        else {\n            throw Reporter.error(107 /* InvalidObjectLiteralPropertyDefinition */, { state });\n        }\n        if (state.currentToken !== 1835017 /* CloseBrace */) {\n            consume(state, 1572875 /* Comma */);\n        }\n    }\n    consume(state, 1835017 /* CloseBrace */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ObjectBindingPattern(keys, values);\n    }\n    else {\n        state.assignable = false;\n        return new ObjectLiteralExpression(keys, values);\n    }\n}\nfunction parseInterpolation(state) {\n    const parts = [];\n    const expressions = [];\n    const length = state.length;\n    let result = '';\n    while (state.index < length) {\n        switch (state.currentChar) {\n            case 36 /* Dollar */:\n                if (state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                    parts.push(result);\n                    result = '';\n                    state.index += 2;\n                    state.currentChar = state.input.charCodeAt(state.index);\n                    nextToken(state);\n                    const expression = parse(state, 0 /* Reset */, 61 /* Variadic */, 2048 /* Interpolation */);\n                    expressions.push(expression);\n                    continue;\n                }\n                else {\n                    result += '$';\n                }\n                break;\n            case 92 /* Backslash */:\n                result += String.fromCharCode(unescapeCode(nextChar(state)));\n                break;\n            default:\n                result += String.fromCharCode(state.currentChar);\n        }\n        nextChar(state);\n    }\n    if (expressions.length) {\n        parts.push(result);\n        return new Interpolation(parts, expressions);\n    }\n    return null;\n}\n/**\n * parseTemplateLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * TemplateExpression :\n * NoSubstitutionTemplate\n * TemplateHead\n *\n * NoSubstitutionTemplate :\n * ` TemplateCharacters(opt) `\n *\n * TemplateHead :\n * ` TemplateCharacters(opt) ${\n *\n * TemplateSubstitutionTail :\n * TemplateMiddle\n * TemplateTail\n *\n * TemplateMiddle :\n * } TemplateCharacters(opt) ${\n *\n * TemplateTail :\n * } TemplateCharacters(opt) `\n *\n * TemplateCharacters :\n * TemplateCharacter TemplateCharacters(opt)\n *\n * TemplateCharacter :\n * $ [lookahead ≠ {]\n * \\ EscapeSequence\n * SourceCharacter (but not one of ` or \\ or $)\n */\nfunction parseTemplate(state, access, bindingType, result, tagged) {\n    const cooked = [state.tokenValue];\n    // TODO: properly implement raw parts / decide whether we want this\n    consume(state, 540714 /* TemplateContinuation */);\n    const expressions = [parse(state, access, 62 /* Assign */, bindingType)];\n    while ((state.currentToken = scanTemplateTail(state)) !== 540713 /* TemplateTail */) {\n        cooked.push(state.tokenValue);\n        consume(state, 540714 /* TemplateContinuation */);\n        expressions.push(parse(state, access, 62 /* Assign */, bindingType));\n    }\n    cooked.push(state.tokenValue);\n    state.assignable = false;\n    if (tagged) {\n        nextToken(state);\n        return new TaggedTemplateExpression(cooked, cooked, result, expressions);\n    }\n    else {\n        nextToken(state);\n        return new TemplateExpression(cooked, expressions);\n    }\n}\nfunction nextToken(state) {\n    while (state.index < state.length) {\n        state.startIndex = state.index;\n        if ((state.currentToken = (CharScanners[state.currentChar](state))) != null) { // a null token means the character must be skipped\n            return;\n        }\n    }\n    state.currentToken = 1572864 /* EOF */;\n}\nfunction nextChar(state) {\n    return state.currentChar = state.input.charCodeAt(++state.index);\n}\nfunction scanIdentifier(state) {\n    // run to the next non-idPart\n    while (IdParts[nextChar(state)])\n        ;\n    const token = KeywordLookup[state.tokenValue = state.tokenRaw];\n    return token === undefined ? 1024 /* Identifier */ : token;\n}\nfunction scanNumber(state, isFloat) {\n    let char = state.currentChar;\n    if (isFloat === false) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n        if (char !== 46 /* Dot */) {\n            state.tokenValue = parseInt(state.tokenRaw, 10);\n            return 8192 /* NumericLiteral */;\n        }\n        // past this point it's always a float\n        char = nextChar(state);\n        if (state.index >= state.length) {\n            // unless the number ends with a dot - that behaves a little different in native ES expressions\n            // but in our AST that behavior has no effect because numbers are always stored in variables\n            state.tokenValue = parseInt(state.tokenRaw.slice(0, -1), 10);\n            return 8192 /* NumericLiteral */;\n        }\n    }\n    if (char <= 57 /* Nine */ && char >= 48 /* Zero */) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n    }\n    else {\n        state.currentChar = state.input.charCodeAt(--state.index);\n    }\n    state.tokenValue = parseFloat(state.tokenRaw);\n    return 8192 /* NumericLiteral */;\n}\nfunction scanString(state) {\n    const quote = state.currentChar;\n    nextChar(state); // Skip initial quote.\n    let unescaped = 0;\n    const buffer = new Array();\n    let marker = state.index;\n    while (state.currentChar !== quote) {\n        if (state.currentChar === 92 /* Backslash */) {\n            buffer.push(state.input.slice(marker, state.index));\n            nextChar(state);\n            unescaped = unescapeCode(state.currentChar);\n            nextChar(state);\n            buffer.push(String.fromCharCode(unescaped));\n            marker = state.index;\n        }\n        else if (state.index >= state.length) {\n            throw Reporter.error(108 /* UnterminatedQuote */, { state });\n        }\n        else {\n            nextChar(state);\n        }\n    }\n    const last = state.input.slice(marker, state.index);\n    nextChar(state); // Skip terminating quote.\n    // Compute the unescaped string value.\n    buffer.push(last);\n    const unescapedStr = buffer.join('');\n    state.tokenValue = unescapedStr;\n    return 4096 /* StringLiteral */;\n}\nfunction scanTemplate(state) {\n    let tail = true;\n    let result = '';\n    while (nextChar(state) !== 96 /* Backtick */) {\n        if (state.currentChar === 36 /* Dollar */) {\n            if ((state.index + 1) < state.length && state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                state.index++;\n                tail = false;\n                break;\n            }\n            else {\n                result += '$';\n            }\n        }\n        else if (state.currentChar === 92 /* Backslash */) {\n            result += String.fromCharCode(unescapeCode(nextChar(state)));\n        }\n        else {\n            if (state.index >= state.length) {\n                throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n            }\n            result += String.fromCharCode(state.currentChar);\n        }\n    }\n    nextChar(state);\n    state.tokenValue = result;\n    if (tail) {\n        return 540713 /* TemplateTail */;\n    }\n    return 540714 /* TemplateContinuation */;\n}\nfunction scanTemplateTail(state) {\n    if (state.index >= state.length) {\n        throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n    }\n    state.index--;\n    return scanTemplate(state);\n}\nfunction consumeOpt(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n        return true;\n    }\n    return false;\n}\nfunction consume(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n    }\n    else {\n        throw Reporter.error(110 /* MissingExpectedToken */, { state, expected: token });\n    }\n}\n/**\n * Array for mapping tokens to token values. The indices of the values\n * correspond to the token bits 0-38.\n * For this to work properly, the values in the array must be kept in\n * the same order as the token bits.\n * Usage: TokenValues[token & Token.Type]\n */\nconst TokenValues = [\n    $false, $true, $null, $undefined, '$this', '$parent',\n    '(', '{', '.', '}', ')', ',', '[', ']', ':', '?', '\\'', '\"',\n    '&', '|', '||', '&&', '==', '!=', '===', '!==', '<', '>',\n    '<=', '>=', 'in', 'instanceof', '+', '-', 'typeof', 'void', '*', '%', '/', '=', '!',\n    540713 /* TemplateTail */, 540714 /* TemplateContinuation */,\n    'of'\n];\nconst KeywordLookup = Object.create(null);\nKeywordLookup.true = 2049 /* TrueKeyword */;\nKeywordLookup.null = 2050 /* NullKeyword */;\nKeywordLookup.false = 2048 /* FalseKeyword */;\nKeywordLookup.undefined = 2051 /* UndefinedKeyword */;\nKeywordLookup.$this = 3076 /* ThisScope */;\nKeywordLookup.$parent = 3077 /* ParentScope */;\nKeywordLookup.in = 1640798 /* InKeyword */;\nKeywordLookup.instanceof = 1640799 /* InstanceOfKeyword */;\nKeywordLookup.typeof = 34850 /* TypeofKeyword */;\nKeywordLookup.void = 34851 /* VoidKeyword */;\nKeywordLookup.of = 1051179 /* OfKeyword */;\n/**\n * Ranges of code points in pairs of 2 (eg 0x41-0x5B, 0x61-0x7B, ...) where the second value is not inclusive (5-7 means 5 and 6)\n * Single values are denoted by the second value being a 0\n *\n * Copied from output generated with \"node build/generate-unicode.js\"\n *\n * See also: https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF\n */\nconst codes = {\n    /* [$0-9A-Za_a-z] */\n    AsciiIdPart: [0x24, 0, 0x30, 0x3A, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B],\n    IdStart: /* IdentifierStart */ [0x24, 0, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B, 0xAA, 0, 0xBA, 0, 0xC0, 0xD7, 0xD8, 0xF7, 0xF8, 0x2B9, 0x2E0, 0x2E5, 0x1D00, 0x1D26, 0x1D2C, 0x1D5D, 0x1D62, 0x1D66, 0x1D6B, 0x1D78, 0x1D79, 0x1DBF, 0x1E00, 0x1F00, 0x2071, 0, 0x207F, 0, 0x2090, 0x209D, 0x212A, 0x212C, 0x2132, 0, 0x214E, 0, 0x2160, 0x2189, 0x2C60, 0x2C80, 0xA722, 0xA788, 0xA78B, 0xA7AF, 0xA7B0, 0xA7B8, 0xA7F7, 0xA800, 0xAB30, 0xAB5B, 0xAB5C, 0xAB65, 0xFB00, 0xFB07, 0xFF21, 0xFF3B, 0xFF41, 0xFF5B],\n    Digit: /* DecimalNumber */ [0x30, 0x3A],\n    Skip: /* Skippable */ [0, 0x21, 0x7F, 0xA1]\n};\n/**\n * Decompress the ranges into an array of numbers so that the char code\n * can be used as an index to the lookup\n */\nfunction decompress(lookup, $set, compressed, value) {\n    const rangeCount = compressed.length;\n    for (let i = 0; i < rangeCount; i += 2) {\n        const start = compressed[i];\n        let end = compressed[i + 1];\n        end = end > 0 ? end : start + 1;\n        if (lookup) {\n            lookup.fill(value, start, end);\n        }\n        if ($set) {\n            for (let ch = start; ch < end; ch++) {\n                $set.add(ch);\n            }\n        }\n    }\n}\n// CharFuncLookup functions\nfunction returnToken(token) {\n    return s => {\n        nextChar(s);\n        return token;\n    };\n}\nconst unexpectedCharacter = s => {\n    throw Reporter.error(111 /* UnexpectedCharacter */, { state: s });\n};\nunexpectedCharacter.notMapped = true;\n// ASCII IdentifierPart lookup\nconst AsciiIdParts = new Set();\ndecompress(null, AsciiIdParts, codes.AsciiIdPart, true);\n// IdentifierPart lookup\nconst IdParts = new Uint8Array(0xFFFF);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.IdStart, 1);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.Digit, 1);\n// Character scanning function lookup\nconst CharScanners = new Array(0xFFFF);\nCharScanners.fill(unexpectedCharacter, 0, 0xFFFF);\ndecompress(CharScanners, null, codes.Skip, s => {\n    nextChar(s);\n    return null;\n});\ndecompress(CharScanners, null, codes.IdStart, scanIdentifier);\ndecompress(CharScanners, null, codes.Digit, s => scanNumber(s, false));\nCharScanners[34 /* DoubleQuote */] =\n    CharScanners[39 /* SingleQuote */] = s => {\n        return scanString(s);\n    };\nCharScanners[96 /* Backtick */] = s => {\n    return scanTemplate(s);\n};\n// !, !=, !==\nCharScanners[33 /* Exclamation */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 32808 /* Exclamation */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638679 /* ExclamationEquals */;\n    }\n    nextChar(s);\n    return 1638681 /* ExclamationEqualsEquals */;\n};\n// =, ==, ===\nCharScanners[61 /* Equals */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1048615 /* Equals */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638678 /* EqualsEquals */;\n    }\n    nextChar(s);\n    return 1638680 /* EqualsEqualsEquals */;\n};\n// &, &&\nCharScanners[38 /* Ampersand */] = s => {\n    if (nextChar(s) !== 38 /* Ampersand */) {\n        return 1572880 /* Ampersand */;\n    }\n    nextChar(s);\n    return 1638613 /* AmpersandAmpersand */;\n};\n// |, ||\nCharScanners[124 /* Bar */] = s => {\n    if (nextChar(s) !== 124 /* Bar */) {\n        return 1572883 /* Bar */;\n    }\n    nextChar(s);\n    return 1638548 /* BarBar */;\n};\n// .\nCharScanners[46 /* Dot */] = s => {\n    if (nextChar(s) <= 57 /* Nine */ && s.currentChar >= 48 /* Zero */) {\n        return scanNumber(s, true);\n    }\n    return 16392 /* Dot */;\n};\n// <, <=\nCharScanners[60 /* LessThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638746 /* LessThan */;\n    }\n    nextChar(s);\n    return 1638748 /* LessThanEquals */;\n};\n// >, >=\nCharScanners[62 /* GreaterThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638747 /* GreaterThan */;\n    }\n    nextChar(s);\n    return 1638749 /* GreaterThanEquals */;\n};\nCharScanners[37 /* Percent */] = returnToken(1638885 /* Percent */);\nCharScanners[40 /* OpenParen */] = returnToken(671750 /* OpenParen */);\nCharScanners[41 /* CloseParen */] = returnToken(1835018 /* CloseParen */);\nCharScanners[42 /* Asterisk */] = returnToken(1638884 /* Asterisk */);\nCharScanners[43 /* Plus */] = returnToken(623008 /* Plus */);\nCharScanners[44 /* Comma */] = returnToken(1572875 /* Comma */);\nCharScanners[45 /* Minus */] = returnToken(623009 /* Minus */);\nCharScanners[47 /* Slash */] = returnToken(1638886 /* Slash */);\nCharScanners[58 /* Colon */] = returnToken(1572878 /* Colon */);\nCharScanners[63 /* Question */] = returnToken(1572879 /* Question */);\nCharScanners[91 /* OpenBracket */] = returnToken(671756 /* OpenBracket */);\nCharScanners[93 /* CloseBracket */] = returnToken(1835021 /* CloseBracket */);\nCharScanners[123 /* OpenBrace */] = returnToken(131079 /* OpenBrace */);\nCharScanners[125 /* CloseBrace */] = returnToken(1835017 /* CloseBrace */);\n//# sourceMappingURL=expression-parser.js.map","import { DI } from '@aurelia/kernel';\nimport { IExpressionParser, RuntimeConfiguration } from '@aurelia/runtime';\nimport { AtPrefixedTriggerAttributePattern, ColonPrefixedBindAttributePattern, DotSeparatedAttributePattern, RefAttributePattern } from './attribute-patterns';\nimport { CallBindingCommand, DefaultBindingCommand, ForBindingCommand, FromViewBindingCommand, OneTimeBindingCommand, ToViewBindingCommand, TwoWayBindingCommand } from './binding-commands';\nimport { parseExpression } from './expression-parser';\nexport const IExpressionParserRegistration = {\n    register(container) {\n        container.registerTransformer(IExpressionParser, parser => {\n            Reflect.set(parser, 'parseCore', parseExpression);\n            return parser;\n        });\n    }\n};\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IExpressionParser`\n */\nexport const DefaultComponents = [\n    IExpressionParserRegistration\n];\nexport const AtPrefixedTriggerAttributePatternRegistration = AtPrefixedTriggerAttributePattern;\nexport const ColonPrefixedBindAttributePatternRegistration = ColonPrefixedBindAttributePattern;\nexport const RefAttributePatternRegistration = RefAttributePattern;\nexport const DotSeparatedAttributePatternRegistration = DotSeparatedAttributePattern;\n/**\n * Default binding syntax for the following attribute name patterns:\n * - `ref`\n * - `target.command` (dot-separated)\n */\nexport const DefaultBindingSyntax = [\n    RefAttributePatternRegistration,\n    DotSeparatedAttributePatternRegistration\n];\n/**\n * Binding syntax for short-hand attribute name patterns:\n * - `@target` (short-hand for `target.trigger`)\n * - `:target` (short-hand for `target.bind`)\n */\nexport const ShortHandBindingSyntax = [\n    AtPrefixedTriggerAttributePatternRegistration,\n    ColonPrefixedBindAttributePatternRegistration\n];\nexport const CallBindingCommandRegistration = CallBindingCommand;\nexport const DefaultBindingCommandRegistration = DefaultBindingCommand;\nexport const ForBindingCommandRegistration = ForBindingCommand;\nexport const FromViewBindingCommandRegistration = FromViewBindingCommand;\nexport const OneTimeBindingCommandRegistration = OneTimeBindingCommand;\nexport const ToViewBindingCommandRegistration = ToViewBindingCommand;\nexport const TwoWayBindingCommandRegistration = TwoWayBindingCommand;\n/**\n * Default runtime/environment-agnostic binding commands:\n * - Property observation: `.bind`, `.one-time`, `.from-view`, `.to-view`, `.two-way`\n * - Function call: `.call`\n * - Collection observation: `.for`\n */\nexport const DefaultBindingLanguage = [\n    DefaultBindingCommandRegistration,\n    OneTimeBindingCommandRegistration,\n    FromViewBindingCommandRegistration,\n    ToViewBindingCommandRegistration,\n    TwoWayBindingCommandRegistration,\n    CallBindingCommandRegistration,\n    ForBindingCommandRegistration\n];\n/**\n * A DI configuration object containing runtime/environment-agnostic registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultBindingSyntax`\n * - `DefaultBindingLanguage`\n */\nexport const JitConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultBindingSyntax, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { kebabCase, } from '@aurelia/kernel';\nimport { BindingMode, CustomAttribute, CustomElement, } from '@aurelia/runtime';\nimport { BindingCommand } from './binding-command';\n/**\n * A pre-processed piece of information about a defined bindable property on a custom\n * element or attribute, optimized for consumption by the template compiler.\n */\nexport class BindableInfo {\n    constructor(\n    /**\n     * The pre-processed *property* (not attribute) name of the bindable, which is\n     * (in order of priority):\n     *\n     * 1. The `property` from the description (if defined)\n     * 2. The name of the property of the bindable itself\n     */\n    propName, \n    /**\n     * The pre-processed (default) bindingMode of the bindable, which is (in order of priority):\n     *\n     * 1. The `mode` from the bindable (if defined and not bindingMode.default)\n     * 2. The `defaultBindingMode` (if it's an attribute, defined, and not bindingMode.default)\n     * 3. `bindingMode.toView`\n     */\n    mode) {\n        this.propName = propName;\n        this.mode = mode;\n    }\n}\n/**\n * Pre-processed information about a custom element resource, optimized\n * for consumption by the template compiler.\n */\nexport class ElementInfo {\n    constructor(name, containerless) {\n        this.name = name;\n        this.containerless = containerless;\n        /**\n         * A lookup of the bindables of this element, indexed by the (pre-processed)\n         * attribute names as they would be found in parsed markup.\n         */\n        this.bindables = Object.create(null);\n    }\n    static from(def) {\n        const info = new ElementInfo(def.name, def.containerless);\n        const bindables = def.bindables;\n        const defaultBindingMode = BindingMode.toView;\n        let bindable;\n        let prop;\n        let attr;\n        let mode;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            // explicitly provided attribute name has priority over the derived implicit attribute name\n            if (bindable.attribute !== void 0) {\n                attr = bindable.attribute;\n            }\n            else {\n                // derive the attribute name from the resolved property name\n                attr = kebabCase(prop);\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            info.bindables[attr] = new BindableInfo(prop, mode);\n        }\n        return info;\n    }\n}\n/**\n * Pre-processed information about a custom attribute resource, optimized\n * for consumption by the template compiler.\n */\nexport class AttrInfo {\n    constructor(name, isTemplateController) {\n        this.name = name;\n        this.isTemplateController = isTemplateController;\n        /**\n         * A lookup of the bindables of this attribute, indexed by the (pre-processed)\n         * bindable names as they would be found in the attribute value.\n         *\n         * Only applicable to multi attribute bindings (semicolon-separated).\n         */\n        this.bindables = Object.create(null);\n        /**\n         * The single or first bindable of this attribute, or a default 'value'\n         * bindable if no bindables were defined on the attribute.\n         *\n         * Only applicable to single attribute bindings (where the attribute value\n         * contains no semicolons)\n         */\n        this.bindable = null;\n    }\n    static from(def) {\n        const info = new AttrInfo(def.name, def.isTemplateController);\n        const bindables = def.bindables;\n        const defaultBindingMode = def.defaultBindingMode !== void 0 && def.defaultBindingMode !== BindingMode.default\n            ? def.defaultBindingMode\n            : BindingMode.toView;\n        let bindable;\n        let prop;\n        let mode;\n        let hasPrimary = false;\n        let isPrimary = false;\n        let bindableInfo;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            isPrimary = bindable.primary === true;\n            bindableInfo = info.bindables[prop] = new BindableInfo(prop, mode);\n            if (isPrimary) {\n                if (hasPrimary) {\n                    throw new Error('primary already exists');\n                }\n                hasPrimary = true;\n                info.bindable = bindableInfo;\n            }\n            // set to first bindable by convention\n            if (info.bindable === null) {\n                info.bindable = bindableInfo;\n            }\n        }\n        // if no bindables are present, default to \"value\"\n        if (info.bindable === null) {\n            info.bindable = new BindableInfo('value', defaultBindingMode);\n        }\n        return info;\n    }\n}\n/**\n * A pre-processed piece of information about declared custom elements, attributes and\n * binding commands, optimized for consumption by the template compiler.\n */\nexport class ResourceModel {\n    constructor(resources) {\n        this.resources = resources;\n        this.elementLookup = Object.create(null);\n        this.attributeLookup = Object.create(null);\n        this.commandLookup = Object.create(null);\n    }\n    /**\n     * Retrieve information about a custom element resource.\n     *\n     * @param element - The original DOM element.\n     *\n     * @returns The resource information if the element exists, or `null` if it does not exist.\n     */\n    getElementInfo(name) {\n        let result = this.elementLookup[name];\n        if (result === void 0) {\n            const def = this.resources.find(CustomElement, name);\n            this.elementLookup[name] = result = def === null ? null : ElementInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve information about a custom attribute resource.\n     *\n     * @param syntax - The parsed `AttrSyntax`\n     *\n     * @returns The resource information if the attribute exists, or `null` if it does not exist.\n     */\n    getAttributeInfo(syntax) {\n        let result = this.attributeLookup[syntax.target];\n        if (result === void 0) {\n            const def = this.resources.find(CustomAttribute, syntax.target);\n            this.attributeLookup[syntax.target] = result = def === null ? null : AttrInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve a binding command resource.\n     *\n     * @param name - The parsed `AttrSyntax`\n     *\n     * @returns An instance of the command if it exists, or `null` if it does not exist.\n     */\n    getBindingCommand(syntax, optional) {\n        const name = syntax.command;\n        if (name === null) {\n            return null;\n        }\n        let result = this.commandLookup[name];\n        if (result === void 0) {\n            result = this.resources.create(BindingCommand, name);\n            if (result === null) {\n                if (optional) {\n                    return null;\n                }\n                throw new Error(`Unknown binding command: ${name}`);\n            }\n            this.commandLookup[name] = result;\n        }\n        return result;\n    }\n}\n//# sourceMappingURL=resource-model.js.map","import { DI } from '@aurelia/kernel';\nexport const IAttrSyntaxTransformer = DI\n    .createInterface('IAttrSyntaxTransformer')\n    .noDefault();\n//# sourceMappingURL=attribute-syntax-transformer.js.map","import { hasBind, hasUnbind } from '@aurelia/runtime';\n/**\n * Listener binding. Handle event binding between view and view model\n */\nexport class Listener {\n    constructor(dom, targetEvent, delegationStrategy, sourceExpression, target, preventDefault, eventManager, locator) {\n        this.dom = dom;\n        this.targetEvent = targetEvent;\n        this.delegationStrategy = delegationStrategy;\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.preventDefault = preventDefault;\n        this.eventManager = eventManager;\n        this.locator = locator;\n        this.$state = 0 /* none */;\n    }\n    callSource(event) {\n        const overrideContext = this.$scope.overrideContext;\n        overrideContext.$event = event;\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        Reflect.deleteProperty(overrideContext, '$event');\n        if (result !== true && this.preventDefault) {\n            event.preventDefault();\n        }\n        return result;\n    }\n    handleEvent(event) {\n        this.callSource(event);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this);\n        }\n        this.handler = this.eventManager.addEventListener(this.dom, this.target, this.targetEvent, this, this.delegationStrategy);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this);\n        }\n        this.$scope = null;\n        this.handler.dispose();\n        this.handler = null;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=listener.js.map","import { __decorate } from \"tslib\";\nimport { DOM, subscriberCollection, } from '@aurelia/runtime';\n/**\n * Observer for handling two-way binding with attributes\n * Has different strategy for class/style and normal attributes\n * TODO: handle SVG/attributes with namespace\n */\nlet AttributeObserver = class AttributeObserver {\n    constructor(scheduler, flags, observerLocator, obj, propertyKey, targetAttribute) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.targetAttribute = targetAttribute;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            switch (this.targetAttribute) {\n                case 'class': {\n                    // Why is class attribute observer setValue look different with class attribute accessor?\n                    // ==============\n                    // For class list\n                    // newValue is simply checked if truthy or falsy\n                    // and toggle the class accordingly\n                    // -- the rule of this is quite different to normal attribute\n                    //\n                    // for class attribute, observer is different in a way that it only observe a particular class at a time\n                    // this also comes from syntax, where it would typically be my-class.class=\"someProperty\"\n                    //\n                    // so there is no need for separating class by space and add all of them like class accessor\n                    if (!!currentValue) {\n                        this.obj.classList.add(this.propertyKey);\n                    }\n                    else {\n                        this.obj.classList.remove(this.propertyKey);\n                    }\n                    break;\n                }\n                case 'style': {\n                    let priority = '';\n                    let newValue = currentValue;\n                    if (typeof newValue === 'string' && newValue.includes('!important')) {\n                        priority = 'important';\n                        newValue = newValue.replace('!important', '');\n                    }\n                    this.obj.style.setProperty(this.propertyKey, newValue, priority);\n                }\n            }\n        }\n    }\n    handleMutation(mutationRecords) {\n        let shouldProcess = false;\n        for (let i = 0, ii = mutationRecords.length; ii > i; ++i) {\n            const record = mutationRecords[i];\n            if (record.type === 'attributes' && record.attributeName === this.propertyKey) {\n                shouldProcess = true;\n                break;\n            }\n        }\n        if (shouldProcess) {\n            let newValue;\n            switch (this.targetAttribute) {\n                case 'class':\n                    newValue = this.obj.classList.contains(this.propertyKey);\n                    break;\n                case 'style':\n                    newValue = this.obj.style.getPropertyValue(this.propertyKey);\n                    break;\n                default:\n                    throw new Error(`Unsupported targetAttribute: ${this.targetAttribute}`);\n            }\n            if (newValue !== this.currentValue) {\n                const { currentValue } = this;\n                this.currentValue = this.oldValue = newValue;\n                this.hasChanges = false;\n                this.callSubscribers(newValue, currentValue, 131072 /* fromDOMEvent */);\n            }\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n            startObservation(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            stopObservation(this.obj, this);\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nAttributeObserver = __decorate([\n    subscriberCollection()\n], AttributeObserver);\nexport { AttributeObserver };\nconst startObservation = (element, subscription) => {\n    if (element.$eMObservers === undefined) {\n        element.$eMObservers = new Set();\n    }\n    if (element.$mObserver === undefined) {\n        element.$mObserver = DOM.createNodeObserver(element, handleMutation, { attributes: true });\n    }\n    element.$eMObservers.add(subscription);\n};\nconst stopObservation = (element, subscription) => {\n    const $eMObservers = element.$eMObservers;\n    if ($eMObservers.delete(subscription)) {\n        if ($eMObservers.size === 0) {\n            element.$mObserver.disconnect();\n            element.$mObserver = undefined;\n        }\n        return true;\n    }\n    return false;\n};\nconst handleMutation = (mutationRecords) => {\n    mutationRecords[0].target.$eMObservers.forEach(invokeHandleMutation, mutationRecords);\n};\nfunction invokeHandleMutation(s) {\n    s.handleMutation(this);\n}\n//# sourceMappingURL=element-attribute-observer.js.map","import { __decorate } from \"tslib\";\nimport { Reporter, } from '@aurelia/kernel';\nimport { BindingMode, connectable, hasBind, hasUnbind, IScheduler, } from '@aurelia/runtime';\nimport { AttributeObserver, } from '../observation/element-attribute-observer';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\n/**\n * Attribute binding. Handle attribute binding betwen view/view model. Understand Html special attributes\n */\nlet AttributeBinding = class AttributeBinding {\n    constructor(sourceExpression, target, \n    // some attributes may have inner structure\n    // such as class -> collection of class names\n    // such as style -> collection of style rules\n    //\n    // for normal attributes, targetAttribute and targetProperty are the same and can be ignore\n    targetAttribute, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.targetAttribute = targetAttribute;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.$state = 0 /* none */;\n        this.$scope = null;\n        this.persistentFlags = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.$scheduler = locator.get(IScheduler);\n    }\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, value);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if (this.mode === BindingMode.fromView) {\n            flags &= ~16 /* updateTargetInstance */;\n            flags |= 32 /* updateSourceExpression */;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this, this.part);\n                this.unobserve(false);\n            }\n            return;\n        }\n        if (flags & 32 /* updateSourceExpression */) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            targetObserver = this.targetObserver = new AttributeObserver(this.$scheduler, flags, this.observerLocator, this.target, this.targetProperty, this.targetAttribute);\n        }\n        if (targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n            targetObserver.subscribe(this);\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this);\n        }\n        this.$scope = null;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    connect(flags) {\n        if (this.$state & 4 /* isBound */) {\n            flags |= this.persistentFlags;\n            this.sourceExpression.connect(flags | 2097152 /* mustEvaluate */, this.$scope, this, this.part); // why do we have a connect method here in the first place? will this be called after bind?\n        }\n    }\n};\nAttributeBinding = __decorate([\n    connectable()\n], AttributeBinding);\nexport { AttributeBinding };\n//# sourceMappingURL=attribute.js.map","/**\n * Attribute accessor in a XML document/element that can be accessed via a namespace.\n * Wraps [`getAttributeNS`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNS).\n */\nexport class AttributeNSAccessor {\n    constructor(scheduler, flags, obj, propertyKey, namespace) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.namespace = namespace;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttributeNS(this.namespace, this.propertyKey);\n            }\n            else {\n                this.obj.setAttributeNS(this.namespace, this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttributeNS(this.namespace, this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=attribute-ns-accessor.js.map","import { __decorate } from \"tslib\";\nimport { subscriberCollection, } from '@aurelia/runtime';\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet CheckedObserver = class CheckedObserver {\n    constructor(scheduler, flags, observerLocator, handler, obj) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.arrayObserver = void 0;\n        this.valueObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (this.valueObserver === void 0) {\n                if (this.obj.$observers !== void 0) {\n                    if (this.obj.$observers.model !== void 0) {\n                        this.valueObserver = this.obj.$observers.model;\n                    }\n                    else if (this.obj.$observers.value !== void 0) {\n                        this.valueObserver = this.obj.$observers.value;\n                    }\n                }\n                if (this.valueObserver !== void 0) {\n                    this.valueObserver.subscribe(this);\n                }\n            }\n            if (this.arrayObserver !== void 0) {\n                this.arrayObserver.unsubscribeFromCollection(this);\n                this.arrayObserver = void 0;\n            }\n            if (this.obj.type === 'checkbox' && Array.isArray(currentValue)) {\n                this.arrayObserver = this.observerLocator.getArrayObserver(flags, currentValue);\n                this.arrayObserver.subscribeToCollection(this);\n            }\n            this.synchronizeElement();\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        const { currentValue, oldValue } = this;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.oldValue = currentValue;\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(currentValue, oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags));\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    synchronizeElement() {\n        const { currentValue, obj } = this;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        const isRadio = obj.type === 'radio';\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (isRadio) {\n            obj.checked = !!matcher(currentValue, elementValue);\n        }\n        else if (currentValue === true) {\n            obj.checked = true;\n        }\n        else if (Array.isArray(currentValue)) {\n            obj.checked = currentValue.findIndex(item => !!matcher(item, elementValue)) !== -1;\n        }\n        else {\n            obj.checked = false;\n        }\n    }\n    handleEvent() {\n        this.oldValue = this.currentValue;\n        let { currentValue } = this;\n        const { obj } = this;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        let index;\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (obj.type === 'checkbox') {\n            if (Array.isArray(currentValue)) {\n                index = currentValue.findIndex(item => !!matcher(item, elementValue));\n                if (obj.checked && index === -1) {\n                    currentValue.push(elementValue);\n                }\n                else if (!obj.checked && index !== -1) {\n                    currentValue.splice(index, 1);\n                }\n                // when existing currentValue is array, do not invoke callback as only the array obj has changed\n                return;\n            }\n            currentValue = obj.checked;\n        }\n        else if (obj.checked) {\n            currentValue = elementValue;\n        }\n        else {\n            return;\n        }\n        this.currentValue = currentValue;\n        this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.obj.checked;\n    }\n    unbind(flags) {\n        if (this.arrayObserver !== void 0) {\n            this.arrayObserver.unsubscribeFromCollection(this);\n            this.arrayObserver = void 0;\n        }\n        if (this.valueObserver !== void 0) {\n            this.valueObserver.unsubscribe(this);\n        }\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\nCheckedObserver = __decorate([\n    subscriberCollection()\n], CheckedObserver);\nexport { CheckedObserver };\n//# sourceMappingURL=checked-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nexport class ClassAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.doNotCache = true;\n        this.nameIndex = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.isActive = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, nameIndex } = this;\n            let { version } = this;\n            this.oldValue = currentValue;\n            const classesToAdd = this.getClassesToAdd(currentValue);\n            // Get strings split on a space not including empties\n            if (classesToAdd.length > 0) {\n                this.addClassesAndUpdateIndex(classesToAdd);\n            }\n            this.version += 1;\n            // First call to setValue?  We're done.\n            if (version === 0) {\n                return;\n            }\n            // Remove classes from previous version.\n            version -= 1;\n            for (const name in nameIndex) {\n                if (!Object.prototype.hasOwnProperty.call(nameIndex, name) || nameIndex[name] !== version) {\n                    continue;\n                }\n                // TODO: this has the side-effect that classes already present which are added again,\n                // will be removed if they're not present in the next update.\n                // Better would be do have some configurability for this behavior, allowing the user to\n                // decide whether initial classes always need to be kept, always removed, or something in between\n                this.obj.classList.remove(name);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    splitClassString(classString) {\n        const matches = classString.match(/\\S+/g);\n        if (matches === null) {\n            return PLATFORM.emptyArray;\n        }\n        return matches;\n    }\n    getClassesToAdd(object) {\n        if (typeof object === 'string') {\n            return this.splitClassString(object);\n        }\n        if (object instanceof Array) {\n            const len = object.length;\n            if (len > 0) {\n                const classes = [];\n                for (let i = 0; i < len; ++i) {\n                    classes.push(...this.getClassesToAdd(object[i]));\n                }\n                return classes;\n            }\n            else {\n                return PLATFORM.emptyArray;\n            }\n        }\n        else if (object instanceof Object) {\n            const classes = [];\n            for (const property in object) {\n                // Let non typical values also evaluate true so disable bool check\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, no-extra-boolean-cast\n                if (!!object[property]) {\n                    // We must do this in case object property has a space in the name which results in two classes\n                    if (property.includes(' ')) {\n                        classes.push(...this.splitClassString(property));\n                    }\n                    else {\n                        classes.push(property);\n                    }\n                }\n            }\n            return classes;\n        }\n        return PLATFORM.emptyArray;\n    }\n    addClassesAndUpdateIndex(classes) {\n        const node = this.obj;\n        for (let i = 0, length = classes.length; i < length; i++) {\n            const className = classes[i];\n            if (!className.length) {\n                continue;\n            }\n            this.nameIndex[className] = this.version;\n            node.classList.add(className);\n        }\n    }\n}\n//# sourceMappingURL=class-attribute-accessor.js.map","/**\n * Attribute accessor for HTML elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see ElementPropertyAccessor\n */\nexport class DataAttributeAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttribute(this.propertyKey);\n            }\n            else {\n                this.obj.setAttribute(this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=data-attribute-accessor.js.map","/**\n * Property accessor for HTML Elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see DataAttributeAccessor\n */\nexport class ElementPropertyAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            this.obj[this.propertyKey] = currentValue;\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj[this.propertyKey];\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=element-property-accessor.js.map","import { DI } from '@aurelia/kernel';\nimport { DelegationStrategy } from '@aurelia/runtime';\n// Note: path and deepPath are designed to handle v0 and v1 shadow dom specs respectively\n/** @internal */\nexport function findOriginalEventTarget(event) {\n    return (event.composedPath && event.composedPath()[0]) || (event.deepPath && event.deepPath()[0]) || (event.path && event.path[0]) || event.target;\n}\nfunction stopPropagation() {\n    this.standardStopPropagation();\n    this.propagationStopped = true;\n}\nfunction handleCapturedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    const orderedCallbacks = [];\n    /**\n     * During capturing phase, event 'bubbles' down from parent. Needs to reorder callback from root down to target\n     */\n    while (target) {\n        if (target.capturedCallbacks) {\n            const callback = target.capturedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                orderedCallbacks.push(callback);\n            }\n        }\n        target = target.parentNode;\n    }\n    for (let i = orderedCallbacks.length - 1; i >= 0 && !event.propagationStopped; i--) {\n        const orderedCallback = orderedCallbacks[i];\n        if ('handleEvent' in orderedCallback) {\n            orderedCallback.handleEvent(event);\n        }\n        else {\n            orderedCallback(event);\n        }\n    }\n}\nfunction handleDelegatedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    while (target && !event.propagationStopped) {\n        if (target.delegatedCallbacks) {\n            const callback = target.delegatedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                if ('handleEvent' in callback) {\n                    callback.handleEvent(event);\n                }\n                else {\n                    callback(event);\n                }\n            }\n        }\n        target = target.parentNode;\n    }\n}\nexport class ListenerTracker {\n    constructor(dom, eventName, listener, capture) {\n        this.dom = dom;\n        this.eventName = eventName;\n        this.listener = listener;\n        this.capture = capture;\n        this.count = 0;\n    }\n    increment() {\n        this.count++;\n        if (this.count === 1) {\n            this.dom.addEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    decrement() {\n        this.count--;\n        if (this.count === 0) {\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    /* @internal */\n    dispose() {\n        if (this.count > 0) {\n            this.count = 0;\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n}\n/**\n * Enable dispose() pattern for `delegate` & `capture` commands\n */\nexport class DelegateOrCaptureSubscription {\n    constructor(entry, lookup, targetEvent, callback) {\n        this.entry = entry;\n        this.lookup = lookup;\n        this.targetEvent = targetEvent;\n        lookup[targetEvent] = callback;\n    }\n    dispose() {\n        this.entry.decrement();\n        this.lookup[this.targetEvent] = null;\n    }\n}\n/**\n * Enable dispose() pattern for addEventListener for `trigger`\n */\nexport class TriggerSubscription {\n    constructor(dom, target, targetEvent, callback) {\n        this.dom = dom;\n        this.target = target;\n        this.targetEvent = targetEvent;\n        this.callback = callback;\n        dom.addEventListener(targetEvent, callback, target);\n    }\n    dispose() {\n        this.dom.removeEventListener(this.targetEvent, this.callback, this.target);\n    }\n}\nexport class EventSubscriber {\n    constructor(dom, events) {\n        this.dom = dom;\n        this.events = events;\n        this.target = null;\n        this.handler = null;\n    }\n    subscribe(node, callbackOrListener) {\n        this.target = node;\n        this.handler = callbackOrListener;\n        const add = this.dom.addEventListener;\n        const events = this.events;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            add(events[i], callbackOrListener, node);\n        }\n    }\n    dispose() {\n        const node = this.target;\n        const callbackOrListener = this.handler;\n        const events = this.events;\n        const dom = this.dom;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            dom.removeEventListener(events[i], callbackOrListener, node);\n        }\n        this.target = this.handler = null;\n    }\n}\nexport const IEventManager = DI.createInterface('IEventManager').withDefault(x => x.singleton(EventManager));\n/** @internal */\nexport class EventManager {\n    constructor() {\n        this.delegatedHandlers = {};\n        this.capturedHandlers = {};\n    }\n    addEventListener(dom, target, targetEvent, callbackOrListener, strategy) {\n        let delegatedHandlers;\n        let capturedHandlers;\n        let handlerEntry;\n        if (strategy === DelegationStrategy.bubbling) {\n            delegatedHandlers = this.delegatedHandlers;\n            handlerEntry = delegatedHandlers[targetEvent] || (delegatedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleDelegatedEvent, false));\n            handlerEntry.increment();\n            const delegatedCallbacks = target.delegatedCallbacks || (target.delegatedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, delegatedCallbacks, targetEvent, callbackOrListener);\n        }\n        if (strategy === DelegationStrategy.capturing) {\n            capturedHandlers = this.capturedHandlers;\n            handlerEntry = capturedHandlers[targetEvent] || (capturedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleCapturedEvent, true));\n            handlerEntry.increment();\n            const capturedCallbacks = target.capturedCallbacks || (target.capturedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, capturedCallbacks, targetEvent, callbackOrListener);\n        }\n        return new TriggerSubscription(dom, target, targetEvent, callbackOrListener);\n    }\n    dispose() {\n        let key;\n        const { delegatedHandlers, capturedHandlers } = this;\n        for (key in delegatedHandlers) {\n            delegatedHandlers[key].dispose();\n        }\n        for (key in capturedHandlers) {\n            capturedHandlers[key].dispose();\n        }\n    }\n}\n//# sourceMappingURL=event-manager.js.map","import { __decorate } from \"tslib\";\nimport { subscriberCollection, } from '@aurelia/runtime';\nimport { bound } from '@aurelia/kernel';\nconst childObserverOptions = {\n    childList: true,\n    subtree: true,\n    characterData: true\n};\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet SelectValueObserver = class SelectValueObserver {\n    constructor(scheduler, flags, observerLocator, dom, handler, obj) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.dom = dom;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.arrayObserver = void 0;\n        this.nodeObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const isArray = Array.isArray(currentValue);\n            if (!isArray && currentValue != void 0 && this.obj.multiple) {\n                throw new Error('Only null or Array instances can be bound to a multi-select.');\n            }\n            if (this.arrayObserver) {\n                this.arrayObserver.unsubscribeFromCollection(this);\n                this.arrayObserver = void 0;\n            }\n            if (isArray) {\n                this.arrayObserver = this.observerLocator.getArrayObserver(flags, currentValue);\n                this.arrayObserver.subscribeToCollection(this);\n            }\n            this.synchronizeOptions();\n            this.notify(flags);\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(this.currentValue, this.oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    notify(flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            return;\n        }\n        const oldValue = this.oldValue;\n        const newValue = this.currentValue;\n        if (newValue === oldValue) {\n            return;\n        }\n        this.callSubscribers(newValue, oldValue, flags);\n    }\n    handleEvent() {\n        // \"from-view\" changes are always synchronous now, so immediately sync the value and notify subscribers\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    synchronizeOptions(indexMap) {\n        const { currentValue, obj } = this;\n        const isArray = Array.isArray(currentValue);\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        const options = obj.options;\n        let i = options.length;\n        while (i-- > 0) {\n            const option = options[i];\n            const optionValue = Object.prototype.hasOwnProperty.call(option, 'model') ? option.model : option.value;\n            if (isArray) {\n                option.selected = currentValue.findIndex(item => !!matcher(optionValue, item)) !== -1;\n                continue;\n            }\n            option.selected = !!matcher(optionValue, currentValue);\n        }\n    }\n    synchronizeValue() {\n        // Spec for synchronizing value from `SelectObserver` to `<select/>`\n        // When synchronizing value to observed <select/> element, do the following steps:\n        // A. If `<select/>` is multiple\n        //    1. Check if current value, called `currentValue` is an array\n        //      a. If not an array, return true to signal value has changed\n        //      b. If is an array:\n        //        i. gather all current selected <option/>, in to array called `values`\n        //        ii. loop through the `currentValue` array and remove items that are nolonger selected based on matcher\n        //        iii. loop through the `values` array and add items that are selected based on matcher\n        //        iv. Return false to signal value hasn't changed\n        // B. If the select is single\n        //    1. Let `value` equal the first selected option, if no option selected, then `value` is `null`\n        //    2. assign `this.currentValue` to `this.oldValue`\n        //    3. assign `value` to `this.currentValue`\n        //    4. return `true` to signal value has changed\n        const obj = this.obj;\n        const options = obj.options;\n        const len = options.length;\n        const currentValue = this.currentValue;\n        let i = 0;\n        if (obj.multiple) {\n            // A.\n            if (!Array.isArray(currentValue)) {\n                // A.1.a\n                return true;\n            }\n            // A.1.b\n            // multi select\n            let option;\n            const matcher = obj.matcher || defaultMatcher;\n            // A.1.b.i\n            const values = [];\n            while (i < len) {\n                option = options[i];\n                if (option.selected) {\n                    values.push(Object.prototype.hasOwnProperty.call(option, 'model')\n                        ? option.model\n                        : option.value);\n                }\n                ++i;\n            }\n            // A.1.b.ii\n            i = 0;\n            while (i < currentValue.length) {\n                const a = currentValue[i];\n                // Todo: remove arrow fn\n                if (values.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.splice(i, 1);\n                }\n                else {\n                    ++i;\n                }\n            }\n            // A.1.b.iii\n            i = 0;\n            while (i < values.length) {\n                const a = values[i];\n                // Todo: remove arrow fn\n                if (currentValue.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.push(a);\n                }\n                ++i;\n            }\n            // A.1.b.iv\n            return false;\n        }\n        // B. single select\n        // B.1\n        let value = null;\n        while (i < len) {\n            const option = options[i];\n            if (option.selected) {\n                value = Object.prototype.hasOwnProperty.call(option, 'model')\n                    ? option.model\n                    : option.value;\n                break;\n            }\n            ++i;\n        }\n        // B.2\n        this.oldValue = this.currentValue;\n        // B.3\n        this.currentValue = value;\n        // B.4\n        return true;\n    }\n    bind(flags) {\n        this.nodeObserver = this.dom.createNodeObserver(this.obj, this.handleNodeChange, childObserverOptions);\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        this.nodeObserver.disconnect();\n        this.nodeObserver = null;\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n        if (this.arrayObserver) {\n            this.arrayObserver.unsubscribeFromCollection(this);\n            this.arrayObserver = null;\n        }\n    }\n    handleNodeChange() {\n        this.synchronizeOptions();\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.notify(131072 /* fromDOMEvent */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\n__decorate([\n    bound\n], SelectValueObserver.prototype, \"handleNodeChange\", null);\nSelectValueObserver = __decorate([\n    subscriberCollection()\n], SelectValueObserver);\nexport { SelectValueObserver };\n//# sourceMappingURL=select-value-observer.js.map","import { PLATFORM, kebabCase } from '@aurelia/kernel';\nexport class StyleAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.styles = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.obj.style.cssText;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    getStyleTuplesFromString(currentValue) {\n        const styleTuples = [];\n        const rx = /\\s*([\\w-]+)\\s*:\\s*((?:(?:[\\w-]+\\(\\s*(?:\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[\\w-]+\\(\\s*(?:[^\"](?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^)]*)\\),?|[^)]*)\\),?|\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^;]*),?\\s*)+);?/g;\n        let pair;\n        let name;\n        while ((pair = rx.exec(currentValue)) !== null) {\n            name = pair[1];\n            if (name.length === 0) {\n                continue;\n            }\n            styleTuples.push([name, pair[2]]);\n        }\n        return styleTuples;\n    }\n    getStyleTuplesFromObject(currentValue) {\n        let value;\n        const styles = [];\n        for (const property in currentValue) {\n            value = currentValue[property];\n            if (value == null) {\n                continue;\n            }\n            if (typeof value === 'string') {\n                styles.push([kebabCase(property), value]);\n                continue;\n            }\n            styles.push(...this.getStyleTuples(value));\n        }\n        return styles;\n    }\n    getStyleTuplesFromArray(currentValue) {\n        const len = currentValue.length;\n        if (len > 0) {\n            const styles = [];\n            for (let i = 0; i < len; ++i) {\n                styles.push(...this.getStyleTuples(currentValue[i]));\n            }\n            return styles;\n        }\n        return PLATFORM.emptyArray;\n    }\n    getStyleTuples(currentValue) {\n        if (typeof currentValue === 'string') {\n            return this.getStyleTuplesFromString(currentValue);\n        }\n        if (currentValue instanceof Array) {\n            return this.getStyleTuplesFromArray(currentValue);\n        }\n        if (currentValue instanceof Object) {\n            return this.getStyleTuplesFromObject(currentValue);\n        }\n        return PLATFORM.emptyArray;\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const styles = this.styles;\n            let style;\n            let version = this.version;\n            const styleTuples = this.getStyleTuples(currentValue);\n            let tuple;\n            let name;\n            let value;\n            const len = styleTuples.length;\n            for (let i = 0; i < len; ++i) {\n                tuple = styleTuples[i];\n                name = tuple[0];\n                value = tuple[1];\n                this.setProperty(name, value);\n            }\n            this.styles = styles;\n            this.version += 1;\n            if (version === 0) {\n                return;\n            }\n            version -= 1;\n            for (style in styles) {\n                if (!Object.prototype.hasOwnProperty.call(styles, style) || styles[style] !== version) {\n                    continue;\n                }\n                this.obj.style.removeProperty(style);\n            }\n        }\n    }\n    setProperty(style, value) {\n        let priority = '';\n        if (value != null && typeof value.indexOf === 'function' && value.includes('!important')) {\n            priority = 'important';\n            value = value.replace('!important', '');\n        }\n        this.obj.style.setProperty(style, value, priority);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.oldValue = this.currentValue = this.obj.style.cssText;\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=style-attribute-accessor.js.map","import { DI } from '@aurelia/kernel';\nexport const ISVGAnalyzer = DI.createInterface('ISVGAnalyzer').withDefault(x => x.singleton(class {\n    isStandardSvgAttribute(node, attributeName) {\n        return false;\n    }\n}));\n//# sourceMappingURL=svg-analyzer.js.map","import { __decorate } from \"tslib\";\nimport { subscriberCollection, } from '@aurelia/runtime';\n// TODO: handle file attribute properly again, etc\n/**\n * Observer for non-radio, non-checkbox input.\n */\nlet ValueAttributeObserver = class ValueAttributeObserver {\n    constructor(scheduler, flags, handler, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.handler = handler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, oldValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj[this.propertyKey] = '';\n            }\n            else {\n                this.obj[this.propertyKey] = currentValue;\n            }\n            if ((flags & 4096 /* fromBind */) === 0) {\n                this.callSubscribers(currentValue, oldValue, flags);\n            }\n        }\n    }\n    handleEvent() {\n        const oldValue = this.oldValue = this.currentValue;\n        const currentValue = this.currentValue = this.obj[this.propertyKey];\n        if (oldValue !== currentValue) {\n            this.oldValue = currentValue;\n            this.callSubscribers(currentValue, oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n            this.currentValue = this.oldValue = this.obj[this.propertyKey];\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nValueAttributeObserver = __decorate([\n    subscriberCollection()\n], ValueAttributeObserver);\nexport { ValueAttributeObserver };\n//# sourceMappingURL=value-attribute-observer.js.map","import { __decorate, __param } from \"tslib\";\nimport { Registration } from '@aurelia/kernel';\nimport { IDOM, ITargetAccessorLocator, ITargetObserverLocator, SetterObserver } from '@aurelia/runtime';\nimport { AttributeNSAccessor } from './attribute-ns-accessor';\nimport { CheckedObserver } from './checked-observer';\nimport { ClassAttributeAccessor } from './class-attribute-accessor';\nimport { DataAttributeAccessor } from './data-attribute-accessor';\nimport { ElementPropertyAccessor } from './element-property-accessor';\nimport { EventSubscriber } from './event-manager';\nimport { SelectValueObserver } from './select-value-observer';\nimport { StyleAttributeAccessor } from './style-attribute-accessor';\nimport { ISVGAnalyzer } from './svg-analyzer';\nimport { ValueAttributeObserver } from './value-attribute-observer';\n// https://infra.spec.whatwg.org/#namespaces\nconst htmlNS = 'http://www.w3.org/1999/xhtml';\nconst mathmlNS = 'http://www.w3.org/1998/Math/MathML';\nconst svgNS = 'http://www.w3.org/2000/svg';\nconst xlinkNS = 'http://www.w3.org/1999/xlink';\nconst xmlNS = 'http://www.w3.org/XML/1998/namespace';\nconst xmlnsNS = 'http://www.w3.org/2000/xmlns/';\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\nconst nsAttributes = Object.assign(Object.create(null), {\n    'xlink:actuate': ['actuate', xlinkNS],\n    'xlink:arcrole': ['arcrole', xlinkNS],\n    'xlink:href': ['href', xlinkNS],\n    'xlink:role': ['role', xlinkNS],\n    'xlink:show': ['show', xlinkNS],\n    'xlink:title': ['title', xlinkNS],\n    'xlink:type': ['type', xlinkNS],\n    'xml:lang': ['lang', xmlNS],\n    'xml:space': ['space', xmlNS],\n    'xmlns': ['xmlns', xmlnsNS],\n    'xmlns:xlink': ['xlink', xmlnsNS],\n});\nconst inputEvents = ['change', 'input'];\nconst selectEvents = ['change'];\nconst contentEvents = ['change', 'input', 'blur', 'keyup', 'paste'];\nconst scrollEvents = ['scroll'];\nconst overrideProps = Object.assign(Object.create(null), {\n    'class': true,\n    'style': true,\n    'css': true,\n    'checked': true,\n    'value': true,\n    'model': true,\n    'xlink:actuate': true,\n    'xlink:arcrole': true,\n    'xlink:href': true,\n    'xlink:role': true,\n    'xlink:show': true,\n    'xlink:title': true,\n    'xlink:type': true,\n    'xml:lang': true,\n    'xml:space': true,\n    'xmlns': true,\n    'xmlns:xlink': true,\n});\nlet TargetObserverLocator = class TargetObserverLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetObserverLocator, this).register(container);\n    }\n    getObserver(flags, scheduler, lifecycle, observerLocator, obj, propertyName) {\n        switch (propertyName) {\n            case 'checked':\n                return new CheckedObserver(scheduler, flags, observerLocator, new EventSubscriber(this.dom, inputEvents), obj);\n            case 'value':\n                if (obj.tagName === 'SELECT') {\n                    return new SelectValueObserver(scheduler, flags, observerLocator, this.dom, new EventSubscriber(this.dom, selectEvents), obj);\n                }\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'files':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'textContent':\n            case 'innerHTML':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, contentEvents), obj, propertyName);\n            case 'scrollTop':\n            case 'scrollLeft':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, scrollEvents), obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            case 'model':\n                return new SetterObserver(lifecycle, flags, obj, propertyName);\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n        }\n        return null;\n    }\n    overridesAccessor(flags, obj, propertyName) {\n        return overrideProps[propertyName] === true;\n    }\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetObserverLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer)\n], TargetObserverLocator);\nexport { TargetObserverLocator };\nlet TargetAccessorLocator = class TargetAccessorLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetAccessorLocator, this).register(container);\n    }\n    getAccessor(flags, scheduler, lifecycle, obj, propertyName) {\n        switch (propertyName) {\n            case 'textContent':\n                // note: this case is just an optimization (textContent is the most often used property)\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            // TODO: there are (many) more situation where we want to default to DataAttributeAccessor,\n            // but for now stick to what vCurrent does\n            case 'src':\n            case 'href':\n            // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n        }\n    }\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetAccessorLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer)\n], TargetAccessorLocator);\nexport { TargetAccessorLocator };\nconst IsDataAttribute = {};\nfunction isDataAttribute(obj, propertyName, svgAnalyzer) {\n    if (IsDataAttribute[propertyName] === true) {\n        return true;\n    }\n    const prefix = propertyName.slice(0, 5);\n    // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n    // https://html.spec.whatwg.org/multipage/dom.html#custom-data-attribute\n    return IsDataAttribute[propertyName] =\n        prefix === 'aria-' ||\n            prefix === 'data-' ||\n            svgAnalyzer.isStandardSvgAttribute(obj, propertyName);\n}\n//# sourceMappingURL=observer-locator.js.map","import { __decorate } from \"tslib\";\nimport { bindingBehavior, IScheduler } from '@aurelia/runtime';\nimport { DataAttributeAccessor } from '../../observation/data-attribute-accessor';\nlet AttrBindingBehavior = class AttrBindingBehavior {\n    bind(flags, scope, binding) {\n        binding.targetObserver = new DataAttributeAccessor(binding.locator.get(IScheduler), flags, binding.target, binding.targetProperty);\n    }\n    unbind(flags, scope, binding) {\n        return;\n    }\n};\nAttrBindingBehavior = __decorate([\n    bindingBehavior('attr')\n], AttrBindingBehavior);\nexport { AttrBindingBehavior };\n//# sourceMappingURL=attr.js.map","import { __decorate } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { bindingBehavior } from '@aurelia/runtime';\nimport { findOriginalEventTarget } from '../../observation/event-manager';\n/** @internal */\nexport function handleSelfEvent(event) {\n    const target = findOriginalEventTarget(event);\n    if (this.target !== target) {\n        return;\n    }\n    return this.selfEventCallSource(event);\n}\nlet SelfBindingBehavior = class SelfBindingBehavior {\n    bind(flags, scope, binding) {\n        if (!binding.callSource || !binding.targetEvent) {\n            throw Reporter.error(8);\n        }\n        binding.selfEventCallSource = binding.callSource;\n        binding.callSource = handleSelfEvent;\n    }\n    unbind(flags, scope, binding) {\n        binding.callSource = binding.selfEventCallSource;\n        binding.selfEventCallSource = null;\n    }\n};\nSelfBindingBehavior = __decorate([\n    bindingBehavior('self')\n], SelfBindingBehavior);\nexport { SelfBindingBehavior };\n//# sourceMappingURL=self.js.map","import { __decorate, __param } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { BindingMode, IDOM, IObserverLocator, bindingBehavior } from '@aurelia/runtime';\nimport { EventSubscriber } from '../../observation/event-manager';\nlet UpdateTriggerBindingBehavior = class UpdateTriggerBindingBehavior {\n    constructor(observerLocator) {\n        this.observerLocator = observerLocator;\n    }\n    bind(flags, scope, binding, ...events) {\n        if (events.length === 0) {\n            throw Reporter.error(9);\n        }\n        if (binding.mode !== BindingMode.twoWay && binding.mode !== BindingMode.fromView) {\n            throw Reporter.error(10);\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        // ensure the binding's target observer has been set.\n        const targetObserver = this.observerLocator.getObserver(this.persistentFlags | flags, binding.target, binding.targetProperty);\n        if (!targetObserver.handler) {\n            throw Reporter.error(10);\n        }\n        binding.targetObserver = targetObserver;\n        // stash the original element subscribe function.\n        targetObserver.originalHandler = binding.targetObserver.handler;\n        // replace the element subscribe function with one that uses the correct events.\n        targetObserver.handler = new EventSubscriber(binding.locator.get(IDOM), events);\n    }\n    unbind(flags, scope, binding) {\n        // restore the state of the binding.\n        binding.targetObserver.handler.dispose();\n        binding.targetObserver.handler = binding.targetObserver.originalHandler;\n        binding.targetObserver.originalHandler = null;\n    }\n};\nUpdateTriggerBindingBehavior = __decorate([\n    bindingBehavior('updateTrigger'),\n    __param(0, IObserverLocator)\n], UpdateTriggerBindingBehavior);\nexport { UpdateTriggerBindingBehavior };\n//# sourceMappingURL=update-trigger.js.map","import { __decorate, __param } from \"tslib\";\nimport { PLATFORM } from '@aurelia/kernel';\nimport { bindable, customAttribute, IDOM, INode, IScheduler } from '@aurelia/runtime';\nconst unset = Symbol();\n// Using passive to help with performance\nconst defaultCaptureEventInit = {\n    passive: true,\n    capture: true\n};\n// Using passive to help with performance\nconst defaultBubbleEventInit = {\n    passive: true\n};\n// weakly connect a document to a blur manager\n// to avoid polluting the document properties\nconst blurDocMap = new WeakMap();\nexport class BlurManager {\n    constructor(dom, scheduler) {\n        this.dom = dom;\n        this.scheduler = scheduler;\n        this.blurs = [];\n        blurDocMap.set(dom.document, this);\n        this.handler = createHandler(this, this.blurs);\n    }\n    static createFor(dom, scheduler) {\n        return blurDocMap.get(dom.document) || new BlurManager(dom, scheduler);\n    }\n    register(blur) {\n        const blurs = this.blurs;\n        if (!blurs.includes(blur) && blurs.push(blur) === 1) {\n            this.addListeners();\n        }\n    }\n    unregister(blur) {\n        const blurs = this.blurs;\n        const index = blurs.indexOf(blur);\n        if (index > -1) {\n            blurs.splice(index, 1);\n        }\n        if (blurs.length === 0) {\n            this.removeListeners();\n        }\n    }\n    addListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.addEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.addEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.addEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.addEventListener('focus', handler, defaultCaptureEventInit);\n        win.addEventListener('blur', handler, defaultBubbleEventInit);\n    }\n    removeListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.removeEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.removeEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.removeEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.removeEventListener('focus', handler, defaultCaptureEventInit);\n        win.removeEventListener('blur', handler, defaultBubbleEventInit);\n    }\n}\nlet Blur = class Blur {\n    constructor(element, dom, scheduler) {\n        this.element = element;\n        this.dom = dom;\n        /**\n         * By default, the behavior should be least surprise possible, that:\n         *\n         * it searches for anything from root context,\n         * and root context is document body\n         */\n        this.linkedMultiple = true;\n        this.searchSubTree = true;\n        this.linkingContext = null;\n        this.value = unset;\n        this.manager = BlurManager.createFor(dom, scheduler);\n    }\n    attached() {\n        this.manager.register(this);\n    }\n    detaching() {\n        this.manager.unregister(this);\n    }\n    handleEventTarget(target) {\n        if (this.value === false) {\n            return;\n        }\n        const dom = this.dom;\n        if (target === dom.window || target === dom.document || !this.contains(target)) {\n            this.triggerBlur();\n        }\n    }\n    contains(target) {\n        if (!this.value) {\n            return false;\n        }\n        let els;\n        let i;\n        let j, jj;\n        let link;\n        const element = this.element;\n        if (containsElementOrShadowRoot(element, target)) {\n            return true;\n        }\n        if (!this.linkedWith) {\n            return false;\n        }\n        const doc = this.dom.document;\n        const linkedWith = this.linkedWith;\n        const linkingContext = this.linkingContext;\n        const searchSubTree = this.searchSubTree;\n        const linkedMultiple = this.linkedMultiple;\n        const links = Array.isArray(linkedWith) ? linkedWith : [linkedWith];\n        const contextNode = (typeof linkingContext === 'string'\n            ? doc.querySelector(linkingContext)\n            : linkingContext)\n            || doc.body;\n        const ii = links.length;\n        for (i = 0; ii > i; ++i) {\n            link = links[i];\n            // When user specify to link with something by a string, it acts as a CSS selector\n            // We need to do some querying stuff to determine if target above is contained.\n            if (typeof link === 'string') {\n                // Default behavior, search the whole tree, from context that user specified, which default to document body\n                if (searchSubTree) {\n                    // todo: are there too many knobs?? Consider remove \"linkedMultiple\"??\n                    if (!linkedMultiple) {\n                        const el = contextNode.querySelector(link);\n                        els = el !== null ? [el] : PLATFORM.emptyArray;\n                    }\n                    else {\n                        els = contextNode.querySelectorAll(link);\n                    }\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].contains(target)) {\n                            return true;\n                        }\n                    }\n                }\n                else {\n                    // default to document body, if user didn't define a linking context, and wanted to ignore subtree.\n                    // This is specifically performant and useful for dialogs, plugins\n                    // that usually generate contents to document body\n                    els = contextNode.children;\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].matches(link)) {\n                            return true;\n                        }\n                    }\n                }\n            }\n            else {\n                // When user passed in something that is not a string,\n                // simply check if has method `contains` (allow duck typing)\n                // and call it against target.\n                // This enables flexible usages\n                if (link && link.contains(target)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    triggerBlur() {\n        this.value = false;\n        if (typeof this.onBlur === 'function') {\n            this.onBlur.call(null);\n        }\n    }\n};\n__decorate([\n    bindable()\n], Blur.prototype, \"value\", void 0);\n__decorate([\n    bindable()\n], Blur.prototype, \"onBlur\", void 0);\n__decorate([\n    bindable()\n], Blur.prototype, \"linkedWith\", void 0);\n__decorate([\n    bindable()\n], Blur.prototype, \"linkedMultiple\", void 0);\n__decorate([\n    bindable()\n], Blur.prototype, \"searchSubTree\", void 0);\n__decorate([\n    bindable()\n], Blur.prototype, \"linkingContext\", void 0);\nBlur = __decorate([\n    customAttribute('blur'),\n    __param(0, INode),\n    __param(1, IDOM),\n    __param(2, IScheduler)\n], Blur);\nexport { Blur };\nconst containsElementOrShadowRoot = (container, target) => {\n    if (container.contains(target)) {\n        return true;\n    }\n    let parentNode = null;\n    while (target != null) {\n        if (target === container) {\n            return true;\n        }\n        parentNode = target.parentNode;\n        if (parentNode === null && target.nodeType === 11 /* DocumentFragment */) {\n            target = target.host;\n            continue;\n        }\n        target = parentNode;\n    }\n    return false;\n};\nconst createHandler = (manager, checkTargets) => {\n    // *******************************\n    // EVENTS ORDER\n    // -----------------------------\n    // pointerdown\n    // touchstart\n    // pointerup\n    // touchend\n    // mousedown\n    // --------------\n    // BLUR\n    // FOCUS\n    // --------------\n    // mouseup\n    // click\n    //\n    // ******************************\n    //\n    // There are cases focus happens without mouse interaction (keyboard)\n    // So it needs to capture both mouse / focus movement\n    //\n    // ******************************\n    let hasChecked = false;\n    const revertCheckage = () => {\n        hasChecked = false;\n    };\n    const markChecked = () => {\n        hasChecked = true;\n        manager.scheduler.queueRenderTask(revertCheckage, { preempt: true });\n    };\n    const handleMousedown = (e) => {\n        if (!hasChecked) {\n            handleEvent(e);\n            markChecked();\n        }\n    };\n    /**\n     * Handle globally captured focus event\n     * This can happen via a few way:\n     * User clicks on a focusable element\n     * User uses keyboard to navigate to a focusable element\n     * User goes back to the window from another browser tab\n     * User clicks on a non-focusable element\n     * User clicks on the window, outside of the document\n     */\n    const handleFocus = (e) => {\n        if (hasChecked) {\n            return;\n        }\n        // there are two way a focus gets captured on window\n        // when the windows itself got focus\n        // and when an element in the document gets focus\n        // when the window itself got focus, reacting to it is quite unnecessary\n        // as it doesn't really affect element inside the document\n        // Do a simple check and bail immediately\n        const isWindow = e.target === manager.dom.window;\n        if (isWindow) {\n            for (let i = 0, ii = checkTargets.length; ii > i; ++i) {\n                checkTargets[i].triggerBlur();\n            }\n        }\n        else {\n            handleEvent(e);\n        }\n        markChecked();\n    };\n    const handleWindowBlur = () => {\n        hasChecked = false;\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].triggerBlur();\n        }\n    };\n    const handleEvent = (e) => {\n        const target = e.composed ? e.composedPath()[0] : e.target;\n        if (target === null) {\n            return;\n        }\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].handleEventTarget(target);\n        }\n    };\n    return {\n        onpointerdown: handleMousedown,\n        ontouchstart: handleMousedown,\n        onmousedown: handleMousedown,\n        onfocus: handleFocus,\n        onblur: handleWindowBlur,\n        handleEvent(e) {\n            this[`on${e.type}`](e);\n        }\n    };\n};\n//# sourceMappingURL=blur.js.map","import { __decorate, __param } from \"tslib\";\nimport { bindable, BindingMode, customAttribute, IDOM, INode } from '@aurelia/runtime';\n/**\n * Focus attribute for element focus binding\n */\nlet Focus = class Focus {\n    constructor(element, dom) {\n        this.element = element;\n        this.dom = dom;\n        /**\n         * Indicates whether `apply` should be called when `attached` callback is invoked\n         */\n        this.needsApply = false;\n    }\n    binding() {\n        this.valueChanged();\n    }\n    /**\n     * Invoked everytime the bound value changes.\n     *\n     * @param newValue - The new value.\n     */\n    valueChanged() {\n        // In theory, we could/should react immediately\n        // but focus state of an element cannot be achieved\n        // while it's disconnected from the document\n        // thus, there neesd to be a check if it's currently connected or not\n        // before applying the value to the element\n        if (this.$controller.state & 32 /* isAttached */) {\n            this.apply();\n        }\n        // If the element is not currently connect\n        // toggle the flag to add pending work for later\n        // in attached lifecycle\n        else {\n            this.needsApply = true;\n        }\n    }\n    /**\n     * Invoked when the attribute is attached to the DOM.\n     */\n    attached() {\n        if (this.needsApply) {\n            this.needsApply = false;\n            this.apply();\n        }\n        const el = this.element;\n        el.addEventListener('focus', this);\n        el.addEventListener('blur', this);\n    }\n    /**\n     * Invoked when the attribute is detached from the DOM.\n     */\n    detached() {\n        const el = this.element;\n        el.removeEventListener('focus', this);\n        el.removeEventListener('blur', this);\n    }\n    /**\n     * EventTarget interface handler for better memory usage\n     */\n    handleEvent(e) {\n        // there are only two event listened to\n        // if the even is focus, it menans the element is focused\n        // only need to switch the value to true\n        if (e.type === 'focus') {\n            this.value = true;\n        }\n        // else, it's blur event\n        // when a blur event happens, there are two situations\n        // 1. the element itself lost the focus\n        // 2. window lost the focus\n        // To handle both (1) and (2), only need to check if\n        // current active element is still the same element of this focus custom attribute\n        // If it's not, it's a blur event happened on Window because the browser tab lost focus\n        else if (this.dom.document.activeElement !== this.element) {\n            this.value = false;\n        }\n    }\n    /**\n     * Focus/blur based on current value\n     */\n    apply() {\n        const el = this.element;\n        if (this.value) {\n            el.focus();\n        }\n        else {\n            el.blur();\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.twoWay })\n], Focus.prototype, \"value\", void 0);\nFocus = __decorate([\n    customAttribute('focus'),\n    __param(0, INode),\n    __param(1, IDOM)\n], Focus);\nexport { Focus };\n//# sourceMappingURL=focus.js.map","import { __decorate, __param } from \"tslib\";\nimport { nextId, } from '@aurelia/kernel';\nimport { bindable, ContinuationTask, IDOM, IRenderLocation, IViewFactory, LifecycleTask, templateController, TerminalTask } from '@aurelia/runtime';\nfunction toTask(maybePromiseOrTask) {\n    if (maybePromiseOrTask == null) {\n        return LifecycleTask.done;\n    }\n    if (typeof maybePromiseOrTask.then === 'function') {\n        return new TerminalTask(maybePromiseOrTask);\n    }\n    return maybePromiseOrTask;\n}\nlet Portal = class Portal {\n    constructor(factory, originalLoc, dom) {\n        this.factory = factory;\n        this.originalLoc = originalLoc;\n        this.dom = dom;\n        this.id = nextId('au$component');\n        this.strict = false;\n        this.task = LifecycleTask.done;\n        // to make the shape of this object consistent.\n        // todo: is this necessary\n        this.currentTarget = dom.createElement('div');\n        this.view = this.factory.create();\n        this.view.hold(originalLoc, 1 /* insertBefore */);\n    }\n    binding(flags) {\n        if (this.callbackContext == null) {\n            this.callbackContext = this.$controller.scope.bindingContext;\n        }\n        return this.view.bind(flags, this.$controller.scope);\n    }\n    attached(flags) {\n        this.targetChanged();\n    }\n    detaching(flags) {\n        this.task = this.deactivate(flags);\n    }\n    unbinding(flags) {\n        this.callbackContext = null;\n        return this.view.unbind(flags);\n    }\n    targetChanged() {\n        const $controller = this.$controller;\n        if (($controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        this.project($controller.flags);\n    }\n    project(flags) {\n        const oldTarget = this.currentTarget;\n        const newTarget = this.currentTarget = this.resolveTarget();\n        if (oldTarget === newTarget) {\n            return;\n        }\n        this.task = this.deactivate(flags);\n        this.task = this.activate(newTarget, flags);\n    }\n    activate(target, flags) {\n        const { activating, activated, callbackContext, view } = this;\n        let task = this.task;\n        view.hold(target, 2 /* append */);\n        if ((this.$controller.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return task;\n        }\n        if (typeof activating === 'function') {\n            if (task.done) {\n                task = toTask(activating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.attach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.attach, view, flags);\n        }\n        if (typeof activated === 'function') {\n            if (task.done) {\n                // TODO: chain this up with RAF queue mount callback so activated is called only when\n                // node is actually mounted (is this needed as per the spec of this resource?)\n                task = toTask(activated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const { deactivating, deactivated, callbackContext, view, target: target } = this;\n        let task = this.task;\n        if (typeof deactivating === 'function') {\n            if (task.done) {\n                task = toTask(deactivating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.detach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.detach, view, flags);\n        }\n        if (typeof deactivated === 'function') {\n            if (task.done) {\n                task = toTask(deactivated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    resolveTarget() {\n        const dom = this.dom;\n        // with a $ in front to make it less confusing/error prone\n        const $document = dom.document;\n        let target = this.target;\n        let context = this.renderContext;\n        if (typeof target === 'string') {\n            let queryContext = $document;\n            if (typeof context === 'string') {\n                context = $document.querySelector(context);\n            }\n            if (dom.isNodeInstance(context)) {\n                queryContext = context;\n            }\n            target = queryContext.querySelector(target);\n        }\n        if (dom.isNodeInstance(target)) {\n            return target;\n        }\n        if (target == null) {\n            if (this.strict) {\n                throw new Error('Render target not found');\n            }\n            else {\n                target = $document.body;\n            }\n        }\n        return target;\n    }\n};\n__decorate([\n    bindable({ primary: true })\n], Portal.prototype, \"target\", void 0);\n__decorate([\n    bindable({ callback: 'targetChanged' })\n], Portal.prototype, \"renderContext\", void 0);\n__decorate([\n    bindable()\n], Portal.prototype, \"strict\", void 0);\n__decorate([\n    bindable()\n], Portal.prototype, \"deactivating\", void 0);\n__decorate([\n    bindable()\n], Portal.prototype, \"activating\", void 0);\n__decorate([\n    bindable()\n], Portal.prototype, \"deactivated\", void 0);\n__decorate([\n    bindable()\n], Portal.prototype, \"activated\", void 0);\n__decorate([\n    bindable()\n], Portal.prototype, \"callbackContext\", void 0);\nPortal = __decorate([\n    templateController('portal'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __param(2, IDOM)\n], Portal);\nexport { Portal };\n//# sourceMappingURL=portal.js.map","export var HTMLTargetedInstructionType;\n(function (HTMLTargetedInstructionType) {\n    HTMLTargetedInstructionType[\"textBinding\"] = \"ha\";\n    HTMLTargetedInstructionType[\"listenerBinding\"] = \"hb\";\n    HTMLTargetedInstructionType[\"attributeBinding\"] = \"hc\";\n    HTMLTargetedInstructionType[\"stylePropertyBinding\"] = \"hd\";\n    HTMLTargetedInstructionType[\"setAttribute\"] = \"he\";\n    HTMLTargetedInstructionType[\"setClassAttribute\"] = \"hf\";\n    HTMLTargetedInstructionType[\"setStyleAttribute\"] = \"hg\";\n})(HTMLTargetedInstructionType || (HTMLTargetedInstructionType = {}));\nexport function isHTMLTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\n//# sourceMappingURL=definitions.js.map","import { DelegationStrategy } from '@aurelia/runtime';\nexport class TextBindingInstruction {\n    constructor(from) {\n        this.from = from;\n        this.type = \"ha\" /* textBinding */;\n    }\n}\nexport class TriggerBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = true;\n        this.strategy = DelegationStrategy.none;\n    }\n}\nexport class DelegateBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.bubbling;\n    }\n}\nexport class CaptureBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.capturing;\n    }\n}\nexport class StylePropertyBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hd\" /* stylePropertyBinding */;\n    }\n}\nexport class SetAttributeInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"he\" /* setAttribute */;\n    }\n}\nexport class SetClassAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hf\" /* setClassAttribute */;\n    }\n}\nexport class SetStyleAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hg\" /* setStyleAttribute */;\n    }\n}\nexport class AttributeBindingInstruction {\n    constructor(\n    /**\n     * `attr` and `to` have the same value on a normal attribute\n     * Will be different on `class` and `style`\n     * on `class`: attr = `class` (from binding command), to = attribute name\n     * on `style`: attr = `style` (from binding command), to = attribute name\n     */\n    attr, from, to) {\n        this.attr = attr;\n        this.from = from;\n        this.to = to;\n        this.type = \"hc\" /* attributeBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","import { CustomElement, HydrateElementInstruction, CustomElementDefinition } from '@aurelia/runtime';\nimport { isHTMLTargetedInstruction } from './definitions';\nimport { SetAttributeInstruction } from './instructions';\nexport function createElement(dom, tagOrType, props, children) {\n    if (typeof tagOrType === 'string') {\n        return createElementForTag(dom, tagOrType, props, children);\n    }\n    else if (CustomElement.isType(tagOrType)) {\n        return createElementForType(dom, tagOrType, props, children);\n    }\n    else {\n        throw new Error(`Invalid tagOrType.`);\n    }\n}\n/**\n * RenderPlan. Todo: describe goal of this class\n */\nexport class RenderPlan {\n    constructor(dom, node, instructions, dependencies) {\n        this.dom = dom;\n        this.node = node;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.lazyDefinition = void 0;\n    }\n    get definition() {\n        if (this.lazyDefinition === void 0) {\n            this.lazyDefinition = CustomElementDefinition.create({\n                name: CustomElement.generateName(),\n                template: this.node,\n                needsCompile: typeof this.node === 'string',\n                instructions: this.instructions,\n                dependencies: this.dependencies,\n            });\n        }\n        return this.lazyDefinition;\n    }\n    getElementTemplate(engine, Type) {\n        return engine.getElementTemplate(this.dom, this.definition, void 0, Type);\n    }\n    createView(flags, engine, parentContext) {\n        return this.getViewFactory(engine, parentContext).create();\n    }\n    getViewFactory(engine, parentContext) {\n        return engine.getViewFactory(this.dom, this.definition, parentContext);\n    }\n    /** @internal */\n    mergeInto(parent, instructions, dependencies) {\n        this.dom.appendChild(parent, this.node);\n        instructions.push(...this.instructions);\n        dependencies.push(...this.dependencies);\n    }\n}\nfunction createElementForTag(dom, tagName, props, children) {\n    const instructions = [];\n    const allInstructions = [];\n    const dependencies = [];\n    const element = dom.createElement(tagName);\n    let hasInstructions = false;\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                hasInstructions = true;\n                instructions.push(value);\n            }\n            else {\n                dom.setAttribute(element, to, value);\n            }\n        });\n    }\n    if (hasInstructions) {\n        dom.makeTarget(element);\n        allInstructions.push(instructions);\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction createElementForType(dom, Type, props, children) {\n    const definition = CustomElement.getDefinition(Type);\n    const tagName = definition.name;\n    const instructions = [];\n    const allInstructions = [instructions];\n    const dependencies = [];\n    const childInstructions = [];\n    const bindables = definition.bindables;\n    const element = dom.createElement(tagName);\n    dom.makeTarget(element);\n    if (!dependencies.includes(Type)) {\n        dependencies.push(Type);\n    }\n    instructions.push(new HydrateElementInstruction(tagName, childInstructions));\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                childInstructions.push(value);\n            }\n            else {\n                const bindable = bindables[to];\n                if (bindable !== void 0) {\n                    childInstructions.push({\n                        type: \"re\" /* setProperty */,\n                        to,\n                        value\n                    });\n                }\n                else {\n                    childInstructions.push(new SetAttributeInstruction(value, to));\n                }\n            }\n        });\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction addChildren(dom, parent, children, allInstructions, dependencies) {\n    for (let i = 0, ii = children.length; i < ii; ++i) {\n        const current = children[i];\n        switch (typeof current) {\n            case 'string':\n                dom.appendChild(parent, dom.createTextNode(current));\n                break;\n            case 'object':\n                if (dom.isNodeInstance(current)) {\n                    dom.appendChild(parent, current);\n                }\n                else if ('mergeInto' in current) {\n                    current.mergeInto(parent, allInstructions, dependencies);\n                }\n        }\n    }\n}\n//# sourceMappingURL=create-element.js.map","import { __decorate, __param } from \"tslib\";\nimport { nextId, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, ContinuationTask, IController, IDOM, IRenderingEngine, ITargetedInstruction, LifecycleTask, PromiseTask, bindable, customElement, } from '@aurelia/runtime';\nimport { createElement, } from '../../create-element';\nconst bindables = ['subject', 'composing'];\nlet Compose = class Compose {\n    constructor(dom, renderable, instruction, renderingEngine) {\n        this.dom = dom;\n        this.renderable = renderable;\n        this.instruction = instruction;\n        this.renderingEngine = renderingEngine;\n        this.id = nextId('au$component');\n        this.subject = void 0;\n        this.composing = false;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.lastSubject = void 0;\n        this.properties = instruction.instructions\n            .filter((x) => !bindables.includes(x.to))\n            .reduce((acc, item) => {\n            if (item.to) {\n                acc[item.to] = item;\n            }\n            return acc;\n        }, {});\n    }\n    binding(flags) {\n        if (this.task.done) {\n            this.task = this.compose(this.subject, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, this.subject, flags);\n        }\n        if (this.task.done) {\n            this.task = this.bindView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.bindView, this, flags);\n        }\n        return this.task;\n    }\n    attaching(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    detaching(flags) {\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n    }\n    unbinding(flags) {\n        this.lastSubject = void 0;\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        this.view = void 0;\n    }\n    subjectChanged(newValue, previousValue, flags) {\n        flags |= this.$controller.flags;\n        if (this.task.done) {\n            this.task = this.compose(newValue, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, newValue, flags);\n        }\n    }\n    compose(subject, flags) {\n        if (this.lastSubject === subject) {\n            return LifecycleTask.done;\n        }\n        this.lastSubject = subject;\n        this.composing = true;\n        let task = this.deactivate(flags);\n        if (subject instanceof Promise) {\n            let viewPromise;\n            if (task.done) {\n                viewPromise = subject.then(s => this.resolveView(s, flags));\n            }\n            else {\n                viewPromise = task.wait().then(() => subject.then(s => this.resolveView(s, flags)));\n            }\n            task = new PromiseTask(viewPromise, this.activate, this, flags);\n        }\n        else {\n            const view = this.resolveView(subject, flags);\n            if (task.done) {\n                task = this.activate(view, flags);\n            }\n            else {\n                task = new ContinuationTask(task, this.activate, this, view, flags);\n            }\n        }\n        if (task.done) {\n            this.onComposed();\n        }\n        else {\n            task = new ContinuationTask(task, this.onComposed, this);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags);\n        return view.unbind(flags);\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (5 /* isBoundOrBinding */)) > 0) {\n            return this.view.bind(flags, this.renderable.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (40 /* isAttachedOrAttaching */)) > 0) {\n            this.view.attach(flags);\n        }\n    }\n    onComposed() {\n        this.composing = false;\n    }\n    resolveView(subject, flags) {\n        const view = this.provideViewFor(subject, flags);\n        if (view) {\n            view.hold(this.$controller.projector.host, 1 /* insertBefore */);\n            view.lockScope(this.renderable.scope);\n            return view;\n        }\n        return void 0;\n    }\n    provideViewFor(subject, flags) {\n        if (!subject) {\n            return void 0;\n        }\n        if ('lockScope' in subject) { // IController\n            return subject;\n        }\n        if ('createView' in subject) { // RenderPlan\n            return subject.createView(flags, this.renderingEngine, this.renderable.context);\n        }\n        if ('create' in subject) { // IViewFactory\n            return subject.create();\n        }\n        if ('template' in subject) { // Raw Template Definition\n            return this.renderingEngine.getViewFactory(this.dom, subject, this.renderable.context).create();\n        }\n        // Constructable (Custom Element Constructor)\n        return createElement(this.dom, subject, this.properties, this.$controller.projector === void 0\n            ? PLATFORM.emptyArray\n            : this.$controller.projector.children).createView(flags, this.renderingEngine, this.renderable.context);\n    }\n};\n__decorate([\n    bindable\n], Compose.prototype, \"subject\", void 0);\n__decorate([\n    bindable({ mode: BindingMode.fromView })\n], Compose.prototype, \"composing\", void 0);\nCompose = __decorate([\n    customElement({ name: 'au-compose', template: null, containerless: true }),\n    __param(0, IDOM),\n    __param(1, IController),\n    __param(2, ITargetedInstruction),\n    __param(3, IRenderingEngine)\n], Compose);\nexport { Compose };\n//# sourceMappingURL=compose.js.map","import { __decorate, __param } from \"tslib\";\nimport { PLATFORM, Registration, Reporter } from '@aurelia/kernel';\nimport { CompiledTemplate, DOM, IDOM, INode, ITemplateFactory, NodeSequence } from '@aurelia/runtime';\nexport var NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Element\"] = 1] = \"Element\";\n    NodeType[NodeType[\"Attr\"] = 2] = \"Attr\";\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    NodeType[NodeType[\"CDATASection\"] = 4] = \"CDATASection\";\n    NodeType[NodeType[\"EntityReference\"] = 5] = \"EntityReference\";\n    NodeType[NodeType[\"Entity\"] = 6] = \"Entity\";\n    NodeType[NodeType[\"ProcessingInstruction\"] = 7] = \"ProcessingInstruction\";\n    NodeType[NodeType[\"Comment\"] = 8] = \"Comment\";\n    NodeType[NodeType[\"Document\"] = 9] = \"Document\";\n    NodeType[NodeType[\"DocumentType\"] = 10] = \"DocumentType\";\n    NodeType[NodeType[\"DocumentFragment\"] = 11] = \"DocumentFragment\";\n    NodeType[NodeType[\"Notation\"] = 12] = \"Notation\";\n})(NodeType || (NodeType = {}));\n/**\n * IDOM implementation for Html.\n */\nexport class HTMLDOM {\n    constructor(window, document, TNode, TElement, THTMLElement, TCustomEvent, TCSSStyleSheet, TShadowRoot) {\n        this.window = window;\n        this.document = document;\n        this.Node = TNode;\n        this.Element = TElement;\n        this.HTMLElement = THTMLElement;\n        this.CustomEvent = TCustomEvent;\n        this.CSSStyleSheet = TCSSStyleSheet;\n        this.ShadowRoot = TShadowRoot;\n        if (DOM.isInitialized) {\n            Reporter.write(1001); // TODO: create reporters code // DOM already initialized (just info)\n            DOM.destroy();\n        }\n        DOM.initialize(this);\n    }\n    static register(container) {\n        return Registration.alias(IDOM, this).register(container);\n    }\n    addEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).addEventListener(eventName, subscriber, options);\n    }\n    appendChild(parent, child) {\n        parent.appendChild(child);\n    }\n    cloneNode(node, deep) {\n        return node.cloneNode(deep !== false);\n    }\n    convertToRenderLocation(node) {\n        if (this.isRenderLocation(node)) {\n            return node; // it's already a IRenderLocation (converted by FragmentNodeSequence)\n        }\n        if (node.parentNode == null) {\n            throw Reporter.error(52);\n        }\n        const locationEnd = this.document.createComment('au-end');\n        const locationStart = this.document.createComment('au-start');\n        node.parentNode.replaceChild(locationEnd, node);\n        locationEnd.parentNode.insertBefore(locationStart, locationEnd);\n        locationEnd.$start = locationStart;\n        locationStart.$nodes = null;\n        return locationEnd;\n    }\n    createDocumentFragment(markupOrNode) {\n        if (markupOrNode == null) {\n            return this.document.createDocumentFragment();\n        }\n        if (this.isNodeInstance(markupOrNode)) {\n            if (markupOrNode.content !== undefined) {\n                return markupOrNode.content;\n            }\n            const fragment = this.document.createDocumentFragment();\n            fragment.appendChild(markupOrNode);\n            return fragment;\n        }\n        return this.createTemplate(markupOrNode).content;\n    }\n    createElement(name) {\n        return this.document.createElement(name);\n    }\n    fetch(input, init) {\n        return this.window.fetch(input, init);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    createCustomEvent(eventType, options) {\n        return new this.CustomEvent(eventType, options);\n    }\n    dispatchEvent(evt) {\n        this.document.dispatchEvent(evt);\n    }\n    createNodeObserver(node, cb, init) {\n        if (typeof MutationObserver === 'undefined') {\n            // TODO: find a proper response for this scenario\n            return {\n                disconnect() { },\n                observe() { },\n                takeRecords() { return PLATFORM.emptyArray; }\n            };\n        }\n        const observer = new MutationObserver(cb);\n        observer.observe(node, init);\n        return observer;\n    }\n    createTemplate(markup) {\n        if (markup == null) {\n            return this.document.createElement('template');\n        }\n        const template = this.document.createElement('template');\n        template.innerHTML = markup.toString();\n        return template;\n    }\n    createTextNode(text) {\n        return this.document.createTextNode(text);\n    }\n    insertBefore(nodeToInsert, referenceNode) {\n        referenceNode.parentNode.insertBefore(nodeToInsert, referenceNode);\n    }\n    isMarker(node) {\n        return node.nodeName === 'AU-M';\n    }\n    isNodeInstance(potentialNode) {\n        return potentialNode != null && potentialNode.nodeType > 0;\n    }\n    isRenderLocation(node) {\n        return node.textContent === 'au-end';\n    }\n    makeTarget(node) {\n        node.className = 'au';\n    }\n    registerElementResolver(container, resolver) {\n        container.registerResolver(INode, resolver);\n        container.registerResolver(this.Node, resolver);\n        container.registerResolver(this.Element, resolver);\n        container.registerResolver(this.HTMLElement, resolver);\n    }\n    remove(node) {\n        if (node.remove) {\n            node.remove();\n        }\n        else {\n            node.parentNode.removeChild(node);\n        }\n    }\n    removeEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).removeEventListener(eventName, subscriber, options);\n    }\n    setAttribute(node, name, value) {\n        node.setAttribute(name, value);\n    }\n}\nconst $DOM = DOM;\nexport { $DOM as DOM };\n/* eslint-enable @typescript-eslint/no-explicit-any */\n// This is the most common form of INodeSequence.\n// Every custom element or template controller whose node sequence is based on an HTML template\n// has an instance of this under the hood. Anyone who wants to create a node sequence from\n// a string of markup would also receive an instance of this.\n// CompiledTemplates create instances of FragmentNodeSequence.\n/**\n * This is the most common form of INodeSequence.\n *\n * @internal\n */\nexport class FragmentNodeSequence {\n    constructor(dom, fragment) {\n        this.dom = dom;\n        this.fragment = fragment;\n        this.isMounted = false;\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n        const targetNodeList = fragment.querySelectorAll('.au');\n        let i = 0;\n        let ii = targetNodeList.length;\n        const targets = this.targets = Array(ii);\n        while (i < ii) {\n            // eagerly convert all markers to RenderLocations (otherwise the renderer\n            // will do it anyway) and store them in the target list (since the comments\n            // can't be queried)\n            const target = targetNodeList[i];\n            if (target.nodeName === 'AU-M') {\n                // note the renderer will still call this method, but it will just return the\n                // location if it sees it's already a location\n                targets[i] = this.dom.convertToRenderLocation(target);\n            }\n            else {\n                // also store non-markers for consistent ordering\n                targets[i] = target;\n            }\n            ++i;\n        }\n        const childNodeList = fragment.childNodes;\n        i = 0;\n        ii = childNodeList.length;\n        const childNodes = this.childNodes = Array(ii);\n        while (i < ii) {\n            childNodes[i] = childNodeList[i];\n            ++i;\n        }\n        this.firstChild = fragment.firstChild;\n        this.lastChild = fragment.lastChild;\n    }\n    findTargets() {\n        return this.targets;\n    }\n    insertBefore(refNode) {\n        if (this.isLinked && !!this.refNode) {\n            this.addToLinked();\n        }\n        else {\n            const parent = refNode.parentNode;\n            if (this.isMounted) {\n                let current = this.firstChild;\n                const end = this.lastChild;\n                let next;\n                while (current != null) {\n                    next = current.nextSibling;\n                    parent.insertBefore(current, refNode);\n                    if (current === end) {\n                        break;\n                    }\n                    current = next;\n                }\n            }\n            else {\n                this.isMounted = true;\n                refNode.parentNode.insertBefore(this.fragment, refNode);\n            }\n        }\n    }\n    appendTo(parent) {\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.appendChild(this.fragment);\n        }\n    }\n    remove() {\n        if (this.isMounted) {\n            this.isMounted = false;\n            const fragment = this.fragment;\n            const end = this.lastChild;\n            let next;\n            let current = this.firstChild;\n            while (current !== null) {\n                next = current.nextSibling;\n                fragment.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n    }\n    addToLinked() {\n        const refNode = this.refNode;\n        const parent = refNode.parentNode;\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.insertBefore(current, refNode);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.insertBefore(this.fragment, refNode);\n        }\n    }\n    unlink() {\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n    }\n    link(next) {\n        this.isLinked = true;\n        if (this.dom.isRenderLocation(next)) {\n            this.refNode = next;\n        }\n        else {\n            this.next = next;\n            this.obtainRefNode();\n        }\n    }\n    obtainRefNode() {\n        if (this.next !== void 0) {\n            this.refNode = this.next.firstChild;\n        }\n        else {\n            this.refNode = void 0;\n        }\n    }\n}\nexport class NodeSequenceFactory {\n    constructor(dom, markupOrNode) {\n        this.dom = dom;\n        if (markupOrNode === null) {\n            this.node = null;\n        }\n        else {\n            this.node = dom.createDocumentFragment(markupOrNode);\n        }\n    }\n    createNodeSequence() {\n        if (this.node === null) {\n            return NodeSequence.empty;\n        }\n        return new FragmentNodeSequence(this.dom, this.node.cloneNode(true));\n    }\n}\n/** @internal */\nexport class AuMarker {\n    constructor(nextSibling) {\n        this.nextSibling = nextSibling;\n        this.textContent = '';\n    }\n    get parentNode() {\n        return this.nextSibling.parentNode;\n    }\n    remove() { }\n}\n(proto => {\n    proto.previousSibling = null;\n    proto.childNodes = PLATFORM.emptyArray;\n    proto.nodeName = 'AU-M';\n    proto.nodeType = 1 /* Element */;\n})(AuMarker.prototype);\n/** @internal */\nlet HTMLTemplateFactory = class HTMLTemplateFactory {\n    constructor(dom) {\n        this.dom = dom;\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateFactory, this).register(container);\n    }\n    create(parentRenderContext, definition) {\n        return new CompiledTemplate(this.dom, definition, new NodeSequenceFactory(this.dom, definition.template), parentRenderContext);\n    }\n};\nHTMLTemplateFactory = __decorate([\n    __param(0, IDOM)\n], HTMLTemplateFactory);\nexport { HTMLTemplateFactory };\n//# sourceMappingURL=dom.js.map","import { __decorate, __param } from \"tslib\";\nimport { addBinding, BindingMode, ensureExpression, IExpressionParser, instructionRenderer, InterpolationBinding, IObserverLocator, MultiInterpolationBinding, PropertyBinding } from '@aurelia/runtime';\nimport { AttributeBinding } from './binding/attribute';\nimport { Listener } from './binding/listener';\nimport { IEventManager } from './observation/event-manager';\nlet TextBindingRenderer = \n/** @internal */\nclass TextBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const next = target.nextSibling;\n        if (dom.isMarker(target)) {\n            dom.remove(target);\n        }\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = new MultiInterpolationBinding(this.observerLocator, expr, next, 'textContent', BindingMode.toView, context);\n        }\n        else {\n            binding = new InterpolationBinding(expr.firstExpression, expr, next, 'textContent', BindingMode.toView, this.observerLocator, context, true);\n        }\n        addBinding(renderable, binding);\n    }\n};\nTextBindingRenderer = __decorate([\n    instructionRenderer(\"ha\" /* textBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], TextBindingRenderer);\nexport { TextBindingRenderer };\nlet ListenerBindingRenderer = \n/** @internal */\nclass ListenerBindingRenderer {\n    constructor(parser, eventManager) {\n        this.parser = parser;\n        this.eventManager = eventManager;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 80 /* IsEventCommand */ | (instruction.strategy + 6 /* DelegationStrategyDelta */));\n        const binding = new Listener(dom, instruction.to, instruction.strategy, expr, target, instruction.preventDefault, this.eventManager, context);\n        addBinding(renderable, binding);\n    }\n};\nListenerBindingRenderer = __decorate([\n    instructionRenderer(\"hb\" /* listenerBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IEventManager)\n], ListenerBindingRenderer);\nexport { ListenerBindingRenderer };\nlet SetAttributeRenderer = \n/** @internal */\nclass SetAttributeRenderer {\n    render(flags, dom, context, renderable, target, instruction) {\n        target.setAttribute(instruction.to, instruction.value);\n    }\n};\nSetAttributeRenderer = __decorate([\n    instructionRenderer(\"he\" /* setAttribute */)\n    /** @internal */\n], SetAttributeRenderer);\nexport { SetAttributeRenderer };\nlet SetClassAttributeRenderer = class SetClassAttributeRenderer {\n    render(flags, dom, context, renderable, target, instruction) {\n        addClasses(target.classList, instruction.value);\n    }\n};\nSetClassAttributeRenderer = __decorate([\n    instructionRenderer(\"hf\" /* setClassAttribute */)\n], SetClassAttributeRenderer);\nexport { SetClassAttributeRenderer };\nlet SetStyleAttributeRenderer = class SetStyleAttributeRenderer {\n    render(flags, dom, context, renderable, target, instruction) {\n        target.style.cssText += instruction.value;\n    }\n};\nSetStyleAttributeRenderer = __decorate([\n    instructionRenderer(\"hg\" /* setStyleAttribute */)\n], SetStyleAttributeRenderer);\nexport { SetStyleAttributeRenderer };\nlet StylePropertyBindingRenderer = \n/** @internal */\nclass StylePropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = new PropertyBinding(expr, target.style, instruction.to, BindingMode.toView, this.observerLocator, context);\n        addBinding(renderable, binding);\n    }\n};\nStylePropertyBindingRenderer = __decorate([\n    instructionRenderer(\"hd\" /* stylePropertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], StylePropertyBindingRenderer);\nexport { StylePropertyBindingRenderer };\nlet AttributeBindingRenderer = \n/** @internal */\nclass AttributeBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, dom, context, renderable, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = new AttributeBinding(expr, target, instruction.attr /* targetAttribute */, instruction.to /* targetKey */, BindingMode.toView, this.observerLocator, context);\n        addBinding(renderable, binding);\n    }\n};\nAttributeBindingRenderer = __decorate([\n    instructionRenderer(\"hc\" /* attributeBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator)\n], AttributeBindingRenderer);\nexport { AttributeBindingRenderer };\n// http://jsben.ch/7n5Kt\nfunction addClasses(classList, className) {\n    const len = className.length;\n    let start = 0;\n    for (let i = 0; i < len; ++i) {\n        if (className.charCodeAt(i) === 0x20) {\n            if (i !== start) {\n                classList.add(className.slice(start, i));\n            }\n            start = i + 1;\n        }\n        else if (i + 1 === len) {\n            classList.add(className.slice(start));\n        }\n    }\n}\n//# sourceMappingURL=html-renderer.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nexport const noopShadowDOMStyles = Object.freeze({\n    applyTo: PLATFORM.noop\n});\nexport const IShadowDOMStyles = DI.createInterface('IShadowDOMStyles').noDefault();\nexport const IShadowDOMGlobalStyles = DI.createInterface('IShadowDOMGlobalStyles')\n    .withDefault(x => x.instance(noopShadowDOMStyles));\nexport class AdoptedStyleSheetsStyles {\n    constructor(dom, localStyles, styleSheetCache, sharedStyles = null) {\n        this.sharedStyles = sharedStyles;\n        this.styleSheets = localStyles.map(x => {\n            let sheet;\n            if (x instanceof dom.CSSStyleSheet) {\n                sheet = x;\n            }\n            else {\n                sheet = styleSheetCache.get(x);\n                if (!sheet) {\n                    sheet = new dom.CSSStyleSheet();\n                    sheet.replaceSync(x);\n                    styleSheetCache.set(x, sheet);\n                }\n            }\n            return sheet;\n        });\n    }\n    static supported(dom) {\n        return 'adoptedStyleSheets' in dom.ShadowRoot.prototype;\n    }\n    applyTo(shadowRoot) {\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n        // https://wicg.github.io/construct-stylesheets/\n        // https://developers.google.com/web/updates/2019/02/constructable-stylesheets\n        shadowRoot.adoptedStyleSheets = [\n            ...shadowRoot.adoptedStyleSheets,\n            ...this.styleSheets\n        ];\n    }\n}\nexport class StyleElementStyles {\n    constructor(dom, localStyles, sharedStyles = null) {\n        this.dom = dom;\n        this.localStyles = localStyles;\n        this.sharedStyles = sharedStyles;\n    }\n    applyTo(shadowRoot) {\n        const styles = this.localStyles;\n        const dom = this.dom;\n        for (let i = styles.length - 1; i > -1; --i) {\n            const element = dom.createElement('style');\n            element.innerHTML = styles[i];\n            shadowRoot.prepend(element);\n        }\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n    }\n}\n//# sourceMappingURL=shadow-dom-styles.js.map","import { PLATFORM, Registration, Reporter, toArray } from '@aurelia/kernel';\nimport { IProjectorLocator } from '@aurelia/runtime';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles } from './styles/shadow-dom-styles';\nconst slice = Array.prototype.slice;\nconst defaultShadowOptions = {\n    mode: 'open'\n};\nexport class HTMLProjectorLocator {\n    static register(container) {\n        return Registration.singleton(IProjectorLocator, this).register(container);\n    }\n    getElementProjector(dom, $component, host, def) {\n        if (def.shadowOptions || def.hasSlots) {\n            if (def.containerless) {\n                throw Reporter.error(21);\n            }\n            return new ShadowDOMProjector(dom, $component, host, def);\n        }\n        if (def.containerless) {\n            return new ContainerlessProjector(dom, $component, host);\n        }\n        return new HostProjector($component, host);\n    }\n}\nconst childObserverOptions = { childList: true };\n/** @internal */\nexport class ShadowDOMProjector {\n    constructor(dom, \n    // eslint-disable-next-line @typescript-eslint/prefer-readonly\n    $controller, host, definition) {\n        this.dom = dom;\n        this.$controller = $controller;\n        this.host = host;\n        let shadowOptions;\n        if (definition.shadowOptions instanceof Object &&\n            'mode' in definition.shadowOptions) {\n            shadowOptions = definition.shadowOptions;\n        }\n        else {\n            shadowOptions = defaultShadowOptions;\n        }\n        this.shadowRoot = host.attachShadow(shadowOptions);\n        this.host.$controller = $controller;\n        this.shadowRoot.$controller = $controller;\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback, options = childObserverOptions) {\n        // TODO: add a way to dispose/disconnect\n        this.dom.createNodeObserver(this.host, callback, options);\n    }\n    provideEncapsulationSource() {\n        return this.shadowRoot;\n    }\n    project(nodes) {\n        const context = this.$controller.context;\n        const styles = context.has(IShadowDOMStyles, false)\n            ? context.get(IShadowDOMStyles)\n            : context.get(IShadowDOMGlobalStyles);\n        styles.applyTo(this.shadowRoot);\n        nodes.appendTo(this.shadowRoot);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class ContainerlessProjector {\n    constructor(dom, $controller, host) {\n        if (host.childNodes.length) {\n            this.childNodes = toArray(host.childNodes);\n        }\n        else {\n            this.childNodes = PLATFORM.emptyArray;\n        }\n        this.host = dom.convertToRenderLocation(host);\n        this.host.$controller = $controller;\n    }\n    get children() {\n        return this.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // TODO: turn this into an error\n        // Containerless does not have a container node to observe children on.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.insertBefore(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class HostProjector {\n    constructor($controller, host) {\n        this.host = host;\n        host.$controller = $controller;\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // Do nothing since this scenario will never have children.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.appendTo(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n//# sourceMappingURL=projectors.js.map","import { DI } from '@aurelia/kernel';\nimport { RuntimeConfiguration } from '@aurelia/runtime';\nimport { HTMLTemplateFactory } from './dom';\nimport { AttributeBindingRenderer, ListenerBindingRenderer, SetAttributeRenderer, StylePropertyBindingRenderer, TextBindingRenderer, SetClassAttributeRenderer, SetStyleAttributeRenderer } from './html-renderer';\nimport { TargetAccessorLocator, TargetObserverLocator } from './observation/observer-locator';\nimport { HTMLProjectorLocator } from './projectors';\nimport { AttrBindingBehavior } from './resources/binding-behaviors/attr';\nimport { SelfBindingBehavior } from './resources/binding-behaviors/self';\nimport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger';\nimport { Blur } from './resources/custom-attributes/blur';\nimport { Focus } from './resources/custom-attributes/focus';\nimport { Portal } from './resources/custom-attributes/portal';\nimport { Compose } from './resources/custom-elements/compose';\nexport const IProjectorLocatorRegistration = HTMLProjectorLocator;\nexport const ITargetAccessorLocatorRegistration = TargetAccessorLocator;\nexport const ITargetObserverLocatorRegistration = TargetObserverLocator;\nexport const ITemplateFactoryRegistration = HTMLTemplateFactory;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `IProjectorLocator`\n * - `ITargetAccessorLocator`\n * - `ITargetObserverLocator`\n * - `ITemplateFactory`\n */\nexport const DefaultComponents = [\n    IProjectorLocatorRegistration,\n    ITargetAccessorLocatorRegistration,\n    ITargetObserverLocatorRegistration,\n    ITemplateFactoryRegistration\n];\nexport const AttrBindingBehaviorRegistration = AttrBindingBehavior;\nexport const SelfBindingBehaviorRegistration = SelfBindingBehavior;\nexport const UpdateTriggerBindingBehaviorRegistration = UpdateTriggerBindingBehavior;\nexport const ComposeRegistration = Compose;\nexport const PortalRegistration = Portal;\nexport const FocusRegistration = Focus;\nexport const BlurRegistration = Blur;\n/**\n * Default HTML-specific (but environment-agnostic) resources:\n * - Binding Behaviors: `attr`, `self`, `updateTrigger`\n * - Custom Elements: `au-compose`\n * - Custom Attributes: `blur`, `focus`, `portal`\n */\nexport const DefaultResources = [\n    AttrBindingBehaviorRegistration,\n    SelfBindingBehaviorRegistration,\n    UpdateTriggerBindingBehaviorRegistration,\n    ComposeRegistration,\n    PortalRegistration,\n    FocusRegistration,\n    BlurRegistration\n];\nexport const ListenerBindingRendererRegistration = ListenerBindingRenderer;\nexport const AttributeBindingRendererRegistration = AttributeBindingRenderer;\nexport const SetAttributeRendererRegistration = SetAttributeRenderer;\nexport const SetClassAttributeRendererRegistration = SetClassAttributeRenderer;\nexport const SetStyleAttributeRendererRegistration = SetStyleAttributeRenderer;\nexport const StylePropertyBindingRendererRegistration = StylePropertyBindingRenderer;\nexport const TextBindingRendererRegistration = TextBindingRenderer;\n/**\n * Default HTML-specfic (but environment-agnostic) renderers for:\n * - Listener Bindings: `trigger`, `capture`, `delegate`\n * - SetAttribute\n * - StyleProperty: `style`, `css`\n * - TextBinding: `${}`\n */\nexport const DefaultRenderers = [\n    ListenerBindingRendererRegistration,\n    AttributeBindingRendererRegistration,\n    SetAttributeRendererRegistration,\n    SetClassAttributeRendererRegistration,\n    SetStyleAttributeRendererRegistration,\n    StylePropertyBindingRendererRegistration,\n    TextBindingRendererRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { __decorate } from \"tslib\";\nimport { bindingCommand, getTarget, } from '@aurelia/jit';\nimport { RefBindingInstruction } from '@aurelia/runtime';\nimport { AttributeBindingInstruction, CaptureBindingInstruction, DelegateBindingInstruction, TriggerBindingInstruction } from '@aurelia/runtime-html';\n/**\n * Trigger binding command. Compile attr with binding symbol with command `trigger` to `TriggerBindingInstruction`\n */\nlet TriggerBindingCommand = class TriggerBindingCommand {\n    constructor() {\n        this.bindingType = 4182 /* TriggerCommand */;\n    }\n    compile(binding) {\n        return new TriggerBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTriggerBindingCommand = __decorate([\n    bindingCommand('trigger')\n], TriggerBindingCommand);\nexport { TriggerBindingCommand };\n/**\n * Delegate binding command. Compile attr with binding symbol with command `delegate` to `DelegateBindingInstruction`\n */\nlet DelegateBindingCommand = class DelegateBindingCommand {\n    constructor() {\n        this.bindingType = 4184 /* DelegateCommand */;\n    }\n    compile(binding) {\n        return new DelegateBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nDelegateBindingCommand = __decorate([\n    bindingCommand('delegate')\n], DelegateBindingCommand);\nexport { DelegateBindingCommand };\n/**\n * Capture binding command. Compile attr with binding symbol with command `capture` to `CaptureBindingInstruction`\n */\nlet CaptureBindingCommand = class CaptureBindingCommand {\n    constructor() {\n        this.bindingType = 4183 /* CaptureCommand */;\n    }\n    compile(binding) {\n        return new CaptureBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nCaptureBindingCommand = __decorate([\n    bindingCommand('capture')\n], CaptureBindingCommand);\nexport { CaptureBindingCommand };\n/**\n * Attr binding command. Compile attr with binding symbol with command `attr` to `AttributeBindingInstruction`\n */\nlet AttrBindingCommand = class AttrBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        const target = getTarget(binding, false);\n        return new AttributeBindingInstruction(target, binding.expression, target);\n    }\n};\nAttrBindingCommand = __decorate([\n    bindingCommand('attr')\n], AttrBindingCommand);\nexport { AttrBindingCommand };\n/**\n * Style binding command. Compile attr with binding symbol with command `style` to `AttributeBindingInstruction`\n */\nlet StyleBindingCommand = class StyleBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('style', binding.expression, getTarget(binding, false));\n    }\n};\nStyleBindingCommand = __decorate([\n    bindingCommand('style')\n], StyleBindingCommand);\nexport { StyleBindingCommand };\n/**\n * Class binding command. Compile attr with binding symbol with command `class` to `AttributeBindingInstruction`\n */\nlet ClassBindingCommand = class ClassBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('class', binding.expression, getTarget(binding, false));\n    }\n};\nClassBindingCommand = __decorate([\n    bindingCommand('class')\n], ClassBindingCommand);\nexport { ClassBindingCommand };\n/**\n * Binding command to refer different targets (element, custom element/attribute view models, controller) attached to an element\n */\nlet RefBindingCommand = class RefBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */ | 4096 /* IgnoreCustomAttr */;\n    }\n    compile(binding) {\n        return new RefBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nRefBindingCommand = __decorate([\n    bindingCommand('ref')\n], RefBindingCommand);\nexport { RefBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","import { __decorate } from \"tslib\";\nimport { attributePattern, AttrSyntax } from '@aurelia/jit';\n/**\n * Attribute syntax pattern recognizer, helping Aurelia understand template:\n * ```html\n * <div attr.some-attr=\"someAttrValue\"></div>\n * <div some-attr.attr=\"someAttrValue\"></div>\n * ````\n */\nlet AttrAttributePattern = class AttrAttributePattern {\n    ['attr.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[1], 'attr');\n    }\n    ['PART.attr'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'attr');\n    }\n};\nAttrAttributePattern = __decorate([\n    attributePattern({ pattern: 'attr.PART', symbols: '.' }, { pattern: 'PART.attr', symbols: '.' })\n], AttrAttributePattern);\nexport { AttrAttributePattern };\n/**\n * Style syntax pattern recognizer, helps Aurelia understand template:\n * ```html\n * <div background.style=\"bg\"></div>\n * <div style.background=\"bg\"></div>\n * <div background-color.style=\"bg\"></div>\n * <div style.background-color=\"bg\"></div>\n * <div -webkit-user-select.style=\"select\"></div>\n * <div style.-webkit-user-select=\"select\"></div>\n * <div --custom-prop-css.style=\"cssProp\"></div>\n * <div style.--custom-prop-css=\"cssProp\"></div>\n * ```\n */\nlet StyleAttributePattern = class StyleAttributePattern {\n    ['style.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[1], 'style');\n    }\n    ['PART.style'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'style');\n    }\n};\nStyleAttributePattern = __decorate([\n    attributePattern({ pattern: 'style.PART', symbols: '.' }, { pattern: 'PART.style', symbols: '.' })\n], StyleAttributePattern);\nexport { StyleAttributePattern };\n/**\n * Class syntax pattern recognizer, helps Aurelia understand template:\n * ```html\n * <div my-class.class=\"class\"></div>\n * <div class.my-class=\"class\"></div>\n * <div ✔.class=\"checked\"></div>\n * <div class.✔=\"checked\"></div>\n * ```\n */\nlet ClassAttributePattern = class ClassAttributePattern {\n    ['class.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[1], 'class');\n    }\n    ['PART.class'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'class');\n    }\n};\nClassAttributePattern = __decorate([\n    attributePattern({ pattern: 'class.PART', symbols: '.' }, { pattern: 'PART.class', symbols: '.' })\n], ClassAttributePattern);\nexport { ClassAttributePattern };\n//# sourceMappingURL=attribute-patterns.js.map","import { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol as $CustomElementSymbol, LetElementSymbol as $LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol as $PlainElementSymbol, ReplacePartSymbol as $ReplacePartSymbol, TemplateControllerSymbol as $TemplateControllerSymbol, TextSymbol as $TextSymbol, } from '@aurelia/jit';\nexport const CustomElementSymbol = $CustomElementSymbol;\nexport const LetElementSymbol = $LetElementSymbol;\nexport const PlainElementSymbol = $PlainElementSymbol;\nexport const ReplacePartSymbol = $ReplacePartSymbol;\nexport const TemplateControllerSymbol = $TemplateControllerSymbol;\nexport const TextSymbol = $TextSymbol;\nexport { BindingSymbol, CustomAttributeSymbol, PlainAttributeSymbol, };\n//# sourceMappingURL=semantic-model.js.map","/* eslint-disable compat/compat */\nimport { BindableInfo, } from '@aurelia/jit';\nimport { camelCase, } from '@aurelia/kernel';\nimport { BindingMode } from '@aurelia/runtime';\nimport { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol, LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol, ReplacePartSymbol, TemplateControllerSymbol, TextSymbol, } from './semantic-model';\nconst invalidSurrogateAttribute = Object.assign(Object.create(null), {\n    'id': true,\n    'replace': true\n});\nconst attributesToIgnore = Object.assign(Object.create(null), {\n    'as-element': true,\n    'replace': true\n});\nfunction hasInlineBindings(rawValue) {\n    const len = rawValue.length;\n    let ch = 0;\n    for (let i = 0; i < len; ++i) {\n        ch = rawValue.charCodeAt(i);\n        if (ch === 92 /* Backslash */) {\n            ++i;\n            // Ignore whatever comes next because it's escaped\n        }\n        else if (ch === 58 /* Colon */) {\n            return true;\n        }\n        else if (ch === 36 /* Dollar */ && rawValue.charCodeAt(i + 1) === 123 /* OpenBrace */) {\n            return false;\n        }\n    }\n    return false;\n}\nfunction processInterpolationText(symbol) {\n    const node = symbol.physicalNode;\n    const parentNode = node.parentNode;\n    while (node.nextSibling !== null && node.nextSibling.nodeType === 3 /* Text */) {\n        parentNode.removeChild(node.nextSibling);\n    }\n    node.textContent = '';\n    parentNode.insertBefore(symbol.marker, node);\n}\nfunction isTemplateControllerOf(proxy, manifest) {\n    return proxy !== manifest;\n}\n/**\n * A (temporary) standalone function that purely does the DOM processing (lifting) related to template controllers.\n * It's a first refactoring step towards separating DOM parsing/binding from mutations.\n */\nfunction processTemplateControllers(dom, manifestProxy, manifest) {\n    const manifestNode = manifest.physicalNode;\n    let current = manifestProxy;\n    let currentTemplate;\n    while (isTemplateControllerOf(current, manifest)) {\n        if (current.template === manifest) {\n            // the DOM linkage is still in its original state here so we can safely assume the parentNode is non-null\n            manifestNode.parentNode.replaceChild(current.marker, manifestNode);\n            // if the manifest is a template element (e.g. <template repeat.for=\"...\">) then we can skip one lift operation\n            // and simply use the template directly, saving a bit of work\n            if (manifestNode.nodeName === 'TEMPLATE') {\n                current.physicalNode = manifestNode;\n                // the template could safely stay without affecting anything visible, but let's keep the DOM tidy\n                manifestNode.remove();\n            }\n            else {\n                // the manifest is not a template element so we need to wrap it in one\n                currentTemplate = current.physicalNode = dom.createTemplate();\n                currentTemplate.content.appendChild(manifestNode);\n            }\n        }\n        else {\n            currentTemplate = current.physicalNode = dom.createTemplate();\n            currentTemplate.content.appendChild(current.marker);\n        }\n        manifestNode.removeAttribute(current.syntax.rawName);\n        current = current.template;\n    }\n}\nfunction processReplacePart(dom, replacePart, manifestProxy) {\n    let proxyNode;\n    let currentTemplate;\n    if ((manifestProxy.flags & 512 /* hasMarker */) > 0) {\n        proxyNode = manifestProxy.marker;\n    }\n    else {\n        proxyNode = manifestProxy.physicalNode;\n    }\n    if (proxyNode.nodeName === 'TEMPLATE') {\n        // if it's a template element, no need to do anything special, just assign it to the replacePart\n        replacePart.physicalNode = proxyNode;\n    }\n    else {\n        // otherwise wrap the replace in a template\n        currentTemplate = replacePart.physicalNode = dom.createTemplate();\n        currentTemplate.content.appendChild(proxyNode);\n    }\n}\n/**\n * TemplateBinder. Todo: describe goal of this class\n */\nexport class TemplateBinder {\n    constructor(dom, resources, attrParser, exprParser, attrSyntaxTransformer) {\n        this.dom = dom;\n        this.resources = resources;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxTransformer = attrSyntaxTransformer;\n    }\n    bind(node) {\n        const surrogate = new PlainElementSymbol(this.dom, node);\n        const resources = this.resources;\n        const attrSyntaxTransformer = this.attrSyntaxTransformer;\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            if (invalidSurrogateAttribute[attrSyntax.target] === true) {\n                throw new Error(`Invalid surrogate attribute: ${attrSyntax.target}`);\n                // TODO: use reporter\n            }\n            const bindingCommand = resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ surrogate);\n                }\n                else if (attrInfo.isTemplateController) {\n                    throw new Error('Cannot have template controller on surrogate element.');\n                    // TODO: use reporter\n                }\n                else {\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ surrogate);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ surrogate);\n            }\n            ++i;\n        }\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ surrogate, \n        /* manifestRoot       */ null, \n        /* parentManifestRoot */ null, \n        /* partName           */ null);\n        return surrogate;\n    }\n    bindManifest(parentManifest, node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        switch (node.nodeName) {\n            case 'LET':\n                // let cannot have children and has some different processing rules, so return early\n                this.bindLetElement(\n                /* parentManifest */ parentManifest, \n                /* node           */ node);\n                return;\n            case 'SLOT':\n                surrogate.hasSlots = true;\n        }\n        // get the part name to override the name of the compiled definition\n        partName = node.getAttribute('replaceable');\n        if (partName === '') {\n            partName = 'default';\n        }\n        let name = node.getAttribute('as-element');\n        if (name === null) {\n            name = node.nodeName.toLowerCase();\n        }\n        const elementInfo = this.resources.getElementInfo(name);\n        if (elementInfo === null) {\n            // there is no registered custom element with this name\n            manifest = new PlainElementSymbol(this.dom, node);\n        }\n        else {\n            // it's a custom element so we set the manifestRoot as well (for storing replaces)\n            parentManifestRoot = manifestRoot;\n            manifestRoot = manifest = new CustomElementSymbol(this.dom, node, elementInfo);\n        }\n        // lifting operations done by template controllers and replaces effectively unlink the nodes, so start at the bottom\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        // the parentManifest will receive either the direct child nodes, or the template controllers / replaces\n        // wrapping them\n        this.bindAttributes(\n        /* node               */ node, \n        /* parentManifest     */ parentManifest, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        if (manifestRoot === manifest && manifest.isContainerless) {\n            node.parentNode.replaceChild(manifest.marker, node);\n        }\n        else if (manifest.isTarget) {\n            node.classList.add('au');\n        }\n    }\n    bindLetElement(parentManifest, node) {\n        const symbol = new LetElementSymbol(this.dom, node);\n        parentManifest.childNodes.push(symbol);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            if (attr.name === 'to-binding-context') {\n                node.removeAttribute('to-binding-context');\n                symbol.toBindingContext = true;\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const command = this.resources.getBindingCommand(attrSyntax, false);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrSyntax.rawValue, bindingType);\n            const to = camelCase(attrSyntax.target);\n            const info = new BindableInfo(to, BindingMode.toView);\n            symbol.bindings.push(new BindingSymbol(command, info, expr, attrSyntax.rawValue, to));\n            ++i;\n        }\n        node.parentNode.replaceChild(symbol.marker, node);\n    }\n    bindAttributes(node, parentManifest, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        // This is the top-level symbol for the current depth.\n        // If there are no template controllers or replaces, it is always the manifest itself.\n        // If there are template controllers, then this will be the outer-most TemplateControllerSymbol.\n        let manifestProxy = manifest;\n        let previousController = (void 0);\n        let currentController = (void 0);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            ++i;\n            if (attributesToIgnore[attr.name] === true) {\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const bindingCommand = this.resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = this.resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    this.attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ manifest);\n                }\n                else if (attrInfo.isTemplateController) {\n                    // the manifest is wrapped by the inner-most template controller (if there are multiple on the same element)\n                    // so keep setting manifest.templateController to the latest template controller we find\n                    currentController = manifest.templateController = this.declareTemplateController(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* partName   */ partName);\n                    // the proxy and the manifest are only identical when we're at the first template controller (since the controller\n                    // is assigned to the proxy), so this evaluates to true at most once per node\n                    if (manifestProxy === manifest) {\n                        currentController.template = manifest;\n                        manifestProxy = currentController;\n                    }\n                    else {\n                        currentController.templateController = previousController;\n                        currentController.template = previousController.template;\n                        previousController.template = currentController;\n                    }\n                    previousController = currentController;\n                }\n                else {\n                    // a regular custom attribute\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ manifest);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                this.attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ manifest);\n            }\n        }\n        if (node.tagName === 'INPUT') {\n            const type = node.type;\n            if (type === 'checkbox' || type === 'radio') {\n                this.ensureAttributeOrder(manifest);\n            }\n        }\n        processTemplateControllers(this.dom, manifestProxy, manifest);\n        let replace = node.getAttribute('replace');\n        if (replace === '' || replace === null && manifestRoot !== null && manifestRoot.isContainerless) {\n            replace = 'default';\n        }\n        const partOwner = manifest === manifestRoot ? parentManifestRoot : manifestRoot;\n        if (replace === null || partOwner === null) {\n            // the proxy is either the manifest itself or the outer-most controller; add it directly to the parent\n            parentManifest.childNodes.push(manifestProxy);\n        }\n        else {\n            // there is a replace attribute on this node, so add it to the parts collection of the manifestRoot\n            // instead of to the childNodes\n            const replacePart = new ReplacePartSymbol(replace);\n            replacePart.parent = parentManifest;\n            replacePart.template = manifestProxy;\n            partOwner.parts.push(replacePart);\n            if (parentManifest.templateController != null) {\n                parentManifest.templateController.parts.push(replacePart);\n            }\n            processReplacePart(this.dom, replacePart, manifestProxy);\n        }\n    }\n    // TODO: refactor to use render priority slots (this logic shouldn't be in the template binder)\n    ensureAttributeOrder(manifest) {\n        // swap the order of checked and model/value attribute, so that the required observers are prepared for checked-observer\n        const attributes = manifest.plainAttributes;\n        let modelOrValueIndex = void 0;\n        let checkedIndex = void 0;\n        let found = 0;\n        for (let i = 0; i < attributes.length && found < 3; i++) {\n            switch (attributes[i].syntax.target) {\n                case 'model':\n                case 'value':\n                case 'matcher':\n                    modelOrValueIndex = i;\n                    found++;\n                    break;\n                case 'checked':\n                    checkedIndex = i;\n                    found++;\n                    break;\n            }\n        }\n        if (checkedIndex !== void 0 && modelOrValueIndex !== void 0 && checkedIndex < modelOrValueIndex) {\n            [attributes[modelOrValueIndex], attributes[checkedIndex]] = [attributes[checkedIndex], attributes[modelOrValueIndex]];\n        }\n    }\n    bindChildNodes(node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        let childNode;\n        if (node.nodeName === 'TEMPLATE') {\n            childNode = node.content.firstChild;\n        }\n        else {\n            childNode = node.firstChild;\n        }\n        let nextChild;\n        while (childNode !== null) {\n            switch (childNode.nodeType) {\n                case 1 /* Element */:\n                    nextChild = childNode.nextSibling;\n                    this.bindManifest(\n                    /* parentManifest     */ manifest, \n                    /* node               */ childNode, \n                    /* surrogate          */ surrogate, \n                    /* manifest           */ manifest, \n                    /* manifestRoot       */ manifestRoot, \n                    /* parentManifestRoot */ parentManifestRoot, \n                    /* partName           */ partName);\n                    childNode = nextChild;\n                    break;\n                case 3 /* Text */:\n                    childNode = this.bindText(\n                    /* textNode */ childNode, \n                    /* manifest */ manifest).nextSibling;\n                    break;\n                case 4 /* CDATASection */:\n                case 7 /* ProcessingInstruction */:\n                case 8 /* Comment */:\n                case 10 /* DocumentType */:\n                    childNode = childNode.nextSibling;\n                    break;\n                case 9 /* Document */:\n                case 11 /* DocumentFragment */:\n                    childNode = childNode.firstChild;\n            }\n        }\n    }\n    bindText(textNode, manifest) {\n        const interpolation = this.exprParser.parse(textNode.wholeText, 2048 /* Interpolation */);\n        if (interpolation !== null) {\n            const symbol = new TextSymbol(this.dom, textNode, interpolation);\n            manifest.childNodes.push(symbol);\n            processInterpolationText(symbol);\n        }\n        let next = textNode;\n        while (next.nextSibling !== null && next.nextSibling.nodeType === 3 /* Text */) {\n            next = next.nextSibling;\n        }\n        return next;\n    }\n    declareTemplateController(attrSyntax, attrInfo, partName) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        // multi-bindings logic here is similar to (and explained in) bindCustomAttribute\n        const isMultiBindings = command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        return symbol;\n    }\n    bindCustomAttribute(attrSyntax, attrInfo, command, manifest) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax. Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        const isMultiBindings = command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            // a multiple-bindings attribute usage (semicolon separated binding) is only valid without a binding command;\n            // the binding commands must be declared in each of the property bindings\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        manifest.customAttributes.push(symbol);\n        manifest.isTarget = true;\n    }\n    bindMultiAttribute(symbol, attrInfo, value) {\n        const bindables = attrInfo.bindables;\n        const valueLength = value.length;\n        let attrName = void 0;\n        let attrValue = void 0;\n        let start = 0;\n        let ch = 0;\n        for (let i = 0; i < valueLength; ++i) {\n            ch = value.charCodeAt(i);\n            if (ch === 92 /* Backslash */) {\n                ++i;\n                // Ignore whatever comes next because it's escaped\n            }\n            else if (ch === 58 /* Colon */) {\n                attrName = value.slice(start, i);\n                // Skip whitespace after colon\n                while (value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                for (; i < valueLength; ++i) {\n                    ch = value.charCodeAt(i);\n                    if (ch === 92 /* Backslash */) {\n                        ++i;\n                        // Ignore whatever comes next because it's escaped\n                    }\n                    else if (ch === 59 /* Semicolon */) {\n                        attrValue = value.slice(start, i);\n                        break;\n                    }\n                }\n                if (attrValue === void 0) {\n                    // No semicolon found, so just grab the rest of the value\n                    attrValue = value.slice(start);\n                }\n                const attrSyntax = this.attrParser.parse(attrName, attrValue);\n                const attrTarget = camelCase(attrSyntax.target);\n                const command = this.resources.getBindingCommand(attrSyntax, false);\n                const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n                const expr = this.exprParser.parse(attrValue, bindingType);\n                let bindable = bindables[attrTarget];\n                if (bindable === undefined) {\n                    // everything in a multi-bindings expression must be used,\n                    // so if it's not a bindable then we create one on the spot\n                    bindable = bindables[attrTarget] = new BindableInfo(attrTarget, BindingMode.toView);\n                }\n                symbol.bindings.push(new BindingSymbol(command, bindable, expr, attrValue, attrTarget));\n                // Skip whitespace after semicolon\n                while (i < valueLength && value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                attrName = void 0;\n                attrValue = void 0;\n            }\n        }\n    }\n    bindPlainAttribute(attrSyntax, attr, surrogate, manifest) {\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n        const attrTarget = attrSyntax.target;\n        const attrRawValue = attrSyntax.rawValue;\n        let expr;\n        if (attrRawValue.length === 0\n            && (bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n            if ((bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n                // Default to the name of the attr for empty binding commands\n                expr = this.exprParser.parse(camelCase(attrTarget), bindingType);\n            }\n            else {\n                return;\n            }\n        }\n        else {\n            expr = this.exprParser.parse(attrRawValue, bindingType);\n        }\n        if ((manifest.flags & 16 /* isCustomElement */) > 0) {\n            const bindable = manifest.bindables[attrTarget];\n            if (bindable != null) {\n                // if the attribute name matches a bindable property name, add it regardless of whether it's a command, interpolation, or just a plain string;\n                // the template compiler will translate it to the correct instruction\n                manifest.bindings.push(new BindingSymbol(command, bindable, expr, attrRawValue, attrTarget));\n                manifest.isTarget = true;\n            }\n            else if (expr != null) {\n                // if it does not map to a bindable, only add it if we were able to parse an expression (either a command or interpolation)\n                manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n                manifest.isTarget = true;\n            }\n        }\n        else if (expr != null) {\n            // either a binding command, an interpolation, or a ref\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n            manifest.isTarget = true;\n        }\n        else if (manifest === surrogate) {\n            // any attributes, even if they are plain (no command/interpolation etc), should be added if they\n            // are on the surrogate element\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n        }\n        if (command == null && expr != null) {\n            // if it's an interpolation, clear the attribute value\n            attr.value = '';\n        }\n    }\n}\n//# sourceMappingURL=template-binder.js.map","import { __decorate, __param } from \"tslib\";\nimport { DI, Registration } from '@aurelia/kernel';\nimport { IDOM } from '@aurelia/runtime';\n// For some reason rollup complains about `DI.createInterface<ITemplateElementFactory>().noDefault()` with this message:\n// \"semantic error TS2742 The inferred type of 'ITemplateElementFactory' cannot be named without a reference to '@aurelia/jit/node_modules/@aurelia/kernel'. This is likely not portable. A type annotation is necessary\"\n// So.. investigate why that happens (or rather, why it *only* happens here and not for the other 50)\nexport const ITemplateElementFactory = DI.createInterface('ITemplateElementFactory').noDefault();\nconst markupCache = {};\n/**\n * Default implementation for `ITemplateFactory` for use in an HTML based runtime.\n *\n * @internal\n */\nlet HTMLTemplateElementFactory = class HTMLTemplateElementFactory {\n    constructor(dom) {\n        this.dom = dom;\n        this.template = dom.createTemplate();\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateElementFactory, this).register(container);\n    }\n    createTemplate(input) {\n        if (typeof input === 'string') {\n            let result = markupCache[input];\n            if (result === void 0) {\n                const template = this.template;\n                template.innerHTML = input;\n                const node = template.content.firstElementChild;\n                // if the input is either not wrapped in a template or there is more than one node,\n                // return the whole template that wraps it/them (and create a new one for the next input)\n                if (node == null || node.nodeName !== 'TEMPLATE' || node.nextElementSibling != null) {\n                    this.template = this.dom.createTemplate();\n                    result = template;\n                }\n                else {\n                    // the node to return is both a template and the only node, so return just the node\n                    // and clean up the template for the next input\n                    template.content.removeChild(node);\n                    result = node;\n                }\n                markupCache[input] = result;\n            }\n            return result.cloneNode(true);\n        }\n        if (input.nodeName !== 'TEMPLATE') {\n            // if we get one node that is not a template, wrap it in one\n            const template = this.dom.createTemplate();\n            template.content.appendChild(input);\n            return template;\n        }\n        // we got a template element, remove it from the DOM if it's present there and don't\n        // do any other processing\n        if (input.parentNode != null) {\n            input.parentNode.removeChild(input);\n        }\n        return input;\n    }\n};\nHTMLTemplateElementFactory = __decorate([\n    __param(0, IDOM)\n], HTMLTemplateElementFactory);\nexport { HTMLTemplateElementFactory };\n//# sourceMappingURL=template-element-factory.js.map","import { __decorate, __param } from \"tslib\";\nimport { IAttributeParser, ResourceModel, } from '@aurelia/jit';\nimport { mergeDistinct, PLATFORM, Registration, mergeArrays, } from '@aurelia/kernel';\nimport { HydrateAttributeInstruction, HydrateElementInstruction, HydrateTemplateController, IExpressionParser, InterpolationInstruction, ITemplateCompiler, LetBindingInstruction, LetElementInstruction, SetPropertyInstruction, CustomElementDefinition } from '@aurelia/runtime';\nimport { SetAttributeInstruction, TextBindingInstruction, SetClassAttributeInstruction, SetStyleAttributeInstruction, } from '@aurelia/runtime-html';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nimport { TemplateBinder } from './template-binder';\nimport { ITemplateElementFactory } from './template-element-factory';\nclass CustomElementCompilationUnit {\n    constructor(partialDefinition, surrogate, template) {\n        this.partialDefinition = partialDefinition;\n        this.surrogate = surrogate;\n        this.template = template;\n        this.instructions = [];\n        this.surrogates = [];\n        this.scopeParts = [];\n        this.parts = {};\n    }\n    toDefinition() {\n        const def = this.partialDefinition;\n        return CustomElementDefinition.create({\n            ...def,\n            instructions: mergeArrays(def.instructions, this.instructions),\n            surrogates: mergeArrays(def.surrogates, this.surrogates),\n            scopeParts: mergeArrays(def.scopeParts, this.scopeParts),\n            template: this.template,\n            needsCompile: false,\n            hasSlots: this.surrogate.hasSlots,\n        });\n    }\n}\n/**\n * Default (runtime-agnostic) implementation for `ITemplateCompiler`.\n *\n * @internal\n */\nlet TemplateCompiler = class TemplateCompiler {\n    constructor(factory, attrParser, exprParser, attrSyntaxModifier) {\n        this.factory = factory;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxModifier = attrSyntaxModifier;\n    }\n    get name() {\n        return 'default';\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateCompiler, this).register(container);\n    }\n    compile(dom, partialDefinition, descriptions) {\n        const resources = new ResourceModel(descriptions);\n        const { attrParser, exprParser, attrSyntaxModifier, factory } = this;\n        const binder = new TemplateBinder(dom, resources, attrParser, exprParser, attrSyntaxModifier);\n        const template = factory.createTemplate(partialDefinition.template);\n        const surrogate = binder.bind(template);\n        const compilation = this.compilation = new CustomElementCompilationUnit(partialDefinition, surrogate, template);\n        const customAttributes = surrogate.customAttributes;\n        const plainAttributes = surrogate.plainAttributes;\n        const customAttributeLength = customAttributes.length;\n        const plainAttributeLength = plainAttributes.length;\n        if (customAttributeLength + plainAttributeLength > 0) {\n            let offset = 0;\n            for (let i = 0; customAttributeLength > i; ++i) {\n                compilation.surrogates[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; i < plainAttributeLength; ++i) {\n                compilation.surrogates[offset] = this.compilePlainAttribute(plainAttributes[i], true);\n                offset++;\n            }\n        }\n        this.compileChildNodes(surrogate, compilation.instructions, compilation.scopeParts);\n        const definition = compilation.toDefinition();\n        this.compilation = null;\n        return definition;\n    }\n    compileChildNodes(parent, instructionRows, scopeParts) {\n        if ((parent.flags & 8192 /* hasChildNodes */) > 0) {\n            const { childNodes } = parent;\n            let childNode;\n            const ii = childNodes.length;\n            for (let i = 0; i < ii; ++i) {\n                childNode = childNodes[i];\n                if ((childNode.flags & 128 /* isText */) > 0) {\n                    instructionRows.push([new TextBindingInstruction(childNode.interpolation)]);\n                }\n                else if ((childNode.flags & 32 /* isLetElement */) > 0) {\n                    const bindings = childNode.bindings;\n                    const instructions = [];\n                    let binding;\n                    const jj = bindings.length;\n                    for (let j = 0; j < jj; ++j) {\n                        binding = bindings[j];\n                        instructions[j] = new LetBindingInstruction(binding.expression, binding.target);\n                    }\n                    instructionRows.push([new LetElementInstruction(instructions, childNode.toBindingContext)]);\n                }\n                else {\n                    this.compileParentNode(childNode, instructionRows, scopeParts);\n                }\n            }\n        }\n    }\n    compileCustomElement(symbol, instructionRows, scopeParts) {\n        // offset 1 to leave a spot for the hydrate instruction so we don't need to create 2 arrays with a spread etc\n        const instructionRow = this.compileAttributes(symbol, 1);\n        instructionRow[0] = new HydrateElementInstruction(symbol.res, this.compileBindings(symbol), this.compileParts(symbol, scopeParts));\n        instructionRows.push(instructionRow);\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compilePlainElement(symbol, instructionRows, scopeParts) {\n        const attributes = this.compileAttributes(symbol, 0);\n        if (attributes.length > 0) {\n            instructionRows.push(attributes);\n        }\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compileParentNode(symbol, instructionRows, scopeParts) {\n        switch (symbol.flags & 511 /* type */) {\n            case 16 /* isCustomElement */:\n                this.compileCustomElement(symbol, instructionRows, scopeParts);\n                break;\n            case 64 /* isPlainElement */:\n                this.compilePlainElement(symbol, instructionRows, scopeParts);\n                break;\n            case 1 /* isTemplateController */:\n                this.compileTemplateController(symbol, instructionRows, scopeParts);\n        }\n    }\n    compileTemplateController(symbol, instructionRows, scopeParts) {\n        const bindings = this.compileBindings(symbol);\n        const controllerInstructionRows = [];\n        const controllerScopeParts = [];\n        this.compileParentNode(symbol.template, controllerInstructionRows, controllerScopeParts);\n        mergeDistinct(scopeParts, controllerScopeParts, false);\n        const def = CustomElementDefinition.create({\n            name: symbol.partName === null ? symbol.res : symbol.partName,\n            scopeParts: controllerScopeParts,\n            template: symbol.physicalNode,\n            instructions: controllerInstructionRows,\n            needsCompile: false,\n        });\n        let parts = void 0;\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            parts = {};\n            for (const part of symbol.parts) {\n                parts[part.name] = this.compilation.parts[part.name];\n            }\n        }\n        instructionRows.push([new HydrateTemplateController(def, symbol.res, bindings, symbol.res === 'else', parts)]);\n    }\n    compileBindings(symbol) {\n        let bindingInstructions;\n        if ((symbol.flags & 4096 /* hasBindings */) > 0) {\n            // either a custom element with bindings, a custom attribute / template controller with dynamic options,\n            // or a single value custom attribute binding\n            const { bindings } = symbol;\n            const len = bindings.length;\n            bindingInstructions = Array(len);\n            let i = 0;\n            for (; i < len; ++i) {\n                bindingInstructions[i] = this.compileBinding(bindings[i]);\n            }\n        }\n        else {\n            bindingInstructions = PLATFORM.emptyArray;\n        }\n        return bindingInstructions;\n    }\n    compileBinding(symbol) {\n        if (symbol.command === null) {\n            // either an interpolation or a normal string value assigned to an element or attribute binding\n            if (symbol.expression === null) {\n                // the template binder already filtered out non-bindables, so we know we need a setProperty here\n                return new SetPropertyInstruction(symbol.rawValue, symbol.bindable.propName);\n            }\n            else {\n                // either an element binding interpolation or a dynamic options attribute binding interpolation\n                return new InterpolationInstruction(symbol.expression, symbol.bindable.propName);\n            }\n        }\n        else {\n            // either an element binding command, dynamic options attribute binding command,\n            // or custom attribute / template controller (single value) binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    compileAttributes(symbol, offset) {\n        let attributeInstructions;\n        if ((symbol.flags & 2048 /* hasAttributes */) > 0) {\n            // any attributes on a custom element (which are not bindables) or a plain element\n            const customAttributes = symbol.customAttributes;\n            const plainAttributes = symbol.plainAttributes;\n            const customAttributeLength = customAttributes.length;\n            const plainAttributesLength = plainAttributes.length;\n            attributeInstructions = Array(offset + customAttributeLength + plainAttributesLength);\n            for (let i = 0; customAttributeLength > i; ++i) {\n                attributeInstructions[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; plainAttributesLength > i; ++i) {\n                attributeInstructions[offset] = this.compilePlainAttribute(plainAttributes[i], false);\n                offset++;\n            }\n        }\n        else if (offset > 0) {\n            attributeInstructions = Array(offset);\n        }\n        else {\n            attributeInstructions = PLATFORM.emptyArray;\n        }\n        return attributeInstructions;\n    }\n    compileCustomAttribute(symbol) {\n        // a normal custom attribute (not template controller)\n        const bindings = this.compileBindings(symbol);\n        return new HydrateAttributeInstruction(symbol.res, bindings);\n    }\n    compilePlainAttribute(symbol, isOnSurrogate) {\n        if (symbol.command === null) {\n            const syntax = symbol.syntax;\n            if (symbol.expression === null) {\n                const attrRawValue = syntax.rawValue;\n                if (isOnSurrogate) {\n                    switch (syntax.target) {\n                        case 'class':\n                            return new SetClassAttributeInstruction(attrRawValue);\n                        case 'style':\n                            return new SetStyleAttributeInstruction(attrRawValue);\n                        // todo:  define how to merge other attribute peacefully\n                        //        this is an existing feature request\n                    }\n                }\n                // a plain attribute on a surrogate\n                return new SetAttributeInstruction(attrRawValue, syntax.target);\n            }\n            else {\n                // a plain attribute with an interpolation\n                return new InterpolationInstruction(symbol.expression, syntax.target);\n            }\n        }\n        else {\n            // a plain attribute with a binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    // private compileAttribute(symbol: IAttributeSymbol): HTMLAttributeInstruction {\n    //   // any attribute on a custom element (which is not a bindable) or a plain element\n    //   if (symbol.flags & SymbolFlags.isCustomAttribute) {\n    //     return this.compileCustomAttribute(symbol as CustomAttributeSymbol);\n    //   } else {\n    //     return this.compilePlainAttribute(symbol as PlainAttributeSymbol);\n    //   }\n    // }\n    compileParts(symbol, scopeParts) {\n        const parts = {};\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            const replaceParts = symbol.parts;\n            const len = replaceParts.length;\n            let s = scopeParts.length;\n            for (let i = 0; i < len; ++i) {\n                const replacePart = replaceParts[i];\n                if (!scopeParts.includes(replacePart.name)) {\n                    scopeParts[s++] = replacePart.name;\n                }\n                const partScopeParts = [];\n                const partInstructionRows = [];\n                this.compileParentNode(replacePart.template, partInstructionRows, partScopeParts);\n                // TODO: the assignment to `this.compilation.parts[replacePart.name]` might be the cause of replaceable bug reported by rluba\n                // need to verify this\n                this.compilation.parts[replacePart.name] = parts[replacePart.name] = CustomElementDefinition.create({\n                    name: replacePart.name,\n                    scopeParts: partScopeParts,\n                    template: replacePart.physicalNode,\n                    instructions: partInstructionRows,\n                    needsCompile: false,\n                });\n            }\n        }\n        return parts;\n    }\n};\nTemplateCompiler = __decorate([\n    __param(0, ITemplateElementFactory),\n    __param(1, IAttributeParser),\n    __param(2, IExpressionParser),\n    __param(3, IAttrSyntaxTransformer)\n], TemplateCompiler);\nexport { TemplateCompiler };\n//# sourceMappingURL=template-compiler.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DI } from '@aurelia/kernel';\nimport { RuntimeHtmlConfiguration } from '@aurelia/runtime-html';\nimport { AttrAttributePattern, ClassAttributePattern, StyleAttributePattern } from './attribute-patterns';\nimport { AttrBindingCommand, CaptureBindingCommand, ClassBindingCommand, DelegateBindingCommand, RefBindingCommand, StyleBindingCommand, TriggerBindingCommand } from './binding-commands';\nimport { HtmlAttrSyntaxTransformer } from './html-attribute-syntax-transformer';\nimport { TemplateCompiler } from './template-compiler';\nimport { HTMLTemplateElementFactory } from './template-element-factory';\nexport const ITemplateCompilerRegistration = TemplateCompiler;\nexport const ITemplateElementFactoryRegistration = HTMLTemplateElementFactory;\nexport const IAttrSyntaxTransformerRegistation = HtmlAttrSyntaxTransformer;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `ITemplateCompiler`\n * - `ITemplateElementFactory`\n */\nexport const DefaultComponents = [\n    ITemplateCompilerRegistration,\n    ITemplateElementFactoryRegistration,\n    IAttrSyntaxTransformerRegistation\n];\n/**\n * Default HTML-specific (but environment-agnostic) implementations for style binding\n */\nexport const JitAttrBindingSyntax = [\n    StyleAttributePattern,\n    ClassAttributePattern,\n    AttrAttributePattern\n];\nexport const RefBindingCommandRegistration = RefBindingCommand;\nexport const TriggerBindingCommandRegistration = TriggerBindingCommand;\nexport const DelegateBindingCommandRegistration = DelegateBindingCommand;\nexport const CaptureBindingCommandRegistration = CaptureBindingCommand;\nexport const AttrBindingCommandRegistration = AttrBindingCommand;\nexport const ClassBindingCommandRegistration = ClassBindingCommand;\nexport const StyleBindingCommandRegistration = StyleBindingCommand;\n/**\n * Default HTML-specific (but environment-agnostic) binding commands:\n * - Event listeners: `.trigger`, `.delegate`, `.capture`\n */\nexport const DefaultBindingLanguage = [\n    RefBindingCommandRegistration,\n    TriggerBindingCommandRegistration,\n    DelegateBindingCommandRegistration,\n    CaptureBindingCommandRegistration,\n    ClassBindingCommandRegistration,\n    StyleBindingCommandRegistration,\n    AttrBindingCommandRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents`\n * - `DefaultBindingLanguage`\n */\nexport const JitHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...JitDefaultComponents, ...JitDefaultBindingSyntax, ...JitAttrBindingSyntax, ...JitDefaultBindingLanguage, ...DefaultComponents, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { Registration } from '@aurelia/kernel';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nexport class HtmlAttrSyntaxTransformer {\n    static register(container) {\n        return Registration.singleton(IAttrSyntaxTransformer, this).register(container);\n    }\n    transform(node, attrSyntax) {\n        if (attrSyntax.command === 'bind' && shouldDefaultToTwoWay(node, attrSyntax)) {\n            attrSyntax.command = 'two-way';\n        }\n        attrSyntax.target = this.map(node.tagName, attrSyntax.target);\n    }\n    map(tagName, attr) {\n        switch (tagName) {\n            case 'LABEL':\n                switch (attr) {\n                    case 'for':\n                        return 'htmlFor';\n                    default:\n                        return attr;\n                }\n            case 'IMG':\n                switch (attr) {\n                    case 'usemap':\n                        return 'useMap';\n                    default:\n                        return attr;\n                }\n            case 'INPUT':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    case 'minlength':\n                        return 'minLength';\n                    case 'formaction':\n                        return 'formAction';\n                    case 'formenctype':\n                        return 'formEncType';\n                    case 'formmethod':\n                        return 'formMethod';\n                    case 'formnovalidate':\n                        return 'formNoValidate';\n                    case 'formtarget':\n                        return 'formTarget';\n                    case 'inputmode':\n                        return 'inputMode';\n                    default:\n                        return attr;\n                }\n            case 'TEXTAREA':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    default:\n                        return attr;\n                }\n            case 'TD':\n            case 'TH':\n                switch (attr) {\n                    case 'rowspan':\n                        return 'rowSpan';\n                    case 'colspan':\n                        return 'colSpan';\n                    default:\n                        return attr;\n                }\n            default:\n                switch (attr) {\n                    case 'accesskey':\n                        return 'accessKey';\n                    case 'contenteditable':\n                        return 'contentEditable';\n                    case 'tabindex':\n                        return 'tabIndex';\n                    case 'textcontent':\n                        return 'textContent';\n                    case 'innerhtml':\n                        return 'innerHTML';\n                    case 'scrolltop':\n                        return 'scrollTop';\n                    case 'scrollleft':\n                        return 'scrollLeft';\n                    case 'readonly':\n                        return 'readOnly';\n                    default:\n                        return attr;\n                }\n        }\n    }\n}\nfunction shouldDefaultToTwoWay(element, attr) {\n    switch (element.tagName) {\n        case 'INPUT':\n            switch (element.type) {\n                case 'checkbox':\n                case 'radio':\n                    return attr.target === 'checked';\n                default:\n                    return attr.target === 'value' || attr.target === 'files';\n            }\n        case 'TEXTAREA':\n        case 'SELECT':\n            return attr.target === 'value';\n        default:\n            switch (attr.target) {\n                case 'textcontent':\n                case 'innerhtml':\n                    return element.hasAttribute('contenteditable');\n                case 'scrolltop':\n                case 'scrollleft':\n                    return true;\n                default:\n                    return false;\n            }\n    }\n}\n//# sourceMappingURL=html-attribute-syntax-transformer.js.map","import { __decorate, __param } from \"tslib\";\n/* eslint-disable no-await-in-loop */\nimport { bound } from '@aurelia/kernel';\nimport { IDOM, IScheduler, TaskQueue, IClock, DOM } from '@aurelia/runtime';\n// Note on the flush requestors: we're probably overdoing it here with the binds and all the wrapping.\n// Just want to start off with something as robust as possible, add many tests first so that we're sure it all works, etc.\n// Once all the proper tests are in place, we can then start simplifying and rely on those tests to tell us precisely which things are necessary and which aren't.\n// Besides looking at test results, we also need to look at benchmark results, memory usage, memory leaks, etc.\nfunction createQueueMicrotaskFlushRequestor(window, flush) {\n    return (function ($window, $flush) {\n        const callFlush = function () {\n            $flush();\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n        return function () {\n            $window.queueMicrotask(callFlush);\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n    })(window, flush);\n}\nfunction createPromiseFlushRequestor(flush) {\n    return (function ($flush) {\n        const callFlush = function () {\n            $flush();\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n        // eslint-disable-next-line compat/compat\n        const p = Promise.resolve();\n        return function () {\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            p.then(callFlush);\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n    })(flush);\n}\nfunction createMutationObserverFlushRequestor(window, flush) {\n    return (function ($window, $flush) {\n        const callFlush = function () {\n            $flush();\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n        const observer = new $window.MutationObserver(callFlush);\n        const node = $window.document.createTextNode('a');\n        // eslint-disable-next-line compat/compat\n        const flip = Object.assign(Object.create(null), { a: 'b', b: 'a' });\n        let val = 'a';\n        observer.observe(node, { characterData: true });\n        return function () {\n            node.data = val = flip[val];\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n    })(window, flush);\n}\n// Create a microtask queue, trying the available options starting with the most performant\nconst createMicrotaskFlushRequestor = (function () {\n    // Ensure we only ever create one requestor (at least, per loaded bundle..).\n    let called = false;\n    return function (wnd, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global MicrotaskFlushRequestor');\n        }\n        called = true;\n        if (wnd.queueMicrotask !== void 0 && wnd.queueMicrotask.toString().includes('[native code]')) {\n            return createQueueMicrotaskFlushRequestor(wnd, flush);\n        }\n        else if (Promise.toString().includes('[native code]')) {\n            return createPromiseFlushRequestor(flush);\n        }\n        else {\n            return createMutationObserverFlushRequestor(wnd, flush);\n        }\n    };\n})();\nconst createPostMessageFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global PostMessageFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            const handleMessage = function (event) {\n                if (event.data === 'au-message' && event.source === $window) {\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            $window.addEventListener('message', handleMessage);\n            return function () {\n                $window.postMessage('au-message', $window.origin);\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n        })(window, flush);\n    };\n})();\nconst createSetTimeoutFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global SetTimeoutFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            let handle = -1;\n            const callFlush = function () {\n                if (handle > -1) {\n                    handle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = function () {\n                if (handle > -1) {\n                    $window.clearTimeout(handle);\n                    handle = -1;\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const request = function () {\n                if (handle === -1) {\n                    handle = $window.setTimeout(callFlush, 0);\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst createRequestAnimationFrameFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global RequestAnimationFrameFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            let handle = -1;\n            const callFlush = function () {\n                if (handle > -1) {\n                    handle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = function () {\n                if (handle > -1) {\n                    $window.cancelAnimationFrame(handle);\n                    handle = -1;\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const request = function () {\n                if (handle === -1) {\n                    handle = $window.requestAnimationFrame(callFlush);\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst createPostRequestAnimationFrameFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global PostRequestAnimationFrameFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            let rafHandle = -1;\n            let timeoutHandle = -1;\n            const callFlush = function () {\n                if (timeoutHandle > -1) {\n                    timeoutHandle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const queueFlush = function () {\n                if (rafHandle > -1) {\n                    rafHandle = -1;\n                    if (timeoutHandle === -1) {\n                        timeoutHandle = $window.setTimeout(callFlush, 0);\n                    }\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = function () {\n                if (rafHandle > -1) {\n                    $window.cancelAnimationFrame(rafHandle);\n                    rafHandle = -1;\n                }\n                if (timeoutHandle > -1) {\n                    $window.clearTimeout(timeoutHandle);\n                    timeoutHandle = -1;\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const request = function () {\n                if (rafHandle === -1) {\n                    rafHandle = $window.requestAnimationFrame(queueFlush);\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst createRequestIdleCallbackFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global RequestIdleCallbackFlushRequestor');\n        }\n        called = true;\n        const hasNative = window.requestIdleCallback !== void 0 && window.requestIdleCallback.toString().includes('[native code]');\n        return (function ($window, $flush) {\n            let handle = -1;\n            const options = { timeout: 1000 }; // TODO: make this configurable\n            const callFlush = function () {\n                if (handle > -1) {\n                    handle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = hasNative\n                ? function () {\n                    if (handle > -1) {\n                        $window.cancelIdleCallback(handle);\n                        handle = -1;\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0)\n                : function () {\n                    if (handle > -1) {\n                        $window.clearTimeout(handle);\n                        handle = -1;\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0);\n            const request = hasNative\n                ? function () {\n                    if (handle === -1) {\n                        handle = $window.requestIdleCallback(callFlush, options);\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0)\n                : function () {\n                    if (handle === -1) {\n                        // Instead of trying anything fancy with event handler debouncers (we could do that if there was a request for it),\n                        // we just wait 45ms which is approximately the interval in a native idleCallback loop in chrome, to at least make it look\n                        // the same from a timing perspective\n                        handle = $window.setTimeout(callFlush, 45);\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst defaultQueueTaskOptions = {\n    delay: 0,\n    preempt: false,\n    priority: 1 /* render */,\n    reusable: true,\n    persistent: false,\n};\nlet BrowserScheduler = class BrowserScheduler {\n    constructor(clock, dom) {\n        const microTaskTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 0 /* microTask */ });\n        const renderTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 1 /* render */ });\n        const macroTaskTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 2 /* macroTask */ });\n        const postRenderTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 3 /* postRender */ });\n        const idleTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 4 /* idle */ });\n        this.taskQueue = [\n            microTaskTaskQueue,\n            renderTaskQueue,\n            macroTaskTaskQueue,\n            postRenderTaskQueue,\n            idleTaskQueue,\n        ];\n        const wnd = dom.window;\n        this.flush = [\n            createMicrotaskFlushRequestor(wnd, microTaskTaskQueue.flush.bind(microTaskTaskQueue)),\n            createRequestAnimationFrameFlushRequestor(wnd, renderTaskQueue.flush.bind(renderTaskQueue)),\n            createSetTimeoutFlushRequestor(wnd, macroTaskTaskQueue.flush.bind(macroTaskTaskQueue)),\n            createPostRequestAnimationFrameFlushRequestor(wnd, postRenderTaskQueue.flush.bind(postRenderTaskQueue)),\n            createRequestIdleCallbackFlushRequestor(wnd, idleTaskQueue.flush.bind(idleTaskQueue)),\n        ];\n    }\n    static register(container) {\n        container.registerResolver(IScheduler, {\n            resolve() {\n                if (DOM.scheduler === void 0) {\n                    const clock = container.get(IClock);\n                    const dom = container.get(IDOM);\n                    const scheduler = new BrowserScheduler(clock, dom);\n                    Reflect.defineProperty(DOM, 'scheduler', {\n                        value: scheduler,\n                        writable: false,\n                        enumerable: false,\n                        configurable: false,\n                    });\n                }\n                return DOM.scheduler;\n            }\n        });\n    }\n    getTaskQueue(priority) {\n        return this.taskQueue[priority];\n    }\n    yield(priority) {\n        return this.taskQueue[priority].yield();\n    }\n    queueTask(callback, opts) {\n        const { delay, preempt, priority, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        return this.taskQueue[priority].queueTask(callback, { delay, preempt, persistent, reusable });\n    }\n    getMicroTaskQueue() {\n        return this.taskQueue[0 /* microTask */];\n    }\n    getRenderTaskQueue() {\n        return this.taskQueue[1 /* render */];\n    }\n    getMacroTaskQueue() {\n        return this.taskQueue[2 /* macroTask */];\n    }\n    getPostRenderTaskQueue() {\n        return this.taskQueue[3 /* postRender */];\n    }\n    getIdleTaskQueue() {\n        return this.taskQueue[4 /* idle */];\n    }\n    yieldMicroTask() {\n        return this.taskQueue[0 /* microTask */].yield();\n    }\n    yieldRenderTask() {\n        return this.taskQueue[1 /* render */].yield();\n    }\n    yieldMacroTask() {\n        return this.taskQueue[2 /* macroTask */].yield();\n    }\n    yieldPostRenderTask() {\n        return this.taskQueue[3 /* postRender */].yield();\n    }\n    yieldIdleTask() {\n        return this.taskQueue[4 /* idle */].yield();\n    }\n    async yieldAll(repeat = 1) {\n        // Yield sequentially from \"large\" to \"small\" so that any smaller tasks initiated by larger tasks are also still awaited,\n        // as well as guaranteeing a single round of persistent tasks from each queue.\n        // Don't change the order or into parallel, without thoroughly testing the ramifications on persistent and recursively queued tasks.\n        // These aspects are currently relatively poorly tested.\n        while (repeat-- > 0) {\n            await this.yieldIdleTask();\n            await this.yieldPostRenderTask();\n            await this.yieldMacroTask();\n            await this.yieldRenderTask();\n            await this.yieldMicroTask();\n        }\n    }\n    queueMicroTask(callback, opts) {\n        return this.taskQueue[0 /* microTask */].queueTask(callback, opts);\n    }\n    queueRenderTask(callback, opts) {\n        return this.taskQueue[1 /* render */].queueTask(callback, opts);\n    }\n    queueMacroTask(callback, opts) {\n        return this.taskQueue[2 /* macroTask */].queueTask(callback, opts);\n    }\n    queuePostRenderTask(callback, opts) {\n        return this.taskQueue[3 /* postRender */].queueTask(callback, opts);\n    }\n    queueIdleTask(callback, opts) {\n        return this.taskQueue[4 /* idle */].queueTask(callback, opts);\n    }\n    requestFlush(taskQueue) {\n        switch (taskQueue.priority) {\n            case 0 /* microTask */:\n                return this.flush[taskQueue.priority]();\n            case 1 /* render */:\n            case 2 /* macroTask */:\n            case 3 /* postRender */:\n            case 4 /* idle */:\n                return this.flush[taskQueue.priority].request();\n        }\n    }\n    cancelFlush(taskQueue) {\n        switch (taskQueue.priority) {\n            case 0 /* microTask */:\n                return;\n            case 1 /* render */:\n            case 2 /* macroTask */:\n            case 3 /* postRender */:\n            case 4 /* idle */:\n                return this.flush[taskQueue.priority].cancel();\n        }\n    }\n};\n__decorate([\n    bound\n], BrowserScheduler.prototype, \"yieldMicroTask\", null);\n__decorate([\n    bound\n], BrowserScheduler.prototype, \"yieldRenderTask\", null);\n__decorate([\n    bound\n], BrowserScheduler.prototype, \"yieldMacroTask\", null);\n__decorate([\n    bound\n], BrowserScheduler.prototype, \"yieldPostRenderTask\", null);\n__decorate([\n    bound\n], BrowserScheduler.prototype, \"yieldIdleTask\", null);\n__decorate([\n    bound\n], BrowserScheduler.prototype, \"yieldAll\", null);\nBrowserScheduler = __decorate([\n    __param(0, IClock),\n    __param(1, IDOM)\n], BrowserScheduler);\nexport { BrowserScheduler };\n//# sourceMappingURL=browser-scheduler.js.map","import { __decorate, __param } from \"tslib\";\nimport { DI, IContainer, Registration } from '@aurelia/kernel';\nimport { IDOM, IDOMInitializer, IScheduler, DOM } from '@aurelia/runtime';\nimport { RuntimeHtmlConfiguration, HTMLDOM } from '@aurelia/runtime-html';\nimport { BrowserScheduler } from './browser-scheduler';\nlet BrowserDOMInitializer = class BrowserDOMInitializer {\n    constructor(container) {\n        this.container = container;\n    }\n    static register(container) {\n        return Registration.singleton(IDOMInitializer, this).register(container);\n    }\n    initialize(config) {\n        if (this.container.has(IDOM, false)) {\n            return this.container.get(IDOM);\n        }\n        let dom;\n        if (config !== undefined) {\n            if (config.dom !== undefined) {\n                dom = config.dom;\n            }\n            else if (config.host.ownerDocument !== null) {\n                dom = new HTMLDOM(window, config.host.ownerDocument, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n            else {\n                dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n        }\n        else {\n            dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n        }\n        Registration.instance(IDOM, dom).register(this.container);\n        if (DOM.scheduler === void 0) {\n            this.container.register(BrowserScheduler);\n        }\n        else {\n            Registration.instance(IScheduler, DOM.scheduler).register(this.container);\n        }\n        return dom;\n    }\n};\nBrowserDOMInitializer = __decorate([\n    __param(0, IContainer)\n], BrowserDOMInitializer);\nexport const IDOMInitializerRegistration = BrowserDOMInitializer;\nexport const IBrowserSchedulerRegistration = BrowserScheduler;\n/**\n * Default HTML-specific, browser-specific implementations for the following interfaces:\n * - `IDOMInitializer`\n */\nexport const DefaultComponents = [\n    IDOMInitializerRegistration,\n    IBrowserSchedulerRegistration,\n];\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents`\n */\nexport const RuntimeHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...DefaultComponents);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport { BrowserDOMInitializer, BrowserScheduler, };\n//# sourceMappingURL=index.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DefaultBindingLanguage as JitHtmlDefaultBindingLanguage, DefaultComponents as JitHtmlDefaultComponents } from '@aurelia/jit-html';\nimport { DI, Profiler } from '@aurelia/kernel';\nimport { RuntimeHtmlBrowserConfiguration } from '@aurelia/runtime-html-browser';\nconst { enter, leave } = Profiler.createTimer('JitHtmlBrowserConfiguration');\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlBrowserConfiguration` from `@aurelia/runtime-html-browser`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents` from `@aurelia/jit-html`\n * - `DefaultBindingLanguage` from `@aurelia/jit-html`\n */\nexport const JitHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        RuntimeHtmlBrowserConfiguration\n            .register(container)\n            .register(...JitDefaultBindingLanguage, ...JitDefaultBindingSyntax, ...JitDefaultComponents, ...JitHtmlDefaultBindingLanguage, ...JitHtmlDefaultComponents);\n        return container;\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        const container = this.register(DI.createContainer());\n        return container;\n    }\n};\n//# sourceMappingURL=index.js.map","import { __decorate } from \"tslib\";\nimport { bound } from '@aurelia/kernel';\n/**\n * A first-in-first-out queue that only processes the next queued item\n * when the current one has been resolved or rejected. Sends queued items\n * one at a time to a specified callback function. The callback function\n * should resolve or reject the queued item when processing is done.\n * Enqueued items can be awaited. Enqueued items can specify an (arbitrary)\n * execution cost and the queue can be set up (activated) to only process\n * a specific amount of execution cost per RAF/tick.\n */\nexport class Queue {\n    constructor(callback) {\n        this.callback = callback;\n        this.pending = [];\n        this.processing = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.currentExecutionCostInCurrentTick = 0;\n        this.scheduler = null;\n        this.task = null;\n    }\n    get isActive() {\n        return this.task !== null;\n    }\n    get length() {\n        return this.pending.length;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Queue has already been activated');\n        }\n        this.scheduler = options.scheduler;\n        this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n        this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Queue has not been activated');\n        }\n        this.task.cancel();\n        this.task = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.clear();\n    }\n    enqueue(itemOrItems, costOrCosts) {\n        const list = Array.isArray(itemOrItems);\n        const items = list ? itemOrItems : [itemOrItems];\n        const costs = items\n            .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n            .map(value => value !== undefined ? value : 1);\n        const promises = [];\n        for (const item of items) {\n            const qItem = { ...item };\n            qItem.cost = costs.shift();\n            promises.push(new Promise((resolve, reject) => {\n                qItem.resolve = () => {\n                    resolve();\n                    this.processing = null;\n                    this.dequeue();\n                };\n                qItem.reject = (reason) => {\n                    reject(reason);\n                    this.processing = null;\n                    this.dequeue();\n                };\n            }));\n            this.pending.push(qItem);\n        }\n        this.dequeue();\n        return list ? promises : promises[0];\n    }\n    dequeue(delta) {\n        if (this.processing !== null) {\n            return;\n        }\n        if (delta !== undefined) {\n            this.currentExecutionCostInCurrentTick = 0;\n        }\n        if (!this.pending.length) {\n            return;\n        }\n        if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n            return;\n        }\n        this.processing = this.pending.shift() || null;\n        if (this.processing) {\n            this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n            this.callback(this.processing);\n        }\n    }\n    clear() {\n        this.pending.splice(0, this.pending.length);\n    }\n}\n__decorate([\n    bound\n], Queue.prototype, \"dequeue\", null);\n//# sourceMappingURL=queue.js.map","import { __decorate, __param } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { IDOM, IScheduler } from '@aurelia/runtime';\nimport { Queue } from './queue';\nlet BrowserNavigator = class BrowserNavigator {\n    constructor(scheduler, dom) {\n        this.scheduler = scheduler;\n        this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n        this.isActive = false;\n        this.options = {\n            useUrlFragmentHash: true,\n            callback: () => { },\n        };\n        this.forwardedState = {};\n        this.handlePopstate = (ev) => {\n            return this.enqueue(this, 'popstate', [ev]);\n        };\n        this.processCalls = (qCall) => {\n            const call = qCall;\n            if (call.target === this && call.methodName !== 'forwardState') {\n                call.parameters.push(this.forwardedState.resolve);\n                this.forwardedState.resolve = null;\n                // Should we suppress this popstate event?\n                if (call.methodName === 'popstate' && this.forwardedState.suppressPopstate) {\n                    call.parameters.push(true);\n                    this.forwardedState.suppressPopstate = false;\n                }\n            }\n            // eslint-disable-next-line @typescript-eslint/ban-types\n            const method = call.target[call.methodName];\n            Reporter.write(10000, 'DEQUEUE', call.methodName, call.parameters);\n            if (method) {\n                method.apply(call.target, call.parameters);\n            }\n            qCall.resolve();\n        };\n        this.window = dom.window;\n        this.history = dom.window.history;\n        this.location = dom.window.location;\n        this.pendingCalls = new Queue(this.processCalls);\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Browser navigation has already been activated');\n        }\n        this.isActive = true;\n        this.options.callback = options.callback;\n        if (options.useUrlFragmentHash != void 0) {\n            this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n        }\n        this.pendingCalls.activate({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n        this.window.addEventListener('popstate', this.handlePopstate);\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Browser navigation has not been activated');\n        }\n        this.window.removeEventListener('popstate', this.handlePopstate);\n        this.pendingCalls.deactivate();\n        this.options = { useUrlFragmentHash: true, callback: () => { } };\n        this.isActive = false;\n    }\n    get length() {\n        return this.history.length;\n    }\n    get state() {\n        return this.history.state;\n    }\n    get viewerState() {\n        const { pathname, search, hash } = this.location;\n        return {\n            path: pathname,\n            query: search,\n            hash,\n            instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n        };\n    }\n    go(delta, suppressPopstate = false) {\n        return this.enqueue(this.history, 'go', [delta], suppressPopstate);\n    }\n    pushNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'pushState', [state, title, `${fragment}${path}`]);\n    }\n    replaceNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'replaceState', [state, title, `${fragment}${path}`]);\n    }\n    popNavigatorState() {\n        return this.enqueue(this, 'popState', []);\n    }\n    popstate(ev, resolve, suppressPopstate = false) {\n        if (!suppressPopstate) {\n            this.options.callback({\n                ...this.viewerState,\n                ...{\n                    event: ev,\n                    state: this.history.state,\n                },\n            });\n        }\n        if (resolve !== null && resolve !== void 0) {\n            resolve();\n        }\n    }\n    async popState(resolve) {\n        await this.go(-1, true);\n        const state = this.history.state;\n        // TODO: Fix browser forward bug after pop on first entry\n        if (state && state.navigationEntry && !state.navigationEntry.firstEntry) {\n            await this.go(-1, true);\n            return this.pushNavigatorState(state);\n        }\n        resolve();\n    }\n    forwardState(state) {\n        this.forwardedState = state;\n    }\n    // Everything that wants to await a browser event should pass suppressPopstate param\n    // Events NOT resulting in popstate events should NOT pass suppressPopstate param\n    enqueue(target, methodName, parameters, suppressPopstate) {\n        const calls = [];\n        const costs = [];\n        const promises = [];\n        if (suppressPopstate !== undefined) {\n            // Due to (browser) events not having a promise, we create and propagate one\n            let resolve = null;\n            promises.push(new Promise(_resolve => {\n                resolve = _resolve;\n            }));\n            calls.push({\n                target: this,\n                methodName: 'forwardState',\n                parameters: [\n                    {\n                        resolve,\n                        suppressPopstate,\n                    }\n                ],\n            });\n            costs.push(0);\n        }\n        calls.push({\n            target: target,\n            methodName: methodName,\n            parameters: parameters,\n        });\n        costs.push(1);\n        // The first promise is the relevant one since it's either a) the propagated one (in\n        // case of a browser action), or b) the only one since there's only one call\n        promises.push(this.pendingCalls.enqueue(calls, costs)[0]);\n        return promises[0];\n    }\n};\nBrowserNavigator = __decorate([\n    __param(0, IScheduler),\n    __param(1, IDOM)\n], BrowserNavigator);\nexport { BrowserNavigator };\n//# sourceMappingURL=browser-navigator.js.map","import { IDOM } from '@aurelia/runtime';\n/**\n * Class responsible for handling interactions that should trigger navigation.\n */\nexport class LinkHandler {\n    // private handler: EventListener;\n    constructor(dom) {\n        // tslint:disable-next-line:no-empty\n        this.options = {\n            useHref: true,\n            callback: () => { }\n        };\n        this.isActive = false;\n        this.handler = (e) => {\n            const info = LinkHandler.getEventInfo(e, this.window, this.options);\n            if (info.shouldHandleEvent) {\n                e.preventDefault();\n                this.options.callback(info);\n            }\n        };\n        this.window = dom.window;\n        this.document = dom.document;\n    }\n    /**\n     * Gets the href and a \"should handle\" recommendation, given an Event.\n     *\n     * @param event - The Event to inspect for target anchor and href.\n     */\n    static getEventInfo(event, win, options) {\n        const info = {\n            shouldHandleEvent: false,\n            instruction: null,\n            anchor: null\n        };\n        const target = info.anchor = LinkHandler.closestAnchor(event.target);\n        if (!target || !LinkHandler.targetIsThisWindow(target, win)) {\n            return info;\n        }\n        if (target.hasAttribute('external')) {\n            return info;\n        }\n        if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {\n            return info;\n        }\n        const goto = target.$au !== void 0 && target.$au['goto'] !== void 0 ? target.$au['goto'].viewModel.value : null;\n        const href = options.useHref && target.hasAttribute('href') ? target.getAttribute('href') : null;\n        if ((goto === null || goto.length === 0) && (href === null || href.length === 0)) {\n            return info;\n        }\n        info.anchor = target;\n        info.instruction = goto || href;\n        const leftButtonClicked = event.button === 0;\n        info.shouldHandleEvent = leftButtonClicked;\n        return info;\n    }\n    /**\n     * Finds the closest ancestor that's an anchor element.\n     *\n     * @param el - The element to search upward from.\n     * @returns The link element that is the closest ancestor.\n     */\n    static closestAnchor(el) {\n        while (el !== null && el !== void 0) {\n            if (el.tagName === 'A') {\n                return el;\n            }\n            el = el.parentNode;\n        }\n        return null;\n    }\n    /**\n     * Gets a value indicating whether or not an anchor targets the current window.\n     *\n     * @param target - The anchor element whose target should be inspected.\n     * @returns True if the target of the link element is this window; false otherwise.\n     */\n    static targetIsThisWindow(target, win) {\n        const targetWindow = target.getAttribute('target');\n        return !targetWindow ||\n            targetWindow === win.name ||\n            targetWindow === '_self';\n    }\n    /**\n     * Activate the instance.\n     *\n     */\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Link handler has already been activated');\n        }\n        this.isActive = true;\n        this.options = { ...options };\n        this.document.addEventListener('click', this.handler, true);\n    }\n    /**\n     * Deactivate the instance. Event handlers and other resources should be cleaned up here.\n     */\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Link handler has not been activated');\n        }\n        this.document.removeEventListener('click', this.handler, true);\n        this.isActive = false;\n    }\n}\nLinkHandler.inject = [IDOM];\n//# sourceMappingURL=link-handler.js.map","export function closestCustomElement(element) {\n    let el = element;\n    while (el) {\n        if (el.$controller) {\n            break;\n        }\n        el = el.parentElement;\n    }\n    return el;\n}\nexport function arrayRemove(arr, func) {\n    const removed = [];\n    let arrIndex = arr.findIndex(func);\n    while (arrIndex >= 0) {\n        removed.push(arr.splice(arrIndex, 1)[0]);\n        arrIndex = arr.findIndex(func);\n    }\n    return removed;\n}\n//# sourceMappingURL=utils.js.map","export function parseQuery(query) {\n    const parameters = {};\n    const list = [];\n    if (!query || !query.length) {\n        return { parameters: parameters, list: list };\n    }\n    const params = query.replace('+', ' ').split('&');\n    for (const param of params) {\n        const kv = param.split('=');\n        const key = decodeURIComponent(kv.shift());\n        if (!kv.length) {\n            list.push(key);\n            continue;\n        }\n        const value = decodeURIComponent(kv.shift());\n        parameters[key] = value;\n        // TODO: Deal with complex parameters such as lists and objects\n    }\n    return { parameters, list };\n}\nexport function mergeParameters(parameters, query, specifiedParameters) {\n    const parsedQuery = parseQuery(query);\n    const parsedParameters = parseQuery(parameters);\n    const params = { ...parsedQuery.parameters, ...parsedParameters.parameters };\n    const list = [...parsedQuery.list, ...parsedParameters.list];\n    if (list.length && specifiedParameters && specifiedParameters.length) {\n        for (const param of specifiedParameters) {\n            // TODO: Support data types\n            params[param] = list.shift();\n        }\n    }\n    if (list.length && Object.keys(params).length) {\n        params['-unnamed'] = list.splice(0, list.length);\n    }\n    let merged;\n    if (list.length) {\n        merged = list;\n    }\n    else {\n        merged = params;\n    }\n    return {\n        namedParameters: params,\n        parameterList: list,\n        merged: merged,\n    };\n}\n//# sourceMappingURL=parser.js.map","import { IContainer } from '@aurelia/kernel';\nimport { CustomElement } from '@aurelia/runtime';\nimport { ComponentAppellationResolver } from './type-resolvers';\nexport class ViewportInstruction {\n    constructor(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        this.ownsScope = ownsScope;\n        this.nextScopeInstructions = nextScopeInstructions;\n        this.componentName = null;\n        this.componentType = null;\n        this.componentInstance = null;\n        this.viewportName = null;\n        this.viewport = null;\n        this.parametersString = null;\n        this.parameters = null;\n        this.parametersList = null;\n        this.scope = null;\n        this.needsViewportDescribed = false;\n        this.setComponent(component);\n        this.setViewport(viewport);\n        this.setParameters(parameters);\n    }\n    setComponent(component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = null;\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isInstance(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = ComponentAppellationResolver.getInstance(component);\n        }\n    }\n    setViewport(viewport) {\n        if (viewport === undefined || viewport === '') {\n            viewport = null;\n        }\n        if (typeof viewport === 'string') {\n            this.viewportName = viewport;\n            this.viewport = null;\n        }\n        else {\n            this.viewport = viewport;\n            if (viewport !== null) {\n                this.viewportName = viewport.name;\n                this.scope = viewport.owningScope;\n            }\n        }\n    }\n    setParameters(parameters) {\n        if (parameters === undefined || parameters === '') {\n            parameters = null;\n        }\n        if (typeof parameters === 'string') {\n            this.parametersString = parameters;\n            // TODO: Initialize parameters better and more of them and just fix this\n            this.parameters = { id: parameters };\n        }\n        else {\n            this.parameters = parameters;\n            // TODO: Create parametersString\n        }\n        // TODO: Deal with parametersList\n    }\n    isEmpty() {\n        return !this.isComponentName() && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentName() {\n        return !!this.componentName && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentType() {\n        return this.componentType !== null && !this.isComponentInstance();\n    }\n    isComponentInstance() {\n        return this.componentInstance !== null;\n    }\n    toComponentType(context) {\n        if (this.componentType !== null) {\n            return this.componentType;\n        }\n        if (this.componentName !== null && typeof this.componentName === 'string') {\n            const container = context.get(IContainer);\n            if (container !== null && container.has(CustomElement.keyFrom(this.componentName), true)) {\n                const resolver = container.getResolver(CustomElement.keyFrom(this.componentName));\n                if (resolver !== null && resolver.getFactory !== void 0) {\n                    const factory = resolver.getFactory(container);\n                    if (factory) {\n                        return factory.Type;\n                    }\n                }\n            }\n        }\n        return null;\n    }\n    toComponentInstance(context) {\n        if (this.componentInstance !== null) {\n            return this.componentInstance;\n        }\n        // TODO: Remove once \"local registration is fixed\"\n        // const component = this.toComponentName();\n        const container = context.get(IContainer);\n        if (container !== void 0 && container !== null) {\n            if (this.isComponentType()) {\n                return container.get(this.componentType);\n            }\n            else {\n                return container.get(CustomElement.keyFrom(this.componentName));\n            }\n        }\n        return null;\n    }\n    toViewportInstance(router) {\n        if (this.viewport !== null) {\n            return this.viewport;\n        }\n        return router.getViewport(this.viewportName);\n    }\n    sameComponent(other, compareParameters = false, compareType = false) {\n        if (compareParameters && this.parametersString !== other.parametersString) {\n            return false;\n        }\n        return compareType ? this.componentType === other.componentType : this.componentName === other.componentName;\n    }\n    // TODO: Somewhere we need to check for format such as spaces etc\n    sameParameters(other) {\n        return this.parametersString === other.parametersString;\n    }\n    sameViewport(other) {\n        return (this.viewport ? this.viewport.name : this.viewportName) === (other.viewport ? other.viewport.name : other.viewportName);\n    }\n}\n//# sourceMappingURL=viewport-instruction.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Controller } from '@aurelia/runtime';\nimport { mergeParameters } from './parser';\nimport { ViewportInstruction } from './viewport-instruction';\nexport var ContentStatus;\n(function (ContentStatus) {\n    ContentStatus[ContentStatus[\"none\"] = 0] = \"none\";\n    ContentStatus[ContentStatus[\"created\"] = 1] = \"created\";\n    ContentStatus[ContentStatus[\"loaded\"] = 2] = \"loaded\";\n    ContentStatus[ContentStatus[\"initialized\"] = 3] = \"initialized\";\n    ContentStatus[ContentStatus[\"added\"] = 4] = \"added\";\n})(ContentStatus || (ContentStatus = {}));\nexport class ViewportContent {\n    constructor(\n    // Can (and wants) be a (resolved) type or a string (to be resolved later)\n    content = new ViewportInstruction(''), instruction = {\n        instruction: '',\n        fullStateInstruction: '',\n    }, context = null) {\n        this.content = content;\n        this.instruction = instruction;\n        this.contentStatus = 0 /* none */;\n        this.entered = false;\n        this.fromCache = false;\n        this.fromHistory = false;\n        this.reentry = false;\n        this.taggedNodes = [];\n        // If we've got a container, we're good to resolve type\n        if (!this.content.isComponentType() && context !== null) {\n            this.content.componentType = this.toComponentType(context);\n        }\n    }\n    get componentInstance() {\n        return this.content.componentInstance;\n    }\n    equalComponent(other) {\n        return this.content.sameComponent(other.content);\n    }\n    equalParameters(other) {\n        return this.content.sameComponent(other.content, true) &&\n            // TODO: Review whether query is relevant\n            this.instruction.query === other.instruction.query;\n    }\n    reentryBehavior() {\n        return (this.content.componentInstance !== null &&\n            'reentryBehavior' in this.content.componentInstance &&\n            this.content.componentInstance.reentryBehavior !== void 0)\n            ? this.content.componentInstance.reentryBehavior\n            : \"default\" /* default */;\n    }\n    isCacheEqual(other) {\n        return this.content.sameComponent(other.content, true);\n    }\n    createComponent(context) {\n        if (this.contentStatus !== 0 /* none */) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache && !this.fromHistory) {\n            this.content.componentInstance = this.toComponentInstance(context);\n        }\n        this.contentStatus = 1 /* created */;\n    }\n    destroyComponent() {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 1 /* created */) {\n            return;\n        }\n        // Don't destroy components when stateful\n        this.contentStatus = 0 /* none */;\n    }\n    canEnter(viewport, previousInstruction) {\n        if (!this.content.componentInstance) {\n            return Promise.resolve(false);\n        }\n        if (!this.content.componentInstance.canEnter) {\n            return Promise.resolve(true);\n        }\n        const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n        const merged = mergeParameters(this.content.parametersString || '', this.instruction.query, typeParameters);\n        this.instruction.parameters = merged.namedParameters;\n        this.instruction.parameterList = merged.parameterList;\n        const result = this.content.componentInstance.canEnter(merged.merged, this.instruction, previousInstruction);\n        Reporter.write(10000, 'viewport canEnter', result);\n        if (typeof result === 'boolean') {\n            return Promise.resolve(result);\n        }\n        if (typeof result === 'string') {\n            return Promise.resolve([new ViewportInstruction(result, viewport)]);\n        }\n        return result;\n    }\n    canLeave(nextInstruction) {\n        if (!this.content.componentInstance || !this.content.componentInstance.canLeave) {\n            return Promise.resolve(true);\n        }\n        const result = this.content.componentInstance.canLeave(nextInstruction, this.instruction);\n        Reporter.write(10000, 'viewport canLeave', result);\n        if (typeof result === 'boolean') {\n            return Promise.resolve(result);\n        }\n        return result;\n    }\n    async enter(previousInstruction) {\n        if (!this.reentry && (this.contentStatus !== 1 /* created */ || this.entered)) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.enter) {\n            const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n            const merged = mergeParameters(this.content.parametersString || '', this.instruction.query, typeParameters);\n            this.instruction.parameters = merged.namedParameters;\n            this.instruction.parameterList = merged.parameterList;\n            await this.content.componentInstance.enter(merged.merged, this.instruction, previousInstruction);\n        }\n        this.entered = true;\n    }\n    async leave(nextInstruction) {\n        if (this.contentStatus !== 4 /* added */ || !this.entered) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.leave) {\n            await this.content.componentInstance.leave(nextInstruction, this.instruction);\n        }\n        this.entered = false;\n    }\n    loadComponent(context, element, viewport) {\n        if (this.contentStatus !== 1 /* created */ || !this.entered || !this.content.componentInstance) {\n            return Promise.resolve();\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache || !this.fromHistory) {\n            const host = element;\n            const container = context;\n            Controller.forCustomElement(this.content.componentInstance, container, host);\n        }\n        // Temporarily tag content so that it can find parent scope before viewport is attached\n        const childNodes = this.content.componentInstance.$controller.nodes.childNodes;\n        for (let i = 0; i < childNodes.length; i++) {\n            const child = childNodes[i];\n            if (child.nodeType === 1) {\n                Reflect.set(child, '$viewport', viewport);\n                this.taggedNodes.push(child);\n            }\n        }\n        this.contentStatus = 2 /* loaded */;\n        return Promise.resolve();\n    }\n    unloadComponent(cache, stateful = false) {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        this.clearTaggedNodes();\n        // Don't unload components when stateful\n        if (!stateful) {\n            this.contentStatus = 1 /* created */;\n        }\n        else {\n            cache.push(this);\n        }\n    }\n    clearTaggedNodes() {\n        for (const node of this.taggedNodes) {\n            Reflect.deleteProperty(node, '$viewport');\n        }\n        this.taggedNodes = [];\n    }\n    initializeComponent() {\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        // Don't initialize cached content or instantiated history content\n        // if (!this.fromCache || !this.fromHistory) {\n        this.content.componentInstance.$controller.bind(1024 /* fromStartTask */ | 4096 /* fromBind */);\n        // }\n        this.contentStatus = 3 /* initialized */;\n    }\n    async terminateComponent(stateful = false) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        // Don't terminate cached content\n        // if (!stateful) {\n        await this.content.componentInstance.$controller.unbind(2048 /* fromStopTask */ | 8192 /* fromUnbind */).wait();\n        // }\n        this.contentStatus = 2 /* loaded */;\n    }\n    addComponent(element) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        this.content.componentInstance.$controller.attach(1024 /* fromStartTask */);\n        if (this.fromCache || this.fromHistory) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                const attr = el.getAttribute('au-element-scroll');\n                if (attr) {\n                    const [top, left] = attr.split(',');\n                    el.removeAttribute('au-element-scroll');\n                    el.scrollTo(+left, +top);\n                }\n            }\n        }\n        this.contentStatus = 4 /* added */;\n    }\n    removeComponent(element, stateful = false) {\n        if (this.contentStatus !== 4 /* added */ || this.entered) {\n            return;\n        }\n        if (stateful && element !== null) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                if (el.scrollTop > 0 || el.scrollLeft) {\n                    el.setAttribute('au-element-scroll', `${el.scrollTop},${el.scrollLeft}`);\n                }\n            }\n        }\n        this.content.componentInstance.$controller.detach(2048 /* fromStopTask */);\n        this.contentStatus = 3 /* initialized */;\n    }\n    async freeContent(element, nextInstruction, cache, stateful = false) {\n        switch (this.contentStatus) {\n            case 4 /* added */:\n                await this.leave(nextInstruction);\n                this.removeComponent(element, stateful);\n            case 3 /* initialized */:\n                await this.terminateComponent(stateful);\n            case 2 /* loaded */:\n                this.unloadComponent(cache, stateful);\n            case 1 /* created */:\n                this.destroyComponent();\n        }\n    }\n    toComponentName() {\n        return this.content.componentName;\n    }\n    toComponentType(context) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentType(context);\n    }\n    toComponentInstance(context) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentInstance(context);\n    }\n}\n//# sourceMappingURL=viewport-content.js.map","import { Reporter } from '@aurelia/kernel';\nimport { arrayRemove } from './utils';\nimport { ViewportContent } from './viewport-content';\nimport { ViewportInstruction } from './viewport-instruction';\nexport class Viewport {\n    constructor(router, name, element, context, owningScope, scope, options = {}) {\n        this.router = router;\n        this.name = name;\n        this.element = element;\n        this.context = context;\n        this.owningScope = owningScope;\n        this.options = options;\n        this.scope = null;\n        this.nextContent = null;\n        this.enabled = true;\n        this.forceRemove = false;\n        this.parent = null;\n        this.children = [];\n        this.clear = false;\n        this.elementResolve = null;\n        this.previousViewportState = null;\n        this.cache = [];\n        this.historyCache = [];\n        this.scope = scope ? this : null;\n        this.content = new ViewportContent();\n    }\n    get doForceRemove() {\n        let viewport = this;\n        let forceRemove = viewport.forceRemove;\n        while (!forceRemove && viewport.parent !== null) {\n            viewport = viewport.parent;\n            forceRemove = viewport.forceRemove;\n        }\n        return forceRemove;\n    }\n    setNextContent(content, instruction) {\n        let viewportInstruction;\n        if (content instanceof ViewportInstruction) {\n            viewportInstruction = content;\n        }\n        else {\n            if (typeof content === 'string') {\n                viewportInstruction = this.router.instructionResolver.parseViewportInstruction(content);\n            }\n            else {\n                viewportInstruction = new ViewportInstruction(content);\n            }\n        }\n        viewportInstruction.setViewport(this);\n        this.clear = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction);\n        // Can have a (resolved) type or a string (to be resolved later)\n        this.nextContent = new ViewportContent(!this.clear ? viewportInstruction : void 0, instruction, this.context);\n        this.nextContent.fromHistory = this.nextContent.componentInstance && instruction.navigation\n            ? !!instruction.navigation.back || !!instruction.navigation.forward\n            : false;\n        if (this.options.stateful) {\n            // TODO: Add a parameter here to decide required equality\n            const cached = this.cache.find((item) => this.nextContent.isCacheEqual(item));\n            if (cached) {\n                this.nextContent = cached;\n                this.nextContent.fromCache = true;\n            }\n            else {\n                this.cache.push(this.nextContent);\n            }\n        }\n        // If we get the same _instance_, don't do anything (happens with cached and history)\n        if (this.nextContent.componentInstance !== null && this.content.componentInstance === this.nextContent.componentInstance) {\n            this.nextContent = null;\n            return false;\n        }\n        // ReentryBehavior 'refresh' takes precedence\n        if (!this.content.equalComponent(this.nextContent) ||\n            instruction.navigation.refresh ||\n            this.content.reentryBehavior() === \"refresh\" /* refresh */) {\n            return true;\n        }\n        // Explicitly don't allow navigation back to the same component again\n        if (this.content.reentryBehavior() === \"disallow\" /* disallow */) {\n            this.nextContent = null;\n            return false;\n        }\n        // ReentryBehavior is now 'enter' or 'default'\n        if (!this.content.equalParameters(this.nextContent) ||\n            this.content.reentryBehavior() === \"enter\" /* enter */) {\n            this.content.reentry = true;\n            this.nextContent.content.setComponent(this.content.componentInstance);\n            this.nextContent.contentStatus = this.content.contentStatus;\n            this.nextContent.reentry = this.content.reentry;\n            return true;\n        }\n        this.nextContent = null;\n        return false;\n    }\n    setElement(element, context, options) {\n        options = options || {};\n        if (this.element !== element) {\n            // TODO: Restore this state on navigation cancel\n            this.previousViewportState = { ...this };\n            this.clearState();\n            this.element = element;\n            if (options.usedBy) {\n                this.options.usedBy = options.usedBy;\n            }\n            if (options.default) {\n                this.options.default = options.default;\n            }\n            if (options.noLink) {\n                this.options.noLink = options.noLink;\n            }\n            if (options.noHistory) {\n                this.options.noHistory = options.noHistory;\n            }\n            if (options.stateful) {\n                this.options.stateful = options.stateful;\n            }\n            if (this.elementResolve) {\n                this.elementResolve();\n            }\n        }\n        // TODO: Might not need this? Figure it out\n        // if (context) {\n        //   context['viewportName'] = this.name;\n        // }\n        if (this.context !== context) {\n            this.context = context;\n        }\n        if (!this.content.componentInstance && (!this.nextContent || !this.nextContent.componentInstance) && this.options.default) {\n            const instructions = this.router.instructionResolver.parseViewportInstructions(this.options.default);\n            for (const instruction of instructions) {\n                instruction.setViewport(this);\n            }\n            this.router.goto(instructions, { append: true }).catch(error => { throw error; });\n        }\n    }\n    async remove(element, context) {\n        if (this.element === element && this.context === context) {\n            if (this.content.componentInstance) {\n                await this.content.freeContent(this.element, (this.nextContent ? this.nextContent.instruction : null), this.historyCache, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful); // .catch(error => { throw error; });\n            }\n            if (this.doForceRemove) {\n                await Promise.all(this.historyCache.map(content => content.freeContent(null, null, this.historyCache, false)));\n                this.historyCache = [];\n            }\n            return true;\n        }\n        return false;\n    }\n    async canLeave() {\n        const results = await Promise.all(this.children.map((child) => child.canLeave()));\n        if (results.some(result => result === false)) {\n            return false;\n        }\n        return this.content.canLeave(this.nextContent ? this.nextContent.instruction : null);\n    }\n    async canEnter() {\n        if (this.clear) {\n            return true;\n        }\n        if ((this.nextContent.content || null) === null) {\n            return false;\n        }\n        await this.waitForElement();\n        this.nextContent.createComponent(this.context);\n        return this.nextContent.canEnter(this, this.content.instruction);\n    }\n    async enter() {\n        Reporter.write(10000, 'Viewport enter', this.name);\n        if (this.clear) {\n            return true;\n        }\n        if (!this.nextContent || !this.nextContent.componentInstance) {\n            return false;\n        }\n        await this.nextContent.enter(this.content.instruction);\n        await this.nextContent.loadComponent(this.context, this.element, this);\n        this.nextContent.initializeComponent();\n        return true;\n    }\n    async loadContent() {\n        Reporter.write(10000, 'Viewport loadContent', this.name);\n        // No need to wait for next component activation\n        if (this.content.componentInstance && !this.nextContent.componentInstance) {\n            await this.content.leave(this.nextContent.instruction);\n            await this.unloadContent();\n        }\n        if (this.nextContent.componentInstance) {\n            if (this.content.componentInstance !== this.nextContent.componentInstance) {\n                this.nextContent.addComponent(this.element);\n            }\n            // Only when next component activation is done\n            if (this.content.componentInstance) {\n                await this.content.leave(this.nextContent.instruction);\n                if (!this.content.reentry && this.content.componentInstance !== this.nextContent.componentInstance) {\n                    await this.unloadContent();\n                }\n            }\n            this.content = this.nextContent;\n            this.content.reentry = false;\n        }\n        if (this.clear) {\n            this.content = new ViewportContent(void 0, this.nextContent.instruction);\n        }\n        this.nextContent = null;\n        return true;\n    }\n    clearTaggedNodes() {\n        if ((this.content || null) !== null) {\n            this.content.clearTaggedNodes();\n        }\n        if (this.nextContent) {\n            this.nextContent.clearTaggedNodes();\n        }\n    }\n    finalizeContentChange() {\n        this.previousViewportState = null;\n    }\n    async abortContentChange() {\n        await this.nextContent.freeContent(this.element, this.nextContent.instruction, this.historyCache, this.router.statefulHistory || this.options.stateful);\n        if (this.previousViewportState) {\n            Object.assign(this, this.previousViewportState);\n        }\n    }\n    // TODO: Deal with non-string components\n    wantComponent(component) {\n        let usedBy = this.options.usedBy || [];\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        return usedBy.includes(component);\n    }\n    // TODO: Deal with non-string components\n    acceptComponent(component) {\n        if (component === '-' || component === null) {\n            return true;\n        }\n        let usedBy = this.options.usedBy;\n        if (!usedBy || !usedBy.length) {\n            return true;\n        }\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        if (usedBy.includes(component)) {\n            return true;\n        }\n        if (usedBy.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    binding(flags) {\n        if (this.content.componentInstance) {\n            this.content.initializeComponent();\n        }\n    }\n    async attaching(flags) {\n        Reporter.write(10000, 'ATTACHING viewport', this.name, this.content, this.nextContent);\n        this.enabled = true;\n        if (this.content.componentInstance) {\n            // Only acts if not already entered\n            await this.content.enter(this.content.instruction);\n            this.content.addComponent(this.element);\n        }\n    }\n    async detaching(flags) {\n        Reporter.write(10000, 'DETACHING viewport', this.name);\n        if (this.content.componentInstance) {\n            // Only acts if not already left\n            await this.content.leave(this.content.instruction);\n            this.content.removeComponent(this.element, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n        this.enabled = false;\n    }\n    async unbinding(flags) {\n        if (this.content.componentInstance) {\n            await this.content.terminateComponent(this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n    }\n    addChild(viewport) {\n        if (!this.children.some(vp => vp === viewport)) {\n            this.children.push(viewport);\n            viewport.parent = this;\n        }\n    }\n    removeChild(viewport) {\n        const index = this.children.indexOf(viewport);\n        if (index >= 0) {\n            this.children.splice(index, 1);\n            viewport.parent = null;\n        }\n    }\n    getEnabledViewports() {\n        return this.children.filter((viewport) => viewport.enabled).reduce((viewports, viewport) => {\n            viewports[viewport.name] = viewport;\n            return viewports;\n        }, {});\n    }\n    findViewports(instructions, alreadyFound, disregardViewports = false) {\n        const foundViewports = [];\n        const remainingInstructions = [];\n        // Get a shallow copy of all available viewports\n        const availableViewports = { ...this.getEnabledViewports() };\n        for (const instruction of alreadyFound.filter(found => found.scope === this)) {\n            availableViewports[instruction.viewportName] = null;\n        }\n        const viewportInstructions = instructions.slice();\n        // The viewport is already known\n        if (!disregardViewports) {\n            for (let i = 0; i < viewportInstructions.length; i++) {\n                const instruction = viewportInstructions[i];\n                if (instruction.viewport) {\n                    const remaining = this.foundViewport(instruction, instruction.viewport, disregardViewports);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[instruction.viewport.name] = null;\n                    viewportInstructions.splice(i--, 1);\n                }\n            }\n        }\n        // Configured viewport is ruling\n        for (let i = 0; i < viewportInstructions.length; i++) {\n            const instruction = viewportInstructions[i];\n            instruction.needsViewportDescribed = true;\n            for (const name in availableViewports) {\n                const viewport = availableViewports[name];\n                // TODO: Also check if (resolved) component wants a specific viewport\n                if (viewport && viewport.wantComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[name] = null;\n                    viewportInstructions.splice(i--, 1);\n                    break;\n                }\n            }\n        }\n        // Next in line is specified viewport (but not if we're disregarding viewports)\n        if (!disregardViewports) {\n            for (let i = 0; i < viewportInstructions.length; i++) {\n                const instruction = viewportInstructions[i];\n                const name = instruction.viewportName;\n                if (!name || !name.length) {\n                    continue;\n                }\n                const newScope = instruction.ownsScope;\n                if (!this.getEnabledViewports()[name]) {\n                    this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                    availableViewports[name] = this.getEnabledViewports()[name];\n                }\n                const viewport = availableViewports[name];\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[name] = null;\n                    viewportInstructions.splice(i--, 1);\n                }\n            }\n        }\n        // Finally, only one accepting viewport left?\n        for (let i = 0; i < viewportInstructions.length; i++) {\n            const instruction = viewportInstructions[i];\n            const remainingViewports = [];\n            for (const name in availableViewports) {\n                const viewport = availableViewports[name];\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    remainingViewports.push(viewport);\n                }\n            }\n            if (remainingViewports.length === 1) {\n                const viewport = remainingViewports.shift();\n                const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                foundViewports.push(instruction);\n                remainingInstructions.push(...remaining);\n                availableViewports[viewport.name] = null;\n                viewportInstructions.splice(i--, 1);\n            }\n        }\n        // If we're ignoring viewports, we now match them anyway\n        if (disregardViewports) {\n            for (let i = 0; i < viewportInstructions.length; i++) {\n                const instruction = viewportInstructions[i];\n                let viewport = instruction.viewport;\n                if (!viewport) {\n                    const name = instruction.viewportName;\n                    if (!name || !name.length) {\n                        continue;\n                    }\n                    const newScope = instruction.ownsScope;\n                    if (!this.getEnabledViewports()[name]) {\n                        this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                        availableViewports[name] = this.getEnabledViewports()[name];\n                    }\n                    viewport = availableViewports[name];\n                }\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[viewport.name] = null;\n                    viewportInstructions.splice(i--, 1);\n                }\n            }\n        }\n        return {\n            foundViewports,\n            remainingInstructions,\n        };\n    }\n    foundViewport(instruction, viewport, withoutViewports, doesntNeedViewportDescribed = false) {\n        instruction.setViewport(viewport);\n        if (doesntNeedViewportDescribed) {\n            instruction.needsViewportDescribed = false;\n        }\n        const remaining = (instruction.nextScopeInstructions || []).slice();\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewport.scope || viewport.owningScope;\n            }\n        }\n        return remaining;\n    }\n    addViewport(name, element, context, options = {}) {\n        let viewport = this.getEnabledViewports()[name];\n        // Each au-viewport element has its own Viewport\n        if (element && viewport && viewport.element !== null && viewport.element !== element) {\n            viewport.enabled = false;\n            viewport = this.children.find(child => child.name === name && child.element === element) || null;\n            if (viewport) {\n                viewport.enabled = true;\n            }\n        }\n        if (!viewport) {\n            viewport = new Viewport(this.router, name, null, null, this.scope || this.owningScope, !!options.scope, options);\n            this.addChild(viewport);\n        }\n        // TODO: Either explain why || instead of && here (might only need one) or change it to && if that should turn out to not be relevant\n        if (element || context) {\n            viewport.setElement(element, context, options);\n        }\n        return viewport;\n    }\n    removeViewport(viewport, element, context) {\n        if ((!element && !context) || viewport.remove(element, context)) {\n            this.removeChild(viewport);\n            return true;\n        }\n        return false;\n    }\n    allViewports(includeDisabled = false) {\n        const viewports = this.children.filter((viewport) => viewport.enabled || includeDisabled);\n        for (const scope of this.children) {\n            viewports.push(...scope.allViewports(includeDisabled));\n        }\n        return viewports;\n    }\n    reparentViewportInstructions() {\n        const enabledViewports = this.children.filter(viewport => viewport.enabled\n            && viewport.content.content\n            && viewport.content.content.componentName);\n        if (!enabledViewports.length) {\n            return null;\n        }\n        for (const viewport of enabledViewports) {\n            if (viewport.content.content !== void 0 && viewport.content.content !== null) {\n                const childInstructions = viewport.reparentViewportInstructions();\n                viewport.content.content.nextScopeInstructions = childInstructions !== null && childInstructions.length > 0 ? childInstructions : null;\n            }\n        }\n        return enabledViewports.map(viewport => viewport.content.content);\n    }\n    async freeContent(component) {\n        const content = this.historyCache.find(cached => cached.componentInstance === component);\n        if (content !== void 0) {\n            this.forceRemove = true;\n            await content.freeContent(null, null, this.historyCache, false);\n            this.forceRemove = false;\n            arrayRemove(this.historyCache, (cached => cached === content));\n        }\n    }\n    async unloadContent() {\n        this.content.removeComponent(this.element, this.router.statefulHistory || this.options.stateful);\n        await this.content.terminateComponent(this.router.statefulHistory || this.options.stateful);\n        this.content.unloadComponent(this.historyCache, this.router.statefulHistory || this.options.stateful);\n        this.content.destroyComponent();\n    }\n    clearState() {\n        this.options = {};\n        this.content = new ViewportContent();\n        this.cache = [];\n    }\n    async waitForElement() {\n        if (this.element) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n            this.elementResolve = resolve;\n        });\n    }\n}\n//# sourceMappingURL=viewport.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { Viewport } from './viewport';\nimport { ViewportInstruction } from './viewport-instruction';\nexport const ComponentAppellationResolver = {\n    isName: function (component) {\n        return typeof component === 'string';\n    },\n    isType: function (component) {\n        return CustomElement.isType(component);\n    },\n    isInstance: function (component) {\n        return !ComponentAppellationResolver.isName(component) && !ComponentAppellationResolver.isType(component);\n    },\n    getName: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return component;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return CustomElement.getDefinition(component).name;\n        }\n        else {\n            return ComponentAppellationResolver.getName(component.constructor);\n        }\n    },\n    getType: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return component;\n        }\n        else {\n            return component.constructor;\n        }\n    },\n    getInstance: function (component) {\n        if (ComponentAppellationResolver.isName(component) || ComponentAppellationResolver.isType(component)) {\n            return null;\n        }\n        else {\n            return component;\n        }\n    },\n};\nexport const ViewportHandleResolver = {\n    isName: function (viewport) {\n        return typeof viewport === 'string';\n    },\n    isInstance: function (viewport) {\n        return viewport instanceof Viewport;\n    },\n    getName: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return viewport;\n        }\n        else {\n            return viewport ? (viewport).name : null;\n        }\n    },\n    getInstance: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return null;\n        }\n        else {\n            return viewport;\n        }\n    },\n};\nexport const NavigationInstructionResolver = {\n    toViewportInstructions: function (router, navigationInstructions) {\n        if (!Array.isArray(navigationInstructions)) {\n            return NavigationInstructionResolver.toViewportInstructions(router, [navigationInstructions]);\n        }\n        const instructions = [];\n        for (const instruction of navigationInstructions) {\n            if (typeof instruction === 'string') {\n                instructions.push(...router.instructionResolver.parseViewportInstructions(instruction));\n            }\n            else if (instruction instanceof ViewportInstruction) {\n                instructions.push(instruction);\n            }\n            else if (instruction.component) {\n                const viewportComponent = instruction;\n                instructions.push(new ViewportInstruction(viewportComponent.component, viewportComponent.viewport, viewportComponent.parameters));\n            }\n            else {\n                instructions.push(new ViewportInstruction(instruction));\n            }\n        }\n        return instructions;\n    },\n};\n//# sourceMappingURL=type-resolvers.js.map","import { ComponentAppellationResolver, ViewportHandleResolver } from './type-resolvers';\nimport { ViewportInstruction } from './viewport-instruction';\nexport class Guard {\n    constructor(guard, options, id) {\n        this.guard = guard;\n        this.id = id;\n        this.type = \"before\" /* Before */;\n        this.includeTargets = [];\n        this.excludeTargets = [];\n        if (options.type !== void 0) {\n            this.type = options.type;\n        }\n        for (const target of options.include || []) {\n            this.includeTargets.push(new Target(target));\n        }\n        for (const target of options.exclude || []) {\n            this.excludeTargets.push(new Target(target));\n        }\n    }\n    matches(viewportInstructions) {\n        if (this.includeTargets.length && !this.includeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        if (this.excludeTargets.length && this.excludeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        return true;\n    }\n    check(viewportInstructions, navigationInstruction) {\n        return this.guard(viewportInstructions, navigationInstruction);\n    }\n}\nclass Target {\n    constructor(target) {\n        this.componentType = null;\n        this.componentName = null;\n        this.viewport = null;\n        this.viewportName = null;\n        if (typeof target === 'string') {\n            this.componentName = target;\n        }\n        else if (ComponentAppellationResolver.isType(target)) {\n            this.componentType = target;\n            this.componentName = ComponentAppellationResolver.getName(target);\n        }\n        else {\n            const cvTarget = target;\n            if (cvTarget.component) {\n                this.componentType = ComponentAppellationResolver.isType(cvTarget.component)\n                    ? ComponentAppellationResolver.getType(cvTarget.component)\n                    : null;\n                this.componentName = ComponentAppellationResolver.getName(cvTarget.component);\n            }\n            if (cvTarget.viewport) {\n                this.viewport = ViewportHandleResolver.isInstance(cvTarget.viewport) ? cvTarget.viewport : null;\n                this.viewportName = ViewportHandleResolver.getName(cvTarget.viewport);\n            }\n        }\n    }\n    matches(viewportInstructions) {\n        const instructions = viewportInstructions.slice();\n        if (!instructions.length) {\n            instructions.push(new ViewportInstruction(''));\n        }\n        for (const instruction of instructions) {\n            if ((this.componentName !== null && this.componentName === instruction.componentName) ||\n                (this.componentType !== null && this.componentType === instruction.componentType) ||\n                (this.viewportName !== null && this.viewportName === instruction.viewportName) ||\n                (this.viewport !== null && this.viewport === instruction.viewport)) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=guard.js.map","import { Guard } from './guard';\n// Only one so far, but it's easier to support more from the start\nexport var GuardTypes;\n(function (GuardTypes) {\n    GuardTypes[\"Before\"] = \"before\";\n})(GuardTypes || (GuardTypes = {}));\nexport class Guardian {\n    constructor() {\n        this.guards = { before: [] };\n        this.lastIdentity = 0;\n    }\n    addGuard(guardFunction, options) {\n        const guard = new Guard(guardFunction, options || {}, ++this.lastIdentity);\n        this.guards[guard.type].push(guard);\n        return this.lastIdentity;\n    }\n    removeGuard(id) {\n        for (const type in this.guards) {\n            const index = this.guards[type].findIndex(guard => guard.id === id);\n            if (index > -1) {\n                this.guards[type].splice(index, 1);\n            }\n        }\n    }\n    passes(type, viewportInstructions, navigationInstruction) {\n        let modified = false;\n        for (const guard of this.guards[type]) {\n            if (guard.matches(viewportInstructions)) {\n                const outcome = guard.check(viewportInstructions, navigationInstruction);\n                if (typeof outcome === 'boolean') {\n                    if (!outcome) {\n                        return false;\n                    }\n                }\n                else {\n                    viewportInstructions = outcome;\n                    modified = true;\n                }\n            }\n        }\n        return modified ? viewportInstructions : true;\n    }\n}\n//# sourceMappingURL=guardian.js.map","export var ReentryBehavior;\n(function (ReentryBehavior) {\n    ReentryBehavior[\"default\"] = \"default\";\n    ReentryBehavior[\"disallow\"] = \"disallow\";\n    ReentryBehavior[\"enter\"] = \"enter\";\n    ReentryBehavior[\"refresh\"] = \"refresh\";\n})(ReentryBehavior || (ReentryBehavior = {}));\n//# sourceMappingURL=interfaces.js.map","import { ComponentAppellationResolver, NavigationInstructionResolver } from './type-resolvers';\nexport class NavRoute {\n    constructor(nav, route) {\n        this.nav = nav;\n        this.instructions = [];\n        this.link = null;\n        this.linkVisible = null;\n        this.linkActive = null;\n        this.compareParameters = false;\n        this.children = null;\n        this.visible = true;\n        this.active = '';\n        this.title = route.title;\n        this.meta = route.meta;\n        if (route.route) {\n            this.instructions = this.parseRoute(route.route);\n            this.link = this.computeLink(this.instructions);\n        }\n        this.linkActive = route.consideredActive ? route.consideredActive : this.link;\n        if (!(this.linkActive instanceof Function) || ComponentAppellationResolver.isType(this.linkActive)) {\n            this.linkActive = NavigationInstructionResolver.toViewportInstructions(this.nav.router, this.linkActive);\n        }\n        this.execute = route.execute;\n        this.compareParameters = !!route.compareParameters;\n        this.linkVisible = route.condition === undefined ? true : route.condition;\n        this.update();\n    }\n    get hasChildren() {\n        return (this.children && this.children.length ? 'nav-has-children' : '');\n    }\n    update() {\n        this.visible = this.computeVisible();\n        if ((this.link && this.link.length) || this.execute) {\n            this.active = this.computeActive();\n        }\n        else {\n            this.active = (this.active === 'nav-active' ? 'nav-active' : (this.activeChild() ? 'nav-active-child' : ''));\n        }\n    }\n    executeAction(event) {\n        if (this.execute) {\n            this.execute(this);\n        }\n        event.stopPropagation();\n    }\n    toggleActive() {\n        this.active = (this.active.startsWith('nav-active') ? '' : 'nav-active');\n    }\n    parseRoute(routes) {\n        return NavigationInstructionResolver.toViewportInstructions(this.nav.router, routes);\n    }\n    computeVisible() {\n        if (this.linkVisible instanceof Function) {\n            return this.linkVisible(this);\n        }\n        return !!this.linkVisible;\n    }\n    computeActive() {\n        if (!Array.isArray(this.linkActive)) {\n            return this.linkActive(this) ? 'nav-active' : '';\n        }\n        const components = this.linkActive;\n        const activeComponents = this.nav.router.instructionResolver.flattenViewportInstructions(this.nav.router.activeComponents);\n        for (const component of components) {\n            if (activeComponents.every((active) => !active.sameComponent(component, this.compareParameters && !!component.parametersString))) {\n                return '';\n            }\n        }\n        return 'nav-active';\n    }\n    computeLink(instructions) {\n        return this.nav.router.instructionResolver.stringifyViewportInstructions(instructions);\n    }\n    activeChild() {\n        if (this.children) {\n            for (const child of this.children) {\n                if (child.active.startsWith('nav-active') || child.activeChild()) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=nav-route.js.map","import { NavRoute } from './nav-route';\nexport class Nav {\n    constructor(router, name, routes = [], classes = {}) {\n        this.router = router;\n        this.name = name;\n        this.routes = routes;\n        this.classes = classes;\n        this.update();\n    }\n    addRoutes(routes) {\n        for (const route of routes) {\n            this.addRoute(this.routes, route);\n        }\n        this.update();\n    }\n    update() {\n        this.updateRoutes(this.routes);\n        this.routes = this.routes.slice();\n    }\n    addRoute(routes, route) {\n        const newRoute = new NavRoute(this, route);\n        routes.push(newRoute);\n        if (route.children) {\n            newRoute.children = [];\n            for (const child of route.children) {\n                this.addRoute(newRoute.children, child);\n            }\n        }\n    }\n    updateRoutes(routes) {\n        for (const route of routes) {\n            route.update();\n            if (route.children && route.children.length) {\n                this.updateRoutes(route.children);\n            }\n        }\n    }\n}\n//# sourceMappingURL=nav.js.map","import { buildQueryString, parseQueryString } from '@aurelia/kernel';\nexport class HandlerEntry {\n    constructor(handler, names) {\n        this.handler = handler;\n        this.names = names;\n    }\n}\n/*\n* An object that is indexed and used for route generation, particularly for dynamic routes.\n*/\nexport class RouteGenerator {\n    constructor(segments, handlers) {\n        this.segments = segments;\n        this.handlers = handlers;\n    }\n}\nexport class TypesRecord {\n    constructor() {\n        this.statics = 0;\n        this.dynamics = 0;\n        this.stars = 0;\n    }\n}\nexport class RecognizeResult {\n    constructor(handler, params, isDynamic) {\n        this.handler = handler;\n        this.params = params;\n        this.isDynamic = isDynamic;\n    }\n}\nexport class CharSpec {\n    constructor(invalidChars, validChars, repeat) {\n        this.invalidChars = invalidChars;\n        this.validChars = validChars;\n        this.repeat = repeat;\n    }\n    equals(other) {\n        return this.validChars === other.validChars && this.invalidChars === other.invalidChars;\n    }\n}\nexport class State {\n    constructor(charSpec) {\n        this.charSpec = charSpec;\n        this.nextStates = [];\n    }\n    put(charSpec) {\n        let state = this.nextStates.find(s => s.charSpec.equals(charSpec));\n        if (state === undefined) {\n            state = new State(charSpec);\n            this.nextStates.push(state);\n            if (charSpec.repeat) {\n                state.nextStates.push(state);\n            }\n        }\n        return state;\n    }\n}\nconst specials = [\n    '/', '.', '*', '+', '?', '|',\n    '(', ')', '[', ']', '{', '}', '\\\\'\n];\nconst escapeRegex = new RegExp(`(\\\\${specials.join('|\\\\')})`, 'g');\n// A Segment represents a segment in the original route description.\n// Each Segment type provides an `eachChar` and `regex` method.\n//\n// The `eachChar` method invokes the callback with one or more character\n// specifications. A character specification consumes one or more input\n// characters.\n//\n// The `regex` method returns a regex fragment for the segment. If the\n// segment is a dynamic or star segment, the regex fragment also includes\n// a capture.\n//\n// A character specification contains:\n//\n// * `validChars`: a String with a list of all valid characters, or\n// * `invalidChars`: a String with a list of all invalid characters\n// * `repeat`: true if the character specification can repeat\nexport class StaticSegment {\n    constructor(str, caseSensitive) {\n        this.caseSensitive = caseSensitive;\n        this.optional = false;\n        this.name = str;\n        this.string = str;\n    }\n    eachChar(callback) {\n        const s = this.string;\n        const len = s.length;\n        let i = 0;\n        let ch = '';\n        if (this.caseSensitive) {\n            for (; i < len; ++i) {\n                ch = s.charAt(i);\n                callback(new CharSpec(null, ch, false));\n            }\n        }\n        else {\n            for (; i < len; ++i) {\n                ch = s.charAt(i);\n                callback(new CharSpec(null, ch.toUpperCase() + ch.toLowerCase(), false));\n            }\n        }\n    }\n    regex() {\n        return this.string.replace(escapeRegex, '\\\\$1');\n    }\n    generate(params, consumed) {\n        return this.string;\n    }\n}\nexport class DynamicSegment {\n    constructor(name, optional) {\n        this.name = name;\n        this.optional = optional;\n    }\n    eachChar(callback) {\n        callback(new CharSpec('/', null, true));\n    }\n    regex() {\n        return '([^/]+)';\n    }\n    generate(params, consumed) {\n        consumed[this.name] = true;\n        return params[this.name];\n    }\n}\nexport class StarSegment {\n    constructor(name) {\n        this.name = name;\n        this.optional = false;\n    }\n    eachChar(callback) {\n        callback(new CharSpec('', null, true));\n    }\n    regex() {\n        return '(.+)';\n    }\n    generate(params, consumed) {\n        consumed[this.name] = true;\n        return params[this.name];\n    }\n}\nexport class EpsilonSegment {\n    eachChar(callback) {\n        return;\n    }\n    regex() {\n        return '';\n    }\n    generate(params, consumed) {\n        return '';\n    }\n}\n/**\n * Class that parses route patterns and matches path strings.\n */\nexport class RouteRecognizer {\n    constructor() {\n        this.rootState = new State();\n        this.names = {};\n        this.routes = new Map();\n    }\n    /**\n     * Parse a route pattern and add it to the collection of recognized routes.\n     *\n     * @param route - The route to add.\n     */\n    add(route) {\n        if (Array.isArray(route)) {\n            route.forEach(r => {\n                this.add(r);\n            });\n            return;\n        }\n        let currentState = this.rootState;\n        const skippableStates = [];\n        let regex = '^';\n        const types = new TypesRecord();\n        const names = [];\n        const routeName = route.handler.name;\n        let isEmpty = true;\n        let normalizedRoute = route.path;\n        if (normalizedRoute.startsWith('/')) {\n            normalizedRoute = normalizedRoute.slice(1);\n        }\n        const segments = [];\n        const splitRoute = normalizedRoute.split('/');\n        let part;\n        let segment;\n        for (let i = 0, ii = splitRoute.length; i < ii; ++i) {\n            part = splitRoute[i];\n            // Try to parse a parameter :param?\n            let match = /^:([^?]+)(\\?)?$/.exec(part);\n            if (match) {\n                const [, name, optional] = match;\n                if (name.includes('=')) {\n                    throw new Error(`Parameter ${name} in route ${route} has a default value, which is not supported.`);\n                }\n                segments.push(segment = new DynamicSegment(name, !!optional));\n                names.push(name);\n                types.dynamics++;\n            }\n            else {\n                // Try to parse a star segment *whatever\n                match = /^\\*(.+)$/.exec(part);\n                if (match) {\n                    segments.push(segment = new StarSegment(match[1]));\n                    names.push(match[1]);\n                    types.stars++;\n                }\n                else if (part === '') {\n                    segments.push(new EpsilonSegment());\n                    continue;\n                }\n                else {\n                    segments.push(segment = new StaticSegment(part, route.caseSensitive === true));\n                    types.statics++;\n                }\n            }\n            // Add a representation of the segment to the NFA and regex\n            const firstState = currentState.put(new CharSpec(null, '/', false));\n            let nextState = firstState;\n            segment.eachChar(ch => {\n                nextState = nextState.put(ch);\n            });\n            // add the first part of the next segment to the end of any skipped states\n            for (let j = 0, jj = skippableStates.length; j < jj; j++) {\n                skippableStates[j].nextStates.push(firstState);\n            }\n            // If the segment was optional we don't fast forward to the end of the\n            // segment, but we do hold on to a reference to the end of the segment\n            // for adding future segments. Multiple consecutive optional segments\n            // will accumulate.\n            if (segment.optional) {\n                skippableStates.push(nextState);\n                regex += `(?:/${segment.regex()})?`;\n                // Otherwise, we fast forward to the end of the segment and remove any\n                // references to skipped segments since we don't need them anymore.\n            }\n            else {\n                currentState = nextState;\n                regex += `/${segment.regex()}`;\n                skippableStates.length = 0;\n                isEmpty = false;\n            }\n        }\n        // An \"all optional\" path is technically empty since currentState is this.rootState\n        if (isEmpty) {\n            currentState = currentState.put(new CharSpec(null, '/', false));\n            regex += '/?';\n        }\n        const handlers = [new HandlerEntry(route.handler, names)];\n        this.routes.set(route.handler, new RouteGenerator(segments, handlers));\n        if (routeName) {\n            const routeNames = Array.isArray(routeName) ? routeName : [routeName];\n            for (let i = 0; i < routeNames.length; i++) {\n                if (!(routeNames[i] in this.names)) {\n                    this.names[routeNames[i]] = new RouteGenerator(segments, handlers);\n                }\n            }\n        }\n        // Any trailing skipped states need to be endpoints and need to have\n        // handlers attached.\n        for (let i = 0; i < skippableStates.length; i++) {\n            const state = skippableStates[i];\n            state.handlers = handlers;\n            state.regex = new RegExp(`${regex}$`, route.caseSensitive ? '' : 'i');\n            state.types = types;\n        }\n        currentState.handlers = handlers;\n        currentState.regex = new RegExp(`${regex}$`, route.caseSensitive ? '' : 'i');\n        currentState.types = types;\n        return currentState;\n    }\n    /**\n     * Retrieve a RouteGenerator for a route by name or RouteConfig (RouteHandler).\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @returns The RouteGenerator for that route.\n     */\n    getRoute(nameOrRoute) {\n        return typeof nameOrRoute === 'string' ? this.names[nameOrRoute] : this.routes.get(nameOrRoute);\n    }\n    /**\n     * Retrieve the handlers registered for the route by name or RouteConfig (RouteHandler).\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @returns The handlers.\n     */\n    handlersFor(nameOrRoute) {\n        const route = this.getRoute(nameOrRoute);\n        if (!route) {\n            throw new Error(`There is no route named ${nameOrRoute}`);\n        }\n        return [...route.handlers];\n    }\n    /**\n     * Check if this RouteRecognizer recognizes a route by name or RouteConfig (RouteHandler).\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @returns True if the named route is recognized.\n     */\n    hasRoute(nameOrRoute) {\n        return !!this.getRoute(nameOrRoute);\n    }\n    /**\n     * Generate a path and query string from a route name or RouteConfig (RouteHandler) and params object.\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @param params - The route params to use when populating the pattern.\n     * Properties not required by the pattern will be appended to the query string.\n     * @returns The generated absolute path and query string.\n     */\n    generate(nameOrRoute, params) {\n        const route = this.getRoute(nameOrRoute);\n        if (!route) {\n            throw new Error(`There is no route named ${nameOrRoute}`);\n        }\n        const handler = route.handlers[0].handler;\n        if (handler.generationUsesHref) {\n            return handler.href;\n        }\n        const routeParams = { ...params };\n        const segments = route.segments;\n        const consumed = {};\n        let output = '';\n        for (let i = 0, l = segments.length; i < l; i++) {\n            const segment = segments[i];\n            if (segment instanceof EpsilonSegment) {\n                continue;\n            }\n            const segmentValue = segment.generate(routeParams, consumed);\n            if (segmentValue == null) {\n                if (!segment.optional) {\n                    throw new Error(`A value is required for route parameter '${segment.name}' in route '${nameOrRoute}'.`);\n                }\n            }\n            else {\n                output += '/';\n                output += segmentValue;\n            }\n        }\n        if (!output.startsWith('/')) {\n            output = `/${output}`;\n        }\n        // remove params used in the path and add the rest to the querystring\n        for (const param in consumed) {\n            Reflect.deleteProperty(routeParams, param);\n        }\n        const queryString = buildQueryString(routeParams);\n        output += queryString ? `?${queryString}` : '';\n        return output;\n    }\n    /**\n     * Match a path string against registered route patterns.\n     *\n     * @param path - The path to attempt to match.\n     * @returns Array of objects containing `handler`, `params`, and\n     * `isDynamic` values for the matched route(s), or undefined if no match\n     * was found.\n     */\n    recognize(path) {\n        let states = [this.rootState];\n        let queryParams = {};\n        let isSlashDropped = false;\n        let normalizedPath = path;\n        const queryStart = normalizedPath.indexOf('?');\n        if (queryStart !== -1) {\n            const queryString = normalizedPath.slice(queryStart + 1);\n            normalizedPath = normalizedPath.slice(0, queryStart);\n            queryParams = parseQueryString(queryString);\n        }\n        normalizedPath = decodeURI(normalizedPath);\n        if (!normalizedPath.startsWith('/')) {\n            normalizedPath = `/${normalizedPath}`;\n        }\n        let pathLen = normalizedPath.length;\n        if (pathLen > 1 && normalizedPath.charAt(pathLen - 1) === '/') {\n            normalizedPath = normalizedPath.slice(0, -1);\n            isSlashDropped = true;\n            --pathLen;\n        }\n        for (let i = 0; i < pathLen; ++i) {\n            const nextStates = [];\n            const ch = normalizedPath.charAt(i);\n            states.forEach(state => {\n                state.nextStates.forEach(nextState => {\n                    if (nextState.charSpec.validChars !== null) {\n                        if (nextState.charSpec.validChars.includes(ch)) {\n                            nextStates.push(nextState);\n                        }\n                    }\n                    else if (nextState.charSpec.invalidChars !== null\n                        && !nextState.charSpec.invalidChars.includes(ch)) {\n                        nextStates.push(nextState);\n                    }\n                });\n            });\n            states = nextStates;\n            if (states.length === 0) {\n                break;\n            }\n        }\n        const solutions = [];\n        for (let i = 0, l = states.length; i < l; i++) {\n            if (states[i].handlers) {\n                solutions.push(states[i]);\n            }\n        }\n        // This is a somewhat naive strategy, but should work in a lot of cases\n        // A better strategy would properly resolve /posts/:id/new and /posts/edit/:id.\n        //\n        // This strategy generally prefers more static and less dynamic matching.\n        // Specifically, it\n        //\n        //  * prefers fewer stars to more, then\n        //  * prefers using stars for less of the match to more, then\n        //  * prefers fewer dynamic segments to more, then\n        //  * prefers more static segments to more\n        solutions.sort((a, b) => {\n            if (a.types.stars !== b.types.stars) {\n                return a.types.stars - b.types.stars;\n            }\n            if (a.types.stars) {\n                if (a.types.statics !== b.types.statics) {\n                    return b.types.statics - a.types.statics;\n                }\n                if (a.types.dynamics !== b.types.dynamics) {\n                    return b.types.dynamics - a.types.dynamics;\n                }\n            }\n            if (a.types.dynamics !== b.types.dynamics) {\n                return a.types.dynamics - b.types.dynamics;\n            }\n            if (a.types.statics !== b.types.statics) {\n                return b.types.statics - a.types.statics;\n            }\n            return 0;\n        });\n        const solution = solutions[0];\n        if (solution && solution.handlers) {\n            // if a trailing slash was dropped and a star segment is the last segment\n            // specified, put the trailing slash back\n            if (isSlashDropped && solution.regex.source.endsWith('(.+)$')) {\n                normalizedPath = `${normalizedPath}/`;\n            }\n            // eslint-disable-next-line @typescript-eslint/prefer-regexp-exec\n            const captures = normalizedPath.match(solution.regex);\n            let currentCapture = 1;\n            const result = [];\n            result.queryParams = queryParams;\n            solution.handlers.forEach(handler => {\n                const params = {};\n                handler.names.forEach(name => {\n                    params[name] = captures[currentCapture++];\n                });\n                result.push(new RecognizeResult(handler.handler, params, handler.names.length > 0));\n            });\n            return result;\n        }\n        return void 0;\n    }\n}\n//# sourceMappingURL=route-recognizer.js.map","/**\n * Class that handles routes configured in a route table\n */\nexport class RouteTable {\n    constructor() {\n        /**\n         * Check a route against the route table and return the appropriate viewport instructions.\n         *\n         * @param route - The route to match.\n         * @param router - The application router.\n         * @returns The viewport instructions for a found route or the route if not found.\n         */\n        this.transformFromUrl = (route, router) => {\n            // TODO: Implement route recognizing to transform a configured route to a set of viewport instructions\n            return route;\n        };\n        /**\n         * Find the route in the route table for a set of viewport instructions.\n         *\n         * @param instructions - The set of viewport instructions to match.\n         * @param router - The application router.\n         * @returns The route for a found set of viewport instructions or the viewport instructions if not found.\n         */\n        this.transformToUrl = (instructions, router) => {\n            // TODO: Implement mapping from set of viewport instructions to a configured route\n            return instructions;\n        };\n    }\n}\n//# sourceMappingURL=route-table.js.map","import { DI, IContainer, Reporter } from '@aurelia/kernel';\nimport { Aurelia, CustomElement } from '@aurelia/runtime';\nimport { BrowserNavigator } from './browser-navigator';\nimport { Guardian } from './guardian';\nimport { InstructionResolver } from './instruction-resolver';\nimport { LinkHandler } from './link-handler';\nimport { Nav } from './nav';\nimport { Navigator } from './navigator';\nimport { parseQuery } from './parser';\nimport { RouteTable } from './route-table';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { arrayRemove } from './utils';\nimport { Viewport } from './viewport';\nimport { ViewportInstruction } from './viewport-instruction';\nexport const IRouteTransformer = DI.createInterface('IRouteTransformer').withDefault(x => x.singleton(RouteTable));\nexport const IRouter = DI.createInterface('IRouter').withDefault(x => x.singleton(Router));\nexport class Router {\n    constructor(container, navigator, navigation, routeTransformer, linkHandler, instructionResolver) {\n        this.container = container;\n        this.navigator = navigator;\n        this.navigation = navigation;\n        this.routeTransformer = routeTransformer;\n        this.linkHandler = linkHandler;\n        this.instructionResolver = instructionResolver;\n        this.rootScope = null;\n        this.navs = {};\n        this.activeComponents = [];\n        this.addedViewports = [];\n        this.options = {\n            useHref: true,\n            statefulHistoryLength: 0,\n        };\n        this.isActive = false;\n        this.loadedFirst = false;\n        this.processingNavigation = null;\n        this.lastNavigation = null;\n        this.linkCallback = (info) => {\n            let instruction = info.instruction || '';\n            if (typeof instruction === 'string' && instruction.startsWith('#')) {\n                instruction = instruction.slice(1);\n                // '#' === '/' === '#/'\n                if (!instruction.startsWith('/')) {\n                    instruction = `/${instruction}`;\n                }\n            }\n            // Adds to Navigator's Queue, which makes sure it's serial\n            this.goto(instruction, { origin: info.anchor }).catch(error => { throw error; });\n        };\n        this.navigatorCallback = (instruction) => {\n            // Instructions extracted from queue, one at a time\n            this.processNavigations(instruction).catch(error => { throw error; });\n        };\n        this.navigatorSerializeCallback = async (entry, preservedEntries) => {\n            let excludeComponents = [];\n            for (const preservedEntry of preservedEntries) {\n                if (typeof preservedEntry.instruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.instruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n                if (typeof preservedEntry.fullStateInstruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.fullStateInstruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n            }\n            excludeComponents = excludeComponents.filter((component, i, arr) => component !== null && arr.indexOf(component) === i);\n            const serialized = { ...entry };\n            let instructions = [];\n            if (serialized.fullStateInstruction && typeof serialized.fullStateInstruction !== 'string') {\n                instructions.push(...serialized.fullStateInstruction);\n                serialized.fullStateInstruction = this.instructionResolver.stringifyViewportInstructions(serialized.fullStateInstruction);\n            }\n            if (serialized.instruction && typeof serialized.instruction !== 'string') {\n                instructions.push(...serialized.instruction);\n                serialized.instruction = this.instructionResolver.stringifyViewportInstructions(serialized.instruction);\n            }\n            instructions = instructions.filter((instruction, i, arr) => instruction !== null\n                && instruction.componentInstance !== null\n                && arr.indexOf(instruction) === i);\n            const alreadyDone = [];\n            for (const instruction of instructions) {\n                await this.freeComponents(instruction, excludeComponents, alreadyDone);\n            }\n            return serialized;\n        };\n        this.browserNavigatorCallback = (browserNavigationEvent) => {\n            const entry = (browserNavigationEvent.state && browserNavigationEvent.state.currentEntry\n                ? browserNavigationEvent.state.currentEntry\n                : { instruction: '', fullStateInstruction: '' });\n            entry.instruction = browserNavigationEvent.instruction;\n            entry.fromBrowser = true;\n            this.navigator.navigate(entry).catch(error => { throw error; });\n        };\n        this.processNavigations = async (qInstruction) => {\n            const instruction = this.processingNavigation = qInstruction;\n            if (this.options.reportCallback) {\n                this.options.reportCallback(instruction);\n            }\n            let fullStateInstruction = false;\n            const instructionNavigation = instruction.navigation;\n            if ((instructionNavigation.back || instructionNavigation.forward) && instruction.fullStateInstruction) {\n                fullStateInstruction = true;\n                // if (!confirm('Perform history navigation?')) {\n                //   this.navigator.cancel(instruction);\n                //   this.processingNavigation = null;\n                //   return Promise.resolve();\n                // }\n            }\n            let instructions;\n            let clearUsedViewports = fullStateInstruction;\n            if (typeof instruction.instruction === 'string') {\n                let path = instruction.instruction;\n                let transformedInstruction = path;\n                if (this.options.transformFromUrl && !fullStateInstruction) {\n                    transformedInstruction = this.options.transformFromUrl(path, this);\n                }\n                if (Array.isArray(transformedInstruction)) {\n                    instructions = transformedInstruction;\n                }\n                else {\n                    path = transformedInstruction;\n                    // TODO: Review this\n                    if (path === '/') {\n                        path = '';\n                    }\n                    instructions = this.instructionResolver.parseViewportInstructions(path);\n                    // TODO: Used to have an early exit if no instructions. Restore it?\n                }\n            }\n            else {\n                instructions = instruction.instruction;\n                // TODO: Used to have an early exit if no instructions. Restore it?\n            }\n            if (instructions.some(instr => this.instructionResolver.isClearAllViewportsInstruction(instr))) {\n                clearUsedViewports = true;\n                instructions = instructions.filter(instr => !this.instructionResolver.isClearAllViewportsInstruction(instr));\n            }\n            const parsedQuery = parseQuery(instruction.query);\n            instruction.parameters = parsedQuery.parameters;\n            instruction.parameterList = parsedQuery.list;\n            // TODO: Fetch title (probably when done)\n            let clearViewports = (clearUsedViewports ? this.allViewports().filter((value) => value.content.componentInstance !== null) : []);\n            const doneDefaultViewports = [];\n            let defaultViewports = this.allViewports().filter(viewport => viewport.options.default\n                && viewport.content.componentInstance === null\n                && doneDefaultViewports.every(done => done !== viewport));\n            const updatedViewports = [];\n            for (const instr of instructions) {\n                if (instr.scope === null) {\n                    instr.scope = this.rootScope;\n                }\n            }\n            const alreadyFoundInstructions = [];\n            // TODO: Take care of cancellations down in subsets/iterations\n            let { found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(instructions, alreadyFoundInstructions);\n            let guard = 100;\n            while (viewportInstructions.length || remainingInstructions.length || defaultViewports.length || clearUsedViewports) {\n                // Guard against endless loop\n                if (!guard--) {\n                    throw Reporter.error(2002);\n                }\n                for (const defaultViewport of defaultViewports) {\n                    doneDefaultViewports.push(defaultViewport);\n                    if (viewportInstructions.every(value => value.viewport !== defaultViewport)) {\n                        const defaultInstruction = this.instructionResolver.parseViewportInstruction(defaultViewport.options.default);\n                        defaultInstruction.viewport = defaultViewport;\n                        viewportInstructions.push(defaultInstruction);\n                    }\n                }\n                const changedViewports = [];\n                const outcome = this.guardian.passes(\"before\" /* Before */, viewportInstructions, instruction);\n                if (!outcome) {\n                    return this.cancelNavigation([...changedViewports, ...updatedViewports], instruction);\n                }\n                if (typeof outcome !== 'boolean') {\n                    viewportInstructions = outcome;\n                }\n                for (const viewportInstruction of viewportInstructions) {\n                    const viewport = viewportInstruction.viewport;\n                    if (viewport.setNextContent(viewportInstruction, instruction)) {\n                        changedViewports.push(viewport);\n                    }\n                    arrayRemove(clearViewports, value => value === viewport);\n                }\n                let results = await Promise.all(changedViewports.map((value) => value.canLeave()));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedViewports, ...updatedViewports], instruction);\n                }\n                results = await Promise.all(changedViewports.map(async (value) => {\n                    const canEnter = await value.canEnter();\n                    if (typeof canEnter === 'boolean') {\n                        if (canEnter) {\n                            return value.enter();\n                        }\n                        else {\n                            return false;\n                        }\n                    }\n                    await this.goto(canEnter, { append: true });\n                    await value.abortContentChange();\n                    // TODO: Abort content change in the viewports\n                    return true;\n                }));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedViewports, ...updatedViewports], qInstruction);\n                }\n                for (const viewport of changedViewports) {\n                    if (updatedViewports.every(value => value !== viewport)) {\n                        updatedViewports.push(viewport);\n                    }\n                }\n                // TODO: Fix multi level recursiveness!\n                alreadyFoundInstructions.push(...viewportInstructions);\n                const remaining = this.findViewports(remainingInstructions, alreadyFoundInstructions);\n                viewportInstructions = [];\n                while (this.addedViewports.length > 0) {\n                    const addedViewport = this.addedViewports.shift();\n                    // TODO: Should this overwrite instead? I think so.\n                    if (remaining.found.every(value => value.viewport !== addedViewport.viewport)) {\n                        viewportInstructions.push(addedViewport);\n                    }\n                }\n                viewportInstructions = [...viewportInstructions, ...remaining.found];\n                remainingInstructions = remaining.remaining;\n                defaultViewports = this.allViewports().filter(viewport => viewport.options.default\n                    && viewport.content.componentInstance === null\n                    && doneDefaultViewports.every(done => done !== viewport)\n                    && updatedViewports.every(updated => updated !== viewport));\n                // clearViewports is empty if we're not clearing viewports\n                if (viewportInstructions.length === 0 &&\n                    remainingInstructions.length === 0 &&\n                    defaultViewports.length === 0) {\n                    viewportInstructions = [\n                        ...viewportInstructions,\n                        ...clearViewports.map(viewport => new ViewportInstruction(this.instructionResolver.clearViewportInstruction, viewport))\n                    ];\n                    clearViewports = [];\n                }\n                // TODO: Do we still need this? What if no viewport at all?\n                // if (!this.allViewports().length) {\n                //   viewportsRemaining = false;\n                // }\n                clearUsedViewports = false;\n            }\n            await Promise.all(updatedViewports.map((value) => value.loadContent()));\n            await this.replacePaths(instruction);\n            this.updateNav();\n            // Remove history entry if no history viewports updated\n            if (instructionNavigation.new && !instructionNavigation.first && !instruction.repeating && updatedViewports.every(viewport => viewport.options.noHistory)) {\n                instruction.untracked = true;\n            }\n            updatedViewports.forEach((viewport) => {\n                viewport.finalizeContentChange();\n            });\n            this.lastNavigation = this.processingNavigation;\n            if (this.lastNavigation.repeating) {\n                this.lastNavigation.repeating = false;\n            }\n            this.processingNavigation = null;\n            await this.navigator.finalize(instruction);\n        };\n        this.guardian = new Guardian();\n    }\n    get isNavigating() {\n        return this.processingNavigation !== null;\n    }\n    get statefulHistory() {\n        return this.options.statefulHistoryLength !== void 0 && this.options.statefulHistoryLength > 0;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Router has already been activated');\n        }\n        this.isActive = true;\n        this.options = {\n            ...this.options,\n            ...{\n                transformFromUrl: this.routeTransformer.transformFromUrl,\n                transformToUrl: this.routeTransformer.transformToUrl,\n            }, ...options\n        };\n        this.instructionResolver.activate({ separators: this.options.separators });\n        this.navigator.activate(this, {\n            callback: this.navigatorCallback,\n            store: this.navigation,\n            statefulHistoryLength: this.options.statefulHistoryLength,\n            serializeCallback: this.statefulHistory ? this.navigatorSerializeCallback : void 0,\n        });\n        this.linkHandler.activate({ callback: this.linkCallback, useHref: this.options.useHref });\n        this.navigation.activate({\n            callback: this.browserNavigatorCallback,\n            useUrlFragmentHash: this.options.useUrlFragmentHash\n        });\n    }\n    loadUrl() {\n        const entry = {\n            ...this.navigation.viewerState,\n            ...{\n                fullStateInstruction: '',\n                replacing: true,\n                fromBrowser: false,\n            }\n        };\n        const result = this.navigator.navigate(entry);\n        this.loadedFirst = true;\n        return result;\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Router has not been activated');\n        }\n        this.linkHandler.deactivate();\n        this.navigator.deactivate();\n        this.navigation.deactivate();\n    }\n    findScope(element) {\n        this.ensureRootScope();\n        return this.closestScope(element);\n    }\n    // External API to get viewport by name\n    getViewport(name) {\n        return this.allViewports().find(viewport => viewport.name === name) || null;\n    }\n    // Called from the viewport custom element in attached()\n    connectViewport(name, element, context, options) {\n        Reporter.write(10000, 'Viewport added', name, element);\n        const parentScope = this.findScope(element);\n        const viewport = parentScope.addViewport(name, element, context, options);\n        let parent = this.closestViewport(element);\n        if (parent === viewport) {\n            if (element.parentElement !== null) {\n                parent = this.closestViewport(element.parentElement);\n            }\n            else {\n                parent = null;\n            }\n        }\n        if (parent !== null) {\n            parent.addChild(viewport);\n        }\n        return viewport;\n    }\n    // Called from the viewport custom element\n    disconnectViewport(viewport, element, context) {\n        if (!viewport.owningScope.removeViewport(viewport, element, context)) {\n            throw new Error(`Failed to remove viewport: ${viewport.name}`);\n        }\n    }\n    allViewports(includeDisabled = false) {\n        this.ensureRootScope();\n        return this.rootScope.allViewports(includeDisabled);\n    }\n    goto(instructions, options) {\n        options = options || {};\n        // TODO: Review query extraction; different pos for path and fragment!\n        if (typeof instructions === 'string' && !options.query) {\n            const [path, search] = instructions.split('?');\n            instructions = path;\n            options.query = search;\n        }\n        if (typeof instructions !== 'string' || instructions !== this.instructionResolver.clearViewportInstruction) {\n            let scope = null;\n            if (options.origin) {\n                scope = this.closestScope(options.origin);\n                if (typeof instructions === 'string') {\n                    // If it's not from scope root, figure out which scope\n                    if (!instructions.startsWith('/')) {\n                        // Scope modifications\n                        if (instructions.startsWith('.')) {\n                            // The same as no scope modification\n                            if (instructions.startsWith('./')) {\n                                instructions = instructions.slice(2);\n                            }\n                            // Find out how many scopes upwards we should move\n                            while (instructions.startsWith('../')) {\n                                scope = scope.parent || scope;\n                                instructions = instructions.slice(3);\n                            }\n                        }\n                    }\n                    else { // Specified root scope with /\n                        scope = this.rootScope;\n                    }\n                }\n                // TODO: Maybe deal with non-strings?\n            }\n            instructions = NavigationInstructionResolver.toViewportInstructions(this, instructions);\n            for (const instruction of instructions) {\n                if (instruction.scope === null) {\n                    instruction.scope = scope;\n                }\n            }\n        }\n        else {\n            instructions = NavigationInstructionResolver.toViewportInstructions(this, instructions);\n        }\n        if (options.append) {\n            if (this.processingNavigation) {\n                this.addedViewports.push(...instructions);\n                // Can't return current navigation promise since it can lead to deadlock in enter\n                return Promise.resolve();\n            }\n            else {\n                // Can only append after first load has happened (defaults can fire too early)\n                if (!this.loadedFirst) {\n                    return Promise.resolve();\n                }\n            }\n        }\n        const entry = {\n            instruction: instructions,\n            fullStateInstruction: '',\n            title: options.title,\n            data: options.data,\n            query: options.query,\n            replacing: options.replace,\n            repeating: options.append,\n            fromBrowser: false,\n        };\n        return this.navigator.navigate(entry);\n    }\n    refresh() {\n        return this.navigator.refresh();\n    }\n    back() {\n        return this.navigator.go(-1);\n    }\n    forward() {\n        return this.navigator.go(1);\n    }\n    setNav(name, routes, classes) {\n        const nav = this.findNav(name);\n        if (nav !== void 0 && nav !== null) {\n            nav.routes = [];\n        }\n        this.addNav(name, routes, classes);\n    }\n    addNav(name, routes, classes) {\n        let nav = this.navs[name];\n        if (nav === void 0 || nav === null) {\n            nav = this.navs[name] = new Nav(this, name, [], classes);\n        }\n        nav.addRoutes(routes);\n        nav.update();\n    }\n    updateNav(name) {\n        const navs = name\n            ? [name]\n            : Object.keys(this.navs);\n        for (const nav of navs) {\n            if (this.navs[nav] !== void 0 && this.navs[nav] !== null) {\n                this.navs[nav].update();\n            }\n        }\n    }\n    findNav(name) {\n        return this.navs[name];\n    }\n    /**\n     * Finds the closest ancestor viewport.\n     *\n     * @param element - The element to search upward from. The element is not searched.\n     * @returns The Viewport that is the closest ancestor.\n     */\n    closestViewport(element) {\n        let el = element;\n        let $viewport = el.$viewport;\n        while (!$viewport && el.parentElement) {\n            el = el.parentElement;\n            $viewport = el.$viewport;\n        }\n        // TODO: Always also check controllers and return the closest one\n        if (el.$viewport) {\n            return el.$viewport;\n        }\n        el = element;\n        let controller = CustomElement.behaviorFor(el);\n        while (!controller && el.parentElement) {\n            el = el.parentElement;\n            CustomElement.behaviorFor(el);\n        }\n        while (controller) {\n            if (controller.host) {\n                const viewport = this.allViewports().find((item) => item.element === controller.host);\n                if (viewport) {\n                    return viewport;\n                }\n            }\n            controller = controller.parent;\n        }\n        return null;\n    }\n    findViewports(instructions, alreadyFound, withoutViewports = false) {\n        const found = [];\n        const remaining = [];\n        while (instructions.length) {\n            const scope = instructions[0].scope;\n            const { foundViewports, remainingInstructions } = scope.findViewports(instructions.filter(instruction => instruction.scope === scope), alreadyFound, withoutViewports);\n            found.push(...foundViewports);\n            remaining.push(...remainingInstructions);\n            instructions = instructions.filter(instruction => instruction.scope !== scope);\n        }\n        return { found, remaining };\n    }\n    async cancelNavigation(updatedViewports, qInstruction) {\n        // TODO: Take care of disabling viewports when cancelling and stateful!\n        updatedViewports.forEach((viewport) => {\n            viewport.abortContentChange().catch(error => { throw error; });\n        });\n        await this.navigator.cancel(qInstruction);\n        this.processingNavigation = null;\n        qInstruction.resolve();\n    }\n    ensureRootScope() {\n        if (!this.rootScope) {\n            const root = this.container.get(Aurelia).root;\n            this.rootScope = new Viewport(this, 'rootScope', root.host, root.controller.context, null, true);\n        }\n    }\n    closestScope(element) {\n        const viewport = this.closestViewport(element);\n        if (viewport && (viewport.scope || viewport.owningScope)) {\n            return viewport.scope || viewport.owningScope;\n        }\n        return this.rootScope;\n    }\n    replacePaths(instruction) {\n        this.rootScope.reparentViewportInstructions();\n        const viewports = this.rootScope.children.filter((viewport) => viewport.enabled && !viewport.content.content.isEmpty());\n        let instructions = viewports.map(viewport => viewport.content.content);\n        // TODO: Check if this is really necessary\n        instructions = this.instructionResolver.cloneViewportInstructions(instructions, true);\n        const alreadyFound = [];\n        let { found, remaining } = this.findViewports(instructions, alreadyFound, true);\n        let guard = 100;\n        while (remaining.length) {\n            // Guard against endless loop\n            if (!guard--) {\n                throw new Error('Failed to find viewport when updating viewer paths.');\n            }\n            alreadyFound.push(...found);\n            ({ found, remaining } = this.findViewports(remaining, alreadyFound, true));\n        }\n        this.activeComponents = instructions;\n        let state = this.instructionResolver.stringifyViewportInstructions(instructions, false, true);\n        if (this.options.transformToUrl) {\n            // TODO: Review this. Also, should it perhaps get full state?\n            const routeOrInstructions = this.options.transformToUrl(this.instructionResolver.parseViewportInstructions(state), this);\n            state = Array.isArray(routeOrInstructions) ? this.instructionResolver.stringifyViewportInstructions(routeOrInstructions) : routeOrInstructions;\n        }\n        const query = (instruction.query && instruction.query.length ? `?${instruction.query}` : '');\n        instruction.path = state + query;\n        const fullViewportStates = [new ViewportInstruction(this.instructionResolver.clearViewportInstruction)];\n        fullViewportStates.push(...this.instructionResolver.cloneViewportInstructions(instructions, this.statefulHistory));\n        instruction.fullStateInstruction = fullViewportStates;\n        return Promise.resolve();\n    }\n    async freeComponents(instruction, excludeComponents, alreadyDone) {\n        const component = instruction.componentInstance;\n        const viewport = instruction.viewport;\n        if (component === null || viewport === null || alreadyDone.some(done => done === component)) {\n            return;\n        }\n        if (!excludeComponents.some(exclude => exclude === component)) {\n            await viewport.freeContent(component);\n            alreadyDone.push(component);\n            return;\n        }\n        if (instruction.nextScopeInstructions !== null) {\n            for (const nextInstruction of instruction.nextScopeInstructions) {\n                await this.freeComponents(nextInstruction, excludeComponents, alreadyDone);\n            }\n        }\n    }\n}\nRouter.inject = [IContainer, Navigator, BrowserNavigator, IRouteTransformer, LinkHandler, InstructionResolver];\n//# sourceMappingURL=router.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Queue } from './queue';\nexport class Navigator {\n    constructor() {\n        this.entries = [];\n        this.options = {\n            statefulHistoryLength: 0,\n        };\n        this.isActive = false;\n        this.processNavigations = (qEntry) => {\n            const entry = qEntry;\n            const navigationFlags = {};\n            if (this.currentEntry === this.uninitializedEntry) { // Refresh or first entry\n                this.loadState();\n                if (this.currentEntry !== this.uninitializedEntry) {\n                    navigationFlags.refresh = true;\n                }\n                else {\n                    navigationFlags.first = true;\n                    navigationFlags.new = true;\n                    // TODO: Should this really be created here? Shouldn't it be in the viewer?\n                    this.currentEntry = {\n                        index: 0,\n                        instruction: '',\n                        fullStateInstruction: '',\n                    };\n                    this.entries = [];\n                }\n            }\n            if (entry.index !== void 0 && !entry.replacing && !entry.refreshing) { // History navigation\n                entry.historyMovement = entry.index - (this.currentEntry.index !== void 0 ? this.currentEntry.index : 0);\n                entry.instruction = this.entries[entry.index] !== void 0 && this.entries[entry.index] !== null ? this.entries[entry.index].fullStateInstruction : entry.fullStateInstruction;\n                entry.replacing = true;\n                if (entry.historyMovement > 0) {\n                    navigationFlags.forward = true;\n                }\n                else if (entry.historyMovement < 0) {\n                    navigationFlags.back = true;\n                }\n            }\n            else if (entry.refreshing || navigationFlags.refresh) { // Refreshing\n                entry.index = this.currentEntry.index;\n            }\n            else if (entry.replacing) { // Replacing\n                navigationFlags.replace = true;\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index;\n            }\n            else { // New entry\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index !== void 0 ? this.currentEntry.index + 1 : this.entries.length;\n            }\n            this.invokeCallback(entry, navigationFlags, this.currentEntry);\n        };\n        this.uninitializedEntry = {\n            instruction: 'NAVIGATOR UNINITIALIZED',\n            fullStateInstruction: '',\n        };\n        this.currentEntry = this.uninitializedEntry;\n        this.pendingNavigations = new Queue(this.processNavigations);\n    }\n    get queued() {\n        return this.pendingNavigations.length;\n    }\n    activate(router, options) {\n        if (this.isActive) {\n            throw new Error('Navigator has already been activated');\n        }\n        this.isActive = true;\n        this.router = router;\n        this.options = { ...options };\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Navigator has not been activated');\n        }\n        this.pendingNavigations.clear();\n        this.isActive = false;\n    }\n    navigate(entry) {\n        return this.pendingNavigations.enqueue(entry);\n    }\n    refresh() {\n        const entry = this.currentEntry;\n        if (entry === this.uninitializedEntry) {\n            return Promise.reject();\n        }\n        entry.replacing = true;\n        entry.refreshing = true;\n        return this.navigate(entry);\n    }\n    go(movement) {\n        const newIndex = (this.currentEntry.index !== undefined ? this.currentEntry.index : 0) + movement;\n        if (newIndex >= this.entries.length) {\n            return Promise.reject();\n        }\n        const entry = this.entries[newIndex];\n        return this.navigate(entry);\n    }\n    setEntryTitle(title) {\n        this.currentEntry.title = title;\n        return this.saveState();\n    }\n    get titles() {\n        if (this.currentEntry == this.uninitializedEntry) {\n            return [];\n        }\n        const index = this.currentEntry.index !== void 0 ? this.currentEntry.index : 0;\n        return this.entries.slice(0, index + 1).filter((value) => !!value.title).map((value) => value.title ? value.title : '');\n    }\n    getState() {\n        const state = this.options.store ? { ...this.options.store.state } : {};\n        const entries = (state.entries || []);\n        const currentEntry = (state.currentEntry || this.uninitializedEntry);\n        return { state, entries, currentEntry };\n    }\n    loadState() {\n        const state = this.getState();\n        this.entries = state.entries;\n        this.currentEntry = state.currentEntry;\n    }\n    async saveState(push = false) {\n        if (this.currentEntry === this.uninitializedEntry) {\n            return Promise.resolve();\n        }\n        const storedEntry = this.toStoredEntry(this.currentEntry);\n        this.entries[storedEntry.index !== undefined ? storedEntry.index : 0] = storedEntry;\n        if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n            const index = this.entries.length - this.options.statefulHistoryLength;\n            for (let i = 0; i < index; i++) {\n                const entry = this.entries[i];\n                if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                    this.entries[i] = await this.options.serializeCallback(entry, this.entries.slice(index));\n                }\n            }\n        }\n        if (!this.options.store) {\n            return Promise.resolve();\n        }\n        const state = {\n            entries: [],\n            currentEntry: { ...this.toStoreableEntry(storedEntry) },\n        };\n        for (const entry of this.entries) {\n            state.entries.push(this.toStoreableEntry(entry));\n        }\n        if (push) {\n            return this.options.store.pushNavigatorState(state);\n        }\n        else {\n            return this.options.store.replaceNavigatorState(state);\n        }\n    }\n    toStoredEntry(entry) {\n        const { previous, fromBrowser, replacing, refreshing, untracked, historyMovement, navigation, resolve, reject, ...storableEntry } = entry;\n        return storableEntry;\n    }\n    async finalize(instruction) {\n        this.currentEntry = instruction;\n        let index = this.currentEntry.index !== undefined ? this.currentEntry.index : 0;\n        if (this.currentEntry.untracked) {\n            if (instruction.fromBrowser && this.options.store) {\n                await this.options.store.popNavigatorState();\n            }\n            index--;\n            this.currentEntry.index = index;\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else if (this.currentEntry.replacing) {\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else { // New entry (add and discard later entries)\n            if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n                // Need to clear the instructions we discard!\n                const indexPreserve = this.entries.length - this.options.statefulHistoryLength;\n                for (const entry of this.entries.slice(index)) {\n                    if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                        await this.options.serializeCallback(entry, this.entries.slice(indexPreserve, index));\n                    }\n                }\n            }\n            this.entries = this.entries.slice(0, index);\n            this.entries.push(this.toStoredEntry(this.currentEntry));\n            await this.saveState(true);\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    async cancel(instruction) {\n        if (instruction.fromBrowser && this.options.store) {\n            if (instruction.navigation && instruction.navigation.new) {\n                await this.options.store.popNavigatorState();\n            }\n            else {\n                await this.options.store.go(-(instruction.historyMovement || 0), true);\n            }\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    invokeCallback(entry, navigationFlags, previousEntry) {\n        const instruction = { ...entry };\n        instruction.navigation = navigationFlags;\n        instruction.previous = this.toStoredEntry(previousEntry);\n        Reporter.write(10000, 'callback', instruction, instruction.previous, this.entries);\n        if (this.options.callback) {\n            this.options.callback(instruction);\n        }\n    }\n    toStoreableEntry(entry) {\n        const storeable = { ...entry };\n        if (storeable.instruction && typeof storeable.instruction !== 'string') {\n            storeable.instruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.instruction);\n        }\n        if (storeable.fullStateInstruction && typeof storeable.fullStateInstruction !== 'string') {\n            storeable.fullStateInstruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.fullStateInstruction);\n        }\n        return storeable;\n    }\n}\n//# sourceMappingURL=navigator.js.map","import { ViewportInstruction } from './viewport-instruction';\nexport class InstructionResolver {\n    constructor() {\n        this.separators = {\n            viewport: '@',\n            sibling: '+',\n            scope: '/',\n            scopeStart: '(',\n            scopeEnd: ')',\n            noScope: '!',\n            parameters: '(',\n            parametersEnd: ')',\n            parameter: '&',\n            add: '+',\n            clear: '-',\n            action: '.',\n        };\n    }\n    activate(options) {\n        options = options || {};\n        this.separators = { ...this.separators, ...options.separators };\n    }\n    get clearViewportInstruction() {\n        return this.separators.clear;\n    }\n    isClearViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportName\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isClearAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !instruction.viewportName\n            : instruction === this.clearViewportInstruction;\n    }\n    parseViewportInstructions(instructions) {\n        return this.parseViewportInstructionsWorker(instructions, true).instructions;\n    }\n    parseViewportInstruction(instruction) {\n        const instructions = this.parseViewportInstructions(instruction);\n        if (instructions.length) {\n            return instructions[0];\n        }\n        return new ViewportInstruction('');\n    }\n    stringifyViewportInstructions(instructions, excludeViewport = false, viewportContext = false) {\n        return instructions\n            .map(instruction => this.stringifyViewportInstruction(instruction, excludeViewport, viewportContext))\n            .filter(instruction => instruction && instruction.length)\n            .join(this.separators.sibling);\n    }\n    stringifyViewportInstruction(instruction, excludeViewport = false, viewportContext = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyAViewportInstruction(instruction, excludeViewport);\n        }\n        else {\n            let excludeCurrentViewport = excludeViewport;\n            if (viewportContext) {\n                if (instruction.viewport && instruction.viewport.options.noLink) {\n                    return '';\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewport && !instruction.viewport.options.forceDescription) {\n                    excludeCurrentViewport = true;\n                }\n            }\n            let stringified = this.stringifyAViewportInstruction(instruction, excludeCurrentViewport);\n            if (instruction.nextScopeInstructions && instruction.nextScopeInstructions.length) {\n                stringified += instruction.nextScopeInstructions.length === 1\n                    ? `${this.separators.scope}${this.stringifyViewportInstructions(instruction.nextScopeInstructions, excludeViewport, viewportContext)}`\n                    : `${this.separators.scope}${this.separators.scopeStart}${this.stringifyViewportInstructions(instruction.nextScopeInstructions, excludeViewport, viewportContext)}${this.separators.scopeEnd}`;\n            }\n            return stringified;\n        }\n    }\n    stringifyScopedViewportInstructions(instructions) {\n        if (!Array.isArray(instructions)) {\n            return this.stringifyScopedViewportInstructions([instructions]);\n        }\n        return instructions.map((instruction) => this.stringifyViewportInstruction(instruction)).join(this.separators.scope);\n    }\n    encodeViewportInstructions(instructions) {\n        return encodeURIComponent(this.stringifyViewportInstructions(instructions)).replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n    }\n    decodeViewportInstructions(instructions) {\n        return this.parseViewportInstructions(decodeURIComponent(instructions));\n    }\n    buildScopedLink(scopeContext, href) {\n        if (scopeContext) {\n            href = `/${scopeContext}${this.separators.scope}${href}`;\n        }\n        return href;\n    }\n    shouldClearViewports(path) {\n        const clearViewports = (path === this.separators.clear || path.startsWith(this.separators.clear + this.separators.add));\n        const newPath = path.startsWith(this.separators.clear) ? path.slice(2) : path;\n        return { clearViewports, newPath };\n    }\n    mergeViewportInstructions(instructions) {\n        const merged = [];\n        for (let instruction of instructions) {\n            if (typeof instruction === 'string') {\n                instruction = this.parseViewportInstruction(instruction);\n            }\n            const index = merged.findIndex(merge => merge.sameViewport(instruction));\n            if (index >= 0) {\n                merged.splice(index, 1, instruction);\n            }\n            else {\n                merged.push(instruction);\n            }\n        }\n        return merged;\n    }\n    flattenViewportInstructions(instructions) {\n        const flat = [];\n        for (const instruction of instructions) {\n            flat.push(instruction);\n            if (instruction.nextScopeInstructions) {\n                flat.push(...this.flattenViewportInstructions(instruction.nextScopeInstructions));\n            }\n        }\n        return flat;\n    }\n    cloneViewportInstructions(instructions, viewportInstances = false) {\n        const clones = [];\n        for (const instruction of instructions) {\n            const clone = new ViewportInstruction(instruction.componentInstance || instruction.componentType || instruction.componentName, viewportInstances ? instruction.viewport || instruction.viewportName : instruction.viewportName, instruction.parametersString);\n            clone.needsViewportDescribed = instruction.needsViewportDescribed;\n            clone.scope = viewportInstances ? instruction.scope : null;\n            if (instruction.nextScopeInstructions) {\n                clone.nextScopeInstructions = this.cloneViewportInstructions(instruction.nextScopeInstructions, viewportInstances);\n            }\n            clones.push(clone);\n        }\n        return clones;\n    }\n    parseViewportInstructionsWorker(instructions, grouped = false) {\n        if (!instructions) {\n            return { instructions: [], remaining: '' };\n        }\n        if (instructions.startsWith(this.separators.scopeStart)) {\n            instructions = `${this.separators.scope}${instructions}`;\n        }\n        const viewportInstructions = [];\n        let guard = 10;\n        while (instructions.length && guard) {\n            guard--;\n            if (instructions.startsWith(this.separators.scope)) {\n                instructions = instructions.slice(this.separators.scope.length);\n                const scopeStart = instructions.startsWith(this.separators.scopeStart);\n                if (scopeStart) {\n                    instructions = instructions.slice(this.separators.scopeStart.length);\n                }\n                const { instructions: found, remaining } = this.parseViewportInstructionsWorker(instructions, scopeStart);\n                if (viewportInstructions.length) {\n                    viewportInstructions[viewportInstructions.length - 1].nextScopeInstructions = found;\n                }\n                else {\n                    viewportInstructions.push(...found);\n                }\n                instructions = remaining;\n            }\n            else if (instructions.startsWith(this.separators.scopeEnd)) {\n                if (grouped) {\n                    instructions = instructions.slice(this.separators.scopeEnd.length);\n                }\n                return { instructions: viewportInstructions, remaining: instructions };\n            }\n            else if (instructions.startsWith(this.separators.sibling)) {\n                if (!grouped) {\n                    return { instructions: viewportInstructions, remaining: instructions };\n                }\n                instructions = instructions.slice(this.separators.sibling.length);\n            }\n            else {\n                const { instruction: viewportInstruction, remaining } = this.parseAViewportInstruction(instructions);\n                viewportInstructions.push(viewportInstruction);\n                instructions = remaining;\n            }\n        }\n        return { instructions: viewportInstructions, remaining: instructions };\n    }\n    findNextToken(instruction, tokens) {\n        const matches = {};\n        // Tokens can have length > 1\n        for (const token of tokens) {\n            const tokenPos = instruction.indexOf(token);\n            if (tokenPos > -1) {\n                matches[token] = instruction.indexOf(token);\n            }\n        }\n        const pos = Math.min(...Object.values(matches));\n        for (const token in matches) {\n            if (matches[token] === pos) {\n                return { token, pos };\n            }\n        }\n        return { token: '', pos: -1 };\n    }\n    parseAViewportInstruction(instruction) {\n        const seps = this.separators;\n        const tokens = [seps.parameters, seps.viewport, seps.noScope, seps.scopeEnd, seps.scope, seps.sibling];\n        let { token, pos } = this.findNextToken(instruction, tokens);\n        const component = pos !== -1 ? instruction.slice(0, pos) : instruction;\n        instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n        let parametersString = void 0;\n        tokens.shift(); // parameters\n        if (token === seps.parameters) {\n            ({ token, pos } = this.findNextToken(instruction, [seps.parametersEnd]));\n            parametersString = instruction.slice(0, pos);\n            instruction = instruction.slice(pos + token.length);\n            ({ token } = this.findNextToken(instruction, tokens));\n            instruction = instruction.slice(token.length);\n        }\n        let viewport = void 0;\n        tokens.shift(); // viewport\n        if (token === seps.viewport) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            viewport = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n        }\n        let scope = true;\n        tokens.shift(); // noScope\n        if (token === seps.noScope) {\n            scope = false;\n        }\n        // Restore token that belongs to next instruction\n        if (token === seps.scopeEnd || token === seps.scope || token === seps.sibling) {\n            instruction = `${token}${instruction}`;\n        }\n        return { instruction: new ViewportInstruction(component, viewport, parametersString, scope), remaining: instruction };\n    }\n    stringifyAViewportInstruction(instruction, excludeViewport = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyViewportInstruction(this.parseViewportInstruction(instruction), excludeViewport);\n        }\n        else {\n            let instructionString = instruction.componentName;\n            if (instruction.parametersString) {\n                // TODO: Review parameters in ViewportInstruction\n                instructionString += this.separators.parameters + instruction.parametersString + this.separators.parametersEnd;\n            }\n            if (instruction.viewportName !== null && !excludeViewport) {\n                instructionString += this.separators.viewport + instruction.viewportName;\n            }\n            if (!instruction.ownsScope) {\n                instructionString += this.separators.noScope;\n            }\n            return instructionString || '';\n        }\n    }\n}\n//# sourceMappingURL=instruction-resolver.js.map","import { __decorate, __param } from \"tslib\";\nimport { customAttribute, INode, bindable, BindingMode } from '@aurelia/runtime';\nlet GotoCustomAttribute = class GotoCustomAttribute {\n    constructor(element) {\n        this.element = element;\n        this.hasHref = null;\n    }\n    binding() {\n        this.updateValue();\n    }\n    valueChanged(newValue) {\n        this.updateValue();\n    }\n    updateValue() {\n        if (this.hasHref === null) {\n            this.hasHref = this.element.hasAttribute('href');\n        }\n        if (!this.hasHref) {\n            // TODO: Figure out a better value here for non-strings (using InstructionResolver?)\n            const value = typeof this.value === 'string' ? this.value : JSON.stringify(this.value);\n            this.element.setAttribute('href', value);\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.toView })\n], GotoCustomAttribute.prototype, \"value\", void 0);\nGotoCustomAttribute = __decorate([\n    customAttribute('goto'),\n    __param(0, INode)\n], GotoCustomAttribute);\nexport { GotoCustomAttribute };\n//# sourceMappingURL=goto.js.map","import { __decorate } from \"tslib\";\nimport { inject } from '@aurelia/kernel';\nimport { bindable, customElement, INode } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nlet NavCustomElement = class NavCustomElement {\n    constructor(router) {\n        this.router = router;\n        this.name = null;\n        this.routes = null;\n        this.level = 0;\n        this.classes = {};\n    }\n    get navRoutes() {\n        const nav = this.router.navs[this.name];\n        return (nav !== void 0 && nav !== null ? nav.routes : []);\n    }\n    get navClasses() {\n        const nav = this.router.navs[this.name];\n        const navClasses = (nav !== void 0 && nav !== null ? nav.classes : {});\n        return {\n            ...{\n                nav: '',\n                ul: '',\n                li: '',\n                a: '',\n                ulActive: '',\n                liActive: 'nav-active',\n                aActive: '',\n            }, ...navClasses\n        };\n    }\n    active(route) {\n        return 'Active';\n    }\n};\n__decorate([\n    bindable\n], NavCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable\n], NavCustomElement.prototype, \"routes\", void 0);\n__decorate([\n    bindable\n], NavCustomElement.prototype, \"level\", void 0);\n__decorate([\n    bindable\n], NavCustomElement.prototype, \"classes\", void 0);\nNavCustomElement = __decorate([\n    inject(IRouter, INode),\n    customElement({\n        name: 'au-nav', template: `<template>\n  <nav if.bind=\"name\" class=\"\\${name} \\${navClasses.nav}\">\n    <au-nav routes.bind=\"navRoutes\" classes.bind=\"navClasses\" containerless></au-nav>\n  </nav>\n  <ul if.bind=\"routes\" class=\"nav-level-\\${level} \\${classes.ul}\">\n    <li repeat.for=\"route of routes\" if.bind=\"route.visible\" class=\"\\${route.active ? classes.liActive : ''} \\${route.hasChildren} \\${classes.li}\">\n      <a if.bind=\"route.link && route.link.length\" href=\"\\${route.link}\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <a if.bind=\"route.execute\" click.trigger=\"route.executeAction($event)\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <span if.bind=\"(!route.link || !route.link.length) && !route.execute && !route.children\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.span} nav-separator\" innerhtml.bind=\"route.title\"></span>\n      <a if.bind=\"(!route.link || !route.link.length) && !route.execute && route.children\" click.delegate=\"route.toggleActive()\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <au-nav if.bind=\"route.children\" routes.bind=\"route.children\" level.bind=\"level + 1\" classes.bind=\"classes\" containerless></au-nav>\n    </li>\n  </ul>\n</template>`\n    })\n], NavCustomElement);\nexport { NavCustomElement };\n//# sourceMappingURL=nav.js.map","import { __decorate, __param } from \"tslib\";\nimport { bindable, INode, customElement, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nlet ViewportCustomElement = class ViewportCustomElement {\n    constructor(router, element) {\n        this.router = router;\n        this.element = element;\n        this.name = 'default';\n        this.usedBy = '';\n        this.default = '';\n        this.noScope = false;\n        this.noLink = false;\n        this.noHistory = false;\n        this.stateful = false;\n        this.viewport = null;\n    }\n    // public created(...rest): void {\n    //   console.log('Created', rest);\n    //   const booleanAttributes = {\n    //     'scope': 'scope',\n    //     'no-link': 'noLink',\n    //     'no-history': 'noHistory',\n    //   };\n    //   const valueAttributes = {\n    //     'used-by': 'usedBy',\n    //     'default': 'default',\n    //   };\n    //   const name = this.element.hasAttribute('name') ? this.element.getAttribute('name') : 'default';\n    //   const options: IViewportOptions = {};\n    //   for (const attribute in booleanAttributes) {\n    //     if (this.element.hasAttribute[attribute]) {\n    //       options[booleanAttributes[attribute]] = true;\n    //     }\n    //   }\n    //   for (const attribute in valueAttributes) {\n    //     if (this.element.hasAttribute(attribute)) {\n    //       const value = this.element.getAttribute(attribute);\n    //       if (value && value.length) {\n    //         options[valueAttributes[attribute]] = value;\n    //       }\n    //     }\n    //   }\n    //   this.viewport = this.router.addViewport(name, this.element, (this as any).$context.get(IContainer), options);\n    // }\n    bound() {\n        this.connect();\n    }\n    unbound() {\n        this.disconnect();\n    }\n    attached() {\n        if (this.viewport) {\n            this.viewport.clearTaggedNodes();\n        }\n    }\n    connect() {\n        const options = { scope: !this.element.hasAttribute('no-scope') };\n        if (this.usedBy && this.usedBy.length) {\n            options.usedBy = this.usedBy;\n        }\n        if (this.default && this.default.length) {\n            options.default = this.default;\n        }\n        if (this.element.hasAttribute('no-link')) {\n            options.noLink = true;\n        }\n        if (this.element.hasAttribute('no-history')) {\n            options.noHistory = true;\n        }\n        if (this.element.hasAttribute('stateful')) {\n            options.stateful = true;\n        }\n        this.viewport = this.router.connectViewport(this.name, this.element, this.$controller.context, options);\n    }\n    disconnect() {\n        if (this.viewport) {\n            this.router.disconnectViewport(this.viewport, this.element, this.$controller.context);\n        }\n    }\n    binding(flags) {\n        if (this.viewport) {\n            this.viewport.binding(flags);\n        }\n    }\n    attaching(flags) {\n        if (this.viewport) {\n            return this.viewport.attaching(flags);\n        }\n        return Promise.resolve();\n    }\n    detaching(flags) {\n        if (this.viewport) {\n            return this.viewport.detaching(flags);\n        }\n        return Promise.resolve();\n    }\n    async unbinding(flags) {\n        if (this.viewport) {\n            await this.viewport.unbinding(flags);\n        }\n    }\n};\n__decorate([\n    bindable\n], ViewportCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable\n], ViewportCustomElement.prototype, \"usedBy\", void 0);\n__decorate([\n    bindable\n], ViewportCustomElement.prototype, \"default\", void 0);\n__decorate([\n    bindable\n], ViewportCustomElement.prototype, \"noScope\", void 0);\n__decorate([\n    bindable\n], ViewportCustomElement.prototype, \"noLink\", void 0);\n__decorate([\n    bindable\n], ViewportCustomElement.prototype, \"noHistory\", void 0);\n__decorate([\n    bindable\n], ViewportCustomElement.prototype, \"stateful\", void 0);\nViewportCustomElement = __decorate([\n    customElement({\n        name: 'au-viewport',\n        template: `\n    <template>\n      <div class=\"viewport-header\" style=\"display: none;\">\n        Viewport: <b>\\${name}</b> \\${scope ? \"[new scope]\" : \"\"} : <b>\\${viewport.content && viewport.content.toComponentName()}</b>\n      </div>\n    </template>\n  `.replace(/\\s+/g, '')\n    }),\n    __param(0, IRouter),\n    __param(1, INode)\n], ViewportCustomElement);\nexport { ViewportCustomElement };\n//# sourceMappingURL=viewport.js.map","import { GotoCustomAttribute } from './resources/goto';\nimport { DI } from '@aurelia/kernel';\nimport { StartTask } from '@aurelia/runtime';\nimport { NavCustomElement } from './resources/nav';\nimport { ViewportCustomElement } from './resources/viewport';\nimport { IRouter } from './router';\nexport const RouterRegistration = IRouter;\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IRouter`\n */\nexport const DefaultComponents = [\n    RouterRegistration,\n];\nexport { ViewportCustomElement, NavCustomElement, GotoCustomAttribute, };\nexport const ViewportCustomElementRegistration = ViewportCustomElement;\nexport const NavCustomElementRegistration = NavCustomElement;\nexport const GotoCustomAttributeRegistration = GotoCustomAttribute;\n/**\n * Default router resources:\n * - Custom Elements: `au-viewport`, `au-nav`\n * - Custom Attributes: `goto`\n */\nexport const DefaultResources = [\n    ViewportCustomElement,\n    NavCustomElement,\n    GotoCustomAttribute,\n];\nlet configurationOptions = {};\nlet configurationCall = (router) => {\n    router.activate(configurationOptions);\n};\n/**\n * A DI configuration object containing router resource registrations.\n */\nconst routerConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, StartTask.with(IRouter).beforeBind().call(configurationCall), StartTask.with(IRouter).beforeAttach().call(router => router.loadUrl()));\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport const RouterConfiguration = {\n    /**\n     * Make it possible to specify options to Router activation.\n     * Parameter is either a config object that's passed to Router's activate\n     * or a config function that's called instead of Router's activate.\n     */\n    customize(config) {\n        if (config === undefined) {\n            configurationOptions = {};\n            configurationCall = (router) => {\n                router.activate(configurationOptions);\n            };\n        }\n        else if (config instanceof Function) {\n            configurationCall = config;\n        }\n        else {\n            configurationOptions = config;\n        }\n        return { ...routerConfiguration };\n    },\n    ...routerConfiguration,\n};\n//# sourceMappingURL=configuration.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport { valueConverter } from \"@aurelia/runtime\";\r\nlet AsDateValueConverter = class AsDateValueConverter {\r\n    toView(value) {\r\n        return value ? value.toDateString() : '';\r\n    }\r\n};\r\nAsDateValueConverter = __decorate([\r\n    valueConverter({\r\n        name: 'asDate'\r\n    })\r\n], AsDateValueConverter);\r\nexport { AsDateValueConverter };\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport { AsDateValueConverter } from './../converters/date';\r\nimport { customElement, bindable, BindingMode } from \"@aurelia/runtime\";\r\nimport template from './date-picker.html';\r\nfunction daysInMonth(year, month) {\r\n    if (year instanceof Date) {\r\n        month = year.getMonth();\r\n        year = year.getFullYear();\r\n    }\r\n    switch (month) {\r\n        case 3:\r\n        case 5:\r\n        case 8:\r\n        case 10:\r\n            return 30;\r\n        case 0:\r\n        case 2:\r\n        case 4:\r\n        case 6:\r\n        case 7:\r\n        case 9:\r\n        case 11:\r\n            return 31;\r\n        case 1:\r\n            return year % 4 === 0 ? 29 : 28;\r\n    }\r\n}\r\nlet AuDatePickerCustomElement = class AuDatePickerCustomElement {\r\n    constructor() {\r\n        this.value = new Date();\r\n        this.currentYear = this.value.getFullYear();\r\n        this.currentMonth = this.value.getMonth();\r\n        this.state = 0;\r\n    }\r\n    valueChanged(value = new Date()) {\r\n        this.currentYear = value.getFullYear();\r\n        this.currentMonth = value.getMonth();\r\n    }\r\n    setMonth(month) {\r\n        this.currentMonth = month;\r\n    }\r\n    weeksInMonth(year, month) {\r\n        const firstDay = new Date(year, month, 1).getDay();\r\n        return Math.ceil((daysInMonth(year, month) + firstDay) / 7);\r\n    }\r\n    getDate(year, month, day) {\r\n        const firstDay = new Date(year, month, 1).getDay();\r\n        const date = day - firstDay + 1;\r\n        if (date < 1) {\r\n            return daysInMonth(year, month - 1) + date;\r\n        }\r\n        const lastDay = daysInMonth(year, month);\r\n        if (date > lastDay) {\r\n            return date % lastDay;\r\n        }\r\n        return date;\r\n    }\r\n    getWeekday(day) {\r\n        return {\r\n            0: 'Sun',\r\n            1: 'Mon',\r\n            2: 'Tue',\r\n            3: 'Wed',\r\n            4: 'Thur',\r\n            5: 'Fri',\r\n            6: 'Sat'\r\n        }[day];\r\n    }\r\n    getMonth(month) {\r\n        return {\r\n            0: 'January',\r\n            1: 'February',\r\n            2: 'March',\r\n            3: 'April',\r\n            4: 'May',\r\n            5: 'June',\r\n            6: 'July',\r\n            7: 'August',\r\n            8: 'September',\r\n            9: 'October',\r\n            10: 'November',\r\n            11: 'December'\r\n        }[month];\r\n    }\r\n    open() {\r\n        this.state = 1;\r\n    }\r\n    close() {\r\n        this.state = 0;\r\n    }\r\n};\r\n__decorate([\r\n    bindable({ mode: BindingMode.twoWay }),\r\n    __metadata(\"design:type\", Date)\r\n], AuDatePickerCustomElement.prototype, \"value\", void 0);\r\nAuDatePickerCustomElement = __decorate([\r\n    customElement({\r\n        name: 'au-date-picker',\r\n        template,\r\n        dependencies: [AsDateValueConverter]\r\n    })\r\n], AuDatePickerCustomElement);\r\nexport { AuDatePickerCustomElement };\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport { AuDatePickerCustomElement } from '../elements/date-picker';\r\nimport template from './date-picker.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nlet DatePickerViewModel = class DatePickerViewModel {\r\n};\r\nDatePickerViewModel = __decorate([\r\n    customElement({\r\n        name: 'date-picker',\r\n        template,\r\n        dependencies: [AuDatePickerCustomElement]\r\n    })\r\n], DatePickerViewModel);\r\nexport { DatePickerViewModel };\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport { DatePickerViewModel } from './pages/date-picker';\r\nimport { customElement } from '@aurelia/runtime';\r\nimport template from './shell.html';\r\nlet ShellViewModel = class ShellViewModel {\r\n    constructor() {\r\n        this.modules = [\r\n            'date-picker',\r\n            'date-range'\r\n        ];\r\n    }\r\n};\r\nShellViewModel = __decorate([\r\n    customElement({\r\n        name: 'shell',\r\n        template,\r\n        dependencies: [DatePickerViewModel]\r\n    })\r\n], ShellViewModel);\r\nexport { ShellViewModel };\r\n","import { Aurelia } from '@aurelia/runtime';\r\nimport { JitHtmlBrowserConfiguration } from '@aurelia/jit-html-browser';\r\nimport { RouterConfiguration } from '@aurelia/router';\r\nimport { ShellViewModel } from './shell';\r\nimport { AsDateValueConverter } from './converters/date';\r\nnew Aurelia()\r\n    .register(JitHtmlBrowserConfiguration, RouterConfiguration, AsDateValueConverter)\r\n    .app({\r\n    host: document.body,\r\n    component: ShellViewModel,\r\n})\r\n    .start();\r\n"],"sourceRoot":""}